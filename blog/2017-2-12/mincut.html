<!DOCTYPE html> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1.0"> <title>无向图最小割 - riteme.site</title> <link rel="shortcut icon" href="/favicon.png" type="image/png"> <link rel=stylesheet  href="/styles/material-icons.css"> <link rel=stylesheet  href="/styles/material.min.css" > <link rel=stylesheet  href="/styles/gitment.css"> <link rel=stylesheet  href="/math-renderer/katex/katex.min.css"> <link rel=stylesheet  href="/styles/site.css"> <script src="/scripts/jquery.min.js"></script> <script src="/scripts/js-cookie.js"></script> <script src="/scripts/quicklink.umd.js"></script> <script defer src="/scripts/material.min.js"></script> <script src="/scripts/site.js"></script> <script src="/scripts/gitment.js"></script> <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header"> <header class=mdl-layout__header > <div class=mdl-layout__header-row > <span class=mdl-layout-title >无向图最小割</span> <div class=mdl-layout-spacer ></div> <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right"> <label class="mdl-button mdl-js-button mdl-button--icon" for=fixed-header-drawer-exp ><i class=material-icons >search</i></label> <div class=mdl-textfield__expandable-holder > <form action="/search.html"><input type=text  class=mdl-textfield__input  placeholder="Search Here" name=q  id=fixed-header-drawer-exp  autocomplete=off  required></form> </div> </div> </div> </header> <div class=mdl-layout__drawer > <span class="mdl-layout-title drawer-title"> <a href="/index.html" style="color: inherit; font-weight: inherit;text-decoration: none;"><img src="/favicon.png" width=32 height=32> riteme.site</a> </span> <nav class=mdl-navigation > <a class=mdl-navigation__link  href="/index.html"><i class="material-icons drawer-icon">home</i> 首页</a> <a class=mdl-navigation__link  href="/posts.html"><i class="material-icons drawer-icon">library_books</i> 所有文章</a> <a class=mdl-navigation__link  href="/about.html"><i class="material-icons drawer-icon">info</i> 关于</a> <a class=mdl-navigation__link  href="/links.html"><i class="material-icons drawer-icon">link</i> 友链</a> <a class=mdl-navigation__link  href="/search.html"><i class="material-icons drawer-icon">search</i> 搜索</a> <a class=mdl-navigation__link  href="https://github.com/riteme/riteme.github.io"><i class="material-icons drawer-icon">class</i> GitHub 项目</a> </nav> </div> <main class=mdl-layout__content > <div class=mdl-grid > <div class="mdl-cell main-cell"> <div class="article main-article" lang=en-US > <h1 id=_1 >无向图最小割</h1> <h2 id=_2 >基本定义</h2> <p>对于一张无向带权图<tex>$G = (V, E, w)$</tex>，将点集<tex>$V$</tex>分为两个不相交的集合<tex>$S$</tex>和<tex>$T$</tex>，满足<tex>$S \cup T = V$</tex>，那么称<tex>$C = (S, T)$</tex>是图<tex>$G$</tex>的一个<strong>割</strong>。<strong>割的权值</strong>定义为两个端点不在同一集合内的边的权值之和，记做<tex>$W(C)$</tex>：</p> <p><tex>$$ W(C) = \sum_{u \in S, v \in T, (u, v) \in E} w(u, v) \tag{1.1} $$</tex></p> <p>对于指定的<tex>$s$</tex>和<tex>$t$</tex>，如果存在一个割<tex>$C = (S, T)$</tex>满足<tex>$s \in S, t \in T$</tex>或者<tex>$s \in T, t \in S$</tex>，那么称这个割为<strong><tex>$s$</tex>-<tex>$t$</tex>割</strong>。</p> <p>对于一张图，权值最小的割称为<strong>最小割</strong>。多数情况下，最小割不是唯一的。</p> <p>例如，在下图中：</p> <p><img alt=graph-example  src="https://git.oschina.net/riteme/blogimg/raw/master/mincut/graph-example.svg" /></p> <p><tex>$(\{2\}, \{1,3,4,5,6\})$</tex>和<tex>$(\{4\}, \{1,2,3,5,6\})$</tex>均是最小割，其权值为<tex>$3$</tex>。而<tex>$(\{1,2,3\}, \{4,5,6\})$</tex>是一个<tex>$1$</tex>-<tex>$6$</tex>最小割，其权值为<tex>$51$</tex>。</p> <p>为了方便，我们对于任意的不相交集合<tex>$U$</tex>、<tex>$V$</tex>，要求<tex>$U \cup V \subseteq V$</tex>，定义它们之间的权值为：</p> <p><tex>$$ W(U, V) = \sum_{u \in U, v \in V, (u, v) \in E} w(u, v) \tag{1.2} $$</tex></p> <p>换言之。权值是横跨<tex>$U$</tex>和<tex>$V$</tex>的边的权值之和。</p> <p>现在来考虑一个比较浅显的定理：</p> <blockquote> <p>对于任意四个不相交集合<tex>$S_1$</tex>、<tex>$T_1$</tex>、<tex>$S_2$</tex>和<tex>$T_2$</tex>，满足<tex>$S_1 \cup T_1 \cup S_2 \cup T_2 \subseteq V$</tex>，那么一定有：<br /> <tex>$$ W(S_1, T_1) + W(S_2, T_2) \leqslant W(S_1 \cup S_2, T_1 \cup T_2) \tag{1.3}$$</tex></p> </blockquote> <p><strong>证明</strong>：<br /> <tex>$$ \begin{aligned} &amp; W(S_1 \cup S_2, T_1 \cup T_2) = W(S_1, T_1) + W(S_1, T_2) + W(S_2, T_1) + W(S_2, T_2) \\ &amp; \because W(S_1, T_2), W(S_2, T_1) \geqslant 0\\ &amp; \therefore W(S_1 \cup S_2, T_1 \cup T_2) \geqslant W(S_1, T_1) + W(S_2, T_2) \end{aligned} $$</tex></p> <h2 id=s-t >求解<tex>$s$</tex>-<tex>$t$</tex>最小割</h2> <p>利用最大流最小割定理，一个图的<tex>$s$</tex>-<tex>$t$</tex>最小割实际上就是将原图建成一个源点为<tex>$s$</tex>，汇点为<tex>$t$</tex>的网络上的最大流，因此可以采用各种最大流算法来解决。这里不再详细介绍。</p> <h2 id=_3 >求解全局最小割</h2> <p>所谓全局最小割就是无向图本身的最小割，没有限定<tex>$s$</tex>和<tex>$t$</tex>。考虑到一个<tex>$s$</tex>-<tex>$t$</tex>最小割可能成为全局最小割，所以可以想出以下的过程：</p> <blockquote> <ol> <li>令<tex>$i = 1, w_0 = \infty$</tex>。 <li>如果<tex>$|V| \leqslant 1$</tex>，返回<tex>$\min\{w_0, w_1, \dots, w_{n - 1}\}$</tex>。 <li>随便选定两个点<tex>$s$</tex>和<tex>$t$</tex>，求出其<tex>$s$</tex>-<tex>$t$</tex>最小割，记权值为<tex>$w_i$</tex>。 <li>将<tex>$s$</tex>和<tex>$t$</tex>合并，即将<tex>$E$</tex>中的每条边的<tex>$t$</tex>改成<tex>$s$</tex>，并从<tex>$V$</tex>中删去<tex>$t$</tex>。 <li><tex>$i = i + 1$</tex>，跳回第二步。 </ol> </blockquote> <p>这样做的理由是：假设全局最小割为<tex>$(S, T)$</tex>，那么分两种情况：</p> <ol> <li>如果<tex>$s$</tex>和<tex>$t$</tex>分别在<tex>$S$</tex>和<tex>$T$</tex>中，那么<tex>$s$</tex>-<tex>$t$</tex>的最小割就是全局最小割。 <li>如果<tex>$s$</tex>和<tex>$t$</tex>同在<tex>$S$</tex>或<tex>$T$</tex>内，那么将<tex>$s$</tex>和<tex>$t$</tex>合并为一个点后，不会影响割的权值。 </ol> <p>这样我们可以在<tex>$\Theta(n)$</tex>次网络流内求出最小割。但是由于网络流算法时间复杂度比较高，所以这并不是一个很优的过程。</p> <p>考虑到在第三步中，我们实际上并不关心<tex>$s$</tex>和<tex>$t$</tex>是谁，我们只在意得到一个<tex>$s$</tex>-<tex>$t$</tex>最小割。那么是不是可以实现一个更加高效的方法来求出任意一个<tex>$s$</tex>-<tex>$t$</tex>最小割呢？</p> <p>现在来考虑以下这个算法：</p> <table class=codehilitetable ><tr><td class=linenos ><div class=linenodiv ><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div><td class=code ><div class=codehilite ><pre><span></span>function ST-MINCUT(G):
    assert |V| &gt; 1

    A = {}
    B = V
    s = 0
    t = 0
    while |B| &gt; 0:
        p = 0
        for u in B:
            if W(A, {u}) &gt; W(A, {p}):  // Assume that W(A, 0) = 0
                p = u

        A = A ∪ p
        B = B - {p}
        s = t
        t = p

    return (s, t)
</pre></div> </table> <p>该算法会返回一个二元组<tex>$(s, t)$</tex>，表示<tex>$(V - {t}, {t})$</tex>是一个<tex>$s$</tex>-<tex>$t$</tex>最小割。<br /> 下面我们将证明这是对的：</p> <blockquote> <p>设<tex>$s$</tex>和<tex>$t$</tex>为<code>ST-MINCUT</code>中<tex>$A$</tex>集合倒数第二个加入的点和最后加入的点，那么<tex>$(V - \{t\}, \{t\})$</tex>是一个<tex>$s$</tex>-<tex>$t$</tex>最小割。</p> </blockquote> <p><strong>证明</strong><sup id="fnref:mistake"><a class=footnote-ref  href="#fn:mistake" rel=footnote >1</a></sup>：<br /> 我们令<tex>$S^\prime = V - \{t\}$</tex>、<tex>$T^\prime = \{t\}$</tex>。对于图中任意一个<tex>$s$</tex>-<tex>$t$</tex>割<tex>$C = (S, T)$</tex>，假设<tex>$t \in T$</tex>并且<tex>$s \in S$</tex>。设<tex>$t^\prime = v_i$</tex>为<tex>$T$</tex>中除了<tex>$t$</tex>之外最后被加入<tex>$A$</tex>的点。令<tex>$V_i = \{v_1, v_2, \dots, v_i\}$</tex>。此外我们注意到<tex>$V_i$</tex>实际上是<code>ST-MINCUT</code>算法在<tex>$G$</tex>关于<tex>$V_i$</tex>的导出子图上的运行结果。<br /> 这几个集合内的点的一种可能如下表所示：</p> <p><tex>$$ \begin{matrix} S &amp; = &amp; &amp; v_2 &amp; &amp; \dots &amp; s &amp; \\ T &amp; = &amp; v_1 &amp; &amp; t^\prime &amp; &amp; &amp; t \\ S^\prime &amp; = &amp; v_1 &amp; v_2 &amp; v_3 &amp; \dots &amp; s &amp; \\ T^\prime &amp; = &amp; &amp; &amp; &amp; &amp; &amp; t \\ \end{matrix} $$</tex></p> <p>进行归纳假设，对于<tex>$|V| = 2$</tex>的图，以上结论显然成立。现在假设对于<tex>$|V| \lt n$</tex>的图均满足，尝试证明对于<tex>$|V| = n$</tex>的图也满足。</p> <p>现在我们要证明<tex>$W(S^\prime, T^\prime) \leqslant W(S, T)$</tex>，就可以得出算法的正确性。首先注意到：</p> <p><tex>$$ W(S, T) \geqslant W(V_i \cap S, V_i \cap T) + W(V_{n - 1} - V_{i - 1}, \{t\}) \tag{3.1} $$</tex></p> <p>以及：</p> <p><tex>$$ W(S^\prime, T^\prime) = W(V_{i - 1}, \{t\}) + W(V_{n - 1} - V_{i - 1}, \{t\}) \tag{3.2} $$</tex></p> <p>根据归纳假设，我们有：</p> <p><tex>$$ W(V_{i - 1}, \{t^\prime\}) \leqslant W(V_i \cap S, V_i \cap T) \tag{3.3} $$</tex></p> <p>考虑到算法的<tex>$A$</tex>变为<tex>$V_{i - 1}$</tex>时，选择了<tex>$t^\prime$</tex>而不是<tex>$t$</tex>加入<tex>$A$</tex>集合，那么说明：</p> <p><tex>$$ W(V_{i - 1}, \{t\}) \leqslant W(V_{i - 1}, \{t^\prime\}) \leqslant W(V_i \cap S, V_i \cap T) \tag{3.4} $$</tex></p> <p>综上可知：<br /> <tex>$$ \begin{aligned} W(S^\prime, T^\prime) &amp; = W(V_{i - 1}, \{t\}) + W(V_{n - 1} - V_{i - 1}, \{t\}) \\ &amp; \leqslant W(V_i \cap S, V_i \cap T) + W(V_{n - 1} - V_{i - 1}, \{t\}) \\ &amp; \leqslant W(S, T) \end{aligned} $$</tex></p> <p>这样，我们可以通过执行<tex>$\Theta(n)$</tex>次<code>ST-MINCUT</code>算法来找出全局最小割。<code>ST-MINCUT</code>的直接实现是<tex>$\Theta(n^2)$</tex>的，如果使用二叉堆这种数据结构来实现，那么可以做到<tex>$\Theta((n + m) \log n)$</tex>的复杂度。这个算法就是Stoer-Wanger算法。</p> <div class=footnote > <hr /> <ol> <li id="fn:mistake"> <p>这个证明是原论文中的证明方式，个人认为其中有一些不妥之处，因为在最后一步时，好像忽略了<tex>$w(t^\prime, t)$</tex>，导致不等式会不成立。不知道是不是个人的理解上的偏差还是确实有误，如果有看过原证明的大神希望能指点我一下。&#160;<a class=footnote-backref  href="#fnref:mistake" rev=footnote  title="Jump back to footnote 1 in the text">&#8617;</a></p> </ol> </div> <hr/> <div id=comments ></div> <script> window.addEventListener('load', () => { quicklink(); }); const gitment = new Gitment({id: '120ef352b6e7dfe23bd7e861fd34b914', owner: 'riteme', repo: 'riteme.github.io', oauth: { client_id: 'd4fcffa25858a7a58e1a', client_secret: 'e0c8e08beb95497871f8355416c69390634cec76' }, perPage: 10, }); gitment.render('comments'); </script> </div> </div> <div class="mdl-cell sidebar"> <div class=article > <div class="mdl-card mdl-shadow--2dp sidebar-card"> <div class="mdl-card__actions sidebar-title">页面信息</div> <div class=mdl-card__supporting-text > 标签: <a href="/search.html?q=最小割"><span class=label >最小割</span></a> <a href="/search.html?q=网络流"><span class=label >网络流</span></a> <a href="/search.html?q=图论"><span class=label >图论</span></a> <a href="/search.html?q=组合优化"><span class=label >组合优化</span></a><br/> 创建时间: 2017.02.12<br/> 上次修改: 2017.02.12<br/> 字数统计: 4107 字 / 约 16 分钟 </div> </div> <br/> <div class="mdl-card mdl-shadow--2dp sidebar-card"> <div class="mdl-card__actions sidebar-title">目录</div> <div class=mdl-card__supporting-text > <div class=toc > <ul> <li><a href="#_1">无向图最小割</a><ul> <li><a href="#_2">基本定义</a> <li><a href="#s-t">求解$s$-$t$最小割</a> <li><a href="#_3">求解全局最小割</a> </ul> </ul> </div> </div> </div> <br/> <div class="mdl-card mdl-shadow--2dp sidebar-card"> <div class="mdl-card__actions sidebar-title">数学公式渲染</div> <div class=mdl-card__supporting-text > <form name=mathopt > <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for=option-1 > <input type=radio  id=option-1  class=mdl-radio__button  name=sel  value=mathjax > <span class=mdl-radio__label >MathJax</span> </label><br/> <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for=option-2 > <input type=radio  id=option-2  class=mdl-radio__button  name=sel  value=katex > <span class=mdl-radio__label >KaTeX</span> </label> <div id=tip-2 > <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for=option-3 > <input type=radio  id=option-3  class=mdl-radio__button  name=sel  value="katex&mathjax"> <span class=mdl-radio__label >Mixed</span> </label> </div> </form> </div> </div> <div class=mdl-tooltip  data-mdl-for=tip-2 >先使用 KaTeX 渲染，再使用 MathJax 渲染</div> <br/> <div class="nano mdl-card mdl-shadow--2dp sidebar-card"> <a class=nano-ref  target=_new  href="http://nichijou.wikia.com/wiki/Nano_Shinonome"></a> <div class=mdl-card__actions > <div class=nano-shell ><span class=shell-start >$</span> nano <a href="https://github.com/riteme/riteme.github.io/blob/master/blog/2017-2-12/mincut.md" id=nano-link >mincut.md</a></div> </div> </div> <div class=mdl-tooltip  data-mdl-for=nano-link >查看原始 Markdown 文档</div> </div> </div> </div> <footer class=mdl-mega-footer > <div class=mdl-mega-footer__middle-section > <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h1 class=mdl-mega-footer__heading >RITEME.SITE</h1><del>一个从不乱说话的博客</del> </div> <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h1 class=mdl-mega-footer__heading >POWERED BY</h1> <ul class=mdl-mega-footer__link-list > <li><a href="http://pythonhosted.org/Markdown/">Python Markdown</a> <li><a href="http://getmdl.io/">Material Design Lite</a> <li><a href="http://www.tipue.com/search/">Tipuesearch</a> <li><a href="http://www.mathjax.org/">MathJax</a> & <a href="http://khan.github.io/KaTeX/">KaTeX</a> <li><a href="https://github.com/imsun/gitment">Gitment</a> </ul> </div> <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h1 class=mdl-mega-footer__heading >友情链接</h1> <ul class=mdl-mega-footer__link-list > <li><a href="http://ruanx.pw/">ruanxingzhi</a> <li><a href="https://blog.xehoth.cc/">xehoth</a> <li><a href="http://hjwjbsr.is-programmer.com/">HJWJBSR</a> <li><a href="http://www.micdz.cn/">MicDZ</a> <li><a href="https://cmxrynp.github.io/">CMXRYNP</a> <li><a href="http://memset0.cn/">memset0</a> </ul> </div> </div> <div class=mdl-mega-footer__bottom-section >Theme based on <a href="https://getmdl.io/">MDL</a> | Copyright © 2015-2019 riteme. All rights reserved.</div> </footer> </main> </div>