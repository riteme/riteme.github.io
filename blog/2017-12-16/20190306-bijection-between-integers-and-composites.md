### 2019.3.6
#### 问题描述
对于正整数 $n$，找到最小的 $m$，使得存在一个长度为 $p$ 递增序列 $\{a_k\}$ 满足 $n = a_1 < a_2 < \cdots < a_p = m$ 且 $\prod_{k = 1}^p a_k$ 为完全平方数，记 $f(n) = m$。证明：$f$ 是一个从正整数集 $\mathbb N$ 到合数集（包括 $1$，记做 $C$）的双射。

#### 解决方案
动手之前先要明白，证明 $f$ 为双射需要能够确认 1) 值域为 $C$；2) $f$ 是单射；3) $f$ 是满射。首先，$f(1) = 1$ 这一对可以简单地排除掉。此外，$f(n)$ 不可能为质数，因为递增序列里面的数字是不重复的，如果最后一个数是质数，那么它就只有一个，导致乘积不是完全平方数，这保证了第一点。

第二，所谓单射就是不同的变量值映射到了不同的函数值。考虑 $1 < x < y$，如果 $f(x) = f(y) = r$，那么存在 $x = a_1 < a_2 < \cdots < a_p = r$ 以及 $y = b_1 < b_2 < \cdots < b_q = r$，满足 $\prod_{k=1}^p a_k$ 和 $\prod_{k = 1}^q b_k$ 均为完全平方数。注意到 $r$ 在其中出现了两次，于是乎我们可以考虑 $\prod_{k=1}^pa_k\prod_{j=1}^qb_j$，将其中重复出现的数字除去，得到的乘积依然为完全平方数，且其中没有 $r$。因为 $x < y$，所以其中最小的数字为 $x$，这推出 $f(x) < r$，产生矛盾。所以 $f$ 为单射。

最后，所谓满射就是对于值域内每一个值，都是对应的变量值映射过来。这需要我们从反方向考虑。既然 $f(n)$ 是找最小的 $m$，不妨考虑令 $g(m)$ 表示最大的 $n$ 使得存在题中所述的序列。首先要保证 $g(m)$ 的定义是合理的：对于每个合数 $m$，可以写成 $m = ab$，并且假设 $1 < a < b < m$，显然 $abm$ 是满足要求的，所以至少有一个合法的方案。之后我们就希望 $f(g(m)) = m$。根据 $f(n)$ 最小化的要求，$f(g(m)) \leqslant m$。如果 $r = f(g(m)) < m$，类似于之前的讨论，存在 $g(m) = a_1 < a_2 < \cdots < a_p = r$ 和 $g(m) = b_1 < b_2 < \cdots < b_q = m$ 满足对应的乘积为完全平方数。这时候 $g(m)$ 又出现了两次，于是乎同样的套路，对于右端点 $m$ 我们可以得到左端点比 $g(m)$ 更大的方案，与 $g(m)$ 的定义矛盾，于是 $f(g(m)) = m$[^bijection-complete]，可以得到 $f$ 是满射。

[^bijection-complete]: 注意这个条件不能直接得到 $f$ 是双射的结论。