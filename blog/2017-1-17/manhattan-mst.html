<!DOCTYPE html> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1.0"> <meta name=referrer  content=no-referrer  /> <title>曼哈顿距离最小生成树 - riteme.site</title> <link rel="shortcut icon" href="/favicon.png" type="image/png"> <link rel=stylesheet  href="/styles/material-icons.css"> <link rel=stylesheet  href="/styles/material.min.css" > <link rel=stylesheet  href="/styles/gitment.css"> <link rel=stylesheet  href="/math-renderer/katex/katex.min.css"> <link rel=stylesheet  href="/styles/site.css"> <script src="/scripts/jquery.min.js"></script> <script src="/scripts/js-cookie.js"></script> <script src="/scripts/quicklink.umd.js"></script> <script defer src="/scripts/material.min.js"></script> <script src="/scripts/site.js"></script> <script src="/scripts/gitment.js"></script> <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header"> <header class=mdl-layout__header > <div class=mdl-layout__header-row > <span class=mdl-layout-title >曼哈顿距离最小生成树</span> <div class=mdl-layout-spacer ></div> <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right"> <label class="mdl-button mdl-js-button mdl-button--icon" for=fixed-header-drawer-exp ><i class=material-icons >search</i></label> <div class=mdl-textfield__expandable-holder > <form action="/search.html"><input type=text  class=mdl-textfield__input  placeholder="Search Here" name=q  id=fixed-header-drawer-exp  autocomplete=off  required></form> </div> </div> </div> </header> <div class=mdl-layout__drawer > <span class="mdl-layout-title drawer-title"> <a href="/index.html" style="color: inherit; font-weight: inherit;text-decoration: none;"><img src="/favicon.png" width=32 height=32> riteme.site</a> </span> <nav class=mdl-navigation > <a class=mdl-navigation__link  href="/index.html"><i class="material-icons drawer-icon">home</i> 首页</a> <a class=mdl-navigation__link  href="/posts.html"><i class="material-icons drawer-icon">library_books</i> 所有文章</a> <a class=mdl-navigation__link  href="/about.html"><i class="material-icons drawer-icon">info</i> 关于</a> <a class=mdl-navigation__link  href="/links.html"><i class="material-icons drawer-icon">link</i> 友链</a> <a class=mdl-navigation__link  href="/search.html"><i class="material-icons drawer-icon">search</i> 搜索</a> <a class=mdl-navigation__link  href="https://github.com/riteme/riteme.github.io"><i class="material-icons drawer-icon">class</i> GitHub 项目</a> </nav> </div> <main class=mdl-layout__content > <div class=mdl-grid > <div class="mdl-cell main-cell"> <div class="article main-article" lang=en-US > <h1 id=_1 >曼哈顿距离最小生成树</h1> <h2 id=_2 >问题</h2> <p>给你平面上的<tex>$n$</tex>个点，<tex>$n$</tex>个点之间两两连边，边权为两点间的曼哈顿距离，构成一张完全图。求这张完全图的最小生成树。</p> <h2 id=_3 >朴素算法</h2> <p>由于完全图的边数是<tex>$\Theta(n^2)$</tex>级别的，所以直接使用稀疏图的最小生成树算法将会得到<tex>$\Omega(n^2)$</tex>级别的算法。这是比较难以接受的。</p> <h2 id=_4 >平面划分</h2> <p>鉴于完全图边数十分之多，然而生成树上的边却只有<tex>$n - 1$</tex>条，是不是真正有用的边数也是<tex>$O(n)$</tex>级别的？</p> <p>事实上确实如此，如果我们随意选择一个点作为中心<tex>$O$</tex>，用四条直线将平面划为八个对称的区域，如下图所示：</p> <p><img alt=r8  src="https://git.oschina.net/riteme/blogimg/raw/master/manhattan-mst/r8.svg" /></p> <p>上图中<tex>$R_1$</tex>到<tex>$R_8$</tex>就是被八等分出来的区域。</p> <p>接下来我们将证明，对于每一个区域，只需要留下离<tex>$O$</tex>最近的点的连边，最后形成的图的最小生成树就是原图的最小生成树。</p> <p>假设现在在区域<tex>$R_1$</tex>有两个点<tex>$A$</tex>和<tex>$B$</tex>，并且满足<tex>$|OA| \leqslant |OB|$</tex>。那么根据最小生成树的环切性质<sup id="fnref:cut"><a class=footnote-ref  href="#fn:cut" rel=footnote >1</a></sup>，我们只需要证明<tex>$|OB| \geqslant |AB|$</tex>就可以了。在这里，<tex>$|AB|$</tex>表示<tex>$A$</tex>到<tex>$B$</tex>的曼哈顿距离。</p> <p>设<tex>$A(x_1, y_1)$</tex>和<tex>$B(x_2, y_2)$</tex>，我们需要考虑<tex>$4$</tex>种情况：</p> <p><strong>情况2：</strong><tex>$x_1 \leqslant x_2, \;y_1 \leqslant y_2$</tex></p> <p><img alt=situation-1  src="https://git.oschina.net/riteme/blogimg/raw/master/manhattan-mst/s1.svg" /></p> <p>此时有：<br /> <tex>$$ |AB| = x_2 - x_1 + y_2 - y_1 \leqslant x_2 + y_2 = |OB| $$</tex></p> <p><strong>情况2：</strong><tex>$x_2 \leqslant x_1, \;y_1 \leqslant y_2$</tex></p> <p><img alt=situation-2  src="https://git.oschina.net/riteme/blogimg/raw/master/manhattan-mst/s2.svg" /></p> <p>此时有：<br /> <tex>$$ |AB| = x_1 - x_2 + y_2 - y_1 $$</tex></p> <p>如果<tex>$|OB| \geqslant |AB|$</tex>，那么也就有<tex>$|OB| - |AB| \geqslant 0$</tex>，于是：<br /> <tex>$$ \begin{aligned} |OB| - |AB| &amp; = x_2 + y_2 - x_1 + x_2 - y_2 + y_1 \\ &amp; = 2x_2 - x_1 + y_1 \end{aligned} $$</tex></p> <p>由于在区域<tex>$R_1$</tex>满足<tex>$x_1 \leqslant y_1$</tex>，所以上式大于等于<tex>$0$</tex>，即满足<tex>$|OB| \geqslant |AB|$</tex>。</p> <p><strong>情况3：</strong><tex>$x_1 \leqslant x_2, \;y_2 \leqslant y_1$</tex></p> <p><img alt=situation-3  src="https://git.oschina.net/riteme/blogimg/raw/master/manhattan-mst/s3.svg" /></p> <p>此时有：<br /> <tex>$$ \begin{aligned} |AB| &amp; = x_2 - x_1 + y_1 - y_2 \\ |OB| - |AB| &amp; = x_2 + y_2 - x_2 + x_1 - y_1 + y_2 \\ &amp; = 2y_2 + x_1 - y_1 \end{aligned} $$</tex></p> <p>由于<tex>$|OA| \leqslant |OB|$</tex>和<tex>$x_2 \leqslant y_2$</tex>，那么我们知道：<br /> <tex>$$ x_1 + y_1 \leqslant x_2 + y_2 \Longrightarrow y_1 \leqslant x_2 + y_2 \leqslant 2y_2 $$</tex></p> <p>所以<tex>$|OB| \geqslant |AB|$</tex>。</p> <p><strong>情况4：</strong><tex>$x_2 \leqslant x_1, \;y_2 \leqslant y_1$</tex><br /> <img alt=situation-4  src="https://git.oschina.net/riteme/blogimg/raw/master/manhattan-mst/s4.svg" /></p> <p>这种情况违反了<tex>$|OA| \leqslant |OB|$</tex>这个条件，故不考虑。</p> <p>综上，在区域<tex>$R_1$</tex>内，只用保留离<tex>$O$</tex>最近的点的连边就可以了。</p> <p>对于其它的区域，都可以通过对称或者旋转，从而变成<tex>$R_1$</tex>的情况。因此<tex>$8$</tex>个区域均满足这一性质。</p> <p>这样一来，每个点只用连出<tex>$8$</tex>条边，然后在得到的图上使用稀疏图的最小生成树算法，就可得到原图的最小生成树。由于这张图的边数是<tex>$O(n)$</tex>的，所以如果我们使用Kruskal算法，我们的算法也就是<tex>$O(n \log n)$</tex>的。</p> <p>一条边在上面的图中被两个端点都被计数了一次，所以最终的边数是不超过<tex>$4n$</tex>的。</p> <h2 id=_5 >求出最近点</h2> <p>上面的性质中还留下一个问题：如何求出每个区域内离<tex>$O$</tex>最近的点？</p> <p>从之前的关于边数的讨论中可知，我们只用求<tex>$R_1$</tex>到<tex>$R_4$</tex>的最近点即可。此外，利用对称的性质，我们可以全部归结到在<tex>$R_1$</tex>求最近点的算法中，只需要提前做一个坐标的变换。下面也将只考虑<tex>$R_1$</tex>的算法。</p> <p>考虑使用扫描线算法：将所有点按照<tex>$x$</tex>坐标升序排好序，<tex>$x$</tex>坐标相同的就按照<tex>$y$</tex>降序排序。然后从前往后扫描。我们将每个点按照<tex>$y - x$</tex>进行离散化（也就是经过该点的斜率为<tex>$1$</tex>的直线的纵截距）。对于某个点<tex>$i$</tex>而言，在以<tex>$i$</tex>为原点的<tex>$R_1$</tex>区域内点<tex>$j$</tex>满足<tex>$y_j - x_j \geqslant y_i - x_i$</tex>。而<tex>$R_1$</tex>内离<tex>$i$</tex>最近的点<tex>$j$</tex>满足<tex>$y_j + x_j$</tex>最小。因此我们可以使用简单的数据结构，如线段树或者树状数组，就可维护<tex>$[y - x, \;\infty]$</tex>内<tex>$y + x$</tex>最小的是谁，从而求得每一个点的最近点。</p> <p>这个算法是<tex>$O(n \log n)$</tex>的。因此，<tex>$n$</tex>个点的最小曼哈顿生成树可以在<tex>$O(n \log n)$</tex>计算出来。</p> <p>至于坐标变换，一个比较方便的顺序就是先关于<tex>$y = x$</tex>对称，也就是交换<tex>$x$</tex>和<tex>$y$</tex>。然后关于<tex>$y = 0$</tex>对称，也就是将<tex>$y$</tex>取反，然后再关于<tex>$y = x$</tex>对称。这样执行<tex>$4$</tex>次扫描线算法就可以完成构图。</p> <div class=footnote > <hr /> <ol> <li id="fn:cut"> <p>对于图上一个环，删去环上权重最大的边后的图的最小生成树与原图一致。证明在很多地方都有。&#160;<a class=footnote-backref  href="#fnref:cut" rev=footnote  title="Jump back to footnote 1 in the text">&#8617;</a></p> </ol> </div> <hr/> <div id=comments ></div> <script> window.addEventListener('load', () => { quicklink(); }); const gitment = new Gitment({id: 'a341f99ffbe2b580c373a1f2de8252d3', owner: 'riteme', repo: 'riteme.github.io', oauth: { client_id: 'd4fcffa25858a7a58e1a', client_secret: 'e0c8e08beb95497871f8355416c69390634cec76' }, perPage: 10, }); gitment.render('comments'); </script> </div> </div> <div class="mdl-cell sidebar"> <div class=article > <div class="mdl-card mdl-shadow--2dp sidebar-card"> <div class="mdl-card__actions sidebar-title">页面信息</div> <div class=mdl-card__supporting-text > 标签: <a href="/search.html?q=最小生成树"><span class=label >最小生成树</span></a> <a href="/search.html?q=计算几何"><span class=label >计算几何</span></a><br/> 创建时间: 2017.01.17<br/> 上次修改: 2017.01.17<br/> 字数统计: 2393 字 / 约 9 分钟 </div> </div> <br/> <div class="mdl-card mdl-shadow--2dp sidebar-card"> <div class="mdl-card__actions sidebar-title">目录</div> <div class=mdl-card__supporting-text > <div class=toc > <ul> <li><a href="#_1">曼哈顿距离最小生成树</a><ul> <li><a href="#_2">问题</a> <li><a href="#_3">朴素算法</a> <li><a href="#_4">平面划分</a> <li><a href="#_5">求出最近点</a> </ul> </ul> <ul><li><a href="#comments">评论区</a></ul></div> </div> </div> <br/> <div class="mdl-card mdl-shadow--2dp sidebar-card"> <div class="mdl-card__actions sidebar-title">数学公式渲染</div> <div class=mdl-card__supporting-text > <form name=mathopt > <label class="mdl-radio mdl-js-radio" for=option-1 > <input type=radio  id=option-1  class=mdl-radio__button  name=sel  value=mathjax > <span class=mdl-radio__label >MathJax</span> </label><br/> <label class="mdl-radio mdl-js-radio" for=option-2 > <input type=radio  id=option-2  class=mdl-radio__button  name=sel  value=katex > <span class=mdl-radio__label >KaTeX</span> </label> <div id=tip-1 > <label class="mdl-radio mdl-js-radio" for=option-3 > <input type=radio  id=option-3  class=mdl-radio__button  name=sel  value="katex&mathjax"> <span class=mdl-radio__label >Mixed</span> </label> </div> </form> <div id=tip-2 > <label class="mdl-checkbox mdl-js-checkbox" for=mathopt-align > <input type=checkbox  id=mathopt-align  class=mdl-checkbox__input > <span class=mdl-checkbox__label >居中显示</span> </label> </div> </div> </div> <div class=mdl-tooltip  data-mdl-for=tip-1 >先使用 KaTeX 渲染，再使用 MathJax 渲染</div> <div class=mdl-tooltip  data-mdl-for=tip-2 >该选项目前仅支持 KaTeX 渲染的公式<br/>点击公式可以切换单个公式的对齐方式</div> <br/> <div class="nano mdl-card mdl-shadow--2dp sidebar-card"> <div class=mdl-card__actions > <div class=nano-shell ><span class=shell-start >$</span> nano <a href="https://github.com/riteme/riteme.github.io/blob/master/blog/2017-1-17/manhattan-mst.md" id=nano-link >manhattan-mst.md</a></div> </div> </div> <div class=mdl-tooltip  data-mdl-for=nano-link >查看原始 Markdown 文档</div> </div> </div> </div> <footer class=mdl-mega-footer > <div class=mdl-mega-footer__middle-section > <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h2 class=mdl-mega-footer__heading >RITEME.SITE</h2><del>一个从不乱说话的博客</del> </div> <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h2 class=mdl-mega-footer__heading >POWERED BY</h2> <ul class=mdl-mega-footer__link-list > <li><a href="http://pythonhosted.org/Markdown/">Python Markdown</a> <li><a href="http://getmdl.io/">Material Design Lite</a> <li><a href="http://www.tipue.com/search/">Tipuesearch</a> <li><a href="http://www.mathjax.org/">MathJax</a> & <a href="http://khan.github.io/KaTeX/">KaTeX</a> <li><a href="https://github.com/imsun/gitment">Gitment</a> </ul> </div> <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h2 class=mdl-mega-footer__heading >友情链接</h2> <ul class=mdl-mega-footer__link-list > <li><a href="http://ruanx.pw/">ruanxingzhi</a> <li><a href="https://blog.xehoth.cc/">xehoth</a> <li><a href="http://hjwjbsr.is-programmer.com/">HJWJBSR</a> <li><a href="http://www.micdz.cn/">MicDZ</a> <li><a href="https://cmxrynp.github.io/">CMXRYNP</a> <li><a href="http://memset0.cn/">memset0</a> </ul> </div> </div> <div class=mdl-mega-footer__bottom-section >Theme based on <a href="https://getmdl.io/">MDL</a> | <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" class=cc  src="/assets/cc-by-nc-sa-4.png" /></a> CC BY-NC-SA 4.0 </div> </footer> </main> </div>