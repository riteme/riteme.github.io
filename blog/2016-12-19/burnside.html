<!DOCTYPE html>
<html>

<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?72d0c4a099cd676176e657b871326707";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  } )();
</script>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>染色计数 - riteme.site</title>
  <link rel="shortcut icon" href="/favicon.png" type="image/png">
  <link rel="stylesheet" href="/material/material-icons.css">
  <link rel="stylesheet" href="/material/material.min.css" /> 
  <link href="/tipuesearch/tipuesearch.css" rel="stylesheet" type="text/css">
  <link href="/css/site.css" rel="stylesheet">
  <script defer src="/material/material.min.js"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config( { tex2jax: { inlineMath: [['$','$']] } } );
  </script>
  <script type="text/javascript" async src="/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script   src="https://code.jquery.com/jquery-2.2.4.min.js"   integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="   crossorigin="anonymous"></script>
  <script src="/tipuesearch/tipuesearch_set.js"></script>
  <script src="/tipuesearch/tipuesearch.min.js"></script>
</head>

<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header">
      <div class="mdl-layout__header-row">
        <span class="mdl-layout-title">染色计数</span>
        <div class="mdl-layout-spacer"></div>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable
        mdl-textfield--floating-label mdl-textfield--align-right">
        <label class="mdl-button mdl-js-button mdl-button--icon"
        for="fixed-header-drawer-exp"><i class="material-icons">search</i></label>
        <div class="mdl-textfield__expandable-holder">
          <form action="/search.html"><input type="text" class="mdl-textfield__input" placeholder="Search Here" name="q" id="fixed-header-drawer-exp" autocomplete="off" required></form>
        </div>
      </div>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title drawer-title">riteme.site</span>
    <nav class="mdl-navigation">
      <a class="mdl-navigation__link" href="/index.html"><i class="material-icons" style="vertical-align: bottom;">home</i> 首页</a>
      <a class="mdl-navigation__link" href="/posts.html"><i class="material-icons" style="vertical-align: bottom;">library_books</i> 所有文章</a>
      <a class="mdl-navigation__link" href="/about.html"><i class="material-icons" style="vertical-align: bottom;">info</i> 关于</a>
      <a class="mdl-navigation__link" href="/search.html"><i class="material-icons" style="vertical-align: bottom;">search</i> 搜索</a>
      <a class="mdl-navigation__link" href="https://github.com/riteme/riteme.github.io"><i class="material-icons" style="vertical-align: bottom;">class</i> GitHub项目</a>
    </nav>
  </div>
  <main class="mdl-layout__content">
    <div class="mdl-grid">
      <div class="mdl-cell mdl-cell--9-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">
        <div class="article">
          
<h1 id="_1">染色计数</h1>
<h2 id="_2">置换</h2>
<p>置换是一个满射，例如：<br />
<mathjax>$$
f(1) = 2, f(2) = 4, f(3) = 3, f(4) = 1
$$</mathjax></p>
<p>也写做：<br />
<mathjax>$$
f = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
2 &amp; 4 &amp; 3 &amp; 1
\end{matrix}
\right)
$$</mathjax></p>
<p>置换可以合成。假如我们有：<br />
<mathjax>$$
\begin{aligned}
f = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
2 &amp; 3 &amp; 4 &amp; 1
\end{matrix}
\right) \\
g = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
4 &amp; 1 &amp; 2 &amp; 3
\end{matrix}
\right)
\end{aligned}
$$</mathjax></p>
<p>那么它们按照一定顺序加合的结果是：<br />
<mathjax>$$
g \circ f = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
1 &amp; 2 &amp; 3 &amp; 4
\end{matrix}
\right)
$$</mathjax></p>
<p>即从右至左地执行这些置换。同时上面这个置换是不变元，无论什么置换与它加合都不会变化。另外，置换的加合满足结合律，但<strong>不一定满足交换律</strong>。置换的另外一种表示方式就是置换矩阵。这也可以说明为什么置换不满足交换律。</p>
<p>由于置换具有这些性质，所以置换的加合运算和置换可以构成<strong>置换群</strong>。</p>
<h2 id="_3">染色</h2>
<p>首先回答一个简单的问题：给正方形四个顶点分别染成黑色或白色的方案有多少个？显然每个顶点都有两种选择，所以答案为<mathjax>$2^4 = 16$</mathjax>。</p>
<p>现在做出一点限制，如果一个染过色的正方形通过旋转或者轴对称后与另外一个染过色的正方形相同，就说这两种染色是本质相同的。那么问你有多少种本质不同的染色方案。通过枚举，我们也可以知道答案是<mathjax>$6$</mathjax>。这<mathjax>$6$</mathjax>中方案如下 (本质相同的只画了一种)：</p>
<p><img alt="rect-6" src="https://git.oschina.net/riteme/blogimg/raw/master/polya/rect-6.svg" /></p>
<p>对我们而言，难以考虑的是同构的问题。假如我们给顶点标号，分别为<mathjax>$1$</mathjax>、<mathjax>$2$</mathjax>、<mathjax>$3$</mathjax>和<mathjax>$4$</mathjax>：</p>
<p><img alt="labeled" src="https://git.oschina.net/riteme/blogimg/raw/master/polya/labeled-rect-2.svg" /></p>
<p>那么上面这个图的染色为：<br />
<mathjax>$$
c_1 = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
\mathrm{W} &amp; \mathrm{B} &amp; \mathrm{W} &amp; \mathrm{W}
\end{matrix}
\right)
$$</mathjax></p>
<p>经过对称，与之同质的染色是这样的：<br />
<mathjax>$$
c_2 = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
\mathrm{W} &amp; \mathrm{W} &amp; \mathrm{B} &amp; \mathrm{W}
\end{matrix}
\right)
$$</mathjax></p>
<p>事实上，这个变换可以看做是将<mathjax>$2$</mathjax>和<mathjax>$3$</mathjax>调换了一下。于是我们将这个对称定义成这样一个置换：<br />
<mathjax>$$
f = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
1 &amp; 3 &amp; 2 &amp; 4
\end{matrix}
\right)
$$</mathjax></p>
<p>然后定义<mathjax>$\times$</mathjax>运算，表示一个染色的顶点经过一个置换后，得到的新的染色，于是有：<br />
<mathjax>$$
f \times c_1 = c_2
$$</mathjax></p>
<p>可以发现，置换的加合和上面的变换在一起时也满足结合律。</p>
<p>这样，我们就将颜色的同构用置换表示出来了。我们定义正方形所有的变换为一个置换，它们构成一个集合：<br />
<mathjax>$$
G = \{e = p^0, p, p^2, p^3, f_1, f_2, f_3, f_4\}
$$</mathjax></p>
<p>其中<mathjax>$e$</mathjax>是置换的不变元。<mathjax>$p$</mathjax>是顺时针旋转<mathjax>$90^\circ$</mathjax>的置换：<br />
<mathjax>$$
p = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
4 &amp; 1 &amp; 2 &amp; 3
\end{matrix}
\right)
$$</mathjax></p>
<p>而<mathjax>$p$</mathjax>的幂次就是多次旋转。<mathjax>$f_1$</mathjax>到<mathjax>$f_4$</mathjax>是沿着正方形的四条对角线的置换。可以验证这个集合和置换的加合运算构成了一个置换群。因此，对于两种染色<mathjax>$c_1$</mathjax>和<mathjax>$c_2$</mathjax>，它们本质相同当且仅当存在一个<mathjax>$f \in G$</mathjax>，满足<mathjax>$f \times c_1 = c_2$</mathjax>。</p>
<p>另外，设图形的所有染色方案为<mathjax>$C$</mathjax>，定义<mathjax>$G(c)$</mathjax>为<mathjax>$\{f : f \times c = c, \;\forall f \in G\}$</mathjax>，即不改变染色<mathjax>$c$</mathjax>的置换的集合。以及<mathjax>$C(f)$</mathjax>为<mathjax>$\{c : f \times c = c, \; \forall c \in C\}$</mathjax>，即经过置换后不变的所有的染色方案的集合。之后的讨论中将会用到它们。</p>
<h2 id="burnside">Burnside定理</h2>
<p>首先来考虑与<mathjax>$c$</mathjax>本质相同的染色的个数：</p>
<blockquote>
<p><strong>定理</strong>：与<mathjax>$c$</mathjax>本质相同的染色的个数为：<br />
<mathjax>$$ {|G| \over |G(c)|} \tag{3.1} $$</mathjax></p>
</blockquote>
<p><strong>证明</strong>：考虑每个<mathjax>$f \times c, f \in G$</mathjax>，都存在<mathjax>$|G(c)|$</mathjax>个<mathjax>$g \times c, g \in G(c)$</mathjax>满足<mathjax>$(f \circ g) \times c = c$</mathjax>。所以总数为<mathjax>$|G| / |G(c)| $</mathjax>。</p>
<p>接下来将采用多计数来证明下面的<strong>Burnside定理</strong>：</p>
<blockquote>
<p>(Burnside定理)<br />
设关于染色集<mathjax>$C$</mathjax>与置换群<mathjax>$G$</mathjax>上本质不同的染色方案数为<mathjax>$N(G, C)$</mathjax>，那么满足：<br />
<mathjax>$$ N(G, C) = \frac1{|G|}\sum_{f \in G} |C(f)| \tag{3.2} $$</mathjax></p>
</blockquote>
<p><strong>证明</strong>：我们现在来考虑满足<mathjax>$f \times c = c$</mathjax>的二元组<mathjax>$(f, c)$</mathjax>的个数。首先我们从<mathjax>$C(f)$</mathjax>的角度考虑，可以知道答案为：<br />
<mathjax>$$
\sum_{f \in G} |C(f)|
$$</mathjax></p>
<p>另外，从<mathjax>$G(c)$</mathjax>的角度考虑，也可以知道答案为：<br />
<mathjax>$$
\sum_{c \in C} |G(c)|
$$</mathjax></p>
<p>为了方便，我们设<mathjax>$A(c) = \{f \times c, \; \forall f \in G\}$</mathjax>，即与<mathjax>$c$</mathjax>本质相同的染色的集合。根据<mathjax>$(3.1)$</mathjax>，我们知道：<br />
<mathjax>$$
G(c) = {|G| \over |A(c)|}
$$</mathjax></p>
<p>那么可以得到：<br />
<mathjax>$$
\sum_{f \in G} |C(f)| = |G|\sum_{c \in C} \frac1{|A(c)|}
$$</mathjax></p>
<p>对有边的和式做如下的考虑：假设每个等价的集合的贡献是<mathjax>$1$</mathjax>，那么每个染色的贡献就是<mathjax>$1/|A(c)|$</mathjax>，所以上式可以改写为：<br />
<mathjax>$$
\sum_{f \in G} |C(f)| = |G|N(G, C)
$$</mathjax></p>
<p>所以：<br />
<mathjax>$$ N(G, C) = \frac1{|G|}\sum_{f \in G} |C(f)| $$</mathjax></p>
<p>回到之前正方形染色的例子，我们对于每一个置换这样考虑：</p>
<ol>
<li>对于不变元<mathjax>$e$</mathjax>，总共有<mathjax>$2^4 = 16$</mathjax>中染色不变。</li>
<li>对于<mathjax>$2$</mathjax>个顺时针旋转 (除了旋转<mathjax>$180^\circ$</mathjax>)，它们都只有全是黑或者全是白的染色不变，贡献为<mathjax>$2 \times 2 = 4$</mathjax>。</li>
<li>对于旋转<mathjax>$180^\circ$</mathjax>，只需要满足两个相邻的顶点颜色相同即可，所以贡献为<mathjax>$2^2 = 4$</mathjax>。</li>
<li>对于<mathjax>$2$</mathjax>个对角线对称，只要满足对角颜色相同即可，贡献为<mathjax>$2^3 \times 2 = 16$</mathjax>。</li>
<li>对于另外<mathjax>$2$</mathjax>个对称，需要满足两边颜色相同，贡献为<mathjax>$2^2 \times 2 = 8$</mathjax>。</li>
</ol>
<p>所以答案为<mathjax>$(16 + 4 + 4 + 16 + 8) / 8 = 6$</mathjax>。</p>
<p>进一步考虑计算<mathjax>$C(f)$</mathjax>。假如我们将置换写成置换环的形式，例如：<br />
<mathjax>$$
f = \left(
\begin{matrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
2 &amp; 1 &amp; 4 &amp; 3
\end{matrix}
\right)
$$</mathjax></p>
<p>可以写成：<br />
<mathjax>$$
f = [2\;1][4\;3]
$$</mathjax></p>
<p>可以发现，如果要满足经过置换后染色不变，那么<strong>每一个置换环内的颜色必须相同</strong>。于是，对于这一个置换环而言，计算就可以直接简便为<mathjax>$2^2 = 4$</mathjax>，而不需要去做讨论。</p>
<h2 id="_4">简单图计数</h2>
<p><a href="http://www.lydsy.com/JudgeOnline/problem.php?id=1488">【HNOI 2009】图的同构</a></p>
<p>现在来讨论一个更加复杂的问题，就是<mathjax>$n$</mathjax>个点的本质不同的<strong>简单图</strong>的数量<sup id="fnref:oeis"><a class="footnote-ref" href="#fn:oeis" rel="footnote">1</a></sup>。简单图是没有重边和自环的图。记为<mathjax>$a(n)$</mathjax>。</p>
<p>首先，我们可以直接列举可以得知：<br />
<mathjax>$$
a(0) = 1, a(1) = 1, a(2) = 2, a(3) = 4
$$</mathjax></p>
<p>更大的<mathjax>$n$</mathjax>如果采用列举的方法实在无法想象。为了能够利用Burnside定理，我们考虑将其转为一个染色问题。注意到大小为<mathjax>$n$</mathjax>的简单图的边已经全部确定，只是存在选或不选的问题。所以可以视为是这些边是染成黑色还是染成白色的问题。此外我们要将本质相同的计数去掉。如果两个图相同，那么存在一个与点编号相关的置换，使得两张图的边集是一样的。所以我们考虑所有的点的置换，总数为<mathjax>$n!$</mathjax>个，每一个将会对应到一个边的置换，即用于判定同构的置换。可以证明从点的置换转来的边的置换是一个置换群。</p>
<p>现在来考虑点的置换是如何转成边的置换的。由于我们已经可以根据置换环的数量来计算<mathjax>$C(f)$</mathjax>了，所以我们不需要关注置换到底长什么样，只需要知道有多少个置换环即可。对于一个边的置换，里面的每一条边的两个端点要么在点置换的一个置换环内，要么在不同的置换环内。</p>
<p>首先观察一下在同一个置换环内的情况：</p>
<p><img alt="one-circle" src="https://git.oschina.net/riteme/blogimg/raw/master/polya/one-circle.svg" /></p>
<p>黄色的边是置换环上的边，而红色的就是边置换中的边。由于将整条边随着置换环旋转，会得到许多一样的边，所以我们将一个点固定，来考虑另外一个点。可以发现实线的边是不同的，而虚线的边则是和实线的边是同构的。所以，对于长度为<mathjax>$A$</mathjax>的置换环，在边的置换中对应了<mathjax>$\lfloor L / 2 \rfloor$</mathjax>个置换环。</p>
<p>然后考虑不在同一个置换环的情况：</p>
<p><img alt="two-circle" src="https://git.oschina.net/riteme/blogimg/raw/master/polya/two-circle.svg" /></p>
<p>设两个置换环的长度分别为<mathjax>$A$</mathjax>和<mathjax>$B$</mathjax>，可以发现，每一条连接两个置换环的边，都会有<mathjax>$\mathrm{lcm}(A, B)$</mathjax>条边与它同构。而总边数为<mathjax>$AB$</mathjax>，所以这个点置换的置换环就对应了边置换中的<mathjax>$\gcd(A, B)$</mathjax>个置换环。</p>
<p>考虑完点置换和边置换的一一对应关系后，我们考虑来计数点置换集中有多少个置换环长度分别为<mathjax>$L_1, L_2, L_3, \dots$</mathjax>的置换。设长度为<mathjax>$i$</mathjax>的置换环的个数为<mathjax>$C_i$</mathjax>，那么这个数量是：<br />
<mathjax>$$
{P(n, L_1)P(n - L_1, L_2)P(n - L_1 - L_2, L_3)\cdots \over L_1 L_2 L_3 \cdots S_1!S_2!S_3!\cdots} = {n! \over L_1 L_2 L_3 \cdots S_1!S_2!S_3!\cdots}
$$</mathjax></p>
<p>所以我们就可以算出所有置换的贡献，然后除以置换的总个数<mathjax>$n!$</mathjax>，就是我们的答案。</p>
<p>最后，我们只需要枚举置换中置换环的情况，这个其实就是<mathjax>$n$</mathjax>的分拆。利用这个方法，我们可以计算更大的<mathjax>$n$</mathjax>的方案 (但是还是难以计算近百的级别)。</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:oeis">
<p>这个数列在<a href="http://oeis.org/A000088">OEIS</a>上有。&#160;<a class="footnote-backref" href="#fnref:oeis" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

          <hr/>

          <div class="ds-thread" data-thread-key="0d089021f3ffa1f1d184d430d5948b62" data-title="染色计数" data-url="http://riteme.github.io/blog/2016-12-19/burnside.html">
            <script type="text/javascript">
              var duoshuoQuery = { short_name:"riteme" };
              (function() {
               var ds = document.createElement('script');
               ds.type = 'text/javascript';ds.async = true;
               ds.src = (
                 document.location.protocol == 'https:' ? 'https:' : 'http:'
                 ) + '//static.duoshuo.com/embed.js';
               ds.charset = 'UTF-8';
               (document.getElementsByTagName('head')[0]
                || document.getElementsByTagName('body')[0]).appendChild(ds);
             } )();
           </script>
           <script src="https://dn-hb0716.qbox.me/duoshuo.js"></script>
         </div>
       </div>
     </div>

     <div class="mdl-cell mdl-cell--3-col mdl-cell--hide-tablet mdl-cell--hide-phone">
       <div class="article">
        <div class="mdl-card mdl-shadow--3dp" style="width: 100%">
          <div class="mdl-card__supporting-text">
            标签: <span class="label">Burnside定理</span> <span class="label">组合数学</span><br/>
            创建时间: 2016.12.19<br/>
            上次修改: 2016.12.19
          </div>
        </div>

        <br />

        
<div class="mdl-card mdl-shadow--3dp" style="width: 100%">
  <div class="mdl-card__title mdl-card--border">
    <h4 class="mdl-card__title-text">目录</h4>
  </div>
  <div class="mdl-card__supporting-text">
    <div class="toc">
<ul>
<li><a href="#_1">染色计数</a><ul>
<li><a href="#_2">置换</a></li>
<li><a href="#_3">染色</a></li>
<li><a href="#burnside">Burnside定理</a></li>
<li><a href="#_4">简单图计数</a></li>
</ul>
</li>
</ul>
</div>
  </div>
</div>

      </div>

      <div class="return-up-button">
        <a href="javascript:$('main').animate( { scrollTop: 0 } , 'fast')">
          <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
            <i class="material-icons">vertical_align_top</i>
          </button>
        </a>
      </div>
    </div>
  </div>

  <footer class="mdl-mega-footer">
    <div class="mdl-mega-footer__middle-section">
      <div class="mdl-mega-footer__drop-down-section">
        <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
        <h1 class="mdl-mega-footer__heading">RITEME.SITE</h1>
        一个从不乱说话的博客...
      </div>

      <div class="mdl-mega-footer__drop-down-section">
        <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
        <h1 class="mdl-mega-footer__heading">POWERED BY</h1>
        <ul class="mdl-mega-footer__link-list">
          <li><a href="http://pythonhosted.org/Markdown/">Python Markdown</a></li>
          <li><a href="http://getmdl.io/">Material Design Lite</a></li>
          <li><a href="http://www.tipue.com/search/">Tipuesearch</a></li>
          <li><a href="http://www.mathjax.org/">MathJax</a></li>
          <li><a href="http://duoshuo.com/">多说</a></li>
        </ul>
      </div>

      <div class="mdl-mega-footer__drop-down-section">
        <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
        <h1 class="mdl-mega-footer__heading">友情链接</h1>
        <ul class="mdl-mega-footer__link-list">
          <li><a href="http://link-arthur.github.io/">Link</a></li>
          <li><a href="http://ruanxingzhi.github.io/">ruanxingzhi</a></li>
          <li><a href="http://haogram.hol.es/">Haogram</a></li>
          <li><a href="http://hjwjbsr.is-programmer.com/">HJWJBSR</a></li>
        </ul>
      </div>
    </div>

    <div class="mdl-mega-footer__bottom-section">
      Theme based on <a href="https://getmdl.io/">MDL</a> | Copyright © 2015-2016 riteme. All rights reserved.
    </div>
  </footer>
</main>
</div>
</body>
</html>
