<!DOCTYPE html> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1.0"> <title>Hall 定理 - riteme.site</title> <link rel="shortcut icon" href="/favicon.png" type="image/png"> <link rel=stylesheet  href="/material/material-icons.css"> <link rel=stylesheet  href="/material/material.min.css" > <link rel=stylesheet  href="/gitment/gitment.css"> <link rel=stylesheet  href="/math-renderer/katex/katex.min.css"> <link rel=stylesheet  href="/css/site.css"> <script src="/js/jquery.min.js"></script> <script src="/js/jump.js"></script> <script src="/js/js-cookie.js"></script> <script src="/js/quicklink.umd.js"></script> <script defer src="/material/material.min.js"></script> <script src="/math-renderer/selector.js"></script> <script src="/gitment/gitment.js"></script> <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header"> <header class=mdl-layout__header > <div class=mdl-layout__header-row > <span class=mdl-layout-title >Hall 定理</span> <div class=mdl-layout-spacer ></div> <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right"> <label class="mdl-button mdl-js-button mdl-button--icon" for=fixed-header-drawer-exp ><i class=material-icons >search</i></label> <div class=mdl-textfield__expandable-holder > <form action="/search.html"><input type=text  class=mdl-textfield__input  placeholder="Search Here" name=q  id=fixed-header-drawer-exp  autocomplete=off  required></form> </div> </div> </div> </header> <div class=mdl-layout__drawer > <span class="mdl-layout-title drawer-title"> <a href="/index.html" style="color: inherit; font-weight: inherit;text-decoration: none;"><img src="/favicon.png" width=32 height=32> riteme.site</a> </span> <nav class=mdl-navigation > <a class=mdl-navigation__link  href="/index.html"><i class="material-icons drawer-icon">home</i> 首页</a> <a class=mdl-navigation__link  href="/posts.html"><i class="material-icons drawer-icon">library_books</i> 所有文章</a> <a class=mdl-navigation__link  href="/about.html"><i class="material-icons drawer-icon">info</i> 关于</a> <a class=mdl-navigation__link  href="/links.html"><i class="material-icons drawer-icon">link</i> 友链</a> <a class=mdl-navigation__link  href="/search.html"><i class="material-icons drawer-icon">search</i> 搜索</a> <a class=mdl-navigation__link  href="https://github.com/riteme/riteme.github.io"><i class="material-icons drawer-icon">class</i> GitHub 项目</a> </nav> </div> <main class=mdl-layout__content > <div class=mdl-grid > <div class="mdl-cell main-cell"> <div class="article main-article" lang=en-US > <h1 id=hall >Hall 定理</h1> <h2 id=_1 >基本形式</h2> <p>Hall 定理是一个用于判定<strong>二分图是否具有完美匹配</strong>的定理。<br /> 首先对于二分图 <tex>$G = (X \cup Y, E)$</tex>，点集被分为了 <tex>$X$</tex> 和 <tex>$Y$</tex> 两部分。<br /> 是否具有完美匹配，首先一个最基本的条件就是 <tex>$|X| = |Y|$</tex>。<br /> Hall 定理则在此基础上给出了一个更强的条件。<br /> 首先对于一个点集 <tex>$T \subseteq X$</tex>，定义 <tex>$\Gamma(T)$</tex> 如下：<br /> <tex>$$ \Gamma(T) = \{v \mid u \rightarrow v \in E,\; u \in T,\; v \in Y\} $$</tex></p> <p>即表示 <tex>$T$</tex> 中所有点能够直接到达的 <tex>$Y$</tex> 中的点的集合。</p> <p><img alt=bigraph  src="https://git.oschina.net/riteme/blogimg/raw/master/hall-theorme/bigraph.png" /></p> <p>上图中，<tex>$\Gamma(\{1,\;3\}) = \{4,\;5,\;6\}$</tex>。<br /> Hall 条件用于判断一个二分图是否存在完美匹配。如果对于<strong>任意</strong>的点集 <tex>$T \subseteq X$</tex>，均存在：<br /> <tex>$$ |T| \le |\Gamma(T)| $$</tex></p> <p>称此二分图满足 Hall 条件。Hall 定理的表述如下：</p> <blockquote> <p>二分图 <tex>$G(X \cup Y,E)$</tex> 存在完美匹配<strong>当且仅当</strong> <tex>$|X| = |Y|$</tex> 并且满足 Hall 条件。</p> </blockquote> <p>本文会使用 <tex>$C = A - B$</tex> 表示集合之差，即 <tex>$C = A \cap \overline B$</tex>。</p> <h2 id=_2 >证明</h2> <p>首先，当 <tex>$|X| \neq |Y|$</tex> 时，二分图不存在完美匹配。如果二分图存在完美匹配，则意味着 <tex>$|X| = |Y|$</tex>。此外，上述定理的充分性非常显然，因为如果 <tex>$|\Gamma(T)| &lt; |T|$</tex>，那么对于子集 <tex>$T$</tex> 是无法找出完美匹配的。</p> <p>现在来证明必要性。记 <tex>$n = |X|$</tex>，不难发现当 <tex>$n = 0$</tex> 或 <tex>$n = 1$</tex> 时，Hall 定理是成立的。</p> <p>尝试使用数学归纳法来证明 <tex>$n &gt; 1$</tex> 的情形。假设对于任意 <tex>$n &lt; k$</tex> 的情况都是成立的，则需要证明当 <tex>$n = k$</tex> 时也是成立的。先来考虑条件最为苛刻的一类非空真子集 <tex>$T \subset X$</tex>，它满足 <tex>$|\Gamma(T)| = |T|$</tex>。对于子集 <tex>$S \subseteq X - T$</tex>，由于满足 Hall 条件，所以 <tex>$|\Gamma(S \cap T)| \geq |S \cap T|$</tex>，又因为 <tex>$|\Gamma(T)| = |T|$</tex>，所以 <tex>$|\Gamma(S) - \Gamma(T)| \geq |S|$</tex>，也就是说，如果图 <tex>$G$</tex> 中删去 <tex>$T$</tex> 和 <tex>$\Gamma(T)$</tex> 中的所有点得到新图 <tex>$G'(X' \cup Y',E')$</tex>，则 <tex>$|X'| &lt; k$</tex> 且依然满足 Hall 条件，故 <tex>$G'$</tex> 存在完美匹配。由于 <tex>$T$</tex> 是真子集，所以 <tex>$|T| &lt; k$</tex>，所以 <tex>$G$</tex> 关于点集 <tex>$T \cup \Gamma(T)$</tex> 的导出子图一定存在完美匹配。即 <tex>$G$</tex> 存在完美匹配。</p> <p>注意到满足上述条件的非空真子集 <tex>$T$</tex> 并不总是存在。当不存在的时候，我们有：<br /> <tex>$$ |\Gamma(T)| \geq |T| + 1 \;\;\;\; (\forall \; T \subset X) $$</tex></p> <p>这个时候任意删去图 <tex>$G$</tex> 的任意一条匹配边，不会使 <tex>$G$</tex> 不符合 Hall 条件。由于 <tex>$n$</tex> 减少了 <tex>$1$</tex>，所以删去该匹配边后的图存在完美匹配。</p> <h2 id=hall_1 >计算所有满足 Hall 条件的子集</h2> <p>对于一张二分图而言，如何确定 <tex>$X$</tex> 或 <tex>$Y$</tex> 的一个子集是否满足 Hall 条件？<br /> 令 <tex>$n$</tex> 为 <tex>$|X|$</tex>。首先我们可以根据定义，对于每个子集枚举自己的子集。采用 DP，可以推算出所有子集的答案。时间复杂度为 <tex>$O(3^n)$</tex>。<br /> 考虑到直接枚举子集过于暴力，因此先选择集合中的一个点 <tex>$u$</tex>，将其删去，将会得到一个更小的子集，这个值已经被提前计算过了，因此一大部分的子集的答案就都被算入其中了。剩下的还未考虑到的子集均包含 <tex>$u$</tex>，但是除了集合本身外，剩余的子集均会相差至少一个点。因此我们枚举所有集合中的点并去掉，用得到的新的更小的集合的 DP 值来更新当前集合，最后再计算自己是否满足不等式。这样计算的时间是 <tex>$O(2^n \cdot n)$</tex> 的。</p> <p>大致的代码如下：</p> <table class=codehilitetable ><tr><td class=linenos ><div class=linenodiv ><pre>1
2
3
4
5</pre></div><td class=code ><div class=codehilite ><pre><span></span><span class=n >f</span> <span class=o >=</span> <span class=p >[</span><span class=bp >True</span><span class=p >]</span> <span class=o >*</span> <span class=mi >2</span><span class=o >^</span><span class=n >n</span>  <span class=o >//</span> <span class=n >DP数组</span>
<span class=k >for</span> <span class=n >s</span> <span class=ow >in</span> <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=mi >2</span><span class=o >^</span><span class=n >n</span><span class=p >):</span>
    <span class=k >for</span> <span class=n >u</span> <span class=ow >in</span> <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=n >n</span><span class=p >):</span>
        <span class=n >f</span><span class=p >[</span><span class=n >s</span><span class=p >]</span> <span class=o >&amp;=</span> <span class=n >f</span><span class=p >[</span><span class=n >s</span> <span class=o >^</span> <span class=p >(</span><span class=mi >1</span> <span class=o >&lt;&lt;</span> <span class=n >u</span><span class=p >)]</span>
    <span class=c1 ># 检查s本身是否可行，更新f[s]</span>
</pre></div> </table> <h2 id=_3 >简单运用</h2> <p>Hall 定理一般没有什么优化算法复杂度上的用途，但是可以作为一个<strong>比较好的思维工具</strong>。<br /> 例如下面这个问题：<br /> <a href="http://codeforces.com/problemset/problem/720/A">[Russian Code Cup 2016 - Finals] A. Closing ceremony</a></p> <p>大意是有一个 <tex>$n\times m$</tex> 的网格和 <tex>$n \times m$</tex> 个人，每个人都要走到一个网格上的一点，每个点只能装下一个人。<br /> 同时定义两个点之间的距离为曼哈顿距离，每个人有自己行走的路程上限。<br /> 现在这 <tex>$n \times m$</tex> 个人分成两批，从 <tex>$(0,\;0)$</tex> 和 <tex>$(0,\;m+1)$</tex> 出发，问你是否存在一种安排每个人的最终位置的方案，来满足每个人走到对应位置时的路程不超过自己的上限。</p> <p>令点 <tex>$A$</tex> 为 <tex>$(0,\;0)$</tex>，点 <tex>$B$</tex> 为 <tex>$(0,\;m+1)$</tex>。并且设 <tex>$f(i,\;j)$</tex> 表示离 <tex>$A$</tex> 距离至少为 <tex>$i$</tex>，离 <tex>$B$</tex> 距离至少为 <tex>$j$</tex> 的格子的个数。<br /> 设 <tex>$S_A(i)$</tex> 表示在 <tex>$A$</tex> 最远距离至少为 <tex>$i$</tex> 的人数，同理，<tex>$S_B(i)$</tex> 表示在 <tex>$B$</tex> 处最远距离至少为 <tex>$i$</tex> 的人数。由于每个人和一个位置形成了一个一一对应的关系，由此我们可以构建一个二分图，并且我们所要做的就是判定这个二分图是否具有完美匹配。<br /> 事实上由于存在单调性，利用 Hall 定理可以知道，我们只用判定是否对于所有的 <tex>$f(i,\;j)$</tex> 均不大于 <tex>$S_A(i) + S_B(j)$</tex>，如果满足这个条件，那么这个二分图就有最大匹配。<br /> 那么现在的问题就是求得 <tex>$f$</tex>。由于曼哈顿距离为 <tex>$i$</tex> 的等距线实际上是一条斜率为 <tex>$1$</tex> 或 <tex>$-1$</tex> 的直线，所以 <tex>$f(i,\;j)$</tex> 就是两条直线在网格中围成的面积。<br /> 并且注意到它可以递归计算：<br /> <tex>$$ f(i,\;j) = f(i+1,\;j) + f(i,\;j+1) - f(i+1,\;j+1) $$</tex></p> <p>并且需要考虑这两条直线的交点是否会占用一个格子。所以我们的做法就是枚举交点，确定是那两条直线相交，并且赋给对应的 <tex>$f$</tex> 去，然后对 <tex>$f$</tex> 计算后缀和就是我们想要的东西啦～</p> <hr/> <div id=comments ></div> <script> window.addEventListener('load', () => { quicklink(); }); const gitment = new Gitment({id: 'dd44e30c22b32e9d4e98aaee30422387', owner: 'riteme', repo: 'riteme.github.io', oauth: { client_id: 'd4fcffa25858a7a58e1a', client_secret: 'e0c8e08beb95497871f8355416c69390634cec76' }, perPage: 10, }); gitment.render('comments'); </script> </div> </div> <div class="mdl-cell sidebar"> <div class=article > <div class="mdl-card mdl-shadow--3dp sidebar-card"> <div class="mdl-card__actions sidebar-title">页面信息</div> <div class=mdl-card__supporting-text > 标签: <a href="/search.html?q=图论"><span class=label >图论</span></a> <a href="/search.html?q=二分图"><span class=label >二分图</span></a> <a href="/search.html?q=Hall 定理"><span class=label >Hall 定理</span></a><br/> 创建时间: 2016.09.19<br/> 上次修改: 2017.12.30<br/> 字数统计: 3094 字 / 约 12 分钟 </div> </div> <br/> <div class="mdl-card mdl-shadow--3dp sidebar-card"> <div class="mdl-card__actions sidebar-title">目录</div> <div class=mdl-card__supporting-text > <div class=toc > <ul> <li><a href="#hall">Hall 定理</a><ul> <li><a href="#_1">基本形式</a> <li><a href="#_2">证明</a> <li><a href="#hall_1">计算所有满足 Hall 条件的子集</a> <li><a href="#_3">简单运用</a> </ul> </ul> </div> </div> </div> <br/> <div class="mdl-card mdl-shadow--3dp sidebar-card"> <div class="mdl-card__actions sidebar-title">数学公式渲染</div> <div class=mdl-card__supporting-text > <form name=mathopt > <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for=option-1 > <input type=radio  id=option-1  class=mdl-radio__button  name=sel  value=mathjax > <span class=mdl-radio__label >MathJax (推荐)</span> </label><br/> <div id=tip-1 > <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for=option-2 > <input type=radio  id=option-2  class=mdl-radio__button  name=sel  value=katex > <span class=mdl-radio__label >KaTeX</span> </label> </div> <div id=tip-2 > <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for=option-3 > <input type=radio  id=option-3  class=mdl-radio__button  name=sel  value="katex&mathjax"> <span class=mdl-radio__label >Mixed</span> </label> </div> </form> </div> </div> <div class=mdl-tooltip  data-mdl-for=tip-1 >KaTeX 渲染效率很高，但是目前 KaTeX 容错性不强，因此使用 KaTeX 时可能会存在一些数学公式无法渲染的情况</div> <div class=mdl-tooltip  data-mdl-for=tip-2 >先使用 KaTeX 渲染，再使用 MathJax 渲染</div> <br/> <div class="nano mdl-card mdl-shadow--3dp sidebar-card"> <a class=nano-ref  target=_new  href="http://nichijou.wikia.com/wiki/Nano_Shinonome"></a> <div class=mdl-card__actions > <div class=nano-shell ><span class=shell-start >$</span> nano <a href="https://github.com/riteme/riteme.github.io/blob/master/blog/2016-9-19/hall-theorem.md" id=nano-link >hall-theorem.md</a></div> </div> </div> <div class=mdl-tooltip  data-mdl-for=nano-link >查看原始 Markdown 文档</div> </div> </div> </div> <footer class=mdl-mega-footer > <div class=mdl-mega-footer__middle-section > <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h1 class=mdl-mega-footer__heading >RITEME.SITE</h1><del>一个从不乱说话的博客</del> </div> <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h1 class=mdl-mega-footer__heading >POWERED BY</h1> <ul class=mdl-mega-footer__link-list > <li><a href="http://pythonhosted.org/Markdown/">Python Markdown</a> <li><a href="http://getmdl.io/">Material Design Lite</a> <li><a href="http://www.tipue.com/search/">Tipuesearch</a> <li><a href="http://www.mathjax.org/">MathJax</a> & <a href="http://khan.github.io/KaTeX/">KaTeX</a> <li><a href="https://github.com/imsun/gitment">Gitment</a> </ul> </div> <div class=mdl-mega-footer__drop-down-section > <input class=mdl-mega-footer__heading-checkbox  type=checkbox  checked> <h1 class=mdl-mega-footer__heading >友情链接</h1> <ul class=mdl-mega-footer__link-list > <li><a href="http://ruanx.pw/">ruanxingzhi</a> <li><a href="https://blog.xehoth.cc/">xehoth</a> <li><a href="http://hjwjbsr.is-programmer.com/">HJWJBSR</a> <li><a href="http://www.micdz.cn/">MicDZ</a> <li><a href="https://cmxrynp.github.io/">CMXRYNP</a> <li><a href="http://memset0.cn/">memset0</a> </ul> </div> </div> <div class=mdl-mega-footer__bottom-section >Theme based on <a href="https://getmdl.io/">MDL</a> | Copyright © 2015-2019 riteme. All rights reserved.</div> </footer> </main> </div>