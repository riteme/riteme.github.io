{
"$k$-SBK\u53d8\u6362": {
"tags": "Problems",
"text": "$k$-SBK\u53d8\u6362 (ksbk.in/out/cpp)<br/>\u65f6\u95f4\u9650\u5236: 1 s / \u5185\u5b58\u9650\u5236: 512 MB / \u6253\u5f00O2\u4f18\u5316<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u6570\u5b66\u5bb6Lunk\u6700\u8fd1\u53d1\u73b0\u4e86\u4e00\u79cd\u9017\u903c\u7684SBK\u53d8\u6362\u3002\u5728Lunk\u773c\u91cc\uff0cSBK\u53d8\u6362\u662f\u8fd9\u6837\u7684\uff1a<br/><br/>\u7ed9\u4f60\u4e00\u4e2a$1$\u81f3$n$\u7684\u6392\u5217$A$\u548c\u4e00\u4e2a$1$\u81f3$n$\u7684\u6392\u5217$P$\uff0c$P$\u5bf9$A$\u505a\u4e00\u6b21SBK\u53d8\u6362\u540e\u5c06\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u6392\u5217$B$\uff0c\u5176\u4e2d\uff1a<br/>$$ B_{P_i} = A_i \\\\tag{SBK Transformation}$$<br/><br/>\u7136\u800c\u505a\u4e00\u6b21SBK\u53d8\u6362\u592a\u8fc7\u65e0\u804a\uff0c\u4e8e\u662fLunk\u51b3\u5b9a\u8fde\u7eed\u505a\u591a\u6b21SBK\u53d8\u6362\u3002\u5373\u5c06\u6bcf\u6b21\u53d8\u6362\u540e\u7684\u7ed3\u679c$B$\u53d8\u4e3a$A$\uff0c\u7136\u540e\u7ee7\u7eed\u7528$P$\u5bf9$A$\u505aSBK\u53d8\u6362\u3002Lunk\u60f3\u77e5\u9053\u8fde\u7eed\u5bf9$A$\u505a$k$\u6b21SBK\u53d8\u6362\u540e\u7684\u7ed3\u679c\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6574\u6570$n$\u548c$k$\uff0c\u8868\u793a\u6392\u5217\u7684\u957f\u5ea6\u548c\u8fde\u7eed\u505aSBK\u53d8\u6362\u7684\u6b21\u6570\u3002<br/>\u7b2c\u4e8c\u884c\u8f93\u5165$n$\u4e2a\u6574\u6570\u8868\u793a\u6392\u5217$A$\u3002<br/>\u7b2c\u4e09\u884c\u8f93\u5165$n$\u4e2a\u6574\u6570\u8868\u793a\u6392\u5217$P$\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4e00\u884c\u8f93\u51fa$n$\u4e2a\u6574\u6570\uff0c\u8868\u793a$k$\u6b21SBK\u53d8\u6362\u540e\u7684\u7ed3\u679c\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>35 2<br/>1 2 3 4 5<br/>2 3 4 5 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>14 5 1 2 3<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca<br/>\u505a\u5b8c\u7b2c\u4e00\u6b21SBK\u53d8\u6362\u540e\uff1a 5 1 2 3 4<br/>\u505a\u5b8c\u7b2c\u4e8c\u6b21SBK\u53d8\u6362\u540e\uff1a 4 5 1 2 3<br/>\u6570\u636e\u8303\u56f4\u53ca\u7ea6\u5b9a<br/>\u5171$10$\u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u7684\u6570\u636e\u8303\u56f4\u5982\u4e0b\u8868\u6240\u793a\uff1a<br/><br/><br/><br/>\u6570\u636e\u70b9<br/>$n$\u7684\u89c4\u6a21<br/>$k$\u7684\u89c4\u6a21<br/><br/><br/><br/><br/>1<br/>$\\\\le10^3$<br/>$\\\\le10^3$<br/><br/><br/>2<br/>$\\\\le10^3$<br/>$\\\\le10^3$<br/><br/><br/>3<br/>$\\\\le10^4$<br/>$\\\\le10^5$<br/><br/><br/>4<br/>$\\\\le10^4$<br/>$\\\\le2\\\\times10^5$<br/><br/><br/>5<br/>$\\\\le4\\\\times10^5$<br/>$\\\\le2^{30}$<br/><br/><br/>6<br/>$\\\\le4\\\\times10^5$<br/>$\\\\le2^{33}$<br/><br/><br/>7<br/>$\\\\le6\\\\times10^5$<br/>$\\\\le2^{63}$<br/><br/><br/>8<br/>$\\\\le6\\\\times10^5$<br/>$\\\\le2^{63}$<br/><br/><br/>9<br/>$\\\\le10^6$<br/>$\\\\le2^{63}$<br/><br/><br/>10<br/>$\\\\le2.3\\\\times10^6$<br/>$\\\\le2^{63}$<br/><br/><br/>",
"url": "blog/2016-7-28/ksbk.html"
},
"$n = p \\\\mathrm{\\\\;mod\\\\;} n$\u9012\u63a8\u6b21\u6570\u7684\u4e0a\u754c\uff1f": {
"tags": "\u6570\u8bba \u9006\u5143 \u65f6\u95f4\u590d\u6742\u5ea6",
"text": "$n = p \\\\mathrm{\\\\;mod\\\\;} n$\u9012\u63a8\u6b21\u6570\u7684\u4e0a\u754c\uff1f<br/>\u539f\u95ee\u9898<br/>\u8fd9\u4e2a\u95ee\u9898\u6211\u6700\u5f00\u59cb\u662f\u4ece\u77e5\u4e4e1\u4e0a\u770b\u5230\u7684\uff0c\u91cc\u9762\u63d0\u5230\u4e86\u4e00\u79cd\u6c42\u9006\u5143\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u73b0\u5728\u6682\u65f6\u6ca1\u6709\u65b9\u6cd5\u80fd\u8bc1\u660e\u5176\u590d\u6742\u5ea6\u3002<br/>\u4f17\u6240\u5468\u77e5\uff0c\u5f53\u6211\u4eec\u9009\u53d6\u4e00\u4e2a\u8d28\u6570$p$\u4f5c\u4e3a\u6a21\u6570\u65f6\uff0c$1..n$\u7684\u6bcf\u4e2a\u6570\u90fd\u5b58\u5728\u4e00\u4e2a\u6a21$p$\u610f\u4e49\u4e0b\u7684\u9006\u5143\u3002\u5982\u4f55\u6c42\u51fa\u8fd9\u4e9b\u9006\u5143\u5462\uff1f\u6700\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u5355\u4e2a\u6570\u6c42\u9006\u5143\u7684\u65b9\u6cd5\u5bf9$1..n$\u90fd\u7528\u4e00\u904d\u3002\u81ea\u7136\u8fd9\u79cd\u65b9\u6cd5\u73b0\u5728\u65e0\u6cd5\u505a\u5230\u7ebf\u6027\u590d\u6742\u5ea6\u3002\u4f46\u662f\u6211\u4eec\u6709\u4e00\u79cd\u76f4\u63a5\u9012\u63a8\u7684\u529e\u6cd5\u6765\u6c42\u51fa$1..n$\u7684\u6240\u6709\u9006\u5143\u3002\u5177\u4f53\u7684\uff0c\u6211\u4eec\u5148\u8003\u8651\u4e0b$n$\u548c$r = p \\\\mathrm{\\\\;mod\\\\;} n$\u7684\u5173\u7cfb\u3002<br/>\u9996\u5148\uff0c\u6839\u636e\u4f59\u6570\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>r = p - \\\\left\\\\lfloor \\\\frac{p}n \\\\right\\\\rfloor n<br/>$$<br/>\u5c06\u5176\u653e\u5728\u6a21$p$\u610f\u4e49\u4e0b\uff1a<br/>$$<br/>r \\\\equiv -\\\\left\\\\lfloor \\\\frac{p}n \\\\right\\\\rfloor n \\\\pmod{p}<br/>$$<br/>\u5982\u679c$r^{-1}$\u548c$n^{-1}$\u90fd\u5b58\u5728\uff08\u5982\u679c$p$\u662f\u8d28\u6570\u5219\u663e\u7136\u6210\u7acb\uff09\uff0c\u90a3\u4e48\u4e0a\u5f0f\u53ef\u4ee5\u53d8\u4e3a\uff1a<br/>$$<br/>n^{-1} \\\\equiv -\\\\left\\\\lfloor \\\\frac{p}n \\\\right\\\\rfloor r^{-1} \\\\pmod{p}<br/>$$<br/>\u53c8\u56e0\u4e3a\u6211\u4eec\u77e5\u9053$1^{-1} = 1$\u5e76\u4e14$r < n$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ee5$1..n$\u7684\u987a\u5e8f\u9012\u63a8\u51fa\u6240\u6709\u7684\u9006\u5143\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u5747\u4e3a$\\\\Theta(n)$\u3002<br/>\u5982\u679c\u76f4\u63a5\u4f7f\u7528\u9012\u63a8\u5f0f\u6765\u8ba1\u7b97\u9006\u5143\uff0c\u4e5f\u5c31\u53d8\u6210\u4e86\u4e0b\u9762\u7684\u7b97\u6cd5\uff1a<br/>1<br/>2<br/>3<br/>4function INVERSE(n, p):<br/>    if n == 1:<br/>        return 1<br/>    return -(p / n) * INVERSE(p %  n, p)<br/><br/><br/>\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u4ee5\u4e0a\u65b9\u6cd5\u5728$p$\u4e0d\u662f\u8d28\u6570\u7684\u65f6\u5019\u5f88\u591a\u60c5\u51b5\u4e0b\u662f\u65e0\u6cd5\u4f7f\u7528\u7684\uff0c\u5373\u4fbf$n$\u548c$p$\u4e92\u8d28\u3002\u4e00\u4e2a\u53cd\u4f8b\u5c31\u662f\u5f53$n = 3$\u5e76\u4e14$p = 8$\u7684\u65f6\u5019\u3002<br/>\u7b97\u6cd5\u590d\u6742\u5ea6<br/>\u8be5\u7b97\u6cd5\u7684\u9012\u5f52\u6b21\u6570\u5b9e\u9645\u4e0a\u5c31\u662f$n = p \\\\mathrm{\\\\;mod\\\\;} n$\u8fd9\u4e2a\u9012\u63a8\u5f0f\u8981\u8fbe\u5230$n \\\\leqslant 1$\u7684\u6b21\u6570\uff0c\u6240\u4ee5\u4e0b\u9762\u7684\u5206\u6790\u90fd\u6309\u7167\u8fd9\u4e2a\u6765\u3002<br/>\u5b9e\u9a8c\u6570\u636e<br/>\u8fd9\u4e2a\u7b97\u6cd5\u4f3c\u4e4e\u5e76\u4e0d\u80fd\u76f4\u63a5\u4ece\u8868\u9762\u4e0a\u7b80\u5355\u5730\u770b\u51fa\u5b83\u7684\u8fed\u4ee3\u6b21\u6570\u3002\u901a\u8fc7\u5bf9\u4e00\u4e2a\u8457\u540d\u7684\u8d28\u6570$p = 10^9 + 7$\u505a\u4e86\u4e00\u4e9b\u6d4b\u8bd5\u540e\uff0c\u5f97\u5230\u4e86\u4e00\u4e9b\u6570\u636e\u3002<br/>\u968f\u673a$10^6$\u4e2a\u6570\u6765\u8ba1\u7b97\u9006\u5143\u7684\u5e73\u5747\u9012\u5f52\u6b21\u6570\u662f$21.9734742$\u6b21\u3002<br/>\u5f3a\u884c\u8ba1\u7b97\u51fa$1..p - 1$\u4e2d\u6bcf\u4e2a\u6570\u7684\u9012\u5f52\u6b21\u6570\uff0c\u5f97\u5230\u4ee5\u4e0b\u6570\u636e\uff1a<br/><br/><br/><br/>\u9012\u5f52\u6b21\u6570<br/>\u6700\u5c0f\u6ee1\u8db3\u7684$n$<br/>\u9012\u5f52\u6b21\u6570<br/>\u6700\u5c0f\u6ee1\u8db3\u7684$n$<br/><br/><br/><br/><br/>$1$<br/>$1$<br/>$26$<br/>$114378$<br/><br/><br/>$2$<br/>$2$<br/>$27$<br/>$207512$<br/><br/><br/>$3$<br/>$3$<br/>$28$<br/>$276557$<br/><br/><br/>$4$<br/>$4$<br/>$29$<br/>$434606$<br/><br/><br/>$5$<br/>$7$<br/>$30$<br/>$591809$<br/><br/><br/>$6$<br/>$8$<br/>$31$<br/>$871900$<br/><br/><br/>$7$<br/>$9$<br/>$32$<br/>$1381645$<br/><br/><br/>$8$<br/>$18$<br/>$33$<br/>$1595237$<br/><br/><br/>$9$<br/>$36$<br/>$34$<br/>$2661365$<br/><br/><br/>$10$<br/>$79$<br/>$35$<br/>$4510426$<br/><br/><br/>$11$<br/>$158$<br/>$36$<br/>$5525194$<br/><br/><br/>$12$<br/>$207$<br/>$37$<br/>$5954939$<br/><br/><br/>$13$<br/>$327$<br/>$38$<br/>$6098436$<br/><br/><br/>$14$<br/>$1063$<br/>$39$<br/>$9347131$<br/><br/><br/>$15$<br/>$1530$<br/>$40$<br/>$17080222$<br/><br/><br/>$16$<br/>$1675$<br/>$41$<br/>$38878508$<br/><br/><br/>$17$<br/>$3418$<br/>$42$<br/>$43540116$<br/><br/><br/>$18$<br/>$5935$<br/>$43$<br/>$72349030$<br/><br/><br/>$19$<br/>$10159$<br/>$44$<br/>$84331907$<br/><br/><br/>$20$<br/>$20343$<br/>$45$<br/>$91566810$<br/><br/><br/>$21$<br/>$21368$<br/>$46$<br/>$129776171$<br/><br/><br/>$22$<br/>$28592$<br/>$47$<br/>$145037306$<br/><br/><br/>$23$<br/>$40540$<br/>$48$<br/>$284987567$<br/><br/><br/>$24$<br/>$56017$<br/>$49$<br/>$357506220$<br/><br/><br/>$25$<br/>$96241$<br/>$50$<br/>$642493787$<br/><br/><br/><br/>\u53ef\u4ee5\u770b\u51fa\u4f3c\u4e4e\u9012\u5f52\u6b21\u6570$ \\\\leqslant 2\\\\log n$\uff1f\u5c1d\u8bd5\u4e86\u5176\u5b83\u7684\u4e00\u4e9b\u8d28\u6570\u53d1\u73b0\u4e5f\u6ee1\u8db3\u8fd9\u4e2a\u4e0a\u754c\u3002\u4f46\u662f\u6211\u5e76\u4e0d\u4f1a\u8bc1\u660e\u3002\u5982\u679c\u6709\u77e5\u9053\u8bc1\u660e\u65b9\u6cd5\u6216\u8005\u76f8\u5173\u8d44\u6599\u7684\u53ef\u4ee5\u4e0e\u6211\u8054\u7cfb\uff0c\u6216\u8005\u76f4\u63a5\u53bb\u56de\u7b54\u77e5\u4e4e\u4e0a\u7684\u90a3\u4e2a\u95ee\u9898\u3002<br/>\u5bf9\u4e8e\u767e\u5ea6\u51fa\u6765\u7684\u4e00\u4e9b\u7b54\u6848\uff0c\u90fd\u662f\u76f4\u63a5\u9ed8\u8ba4\u5b83\u6bcf\u6b21$n \\\\mathrm{\\\\;mod\\\\;} p$\u90fd\u4f1a\u51cf\u534a\u3002\u4f46\u662f\u5b9e\u9645\u4e0a\u5e76\u975e\u5982\u6b64\u3002\u5982\u679c\u771f\u7684\u8fbe\u5230\u4e86\u6bcf\u6b21\u64cd\u4f5c\u5b8c$n$\u90fd\u4f1a\u51cf\u534a\uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u6570\u636e\u4e2d\u4e5f\u5c31\u4e0d\u4f1a\u51fa\u73b0$50$\u6b21\u7684\u60c5\u51b5\u3002\u5e76\u4e14\u5c31\u4ee5\u4e0a\u9762\u6700\u5927\u7684\u6570\u5b57$642493787$\u4e3a\u4f8b\uff0c\u5b83\u7684\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u8fd9\u6837\u7684\u4e1c\u897f\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7...<br/>188<br/>183<br/>167<br/>166<br/>71<br/>...<br/><br/><br/>\u5f53$n = 188$\u5e76\u4e14$p = 10^9 + 7$\u65f6\uff0c\u7ecf\u8fc7$3$\u6b21\u8fed\u4ee3\u624d\u4f7f\u5f97$n$\u7684\u89c4\u6a21\u51cf\u534a\u3002<br/>\u6839\u53f7\u4e0a\u754c<br/>\u6839\u636e\u77e5\u4e4e\u4e0a@\u5f90\u8001\u4e1d\u7684\u56de\u7b54\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u8bc1\u660e\u5176\u9012\u5f52\u6b21\u6570$\\\\leqslant 2\\\\sqrt{p}$\u7684\u65b9\u6cd5\u3002<br/>\u9996\u5148\u9700\u8981\u786e\u5b9a\u4e00\u4e2a\u57fa\u672c\u5b9a\u7406\uff1a<br/><br/>\u5982\u679c\u6ee1\u8db3$\\\\frac1m p \\\\lt n \\\\leqslant \\\\frac1{m-1} p$\uff0c\u90a3\u4e48$p \\\\mathrm{\\\\;mod\\\\;} n \\\\lt \\\\frac1m p$\u3002<br/><br/>\u8bc1\u660e \u8bc1\u660e\u8fc7\u7a0b\u6bd4\u8f83\u7b80\u5355\uff0c\u53ea\u7528\u786e\u8ba4$p - (m - 1)n$\u7684\u8303\u56f4\u5373\u53ef\uff1a<br/>$$<br/>p - \\\\frac1m p \\\\lt (m - 1)n \\\\leqslant p \\\\\\\\<br/>\\\\frac1m p \\\\gt p - (m - 1)n \\\\geqslant 0<br/>$$<br/>\u7531\u4e8e$n \\\\gt \\\\frac1m p$\uff0c\u6240\u4ee5$p \\\\mathrm{\\\\;mod\\\\;} n = p - (m - 1)n \\\\lt \\\\frac1m p$\u3002<br/>\u6839\u636e\u4ee5\u4e0a\u5b9a\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff0c\u5982\u679c\u4e00\u5f00\u59cb$\\\\frac1m p \\\\lt n \\\\leqslant \\\\frac1{m-1} p$\uff0c\u90a3\u4e48\u7ecf\u8fc7$\\\\sqrt{p}$\u6b21\u8fed\u4ee3\u540e\uff0c\u5c31\u6709$n \\\\lt \\\\frac1{m + \\\\sqrt{p}} p$\u3002\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u7684$1 \\\\leqslant n \\\\lt p$\uff0c\u7ecf\u8fc7$\\\\sqrt{p}$\u6b21\u8fed\u4ee3\u540e\u90fd\u6709$n \\\\lt \\\\frac1{\\\\sqrt{p}} p = \\\\sqrt{p}$\u3002\u7531\u4e8e\u6bcf\u6b21\u53d6\u6a21$n$\u81f3\u5c11\u51cf$1$\uff0c\u6240\u4ee5\u4e4b\u540e\u6700\u591a$\\\\sqrt{p}$\u6b65\u4f7f\u5f97$n \\\\leqslant 1$\u3002\u6240\u4ee5\u8be5\u7b97\u6cd5\u7684\u4e00\u4e2a\u4e0a\u754c\u662f$2\\\\sqrt{p}$\u7684\u3002<br/>\u671f\u671b\u6b21\u6570\u5206\u6790<br/>\u6211\u81ea\u5df1\u601d\u8003\u4e86\u4e00\u79cd\u601d\u8def\uff0c\u4f3c\u4e4e\u53ef\u4ee5\u63d0\u4f9b\u4e00\u79cd\u4e3a\u4ec0\u4e48\u8be5\u7b97\u6cd5\u7684\u9012\u5f52\u6b21\u6570\u975e\u5e38\u5c11\u7684\u89e3\u91ca\u3002<br/>\u9996\u5148\u6ce8\u610f\u5230\u5bf9\u4e8e\u4efb\u610f\u7684$0 \\\\lt n \\\\lt p$\uff0c\u8bbe$r = p \\\\mathrm{\\\\;mod\\\\;} n$\uff0c\u90a3\u4e48\u6709$n \\\\mid (p - r)$\u3002<br/>\u540c\u65f6\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684$0 \\\\leqslant r \\\\lt p$\uff0c\u6240\u6709\u6ee1\u8db3$p \\\\mathrm{\\\\;mod\\\\;} n = r$\u7684$n$\u662f$p - r$\u4e2d\u6240\u6709\u5927\u4e8e$r$\u7684\u56e0\u5b50\u3002<br/>\u66f4\u8fdb\u4e00\u6b65\uff0c\u6211\u4eec\u6bd4\u8f83\u5173\u6ce8\u90a3\u79cd$r \\\\leqslant n / 2$\u7684$n$\uff0c\u4ece$r$\u7684\u89d2\u5ea6\u800c\u8a00\uff0c\u8fd9\u6837\u7684$n$\u90fd\u662f$p - r$\u7684\u5927\u4e8e\u7b49\u4e8e$2r$\u7684\u56e0\u5b50\u3002<br/>\u73b0\u5728\u7528\u4e00\u5f20\u56fe\u6765\u5212\u5206\u8fd9\u4e24\u79cd$n$\uff1a<br/><br/>\u4e0a\u56fe\u662f$p = 11$\u65f6\u7684\u60c5\u51b5\u3002\u56fe\u4e0a\u7684\u6bcf\u4e00\u4e2a\u9ed1\u70b9$(x,y)$\u8868\u793a$y \\\\mid x$\u3002\u8fd9\u6837\u6bcf\u4e00\u4e2a\u6a2a\u5750\u6807\u4e0a\u65b9\u7684\u70b9\u7684\u7eb5\u5750\u6807\u5c31\u662f\u5b83\u7684\u56e0\u5b50\u3002\u56fe\u4e2d\u5e76\u6ca1\u6709\u753b\u51fa$1$\u7684\u6240\u6709\u500d\u6570\u3002\u7ea2\u8272\u7684\u76f4\u7ebf\u662f$y = 11 - x$\uff0c\u84dd\u8272\u7684\u76f4\u7ebf\u662f$y = 2 \\\\times 11 - 2x$\u3002\u6b64\u65f6\u7ea2\u8272\u76f4\u7ebf\u548c\u84dd\u8272\u76f4\u7ebf\u4e4b\u95f4\u6240\u5939\u7684\u4e00\u7247\u7eff\u8272\u533a\u57df\uff08\u4e0d\u5305\u542b\u84dd\u8272\u76f4\u7ebf\u548c\u7ea2\u8272\u76f4\u7ebf\uff09\u4e2d\u7684\u70b9\u7684\u7eb5\u5750\u6807$n$\u6ee1\u8db3$p \\\\mathrm{\\\\;mod\\\\;} n > n / 2$\uff0c\u800c\u5269\u4f59\u7684\u9ec4\u8272\u533a\u57df\uff08\u5305\u62ec\u84dd\u8272\u76f4\u7ebf\uff09\u4e2d\u7684\u70b9\u7684\u7eb5\u5750\u6807$n$\u5219\u6ee1\u8db3$p \\\\mathrm{\\\\;mod\\\\;} n \\\\leqslant n / 2$\u3002<br/>\u4ece\u4e00\u4e2a\u7ed9\u5b9a\u7684$n$\u5f00\u59cb\u8fed\u4ee3\uff0c\u6bcf\u6b21\u53ea\u80fd\u5411\u4e0b\u8d70\u5230\u53e6\u5916\u4e00\u4e2a\u7eb5\u5750\u6807\u3002\u5982\u679c\u8d70\u5230\u4e86\u9ec4\u8272\u533a\u57df\uff0c\u90a3\u4e48\u6b64\u65f6$n$\u7684\u89c4\u6a21\u51cf\u534a\u3002\u6ce8\u610f\u5230\u5bf9\u4e8e\u56fa\u5b9a\u7684$n$\uff0c\u7eb5\u5750\u6807\u4e3a$n$\u7684\u70b9\u4e4b\u95f4\u7684\u95f4\u8ddd\u662f\u76f8\u540c\u7684\uff0c\u800c\u7ea2\u7ebf\u548c\u84dd\u7ebf\u4e4b\u95f4\u7684\u8ddd\u79bb\u548c\u84dd\u7ebf\u5230\u76f4\u7ebf$y = p$\u7684\u8ddd\u79bb\u4e5f\u662f\u76f8\u540c\u7684\u3002\u90a3\u4e48$p$\u968f\u673a\u7684\u60c5\u51b5\u4e0b\uff0c$p \\\\mathrm{\\\\;mod\\\\;} n \\\\leqslant n / 2$\u7684\u6982\u7387\u53ef\u4ee5\u8fd1\u4f3c\u4e3a$1/2$\u3002\u610f\u601d\u662f\u5728$n$\u548c$p$\u90fd\u968f\u673a\u7684\u60c5\u51b5\u4e0b\uff0c\u671f\u671b$\\\\sum_{k = 1}^\\\\infty k/2^k = 2$\u6b65\u5c31\u53ef\u4ee5\u4f7f$n$\u89c4\u6a21\u51cf\u534a\u3002\u5982\u679c\u4e0d\u90a3\u4e48\u4e25\u8c28\u7684\u8bdd\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u671f\u671b\u6b65\u6570\u662f$O(\\\\log n)$\u7684\u3002<br/><br/><br/><br/><br/>\u5173\u4e8e\u4e00\u79cd\u6c42\u9006\u5143\u7684\u9012\u5f52\u5f0f\u7684\u590d\u6742\u5ea6\u95ee\u9898\uff1f\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-5-8/nmodp.html"
},
"2-3\u6811\u4e0e\u7ea2\u9ed1\u6811": {
"tags": "2-3\u6811 \u7ea2\u9ed1\u6811 \u7b97\u6cd5 \u6570\u636e\u7ed3\u6784",
"text": "2-3\u6811\u4e0e\u7ea2\u9ed1\u6811<br/>\u6982\u8ff0<br/>\u7ea2\u9ed1\u6811<br/>\u7ea2\u9ed1\u68111\u662f\u4e00\u79cd\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u5176\u76ee\u6807\u662f\u4e3a\u4e86\u4f18\u5316\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u9632\u6b62\u6781\u7aef\u60c5\u51b5\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u9000\u5316\u3002<br/><br/>\u7ea2\u9ed1\u6811\u7684\u80cc\u540e\u539f\u578b\u5176\u5b9e\u662f2-3\u6811\u3002\u56e0\u6b64\u6211\u4eec\u5c06\u5148\u4e86\u89e3\u4ec0\u4e48\u662f2-3\u6811\u3002<br/>2-3\u6811<br/>2-3\u68112\u662f\u4e00\u79cd\u9636\u4e3a3\u7684B\u68113\uff0c\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u4e3a3\u53c9\u6811\u30022-3\u6811\u6700\u5927\u7684\u7279\u70b9\u5c31\u662f\u5b83\u4e00\u5b9a\u662f\u4e00\u68f5\u5b8c\u51683\u53c9\u6811\uff0c\u5373\u9664\u4e86\u53f6\u8282\u70b9\u5916\uff0c\u5176\u5b83\u7684\u8282\u70b9\u6ca1\u6709\u7a7a\u513f\u5b50\u3002<br/><br/>\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u63a2\u7a762-3\u6811\u7684\u57fa\u672c\u64cd\u4f5c\u3002\u4e4b\u540e\u518d\u6765\u89c2\u5bdf2-3\u6811\u4e0e\u7ea2\u9ed1\u6811\u4e4b\u95f4\u7684\u8054\u7cfb\u3002<br/>2-3\u6811\uff1f<br/>\u6811\u7684\u8868\u793a<br/>\u4ece\u4e4b\u524d\u7ed9\u51fa\u7684\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c2-3\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0d\u4e00\u5b9a\u53ea\u6709\u4e00\u4e2a\u952e4\uff0c\u540c\u65f6\u513f\u5b50\u7684\u6570\u91cf\u4e5f\u6709\u4e0d\u540c\u3002<br/>\u57282-3\u6811\u4e2d\uff0c\u5171\u6709\u4e24\u79cd\u8282\u70b9\u3002<br/>\u7b2c\u4e00\u79cd\u662f\u201c2-\u8282\u70b9\u201d\uff1a<br/><br/>2-\u8282\u70b9\u548c\u666e\u901a\u7684\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u8282\u70b9\u6ca1\u6709\u4ec0\u4e48\u4e0d\u540c\u3002\u5176\u5de6\u513f\u5b50\u8868\u793a\u6bd4a\u5c0f\u7684\u5b50\u6811\uff0c\u53f3\u513f\u5b50\u8868\u793a\u6bd4a\u5927\u7684\u5b50\u6811\u3002<br/>\u63a5\u4e0b\u6765\u662f\u4e0d\u4e00\u6837\u7684\u201c3-\u8282\u70b9\u201d\uff1a<br/><br/>3-\u8282\u70b9\u6709\u4e24\u4e2a\u952e\u3002\u6700\u5de6\u8fb9\u7684\u513f\u5b50\u8868\u793a\u6bd4a\u5c0f\u7684\u5b50\u6811\uff0c\u4e2d\u95f4\u7684\u513f\u5b50\u8868\u793a\u5927\u4e8ea\u4f46\u5c0f\u4e8eb\u7684\u5b50\u6811\uff0c\u53f3\u8fb9\u7684\u513f\u5b50\u8868\u793a\u6bd4b\u5927\u7684\u5b50\u6811\u3002<br/>\u867d\u7136\u8fd9\u662f2-3\u6811\uff0c\u5448\u73b0\u7ed9\u6211\u4eec\u770b\u7684\u6811\u4e2d\u662f\u4e0d\u5b58\u5728\u201c4-\u8282\u70b9\u201d\u7684\u3002\u4f46\u662f\u4e3a\u4e86\u4fdd\u6301\u6811\u7684\u5e73\u8861\u6027\uff0c\u6211\u4eec\u5c06\u4f1a\u5229\u75284-\u8282\u70b9\u6765\u5728\u63d2\u5165\u548c\u5220\u9664\u8fc7\u7a0b\u4e2d\u4fdd\u6301\u6811\u7684\u5b8c\u7f8e\u5e73\u8861\u3002\u4e0b\u9762\u662f\u4e00\u4e2a4-\u8282\u70b9\uff1a<br/><br/>\u4e0e3-\u8282\u70b9\u7c7b\u4f3c\uff0c\u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u513f\u5b50\u5206\u522b\u8868\u793a\u5c0f\u4e8ea\u548c\u5927\u4e8ec\u7684\u5b50\u6811\u3002\u4e2d\u95f4\u7684\u4e24\u4e2a\u513f\u5b50\u5206\u522b\u8868\u793a\u5927\u4e8ea\u4e14\u5c0f\u4e8eb\u7684\u5b50\u6811\u548c\u5927\u4e8eb\u5c0f\u4e8ec\u7684\u5b50\u6811\u3002<br/>\u67e5\u8be2\u64cd\u4f5c<br/>2-3\u6811\u5177\u6709\u548c\u4e8c\u53c9\u67e5\u627e\u6811\u4e00\u6837\u7684\u6709\u5e8f\u6027\uff0c\u4f7f\u5f97\u67e5\u627e\u64cd\u4f5c\u548c\u4e8c\u53c9\u67e5\u627e\u6811\u7c7b\u4f3c\u3002<br/>\u6211\u4eec\u5148\u6765\u770b\u4e00\u68f52-3\u6811\uff1a<br/><br/>\u4f7f\u7528\u548c\u4e8c\u53c9\u67e5\u627e\u6811\u4e00\u6837\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u5728\u5411\u4e0b\u9012\u5f52\u8fd9\u68f5\u6811\u7684\u65f6\u5019\u901a\u8fc7\u201c\u6253\u64c2\u53f0\u201d\u6765\u786e\u5b9a\u67e5\u627e\u7684\u8282\u70b9\u5e94\u8be5\u5728\u54ea\u68f5\u5b50\u6811\u4e2d\u3002<br/>\u4f8b\u5982\u6211\u4eec\u8981\u67e5\u627e8,\u9996\u5148\u548c\u6839\u8282\u70b95\u505a\u6bd4\u8f83\uff0c\u53d1\u73b0\u6bd45\u5927\uff0c\u4e8e\u662f\u5728\u5176\u53f3\u5b50\u6811\u4e2d\u67e5\u627e\u3002<br/>\u63a5\u4e0b\u67657-9\u8fd9\u4e2a3-\u8282\u70b9\u4e2d\uff0c\u6211\u4eec\u5148\u548c9\u6bd4\u8f83\uff0c\u53d1\u73b0\u6bd49\u5c0f\uff0c\u4e8e\u662f\u5411\u5de6\u79fb\u4e00\u4f4d\uff0c\u4e0e7\u6bd4\u8f83\uff0c\u53d1\u73b0\u6bd47\u5927\uff0c\u56e0\u6b64\u67e5\u627e\u7684\u8282\u70b9\u5e94\u5f53\u5728\u4e2d\u95f4\u7684\u5b50\u6811\u4e2d\u3002<br/>\u7ee7\u7eed\u6df1\u5165\u4e0b\u53bb\uff0c\u6211\u4eec\u53d1\u73b02-\u8282\u70b98\u5c31\u662f\u6211\u4eec\u8981\u627e\u7684\u3002<br/>\u7531\u4e8e2-3\u6811\u7684\u5b8c\u7f8e\u5e73\u8861\u6027\u8d28\uff0c\u56e0\u6b64\u6240\u6709\u67e5\u8be2\u64cd\u4f5c\u5747\u53ef\u5728$ \\\\Theta(\\\\text{log}N) $\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u3002<br/>\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u4e3a\u4ec0\u4e482-3\u6811\u5177\u6709\u5b8c\u7f8e\u5e73\u8861\u7684\u6027\u8d28\uff1f<br/>\u63d2\u5165\u64cd\u4f5c<br/>2-3\u6811\u4e4b\u6240\u4ee5\u5b8c\u7f8e\u5e73\u8861\uff0c\u5173\u952e\u5728\u4e8e\u63d2\u5165\u65f6\u7684\u7ef4\u62a4\u3002<br/>\u6211\u4eec\u9996\u5148\u6765\u770b2-\u8282\u70b9\u30013-\u8282\u70b9\u4ee5\u53ca4-\u8282\u70b9\u4e4b\u95f4\u5982\u4f55\u8f6c\u6362\u3002<br/>\u8282\u70b9\u5408\u5e76<br/>\u5f53\u6211\u4eec\u63d2\u5165\u7ed3\u70b9\u65f6\uff0c\u901a\u5e38\u90fd\u662f\u63d2\u5165\u4e00\u4e2a\u952e\uff0c\u57282-3\u6811\u4e2d\u5c31\u662f\u4e00\u4e2a2-\u8282\u70b9\u3002<br/>\u4e0e\u4e8c\u53c9\u67e5\u627e\u6811\u4e00\u6837\uff0c\u6211\u4eec\u5c06\u4f1a\u57282-3\u6811\u4e2d\u627e\u5230\u4e00\u4e2a\u5408\u9002\u4f4d\u7f6e\u6765\u63d2\u5165\u5b83\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e00\u5b9a\u5728\u6811\u7684\u5e95\u90e8\u3002<br/>\u7136\u800c\uff0c\u5728\u63d2\u5165\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u4fdd\u8bc1\u8fd9\u68f52-3\u6811\u662f\u5b8c\u7f8e\u5e73\u8861\u7684\uff08\u7a7a\u6811\u4e5f\u662f\u5982\u6b64\uff09\u3002\u5728\u5e95\u90e8\u63d2\u5165\u4e00\u4e2a\u8282\u70b9\u540e\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5e95\u90e8\u201c\u591a\u51fa\u201d\u4e00\u4e2a\u8282\u70b9\uff0c\u5bfc\u81f42-3\u6811\u4e0d\u5b8c\u7f8e\u5e73\u8861\u3002<br/>\u5176\u89e3\u51b3\u65b9\u6848\u5c31\u662f\u628a\u5b83\u4e0e\u4e0a\u9762\u7684\u8282\u70b9\u76f8\u7ed3\u5408\u3002<br/>\u4e0e\u8282\u70b9\u7ed3\u5408\u65f6\uff0c\u5171\u67095\u79cd\u60c5\u51b5\uff1a<br/><br/>\u5728\u4e00\u4e2a2-\u8282\u70b9\u7684\u5de6\u8fb9 <br/>\u5728\u4e00\u4e2a2-\u8282\u70b9\u7684\u53f3\u8fb9 <br/>\u5728\u4e00\u4e2a3-\u8282\u70b9\u7684\u5de6\u8fb9 <br/>\u5728\u4e00\u4e2a3-\u8282\u70b9\u7684\u4e2d\u95f4 <br/>\u5728\u4e00\u4e2a3-\u8282\u70b9\u7684\u53f3\u8fb9<br/><br/>\u55ef\u2026\u8fd9\u4e9b\u60c5\u51b5\u5f88\u65e0\u804a\uff0c\u4e0b\u9762\u662f\u5b83\u4eec\u7684\u8f6c\u6362\u60c5\u51b5\uff1a<br/><br/>\u5408\u5e76\u7684\u8fc7\u7a0b\u662f\u5f88\u76f4\u89c2\u7684\uff0c\u5c31\u662f\u5c062-\u8282\u70b9\u653e\u5230\u4e86\u4e00\u4e2a\u5408\u9002\u7684\u5730\u65b9\u3002<br/>\u7531\u4e8e2-3\u6811\u4e2d\u4e0d\u5b58\u57284-\u8282\u70b9\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u8003\u8651\u4e0e4-\u8282\u70b9\u7684\u5408\u5e76\u3002<br/>\u8282\u70b9\u5206\u88c2<br/>\u5728\u4e0a\u9762\u7684\u8282\u70b9\u5408\u5e76\u7684\u64cd\u4f5c\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u51fa\u73b0\u4e864-\u8282\u70b9\u3002\u7136\u800c4-\u8282\u70b9\u662f\u4e0d\u80fd\u51fa\u73b0\u5728\u6700\u540e\u76842-3\u6811\u4e2d\u7684\u3002<br/>\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5c064-\u8282\u70b9\u201c\u80a2\u89e3\u201d\uff0c\u4ee5\u786e\u4fdd\u8fd9\u662f\u4e00\u68f52-3\u6811\u3002<br/>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a4-\u8282\u70b9\u53ef\u4ee5\u5206\u88c2\u62103\u4e2a2-\u8282\u70b9\uff1a<br/><br/>\u5206\u88c2\u7684\u8fc7\u7a0b\u5341\u5206\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5c064-\u53c9\u8282\u70b9\u4ece\u4e2d\u95f4\u5206\u5f00\uff0c\u5e76\u5c06\u4e2d\u95f4\u7684\u4e24\u4e2a\u513f\u5b50\u5206\u522b\u91cd\u65b0\u63a5\u5728a\u7684\u53f3\u513f\u5b50\u548cc\u7684\u5de6\u513f\u5b50\u5373\u53ef\u3002<br/>\u4f46\u662f4-\u8282\u70b9\u662f\u5728\u63d2\u5165\u65f6\u51fa\u73b0\u7684\uff0c\u5e76\u4e14\u662f\u51fa\u73b0\u5728\u6811\u7684\u5e95\u90e8\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u4e00\u5206\u88c2\u5c31\u5bfc\u81f4\u9ad8\u5ea6\u52a01\uff0c\u76f4\u63a5\u5bfc\u81f4\u6811\u7684\u4e0d\u5e73\u8861\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5c06a\u548cc\u7559\u5728\u539f\u5904\uff0c\u628ab\u5411\u4e0a\u4f20\u9012\uff0c\u4e0e\u7236\u4eb2\u8282\u70b9\u7ed3\u5408\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u9ad8\u5ea6\u7684\u589e\u52a0\u4e86\u3002<br/>\u4f46\u662f\u7236\u4eb2\u8282\u70b9\u53ef\u80fd\u662f\u4e00\u4e2a3-\u8282\u70b9\uff0cb\u5411\u4e0a\u7ed3\u5408\u65f6\u53c8\u4f1a\u4ea7\u751f4-\u8282\u70b9\uff01\u4f46\u662f\u4e0d\u5fc5\u614c\u5f20\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ee7\u7eed\u5206\u89e3\u8fd9\u4e2a\u65b0\u751f\u6210\u76844-\u8282\u70b9\u5373\u53ef\u3002<br/>\u90a3\u4e48\u95ee\u9898\u53c8\u6765\u4e86\uff0c\u5982\u679c\u7236\u4eb2\u8282\u70b9\u662f3-\u8282\u70b9\u5e76\u4e14\u5b83\u662f\u6811\u6839\u5462\uff1f<br/>\u5176\u5b9e\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u4f9d\u7136\u53ef\u4ee5\u5206\u89e34-\u8282\u70b9\uff0c\u7531\u4e8e\u6839\u8282\u70b9\u6ca1\u6709\u7236\u4eb2\uff0c\u56e0\u6b64\u5411\u4e0a\u4f20\u9012\u7684\u8282\u70b9\u5c31\u6ca1\u5fc5\u8981\u53bb\u7ed3\u5408\u4e86\uff0c\u6b64\u65f6\u6574\u68f5\u6811\u7684\u9ad8\u5ea6\u52a01\uff0c\u4fdd\u8bc1\u4e862-3\u6811\u7684\u5b8c\u7f8e\u5e73\u8861\u6027\u3002<br/>\u63d2\u5165\u793a\u4f8b<br/>\u4e0b\u9762\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u63d2\u5165\u793a\u4f8b\uff0c\u4f9d\u6b21\u5411\u4e00\u68f5\u7a7a\u76842-3\u6811\u4e2d\u63d2\u51651\u52307\uff1a<br/><br/>\u5728\u63d2\u5165\u8282\u70b9\u4e2d\uff0c\u627e\u5230\u5176\u6b63\u786e\u7684\u4f4d\u7f6e\u9700\u8981\u8bbf\u95ee$ \\\\Theta(\\\\text{log}N) $\u4e2a\u8282\u70b9\u3002\u56de\u6eaf\u5411\u4e0a\u8c03\u65742-3\u6811\u65f6\uff0c\u6bcf\u4e2a\u8282\u70b9\u5904\u7684\u8c03\u6574\u65f6\u95f4\u4e3a$ \\\\Theta(1) $\u3002\u56e0\u6b64\uff0c2-3\u6811\u7684\u63d2\u5165\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$ \\\\Theta(\\\\text{log}N) $\u3002<br/>\u5220\u9664\u64cd\u4f5c<br/>\u53ef\u4ee5\u770b\u51fa\uff0c2-3\u6811\u7684\u63d2\u5165\u64cd\u4f5c\u662f\u6709\u70b9\u590d\u6742\u7684\uff0c\u7136\u800c\u5220\u9664\u64cd\u4f5c\u66f4\u52a0\u9ebb\u70e6\u3002\u6211\u4eec\u9996\u5148\u4ece\u7b80\u5355\u7684\u60c5\u51b5\u5f00\u59cb\u8ba8\u8bba\u3002<br/>\u9996\u5148\uff0c\u6211\u4eec\u786e\u5b9a\u4e00\u70b9\uff1a2-3\u6811\u4e2d\u7684\u8282\u70b9\u7684\u513f\u5b50\uff0c\u8981\u4e48\u90fd\u662f\u7a7a\u513f\u5b50\uff0c\u8981\u4e48\u90fd\u4e0d\u662f\u7a7a\u513f\u5b50\u3002<br/>\u539f\u56e0\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u7528\u53cd\u8bc1\u6cd5\u6765\u8bc1\u660e\uff1a\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u8282\u70b9\uff0c\u5b83\u65e2\u6709\u975e\u7a7a\u513f\u5b50\uff0c\u53c8\u6709\u7a7a\u513f\u5b50\uff0c\u90a3\u4e48\u975e\u7a7a\u513f\u5b50\u5728\u6811\u4e2d\u6240\u5904\u7684\u6df1\u5ea6\u80af\u5b9a\u5927\u4e8e\u7236\u8282\u70b9\u7684\u6df1\u5ea6\uff0c\u90a3\u4e48\u4ee5\u8fd9\u4e2a\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u4e0d\u662f\u5b8c\u7f8e\u5e73\u8861\u7684\u3002\u53c8\u56e0\u4e3a2-3\u6811\u5fc5\u987b\u662f\u5b8c\u7f8e\u5e73\u8861\u7684\uff0c\u56e0\u6b642-3\u6811\u9700\u8981\u5b83\u6240\u6709\u7684\u5b50\u6811\u4e5f\u662f\u5b8c\u7f8e\u5e73\u8861\u7684\uff0c\u6545\u8fd9\u6837\u7684\u8282\u70b9\u662f\u4e0d\u5b58\u5728\u7684\u3002<br/>\u5e76\u4e14\u53ef\u4ee5\u770b\u51fa\uff0c\u53ea\u6709\u6811\u7684\u5e95\u90e8\u8282\u70b9\u624d\u4f1a\u6ca1\u6709\u513f\u5b50\u3002<br/>\u7531\u6b64\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u5206\u60c5\u51b5\u8ba8\u8bba\u3002<br/>\u5220\u9664\u5e95\u90e8\u8282\u70b9<br/>\u6211\u4eec\u5148\u8003\u8651\u5e95\u90e8\u8282\u70b9\u662f\u56e0\u4e3a\u8fd9\u4e9b\u8282\u70b9\u4e0d\u9700\u8981\u548c\u5b83\u7684\u513f\u5b50\u4eec\u201c\u7ea0\u7f20\u4e0d\u6e05\u201d\uff0c\u5e76\u4e14\u5b83\u4e5f\u662f\u6211\u4eec\u540e\u7eed\u5220\u9664\u7b97\u6cd5\u7684\u4e00\u4e2a\u57fa\u7840\u3002<br/>\u9996\u5148\u8003\u86513-\u8282\u70b9\u3002\u4ece3-\u7ed3\u70b9\u5220\u9664\u4e00\u4e2a\u952e\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5c06\u5176\u53d8\u6210\u4e00\u4e2a2-\u8282\u70b9\u5c31\u53ef\u4ee5\u4fdd\u8bc12-3\u6811\u7684\u5b8c\u7f8e\u5e73\u8861\u3002\u7136\u800c\u5220\u9664\u4e00\u4e2a2-\u8282\u70b9\u5c31\u9ebb\u70e6\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u5bfc\u81f4\u7559\u4e0b\u4e00\u4e2a\u7a7a\u4f4d\uff0c\u800c\u4e14\u6ca1\u6709\u5408\u9002\u7684\u8282\u70b9\u6765\u586b\u8865\u5b83\u3002<br/>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8003\u8651\u5728\u5220\u9664\u4e4b\u524d\u80fd\u5426\u5c06\u5176\u53d8\u6210\u4e00\u4e2a3-\u8282\u70b9\u3002<br/>\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u7684\u4e00\u7cfb\u5217\u53d8\u6362\u6765\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002<br/>\u4e3a\u4e86\u5728\u6700\u540e\u5220\u9664\u7684\u65f6\u5019\u7684\u786e\u662f\u4e00\u4e2a3-\u8282\u70b9\uff0c\u6211\u4eec\u5fc5\u987b\u786e\u4fdd\u5728\u67e5\u627e\u88ab\u5220\u9664\u7684\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u5fc5\u987b\u4e00\u76f4\u67093-\u8282\u70b9\u3002<br/>\u5047\u8bbe\u6211\u4eec\u5728\u5bfb\u627e\u5f85\u5220\u9664\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u5df2\u7ecf\u5904\u4e8e\u4e00\u4e2a3-\u8282\u70b9\u5904\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u5982\u4f55\u4fdd\u8bc1\u4e0b\u4e00\u6b65\u4e5f\u662f\u4e00\u4e2a3-\u8282\u70b9\u3002\u9996\u5148\uff0c\u6211\u4eec\u786e\u5b9a\u8981\u5411\u4e0b\u9012\u5f52\u7684\u65b9\u5411\uff0c\u5982\u679c\u5728\u8be5\u65b9\u5411\u4e0a\u5df2\u7ecf\u6709\u4e00\u4e2a3-\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u65e0\u9700\u53d8\u6362\u5c31\u53ef\u5b89\u5168\u5730\u9012\u5f52\u5411\u4e0b\u3002\u5982\u679c\u8be5\u65b9\u5411\u4e0a\u6ca1\u67093-\u8282\u70b9\uff0c\u6211\u4eec\u5c31\u9700\u8981\u60f3\u529e\u6cd5\u53d8\u51fa\u4e00\u4e2a3-\u8282\u70b9\u3002<br/>\u5982\u4f55\u624d\u80fd\u53d8\u51fa\u4e00\u4e2a3-\u8282\u70b9\u5462\uff1f\u4e00\u4e2a\u5f88\u597d\u7684\u60f3\u6cd5\u5c31\u662f\u5f53\u6211\u4eec\u6709\u5f88\u591a\u7684\u8282\u70b9\u65f6\uff0c\u6211\u4eec\u5c31\u6709\u5f88\u5927\u7684\u81ea\u7531\u6765\u5206\u914d\u8fd9\u4e9b\u8282\u70b9\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u5f53\u524d\u76843-\u8282\u70b9\u4e2d\u7684\u4e00\u4e2a\u952e\u62ff\u51fa\u6765\uff0c\u548c\u5b83\u7684\u513f\u5b50\u201d\u56e2\u805a\u201d\u4e00\u4e0b\uff0c\u7136\u540e\u786e\u5b9a\u5982\u4f55\u201c\u53d1\u914d\u201d\u8fd9\u4e9b\u201c\u805a\u5728\u4e00\u8d77\u201d\u7684\u8282\u70b9\u3002\u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u513f\u5b50\u662f3-\u8282\u70b9\uff0c\u90a3\u4e48\u805a\u5408\u540e\u5c31\u4f1a\u51fa\u73b0\u4e00\u4e2a\u542b\u67094\u4e2a\u952e\u76845-\u8282\u70b9\uff015-\u8282\u70b9\u662f\u7edd\u5bf9\u4e0d\u80fd\u51fa\u73b0\u7684\uff01\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u4ece\u4e2d\u53d6\u51fa\u4e24\u4e2a\u952e\u6765\u6784\u6210\u4e00\u4e2a3-\u8282\u70b9\uff0c\u5269\u4e0b\u7684\u4e24\u4e2a\u952e\u5219\u7528\u4e8e\u8c03\u6574\u5c40\u90e8\u5e73\u8861\u3002\u8fd9\u6837\u5c31\u65e2\u4e0d\u635f\u5bb32-3\u6811\u7684\u5b8c\u7f8e\u5e73\u8861\u6027\uff0c\u53c8\u80fd\u5728\u5e0c\u671b\u7684\u5730\u65b9\u521b\u5efa\u4e00\u4e2a3-\u8282\u70b9\u4e86\u3002\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7406\u89e3\u6210\u516c\u7136\u4ece\u5de6\u513f\u5b50\u6216\u53f3\u513f\u5b50\u4e2d\u201c\u62a2\u6765\u201d\u4e86\u4e00\u4e2a\u952e\u3002<br/>\u4f46\u5982\u679c\u4e24\u4e2a\u513f\u5b50\u4e2d\u6ca1\u6709\u4e00\u4e2a\u662f3-\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u53ea\u51d1\u5230\u4e863\u4e2a\u952e\uff0c\u8fd8\u4e0d\u8db3\u4ee5\u5206\u89e3\u51fa3-\u8282\u70b9\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u7d22\u6027\u5c06\u4ece\u5f53\u524d\u8282\u70b9\u7684\u5206\u79bb\u51fa\u6765\u7684\u952e\u548c\u513f\u5b50\u4eec\u6784\u6210\u4e00\u4e2a\u4e34\u65f6\u76844-\u8282\u70b9\u3002\u6ca1\u9519\uff0c\u5c31\u662f4-\u8282\u70b9\uff0c\u57284-\u8282\u70b9\u4e2d\u5220\u9664\u4e00\u4e2a\u952e\u4e5f\u662f\u5f88\u5bb9\u6613\u7684\uff0c\u5e76\u4e14\u5982\u679c\u4e0d\u662f\u4ece\u4e2d\u5220\u9664\u952e\uff0c\u6211\u4eec\u4e5f\u6709\u529e\u6cd5\u5728\u5220\u9664\u5b8c\u6307\u5b9a\u7684\u952e\u4e4b\u540e\u7684\u56de\u6eaf\u8fc7\u7a0b\u4e2d\u6765\u5206\u89e3\u8fd9\u4e2a4-\u8282\u70b9\uff0c\u4ece\u800c\u4fdd\u8bc12-3\u6811\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u4e0d\u8be5\u51fa\u73b0\u7684\u4e1c\u897f\u3002<br/>\u4e3a\u4e86\u66f4\u6e05\u695a\u7684\u8bf4\u660e\u4e0a\u9762\u8fd9\u5768\u4e1c\u897f\u5728\u8bb2\u4ec0\u4e48\uff0c\u6211\u653e\u51e0\u5f20\u56fe\u89e3\u91ca\u4e00\u4e0b\uff1a<br/>\u9996\u5148\u662f\u53ef\u4ee5\u4ece\u65c1\u8fb9\u201c\u62a2\u201d\u8282\u70b9\u7684\u60c5\u51b5\uff1a<br/><br/>\u4e0a\u56fe\u662f\u51c6\u5907\u5411\u53f3\u9012\u5f52\u4e4b\u524d\u7684\u8c03\u6574\u8fc7\u7a0b\u3002\u9996\u5148\u53d6\u51fae\u4e0e\u5b83\u7684\u513f\u5b503-\u8282\u70b9c-d\u548c2-\u8282\u70b9f\u7ed3\u5408\u751f\u6210\u4e86\u4e00\u4e2a5-\u8282\u70b9c-d-e-f\uff0c\u7136\u540e\u6211\u4eec\u53d6\u51fae\u548cf\u5728\u53f3\u8fb9\u521b\u5efa\u51fa\u4e00\u4e2a3-\u8282\u70b9\uff0c\u7136\u540ed\u4ee3\u66ff\u539f\u67653-\u8282\u70b9b-e\u4e2de\u4ece\u800c\u8fd8\u539f\uff0c\u7136\u540e\u88ab\u62a2\u6389\u4e00\u4e2a\u952e\u7684c\u5c31\u9ed8\u9ed8\u7684\u7559\u5728\u539f\u5730\u2026<br/>\u5bf9\u4e8e\u5411\u5de6\u8fb9\u548c\u4e2d\u95f4\u8c03\u6574\u90fd\u662f\u7c7b\u4f3c\u7684\u505a\u6cd5\u3002\u53ea\u662f\u5411\u4e2d\u95f4\u9012\u5f52\u7684\u8c03\u6574\u9700\u8981\u5148\u5224\u5b9a\u662f\u5de6\u8fb9\u67093-\u8282\u70b9\u8fd8\u662f\u53f3\u8fb9\u67093-\u8282\u70b9\uff0c\u4ece\u800c\u786e\u5b9a\u88ab\u53d6\u51fa\u7684\u952e\u662f\u8c01\u3002<br/>\u5982\u679c\u8fd9\u4e2a\u952e\u7684\u513f\u5b50\u90fd\u662f2-\u8282\u70b9\uff0c\u6211\u4eec\u4ece\u8fd9\u4e2a\u8282\u70b9\u4e2d\u53d6\u51fa\u4e00\u4e2a\u952e\u5411\u4e0b\u5408\u5e76\uff0c\u5374\u53ea\u80fd\u521b\u9020\u51fa\u4e00\u4e2a\u4e34\u65f6\u76844-\u8282\u70b9\uff0c\u65e0\u6cd5\u4ece\u4e2d\u63d0\u53d6\u51fa3-\u8282\u70b9\u3002\u56e0\u6b64\u6211\u4eec\u5c06\u5176\u7559\u5728\u90a3\u91cc\u5f53\u4f5c\u662f3-\u8282\u70b9\u3002\u8fd9\u4e2a4-\u8282\u70b9\u7b49\u5230\u6211\u4eec\u5220\u9664\u5b8c\u4e4b\u540e\u518d\u6765\u5904\u7406\u3002\u5982\u679c\u8981\u5220\u9664\u7684\u952e\u5c31\u5728\u8fd9\u4e2a\u8282\u70b9\u4e2d\uff0c\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u7ba1\u4e86\u3002\u5982\u679c\u8fd9\u4e2a4-\u8282\u70b9\u4f9d\u7136\u4fdd\u7559\u7740\uff0c\u53ea\u9700\u5206\u89e3\u5b83\u5373\u53ef\u3002\u4e0b\u9762\u662f\u5408\u5e76\u7684\u8fc7\u7a0b\uff1a<br/><br/>\u4f46\u662f\uff0c\u4e0a\u9762\u7684\u505a\u6cd5\u90fd\u662f\u5728\u5047\u8bbe\u5f53\u524d\u6b63\u5904\u5728\u4e00\u4e2a3-\u8282\u70b9\u5904\u800c\u505a\u7684\u3002\u5018\u82e5\u6839\u8282\u70b9\u5c31\u4e0d\u662f3-\u8282\u70b9\uff0c\u90a3\u8be5\u600e\u4e48\u529e\u5462\uff1f<br/>\u8003\u8651\u5230\u6839\u8282\u70b9\u7684\u7279\u6b8a\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u548c\u5b83\u7684\u513f\u5b50\u5408\u5e76\u4e3a4-\u8282\u70b9\u3002<br/><br/>\u5982\u679c\u6839\u8282\u70b9\u548c\u5b83\u7684\u5de6\u53f3\u513f\u5b50\u90fd\u662f2-\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5b83\u548c\u513f\u5b50\u4eec\u7ed3\u5408\uff0c\u53d8\u6210\u4e00\u4e2a3-\u8282\u70b9\u3002\u8fd9\u6837\u4f1a\u5bfc\u81f4\u6811\u7684\u5c40\u90e8\u7684\u9ad8\u5ea6\u964d\u4f4e\u3002\u7136\u800c\u8fd9\u662f\u5728\u6839\u8282\u70b9\u5904\uff0c\u6240\u4ee5\u8fd9\u6837\u7684\u53d8\u5316\u662f\u5168\u5c40\u6027\u7684\uff0c\u4e0d\u4f1a\u5f71\u54cd2-3\u6811\u7684\u5b8c\u7f8e\u5e73\u8861\u6027\u3002\u540c\u65f6\u6709\u4fdd\u8bc1\u5411\u4e0b\u53d8\u6362\u65f6\u6709\u5145\u8db3\u7684\u952e\u53ef\u53d6\u3002\u540c\u7406\uff0c\u8fd9\u4e2a\u9057\u7559\u76844-\u8282\u70b9\u53ef\u4ee5\u65e5\u540e\u518d\u6765\u5c06\u5176\u5206\u89e3\u6389\u3002<br/>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u80fd\u786e\u4fdd\u5728\u5220\u9664\u64cd\u4f5c\u5fc5\u5b9a\u662f\u57283-\u8282\u70b9\u5185\u8fdb\u884c\u7684\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u5b8c\u6210\u4e86\u5e95\u90e8\u8282\u70b9\u7684\u5220\u9664\u64cd\u4f5c\u3002<br/>\u5220\u9664\u4e2d\u95f4\u8282\u70b9<br/>\u7136\u800c\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u4f1a\u53bb\u5220\u9664\u5e95\u90e8\u8282\u70b9\uff0c\u800c\u662f\u4f1a\u5220\u9664\u6811\u4e2d\u592e\u7684\u4e00\u4e2a\u8282\u70b9\u3002\u8fd9\u6837\u4f3c\u4e4e\u95ee\u9898\u53d8\u5f97\u5f88\u68d8\u624b\u3002<br/>\u7136\u800c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3a\u5220\u9664\u5e95\u90e8\u8282\u70b9\u3002\u6211\u4eec\u6a21\u4eff\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u5220\u9664\u65b9\u5f0f\uff1a\u5f53\u8981\u88ab\u5220\u9664\u7684\u8282\u70b9\u6709\u4e24\u4e2a\u513f\u5b50\u65f6\uff0c\u7528\u8be5\u8282\u70b9\u7684\u524d\u8d8b\u6216\u8005\u540e\u7ee7\u8282\u70b9\u6765\u9876\u66ff\u5b83\uff0c\u5e76\u4e14\u5c06\u8fd9\u4e2a\u524d\u8d8b\u6216\u8005\u540e\u7ee7\u8282\u70b9\u5220\u9664\u3002<br/>\u7531\u4e8e2-3\u6811\u7684\u975e\u5e95\u90e8\u8282\u70b9\u4e00\u5b9a\u662f\u6709\u591a\u4e2a\u513f\u5b50\u7684\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u627e\u5230\u5176\u540e\u7ee7\u8282\u70b9\uff0c\u5c06\u8fd9\u4e2a\u540e\u7ee7\u8282\u70b9\u7684\u952e\u548c\u536b\u661f\u6570\u636e5\u590d\u5236\u5230\u8981\u88ab\u5220\u9664\u7684\u8282\u70b9\u5904\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u7528\u540e\u7ee7\u8282\u70b9\u6765\u9876\u66ff\u539f\u5148\u8282\u70b9\u7684\u4efb\u52a1\u3002\u56e0\u6b64\u6211\u4eec\u5c31\u53ea\u9700\u8981\u5c06\u539f\u6765\u7684\u540e\u7ee7\u8282\u70b9\u5220\u9664\u5373\u53ef\u3002<br/>\u800c\u4e00\u4e2a\u8282\u70b9\u7684\u540e\u7ee7\u8282\u70b9\u662f\u5b83\u7684\u53f3\u5b50\u6811\u4e2d\u7684\u6700\u5c0f\u7684\u8282\u70b9\uff0c\u5373\u53f3\u5b50\u6811\u4e2d\u6700\u9760\u5de6\u7684\u8282\u70b9\uff0c\u56e0\u6b64\u5b83\u80af\u5b9a\u6ca1\u6709\u513f\u5b50\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5220\u9664\u5e95\u90e8\u8282\u70b9\u7684\u65b9\u6cd5\u6765\u5220\u9664\u5b83\u3002<br/>\u5220\u9664\u793a\u4f8b<br/>\u4e3a\u4e86\u4f7f\u5927\u5bb6\u60f3\u5f97\u66f4\u660e\u767d\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u5220\u9664\u5e95\u90e8\u8282\u70b9\u7684\u793a\u4f8b\u3002<br/>\u9996\u5148\uff0c\u4e0b\u9762\u662f\u4e00\u68f5\u9ad8\u5ea6\u4e3a4\u76842-3\u6811\uff0c\u6211\u4eec\u51c6\u5907\u5220\u9664i\uff1a<br/><br/>\u4ece\u6839\u8282\u70b9\u5f00\u59cb\uff0c\u53d1\u73b0i\u5728\u53f3\u5b50\u6811\u4e2d\uff0c\u4f46\u53d1\u73b0\u6839\u8282\u70b9\u81ea\u5df1\u548c\u5de6\u53f3\u513f\u5b50\u90fd\u662f2-\u8282\u70b9\uff0c\u4e8e\u662f\u5b83\u4eec\u5408\u5e76\u4e3a\u4e00\u4e2a4-\u8282\u70b9\uff1a<br/><br/>\u63a5\u4e0b\u6765\u5728\u65b0\u76844-\u8282\u70b9d-h-n\u4e2d\u53d1\u73b0\u53f3\u513f\u5b50\u4e3a3-\u8282\u70b9\uff0c\u4e8e\u662f\u76f4\u63a5\u5411\u4e0b\u641c\u7d22\u3002<br/>\u57283-\u8282\u70b9j-l\u4e2d\u6211\u4eec\u53d1\u73b0i\u5728\u5176\u5de6\u5b50\u6811\u4e2d\uff0c\u5e76\u4e14\u5de6\u513f\u5b50\u4e0d\u662f3-\u8282\u70b9\uff0c\u4e8e\u662f\u6211\u4eec\u5c06j\u5411\u4e0b\u5408\u5e76\uff1a<br/><br/>\u5411\u4e0b\u540e\u6765\u52304-\u8282\u70b9i-j-k\uff0c\u53d1\u73b0\u76ee\u6807i\u5c31\u5728\u5176\u4e2d\uff0c\u6211\u4eec\u76f4\u63a5\u5c06\u5176\u5220\u9664\uff1a<br/><br/>\u5220\u9664\u5b8c\u6210\uff0c\u6211\u4eec\u6cbf\u7740\u9012\u5f52\u5411\u4e0b\u7684\u987a\u5e8f\u5411\u4e0a\u56de\u6eaf\u3002\u56de\u6eaf\u5230\u6839\u8282\u70b9\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u662f\u4e00\u4e2a4-\u8282\u70b9\uff0c\u4e8e\u662f\u6211\u4eec\u5c06\u5176\u5206\u89e3\uff1a<br/><br/>\u81f3\u6b64\u3002\u5220\u9664\u64cd\u4f5c\u5c31\u5b8c\u6210\u4e86\u3002<br/>\u5bf9\u4e8e\u6240\u6709\u7684\u5220\u9664\u64cd\u4f5c\uff0c2-3\u6811\u9700\u8981$ \\\\Theta(\\\\text{log}N) $\u7684\u65f6\u95f4\u67e5\u627e\u8282\u70b9\uff0c\u5e76\u4e14\u4ee5$ \\\\Theta(1) $\u7684\u65f6\u95f4\u5728\u6bcf\u4e2a\u56de\u6eaf\u7684\u8282\u70b9\u5904\u6765\u4f5c\u51fa\u9002\u5f53\u7684\u8c03\u6574\u3002\u65452-3\u6811\u7684\u5220\u9664\u64cd\u4f5c\u662f$ \\\\Theta(\\\\text{log}N) $\u7684\u3002<br/>2-3\u6811\u5230\u7ea2\u9ed1\u6811<br/>\u4e0a\u9762\u8bb2\u4e86\u90a3\u4e48\u591a\u5173\u4e8e2-3\u6811\u7684\u64cd\u4f5c\uff0c\u5374\u4ece\u4e0d\u63d0\u53ca\u5176\u5177\u4f53\u5b9e\u73b0\uff0c\u662f\u56e0\u4e3a2-3\u6811\u5728\u5b9e\u9645\u4e2d\u5f88\u5c11\u4f7f\u7528\u3002<br/>\u7531\u4e8e\u5176\u9700\u8981\u5927\u91cf\u7684\u8282\u70b9\u53d8\u6362\uff08\u4ece2-\u8282\u70b9\u52303-\u8282\u70b9\u52304-\u8282\u70b9\u751a\u81f3\u52305-\u8282\u70b9\u2026\uff09\uff0c\u8fd9\u4e9b\u53d8\u6362\u5728\u5b9e\u9645\u4ee3\u7801\u4e2d\u662f\u5f88\u590d\u6742\u7684\u3002\u6240\u4ee5\u73b0\u5728\u51e0\u4e4e\u6ca1\u67092-3\u6811\u7684\u5177\u4f53\u5b9e\u73b0\u3002<br/>\u4f46\u662f\u7531\u4e8e2-3\u6811\u7684\u53d8\u5316\u5341\u5206\u76f4\u89c2\uff0c\u56e0\u6b64\u524d\u4eba\u57282-3\u6811\u7684\u7406\u8bba\u57fa\u7840\u4e0a\u53d1\u660e\u4e86\u7ea2\u9ed1\u6811\u3002<br/>\u53d8\u5316\u5230\u7ea2\u9ed1\u6811<br/>\u7ea2\u9ed1\u6811\u662f\u4e00\u79cd\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u53ea\u6709\u4e00\u79cd\u8282\u70b9\u3002\u8fd9\u79cd\u8282\u70b9\u6709\u4e24\u4e2a\u513f\u5b50\uff0c\u548c2-3\u6811\u4e2d\u76842-\u8282\u70b9\u5bf9\u5e94\u3002<br/><br/>\u5982\u4f55\u8868\u793a3-\u8282\u70b9\u5462\uff1f\u6211\u4eec\u5c1d\u8bd5\u4e00\u79cd\u7279\u6b8a\u7684\u8fb9\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8282\u70b9\u7684\u989c\u8272\u5747\u4e3a\u9ed1\u8272\u3002\u6211\u4eec\u5c06\u67d0\u4e2a\u8282\u70b9\u67d3\u4e3a\u7ea2\u8272\uff0c\u8868\u793a\u5b83\u548c\u7236\u4eb2\u7684\u7684\u94fe\u63a5\u662f\u7ea2\u8272\u7684\uff0c\u5c31\u50cf\u4e0b\u56fe\uff1a<br/><br/>\u5f53\u6211\u4eec\u5c06\u7ea2\u94fe\u63a5\u753b\u5e73\u65f6\u2026<br/><br/>\u6211\u4eec\u53d1\u73b0\u5b83\u548c2-3\u6811\u4e2d\u76843-\u8282\u70b9\u6781\u4e3a\u7c7b\u4f3c\uff01<br/>\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u7528\u8fd9\u6837\u7684\u65b9\u5f0f\u6765\u8868\u793a2-3\u6811\u4e2d\u76843-\u8282\u70b9\u3002<br/>\u4e0b\u56fe\u662f\u4e00\u68f5\u5178\u578b\u7684\u7ea2\u9ed1\u6811\uff1a<br/><br/>\u5982\u679c\u5c06\u7ea2\u94fe\u63a5\u753b\u5e73\uff0c\u5c06\u5f97\u5230\u4e00\u68f5\u5b8c\u7f8e\u5e73\u8861\u7684\u201c2-3\u6811\u201d\uff1a<br/><br/>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u7ea2\u9ed1\u6811\u548c2-3\u6811\u662f\u4e00\u79cd\u7b49\u540c\u3002<br/>\u540c\u65f6\uff0c\u4e3a\u4e86\u6211\u4eec\u7684\u64cd\u4f5c\u65b9\u4fbf\uff0c\u6211\u4eec\u5bf9\u7ea2\u9ed1\u6811\u4f5c\u51fa\u4ee5\u4e0b\u89c4\u5b9a\uff1a<br/><br/>\u7ea2\u9ed1\u6811\u662f\u4e8c\u53c9\u641c\u7d22\u6811\u3002  <br/>\u6839\u8282\u70b9\u5fc5\u987b\u4e3a\u9ed1\u8272\u3002\u6bd5\u7adf\u6839\u8282\u70b9\u6ca1\u6709\u7236\u4eb2\u3002  <br/>\u7ea2\u94fe\u63a5\u5fc5\u987b\u5728\u5de6\u4fa76\u3002\u5c06\u7ea2\u94fe\u63a5\u7edf\u4e00\u5728\u4e00\u4e2a\u65b9\u5411\u662f\u4e3a\u4e86\u65b9\u4fbf\u5176\u5b83\u64cd\u4f5c\u3002\u5982\u679c\u4e0d\u7edf\u4e00\uff0c3-\u8282\u70b9\u5c31\u6709\u4e24\u79cd\u60c5\u51b5\uff0c4-\u8282\u70b9\u5c31\u67095\u4e2d\u60c5\u51b5\uff0c\u975e\u5e38\u4e0d\u5229\u4e8e\u6211\u4eec\u5224\u5b9a\u5f53\u524d\u662f\u4ec0\u4e48\u8282\u70b9\u3002\u5e76\u4e14\uff0c\u5bf9\u4e8e\u53f3\u8fb9\u7684\u7ea2\u94fe\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u65cb\u8f6c\u64cd\u4f5c\u6765\u5c06\u5176\u53d8\u4e3a\u5de6\u94fe\u63a5\u3002\u5177\u4f53\u7684\u4f1a\u5728\u4e4b\u540e\u89e3\u91ca\u3002  <br/>\u4e0d\u5141\u8bb8\u4e24\u4e2a\u8fde\u7eed\u7684\u7ea2\u94fe\u63a5\u3002\u56e0\u4e3a\u8fde\u7eed\u7684\u8fde\u4e2a\u7ea2\u94fe\u63a5\u8868\u793a\u7684\u662f4-\u8282\u70b9\u3002\u5f53\u7136\uff0c\u8ddf2-3\u6811\u4e00\u6837\uff0c\u63d2\u5165/\u5220\u9664\u7684\u8fc7\u7a0b\u4e2d\u8fd8\u662f\u5141\u8bb8\u4e34\u65f6\u76844-\u8282\u70b9\u3002  <br/>\u6bcf\u4e00\u6761\u6811\u94fe\u4e0a\u7684\u9ed1\u8272\u8282\u70b9\u6570\u91cf\uff08\u79f0\u4e4b\u4e3a\u201c\u9ed1\u9ad8\u201d\uff09\u5fc5\u987b\u76f8\u7b49\u3002\u539f\u56e0\u975e\u5e38\u7b80\u5355\uff0c\u4e00\u4e2a\u9ed1\u8272\u8282\u70b9\u5c31\u5bf9\u5e94\u77402-3\u6811\u4e2d\u7684\u4e00\u4e2a2-\u8282\u70b9\u62163-\u8282\u70b9\uff0c\u800c2-3\u6811\u662f\u5b8c\u7f8e\u5e73\u8861\u7684\u3002  <br/>\u7a7a\u8282\u70b9\uff08NULL/None\uff09\u4e3a\u9ed1\u8272\u3002\u8fd9\u6837\u65b9\u4fbf\u5c06\u65b9\u4fbf\u6211\u4eec\u8bc6\u522b\u6ca1\u6709\u513f\u5b50\u76842-\u8282\u70b9\u3002<br/><br/>\u67e5\u8be2\u64cd\u4f5c<br/>\u7531\u4e8e\u7ea2\u9ed1\u6811\u662f\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u56e0\u6b64\u67e5\u8be2\u64cd\u4f5c\u5c31\u662f\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u67e5\u8be2\u64cd\u4f5c\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$ \\\\Theta(\\\\text{log}N) $\u3002<br/>\u57fa\u672c\u64cd\u4f5c<br/>\u5728\u4ecb\u7ecd\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\u524d\uff0c\u9996\u5148\u4ecb\u7ecd\u7ea2\u9ed1\u6811\u7684\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c\u3002<br/>\u65cb\u8f6c<br/>\u7ea2\u9ed1\u6811\u7684\u65cb\u8f6c\u53ea\u6709\u4e24\u79cd\uff1a\u987a\u65f6\u9488\u65cb\u8f6c\u548c\u9006\u65f6\u9488\u65cb\u8f6c7\u3002<br/>\u7ea2\u9ed1\u6811\u7684\u65cb\u8f6c\u64cd\u4f5c\u662f\u4e3a\u4e86\u5728\u4fdd\u8bc1\u4e8c\u53c9\u641c\u7d22\u6811\u548c\u7ea2\u9ed1\u6811\u7684\u6027\u8d28\u7684\u524d\u63d0\u4e0b\uff0c\u6765\u8f6c\u6362\u7ea2\u94fe\u63a5\u7684\u4f4d\u7f6e\u3002  <br/><br/>\u53ef\u4ee5\u770b\u51fa\u987a\u65f6\u9488\u65cb\u8f6c\u5c31\u662f\u5c06\u8282\u70b9\u7684\u5de6\u513f\u5b50\u63d0\u4e0a\u6765\uff0c\u5c06\u81ea\u5df1\u53d8\u505a\u5b83\u7684\u53f3\u513f\u5b50\uff0c\u5c06\u5de6\u513f\u5b50\u7684\u53f3\u5b50\u6811\u63a5\u5230\u81ea\u5df1\u7684\u5de6\u5b50\u6811\u4e2d\uff0c\u540c\u65f6\u8f6c\u53d8\u7ea2\u94fe\u63a5\u3002\u53ef\u4ee5\u5c06\u5176\u60f3\u8c61\u6210\u628a4->2\u8fd9\u6761\u8fb9\u987a\u65f6\u9488\u65cb\u8f6c\u4e86\u4e00\u4e0b\u3002\u9006\u65f6\u9488\u65cb\u8f6c\u4e5f\u662f\u7c7b\u4f3c\u7684\u505a\u6cd5\u3002\u540c\u65f6\u987a\u65f6\u9488\u65cb\u8f6c\u548c\u9006\u65f6\u9488\u65cb\u8f6c\u53ef\u4ee5\u89c6\u4e3a\u4e00\u5bf9\u9006\u64cd\u4f5c\uff0c\u56e0\u4e3a\u4e00\u6b21\u5de6\u65cb\u548c\u4e00\u6b21\u53f3\u65cb\u53ef\u4ee5\u53d8\u56de\u539f\u6765\u7684\u6837\u5b50\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25# \u987a\u65f6\u9488\u65cb\u8f6c<br/>def cw_rotate(h):<br/>    assert h is not None and h.left is red  # h\u662f\u975e\u7a7a\u8282\u70b9\u5e76\u4e14\u5de6\u513f\u5b50\u4e3a\u7ea2\u8272<br/><br/>    x = h.left<br/>    h.left = x.right<br/>    x.right = h<br/>    x.color = h.color<br/>    h.color = red<br/><br/>    return x  # \u8fd4\u56de\u88ab\u63d0\u4e0a\u6765\u7684\u5de6\u513f\u5b50<br/><br/># \u9006\u65f6\u9488\u65cb\u8f6c<br/>def ccw_rotate(h):<br/>    assert h is not None and h.right is red  # h\u662f\u975e\u7a7a\u8282\u70b9\u5e76\u4e14\u5de6\u513f\u5b50\u4e3a\u7ea2\u8272<br/><br/>    x = h.right<br/>    h.right = x.left<br/>    x.left = h<br/>    x.color = h.color<br/>    h.color = red<br/><br/>    return x  # \u8fd4\u56de\u88ab\u63d0\u4e0a\u6765\u7684\u5de6\u513f\u5b50<br/><br/>h = cw_rotate(h)  # \u5c06h\u987a\u65f6\u9488\u65cb\u8f6c<br/><br/><br/>\u53cd\u8272<br/>\u5982\u540c\u57282-3\u6811\u4e2d\u4e00\u6837\uff0c\u7ea2\u9ed1\u6811\u8981\u80fd\u591f\u5904\u74064-\u8282\u70b9\u3002<br/>\u5bf9\u4e8e4-\u8282\u70b9\uff0c\u6211\u4eec\u53ea\u6709\u4e24\u79cd\u64cd\u4f5c\uff1a\u5408\u6210\u4e00\u4e2a4-\u8282\u70b9\u548c\u5206\u89e3\u4e00\u4e2a4-\u8282\u70b9\u3002<br/><br/>\u5bf9\u7167\u4e00\u4e0b2-3\u6811\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5c31\u663e\u800c\u6613\u89c1\u4e86\u3002<br/><br/>\u4e5f\u8bb8\u4f60\u4f1a\u6ce8\u610f\u5230\u53cd\u8272\u64cd\u4f5c\u4f1a\u5c06\u4e24\u4e2a\u513f\u5b50\u7684\u7236\u8282\u70b9\u53d8\u4e3a\u7ea2\u8272\uff0c\u662f\u56e0\u4e3a\u57282-3\u6811\u4e2d\uff0c\u4e2d\u95f4\u53d6\u51fa\u6765\u7684\u952e\u8981\u5411\u4e0a\u4f20\u9012\u5e76\u7ed3\u5408\u8fdb\u53bb\u3002\u6b64\u5916\uff0c\u53cd\u8272\u64cd\u4f5c\u4f1a\u5bfc\u81f4\u51fa\u73b0\u53f3\u8fb9\u7684\u7ea2\u94fe\u63a5\uff0c\u7136\u800c\u8fd9\u6ca1\u6709\u5173\u7cfb\uff0c\u56e0\u4e3a4-\u8282\u70b9\u662f\u4e34\u65f6\u7684\uff0c\u6211\u4eec\u6700\u7ec8\u4f1a\u901a\u8fc7\u9006\u65f6\u9488\u65cb\u8f6c\u5c06\u5176\u53d8\u4e3a\u5de6\u8fb9\u7684\u7ea2\u94fe\u63a5\u6216\u8005\u518d\u6b21\u53cd\u8272\u5c06\u8fd9\u4e2a4-\u8282\u70b9\u5206\u89e3\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10def flip_color(h):<br/>    assert h.color is different from h.children.color  # h\u7684\u989c\u8272\u548c\u5b83\u7684\u513f\u5b50\u76f8\u53cd<br/><br/>    h.color = (h.color == RED ? BLACK : RED)<br/>    h.left.color = (h.left.color == RED ? BLACK : RED)<br/>    h.right.color = (h.right.color == RED ? BLACK : RED)<br/><br/>    return h<br/><br/>h = flip_color(h)  # \u5c06h\u53cd\u8272<br/><br/><br/>\u63d2\u5165\u64cd\u4f5c<br/>\u4e3a\u4e86\u63a2\u7a76\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u64cd\u4f5c\uff0c\u6211\u4eec\u4f9d\u7136\u56de\u52302-3\u6811\u3002\u57282-3\u6811\u4e2d\uff0c\u6211\u4eec\u5c06\u65b0\u63d2\u5165\u7684\u8282\u70b9\u4e0e\u4e0a\u9762\u7684\u8282\u70b9\u5408\u5e76\uff0c\u7136\u540e\u518d\u505a\u8c03\u6574\u3002\u4e3a\u4e86\u8868\u793a\u5408\u5e76\uff0c\u6211\u4eec\u5c06\u65b0\u63d2\u5165\u7684\u8282\u70b9\u5747\u8bbe\u4e3a\u7ea2\u8272\uff0c\u8868\u793a\u4e0e\u4e0a\u9762\u7684\u8282\u70b9\u76f8\u8fde\u63a5\u3002  <br/>\u7136\u800c\u63d2\u5165\u540e\uff0c\u65b0\u7684\u7ea2\u8282\u70b9\u53ef\u80fd\u4f1a\u8fdd\u53cd\u6211\u4eec\u7684\u89c4\u5b9a\uff0c\u56e0\u6b64\u9700\u8981\u5728\u56de\u6eaf\u7684\u65f6\u5019\u8fdb\u884c\u8c03\u6574\u3002<br/>\u60c5\u51b5\u4e00\uff1a\u8c03\u6574\u53f3\u8fb9\u7684\u7ea2\u94fe\u63a5<br/>\u5f53\u6211\u4eec\u53d1\u73b0\u67d0\u4e2a\u8282\u70b9\u7684\u5de6\u513f\u5b50\u662f\u9ed1\u8272\u4f46\u53f3\u513f\u5b50\u662f\u7ea2\u8272\u65f6\uff0c\u6211\u4eec\u8981\u5c06\u53f3\u8fb9\u7684\u7ea2\u8272\u94fe\u63a5\u8f6c\u5230\u5de6\u8fb9\u6765\uff1a<br/><br/>\u5982\u4e0a\u56fe\uff0c\u901a\u8fc7\u5bf9b\u9006\u65f6\u9488\u65cb\u8f6c\uff0c\u5b8c\u6210\u4e86\u5bf9\u7ea2\u94fe\u63a5\u4f4d\u7f6e\u7684\u7ea0\u6b63\u3002<br/>\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u65b9\u4fbf\u63a5\u4e0b\u6765\u7684\u64cd\u4f5c\u3002<br/>\u60c5\u51b5\u4e8c\uff1a\u5206\u89e34-\u8282\u70b9<br/>\u5728\u60c5\u51b5\u4e00\u4e2d\uff0c\u6211\u4eec\u8981\u6c42\u8282\u70b9\u7684\u5de6\u513f\u5b50\u662f\u9ed1\u8272\u3002\u8fd9\u662f\u56e0\u4e3a\u5f53\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\u90fd\u662f\u7ea2\u8272\u65f6\uff0c\u5c31\u4ee3\u8868\u7740\u4e00\u4e2a4-\u8282\u70b9\uff0c\u4e3a\u6b64\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u53cd\u8272\u6765\u5206\u89e3\u5b83\uff1a<br/><br/>\u5982\u679c\u8be5\u64cd\u4f5c\u662f\u5728\u6839\u8282\u70b9\u4e0a\uff0c\u90a3\u4e48\u6574\u68f5\u7ea2\u9ed1\u6811\u7684\u9ed1\u9ad8\u5c06\u4f1a\u52a01\u3002<br/>\u60c5\u51b5\u4e09\uff1a\u8fde\u7eed\u7684\u7ea2\u8272\u5de6\u513f\u5b50<br/>\u5728\u60c5\u51b5\u4e00\u4e2d\uff0c\u6211\u4eec\u80fd\u591f\u628a\u6240\u6709\u7684\u53f3\u8fb9\u7684\u7ea2\u8272\u8282\u70b9\u8f6c\u5230\u5de6\u8fb9\u6765\uff0c\u8fd9\u6837\u5c31\u597d\u5224\u65ad\u662f\u5426\u5b58\u57284-\u8282\u70b9\u3002\u9664\u4e86\u60c5\u51b5\u4e8c\u4e2d\u76844-\u8282\u70b9\u5916\uff0c\u8fde\u7eed\u7684\u4e24\u4e2a\u7ea2\u8272\u5de6\u513f\u5b50\u4e5f\u5c06\u8868\u793a\u4e00\u4e2a4-\u8282\u70b9\uff1a<br/><br/>\u5bf9\u6b64\uff0c\u6211\u4eec\u7684\u505a\u6cd5\u662f\u5c06\u8282\u70b9\u987a\u65f6\u9488\u65cb\u8f6c\uff0c\u4ece\u800c\u53d8\u4e3a\u4e86\u60c5\u51b5\u4e8c\u3002<br/>\u5e73\u8861\u64cd\u4f5c<br/>\u4e0a\u9762\u4ecb\u7ecd\u4e86\u4e09\u79cd\u63d2\u5165\u65f6\u7684\u60c5\u51b5\uff0c\u5b9e\u9645\u4e0a\u5df2\u7ecf\u5c06\u63d2\u5165\u7684\u6240\u6709\u60c5\u51b5\u90fd\u6982\u62ec\u5230\u4e86\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u5b9e\u73b0\u4e00\u4e2a\u5e73\u8861\u64cd\u4f5c\u3002\u8fd9\u4e2a\u5e73\u8861\u64cd\u4f5c\u5c31\u662f\u901a\u8fc7\u5bf9\u8282\u70b9\u7684\u60c5\u51b5\u8fdb\u884c\u5224\u5b9a\u5e76\u4f5c\u51fa\u8c03\u6574\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13def balance(h):<br/>    assert h is not None  # \u5f53\u7136\u4e0d\u80fd\u4e3a\u975e\u7a7a\u8282\u70b9<br/><br/>    if h.right is red and h.left is not red:  # \u60c5\u51b5\u4e00<br/>        h = ccw_rotate(h)<br/><br/>    if h.left is red and h.left.left is red:  # \u60c5\u51b5\u4e09<br/>        h =.cw_rotate(h)<br/><br/>    if h.left is red and h.right is red:  # \u60c5\u51b5\u4e8c<br/>        h = flip_color(h)<br/><br/>    return h  # \u8fd4\u56de\u8c03\u6574\u540e\u7684h\u8282\u70b9<br/><br/><br/>\u6709\u4e86\u5e73\u8861\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u5c31\u80fd\u76f4\u63a5\u6539\u52a8\u4e00\u884c\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u63d2\u5165\u4ee3\u7801\uff0c\u5c31\u80fd\u5b9e\u73b0\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u4e86\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5def insert(h, key, value):<br/>    # \u4e8c\u53c9\u641c\u7d22\u6811\u7684\u63d2\u5165\u5b9e\u73b0<br/><br/>    # return h<br/>    return balance(h)  # \u63d2\u5165\u540e\u56de\u6eaf\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5148\u5e73\u8861\u8282\u70b9\uff0c\u518d\u8fd4\u56de<br/><br/><br/>\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u5f53\u6240\u6709\u64cd\u4f5c\u5b8c\u6210\u4ee5\u540e\uff0c\u6839\u8282\u70b9\u53ef\u80fd\u53d8\u4e3a\u7ea2\u8272\uff0c\u8fd9\u662f\u9700\u8981\u6211\u4eec\u624b\u52a8\u5c06\u6839\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\u3002<br/>\u7531\u4e8ebalance\u64cd\u4f5c\u662f$ \\\\Theta(1) $\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6545\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u64cd\u4f5c\u662f$ \\\\Theta(\\\\text{log}N) $\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002<br/>\u5220\u9664\u64cd\u4f5c<br/>\u6b63\u5982\u4f60\u6240\u89c1\uff0c\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u5199\u8d77\u6765\u4e5f\u5e76\u4e0d\u662f\u90a3\u4e48\u96be\u3002\u7136\u800c\u5220\u9664\u64cd\u4f5c\u5c31\u672a\u5fc5\u3002\u6839\u636e\u6211\u4eec\u57282-3\u6811\u4e2d\u6240\u8ba8\u8bba\u7684\uff0c\u7ea2\u9ed1\u6811\u5220\u9664\u8282\u70b9\u4e5f\u8981\u4fdd\u8bc1\u4e00\u8def\u4e0a\u90fd\u6709\u4e00\u4e2a3-\u8282\u70b9\u62164-\u8282\u70b9\u3002<br/>\u7ea2\u8282\u70b9\u7684\u8f6c\u79fb<br/>\u7531\u4e8e\u7ea2\u9ed1\u6811\u5728\u5411\u4e0b\u9012\u5f52\u7684\u8fc7\u7a0b\u4e2d\u53ea\u6709\u5411\u5de6\u8fb9\u548c\u5411\u53f3\u4e24\u4e2a\u65b9\u5411\uff0c\u56e0\u6b64\u6211\u4eec\u518d\u5f04\u4e24\u4e2a\u64cd\u4f5c\uff1a\u7ea2\u8272\u5de6\u79fb\u548c\u7ea2\u8272\u53f3\u79fb\u3002\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u7528\u4e8e\u5728\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\u5904\u521b\u9020\u51fa\u4e00\u4e2a3-\u8282\u70b9\u62164-\u8282\u70b9\u3002<br/>\u6211\u4eec\u5148\u8ba8\u8bba\u7ea2\u8272\u5de6\u79fb\u7684\u60c5\u51b5\uff0c\u6bd5\u7adf\u7ea2\u8272\u53f3\u79fb\u4e5f\u662f\u7c7b\u4f3c\u7684\u505a\u6cd5\u3002<br/>\u5f53\u6211\u4eec\u8981\u5728\u5de6\u513f\u5b50\u5904\u9020\u4e00\u4e2a3-\u8282\u70b9\u65f6\uff0c\u9996\u5148\u80af\u5b9a\u5de6\u513f\u5b50\u4e0d\u662f3-\u8282\u70b9\u3002\u90a3\u4e48\u6309\u71672-3\u6811\u7684\u505a\u6cd5\uff0c\u6211\u4eec\u8981\u4e48\u662f\u4ece\u53f3\u513f\u5b50\u501f\u4e00\u4e2a\u8282\u70b9\uff0c\u8981\u4e48\u5c31\u662f\u628a\u81ea\u5df1\u201c\u732e\u8eab\u201d\u3002<br/>\u7b2c\u4e00\u79cd\u60c5\u51b5\u662f\u53f3\u513f\u5b50\u4e0d\u662f3-\u8282\u70b9\uff0c\u6211\u4eec\u76f4\u63a5\u5728\u5de6\u513f\u5b50\u5904\u521b\u5efa4-\u8282\u70b9\uff1a<br/><br/>\u4e0a\u9762\u5c31\u662f\u5229\u7528\u4e86\u53cd\u8272\u64cd\u4f5c\u3002<br/>\u53e6\u4e00\u79cd\u60c5\u51b5\u662f\u53f3\u513f\u5b50\u662f\u4e00\u4e2a3-\u8282\u70b9\uff0c\u90a3\u4e48\u64cd\u4f5c\u5c31\u6709\u70b9\u590d\u6742\u4e86\uff1a<br/><br/>\u548c2-3\u6811\u4e00\u6837\uff0c\u6211\u4eec\u5c06b\u5408\u5e76\u521b\u5efa\u51fa\u4e00\u4e2a5-\u8282\u70b9\u3002\u7136\u540e\u6211\u4eec\u53d1\u73b0\u53f3\u513f\u5b50\u7684\u5de6\u513f\u5b50\u662f\u7ea2\u8272\u7684\uff0c\u5373\u53f3\u513f\u5b50\u4e3a3-\u8282\u70b9\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u901a\u8fc7\u4e24\u6b21\u65cb\u8f6c\u64cd\u4f5c\u5c06\u4ee3\u66ff\u8282\u70b9b\u7684\u8282\u70b9c\u65cb\u8f6c\u5230\u66fe\u7ecfb\u7684\u4f4d\u7f6e\u3002\u6700\u540e\u6211\u4eec\u5206\u88c2\u8fd9\u4e2a5-\u8282\u70b9\uff0c\u6b64\u65f6\u5de6\u513f\u5b50\u5df2\u7ecf\u662f\u4e00\u4e2a3-\u8282\u70b9\u3002<br/>\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u628a\u7ea2\u8272\u5de6\u79fb\u7ed9\u5199\u51fa\u6765\u4e86\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13def move_red_to_left(h):<br/>    assert h is red and h.left is not red  # \u5de6\u513f\u5b50\u5fc5\u987b\u4e3a\u9ed1\u8272\uff0c\u540c\u65f6\u5f53\u524d\u5fc5\u987b\u662f\u7ea2\u8272<br/><br/>    h = flip_color(h)  # \u4e0e\u513f\u5b50\u8282\u70b9\u7ed3\u5408<br/><br/>    if h.right.left is red:  # \u5982\u679c\u53f3\u513f\u5b50\u4e3a3-\u8282\u70b9<br/>        # \u901a\u8fc7\u4e24\u6b21\u65cb\u8f6c\u5c06\u66ff\u4ee3\u8005\u4e0a\u79fb\u81f3h\u5904<br/>        h.right = cw_rotate(h.right)<br/>        h = ccw_rotate(h)<br/><br/>        h = flip_color(h)  # \u5206\u88c25-\u8282\u70b9<br/><br/>    return h<br/><br/><br/>\u540c\u6837\u7ea2\u8272\u53f3\u79fb\u4e5f\u662f\u4e00\u6837\u7684\u505a\u6cd5\u3002\u5148\u662f\u8282\u70b9\u7ed3\u5408\uff0c\u7136\u540e\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11def move_red_to_left(h):<br/>    assert h is red and h.right is not red<br/><br/>    h = flip_color(h)<br/><br/>    if h.left.left is red:<br/>        h = cw_rotate(h)  # h\u7684\u5de6\u513f\u5b50\u5c31\u662f\u66ff\u4ee3\u8005<br/><br/>        h = flip_color(h)<br/><br/>    return h<br/><br/><br/>\u5904\u7406\u6839\u8282\u70b9<br/>\u548c2-3\u6811\u4e00\u6837\uff0c\u6839\u8282\u70b9\u53ef\u80fd\u4e3a2-\u8282\u70b9\u3002\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6839\u8282\u70b9\u4e5f\u770b\u4f5c\u662f\u4e00\u4e2a3-\u8282\u70b9\uff1a<br/><br/>\u4e0a\u56fe\u4e2d\uff0ca\u662f\u771f\u6b63\u7684\u6839\u8282\u70b9\uff0c\u800c$ \\\\infty $\u662f\u4e00\u4e2a\u60f3\u8c61\u7684\u8282\u70b9\uff0c\u5b9e\u9645\u4e0a\u4e0d\u5b58\u5728\u3002\u8fd9\u6837\u6839\u8282\u70b9\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a3-\u8282\u70b9\u3002<br/>\u5e76\u4e14\uff0c\u5bf9\u4e8e\u8fd9\u4e2a3-\u8282\u70b9\uff0c\u65e0\u8bba\u7ea2\u8272\u5de6\u79fb\u548c\u7ea2\u8272\u53f3\u79fb\u90fd\u4e0d\u4f1a\u5173\u7cfb\u5230$ \\\\infty $\uff0c\u56e0\u6b64\u8fd9\u6837\u4e0d\u4f1a\u5bfc\u81f4\u95ee\u9898\u3002<br/>\u5b9e\u9645\u4e2d\uff0c\u6211\u4eec\u76f4\u63a5\u5c06\u6839\u8282\u70b9\u8bbe\u4e3a\u7ea2\u8272\u5373\u53ef\u3002\u5f53\u5220\u9664\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u518d\u628a\u6839\u8282\u70b9\u8bbe\u4e3a\u9ed1\u8272\u3002<br/>\u771f\u6b63\u7684\u5220\u9664<br/>\u89e3\u51b3\u4e86\u7ea2\u8272\u8282\u70b9\u7684\u8f6c\u79fb\u7684\u5de5\u4f5c\uff0c\u5220\u9664\u64cd\u4f5c\u4e5f\u5c31\u53d8\u5f97\u6e05\u6670\u4e86\u3002\u4e0b\u9762\u5c06\u4ecb\u7ecd\u5220\u9664\u64cd\u4f5c\u8be5\u5982\u4f55\u8fdb\u884c\u3002<br/>\u7ea2\u9ed1\u6811\u7684\u5220\u9664\u8fc7\u7a0b\u548c\u4e8c\u53c9\u641c\u7d22\u6811\u7c7b\u4f3c\u3002\u9996\u5148\u90fd\u8981\u5728\u6811\u4e2d\u627e\u5230\u8fd9\u4e2a\u8282\u70b9\uff0c\u7136\u540e\u518d\u7740\u624b\u5904\u7406\u3002<br/>\u5bf9\u4e8e\u7ea2\u9ed1\u6811\uff0c\u5b83\u7684\u8282\u70b9\u4e5f\u662f\u8981\u4e48\u90fd\u662f\u7a7a\u513f\u5b50\uff0c\u8981\u4e48\u5c31\u6ca1\u6709\u7a7a\u513f\u5b50\u3002<br/><br/>\u5bf9\u4e8e\u6ca1\u6709\u513f\u5b50\u7684\u8282\u70b9\uff0c\u5728\u4fdd\u8bc1\u5411\u4e0b\u9012\u5f52\u7684\u7ea2\u8272\u8282\u70b9\u7684\u53d8\u6362\u5b8c\u6210\u4e4b\u540e\uff0c\u5982\u679c\u5b83\u662f\u7ea2\u8282\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u5220\u9664\u3002\u5982\u679c\u4e0d\u662f\u7ea2\u8282\u70b9\uff0c\u90a3\u4e48\u5b83\u7684\u5de6\u513f\u5b50\u5fc5\u5b9a\u662f\u7ea2\u8272\u8282\u70b9\uff0c\u56e0\u4e3a\u6211\u4eec\u4fdd\u8bc1\u5b83\u4f1a\u5728\u4e00\u4e2a3-\u8282\u70b9\u62164-\u8282\u70b9\u4e2d\uff0c\u5e76\u4e14\u6211\u4eec\u7684\u7ea2\u8272\u8f6c\u79fb\u64cd\u4f5c\u90fd\u662f\u521b\u5efa\u7ea2\u94fe\u63a5\u5728\u5de6\u7684\u8282\u70b9\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u987a\u65f6\u9488\u65cb\u8f6c\uff0c\u4f7f\u5176\u53d8\u4e3a\u7ea2\u8272\u8282\u70b9\uff0c\u7136\u540e\u76f4\u63a5\u5220\u9664\u3002  <br/>\u5bf9\u4e8e\u6709\u513f\u5b50\u7684\u8282\u70b9\uff0c\u6211\u4eec\u6a21\u4eff\u4e8c\u53c9\u641c\u7d22\u6811\u4e2d\u7684\u505a\u6cd5\uff1a\u5728\u5b83\u7684\u53f3\u5b50\u6811\u4e2d\u627e\u5230\u6700\u5c0f\u7684\u8282\u70b9\u6765\u66ff\u4ee3\u5b83\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u5728\u53f3\u5b50\u6811\u4e2d\u5c06\u8fd9\u4e2a\u8282\u70b9\u5220\u9664\u5373\u53ef\u3002<br/><br/>\u4e0b\u9762\u662f\u7ea2\u9ed1\u6811\u7684\u5220\u9664\u64cd\u4f5c\u7684\u53c2\u8003\u5b9e\u73b0\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40# \u83b7\u53d6\u540e\u7ee7\u8282\u70b9<br/>def min_node(h):<br/>    assert h is not None<br/><br/>    if h.left is not None:  # \u4e00\u76f4\u6cbf\u5de6\u94fe\u63a5\u5bfb\u627e<br/>        return min_node(h.left)<br/>    else:<br/>        return h<br/><br/>def delete(h, key):<br/>    assert h is not None  # \u786e\u8ba4\u4e0d\u662f\u4e00\u68f5\u7a7a\u6811<br/><br/>    if key < h.key:  # \u5728\u5de6\u5b50\u6811\u4e2d<br/>        if h.left is black and h.left.left is black:  # \u5982\u679c\u5de6\u513f\u5b50\u4e0d\u662f3-\u8282\u70b9<br/>            h = move_red_to_left(h)<br/><br/>        h.left = delete(h.left, key)<br/>    else:  # \u5728\u53f3\u5b50\u6811\u4e2d\u6216\u5df2\u7ecf\u627e\u5230<br/>        if h.left is red:<br/>            h = cw_rotate(h)  # \u5c06\u5de6\u8fb9\u7684\u7ea2\u94fe\u63a5\u53d8\u4e3a\u53f3\u8fb9\u7684\u7ea2\u94fe\u63a5<br/><br/>        if key == h.key and h.right is None:  # \u5982\u679c\u5df2\u7ecf\u67e5\u627e\u5230\u5e76\u4e14\u6ca1\u6709\u513f\u5b50<br/>            del h  # \u76f4\u63a5\u5220\u9664<br/>            return None<br/><br/>        if h.right is black and h.right.left is black:  # \u5982\u679c\u53f3\u513f\u5b50\u4e0d\u662f3-\u8282\u70b9<br/>            h = move_red_to_right(h)<br/><br/>        if key == h.key:  # \u5982\u679c\u5df2\u7ecf\u67e5\u627e\u5230\u4f46\u6709\u513f\u5b50<br/>            x = min_node(h.right)  # \u627e\u5230\u540e\u53ca\u8282\u70b9<br/><br/>            # \u4ea4\u6362\u952e\u503c\u548c\u536b\u661f\u6570\u636e<br/>            h.key = x.key<br/>            h.data = x.data<br/><br/>            h.right = delele(h.right, x.key)  # \u5728\u53f3\u5b50\u6811\u4e2d\u5220\u9664\u540e\u7ee7<br/>        else:  # \u5982\u679c\u6ca1\u6709\u547d\u4e2d\uff0c\u5219\u7ee7\u7eed\u5f80\u53f3\u8fb9\u5bfb\u627e<br/>            h.right = delete(h.right, key)<br/><br/>    return balance(h)  # \u5b8c\u6210\u5220\u9664\u540e\u5e73\u8861\u5f53\u524d\u7684\u5b50\u6811<br/><br/><br/><br/><br/><br/><br/>\u7ea2\u9ed1\u6811\u7ef4\u57fa\u767e\u79d1\uff1ahttps://zh.wikipedia.org/zh-cn/% E7% BA% A2% E9% BB% 91% E6% A0% 91\u00a0\u21a9<br/><br/><br/>2-3\u6811\uff082-3-4\u6811\uff09\u7ef4\u57fa\u767e\u79d1\uff1ahttps://zh.wikipedia.org/wiki/2-3-4% E6% A0% 91\u00a0\u21a9<br/><br/><br/>B\u6811\u7ef4\u57fa\u767e\u79d1\uff1ahttps://zh.wikipedia.org/wiki/B% E6% A0% 91\u00a0\u21a9<br/><br/><br/>\u952e\uff08Key\uff09\u8868\u793a\u8282\u70b9\u7528\u4e8e\u7d22\u5f15\u7684\u503c\uff0c\u540c\u65f6\u4e5f\u662f\u786e\u5b9a\u8282\u70b9\u5728\u6811\u4e2d\u7684\u4f4d\u7f6e\u7684\u4f9d\u636e\u4e4b\u4e00\u3002\u00a0\u21a9<br/><br/><br/>\u536b\u661f\u6570\u636e\u6307\u5b58\u50a8\u5728\u8fd9\u4e2a\u8282\u70b9\u4e0a\u7684\u4e0e\u6811\u7ed3\u6784\u65e0\u5173\u7684\u6570\u636e\uff0c\u5373\u8fd9\u4e2a\u8282\u70b9\u7684\u4e00\u4e9b\u9644\u52a0\u6570\u636e\uff0c\u4f8b\u5982\u5047\u8bbe\u6bcf\u4e2a\u8282\u70b9\u8868\u793a\u4e00\u4e2a\u4eba\uff0c\u90a3\u4e48\u6027\u522b\u3001\u5e74\u9f84\u3001\u8eab\u9ad8\u7b49\u5c31\u5c5e\u4e8e\u536b\u661f\u6570\u636e\u3002\u00a0\u21a9<br/><br/><br/>\u8fd9\u662f\u7ea2\u9ed1\u6811\u7684\u4e00\u79cd\u5b9e\u73b0\u3002\u7f51\u7edc\u4e0a\u6709\u5176\u5b83\u7684\u5b9e\u73b0\uff0c\u5141\u8bb8\u53f3\u513f\u5b50\u4e3a\u7ea2\u8272\u3002\u00a0\u21a9<br/><br/><br/>\u4e5f\u79f0\u4f5c\u5de6\u65cb\u548c\u53f3\u65cb\uff0c\u4f46\u4e2a\u4eba\u8ba4\u4e3a\u8fd9\u6837\u7684\u540d\u5b57\u6666\u6da9\u5e76\u5177\u6709\u8bef\u5bfc\u6027\uff0c\u6545\u4f7f\u7528\u987a\u65f6\u9488\u65cb\u8f6c\u548c\u9006\u65f6\u9488\u65cb\u8f6c\u4ee3\u66ff\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-3-12/2-3-tree-and-red-black-tree.html"
},
"BST\u5382\u957f": {
"tags": "Problems ZY XL LinkSBK",
"text": "BST\u5382\u957f (bst.in/out/cpp)<br/>\u65f6\u95f4\u9650\u5236: 1 s / \u5185\u5b58\u9650\u5236: 128 MB / \u6253\u5f00O2\u4f18\u5316<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>\u4e8c\u53c9\u6811\u771f\u662f\u8ff7\u4eba......<br/><br/>\u968f\u7740\u65f6\u4ee3\u7684\u8fdb\u6b65\uff0c\u4e8c\u53c9\u641c\u7d22\u6811(Binary Search Tree)\u53d1\u6325\u7740\u8d8a\u6765\u8d8a\u5927\u7684\u4f5c\u7528\u3002\u4f5c\u4e3aHNSDFZ\u4e0a\u673a\u90e8\u957fXL\uff0c\u62c5\u8d1f\u7740\u4e3a\u5b66\u6821\u5236\u9020\u5404\u79cdBST\u7684\u4efb\u52a1\u3002\u5b83\u4eec\u4f1a\u7528\u4e8e\u5404\u79cd\u7528\u9014\uff1a\u6210\u7ee9\u6392\u540d\u3001\u85aa\u6c34\u53d1\u653e\u3001PY**......<br/>\u672c\u6765\u5b66\u6821\u5bf9BST\u7684\u9700\u6c42\u5e76\u4e0d\u662f\u5f88\u5927\uff0c\u4f46\u662f\u81ea\u4eceZY\u52a0\u5165\u4e86\u4e0a\u673a\u7ec4\u540e\uff0cBST\u7684\u9700\u6c42\u8d8a\u6765\u8d8a\u5927......<br/>\u4f5c\u4e3aXL\uff0c\u65e9\u5df2\u6309\u637a\u4e0d\u4f4f\u3002\u4e8e\u662fXL\u5229\u7528\u901a\u7528\u6280\u672f\u6559\u5b66\u697c\u5efa\u7acb\u4e86\u4e00\u4e2a\u5382\u623f\uff0c\u4e13\u95e8\u5236\u9020\u5404\u79cdBST\u3002<br/>\u8fd9\u4e2a\u5382\u5b50\u4f1a\u6536\u5230\u5404\u79cd\u5404\u6837\u7684\u8ba2\u5355\u3002\u6bcf\u4e2a\u8ba2\u5355\u90fd\u4f1a\u662f\u4e00\u4e2a\u5f88\u957f\u7684\u6570\u5217\uff0c\u5176\u4e2d\u6ca1\u6709\u4e24\u4e2a\u6570\u662f\u76f8\u540c\u7684\u3002\u800cXL\u8981\u505a\u7684\u5c31\u662f\u5c06\u8fd9\u4e9b\u6570\u5b57\u4f9d\u6b21\u63d2\u5165\u5230\u4e00\u68f5\u7a7a\u7684BST\u4e2d\uff0c\u7136\u540e\u5c06BST\u53d1\u9001\u51fa\u53bb\u3002<br/>\u7136\u800c\u4eba\u5de5\u5e72\u8fd9\u4ef6\u4e8b\u5b9e\u5728\u662f\u592a\u9ebb\u70e6\u4e86\uff0c\u56e0\u6b64XL\u5c06ZY\u6293\u8fc7\u6765\u9020BST\u3002\u7136\u800cZY\u66f4\u61d2\uff0c\u628aLink\u6293\u8fc7\u6765\u8981\u5b83\u5e2e<br/>ZY\u5199\u4e2a\u7a0b\u5e8f\u6765\u6784\u5efaBST\u3002\u7136\u800cLink\u5e76\u4e0d\u5c51\u4e8e\u5199\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u4e8e\u662f\u8fd9\u4e2a\u4efb\u52a1\u83ab\u540d\u5176\u5999\u5730\u4f20\u5230\u4e86\u4f60\u624b\u4e0a......<br/>\u5f53\u7136XL\u4e0d\u4f1a\u5c31\u8fd9\u6837\u653e\u624b\u4e0d\u7ba1\uff0cXL\u4f1a\u968f\u65f6\u6765\u68c0\u67e5\u8fd9\u68f5BST\u662f\u5426\u662f\u6b63\u786e\u7684\uff0c\u4ee5\u9632\u4f60\u5728\u4e71\u9020BST\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6b63\u6574\u6570$n$\uff0c\u8868\u793a\u8ba2\u5355\u4e2d\u6570\u5217\u7684\u957f\u5ea6\u3002<br/>\u63a5\u4e0b\u6765$n$\u884c\uff0c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570$x$\u548c$k$\u3002\u8868\u793a\u5c06$x$\u63d2\u5165\u5230\u5f53\u524d\u7684BST\u4e2d\u3002\u521d\u59cb\u65f6\u662f\u7a7a\u6811\u3002$k$\u5219\u8868\u793aXL\u7684\u68c0\u67e5\u3002\u4ed6\u4f1a\u95ee\u4f60\u6839\u8282\u70b9\u5230\u65b0\u63d2\u5165\u7684\u8282\u70b9$x$\u7684\u94fe\u4e0a\u7b2c$k$\u4e2a\u8282\u70b9\u662f\u8c01\u3002\u9ed8\u8ba4\u4ece$1$\u5f00\u59cb\u6570\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u6b21XL\u7684\u68c0\u67e5\uff0c\u8f93\u51fa\u5bf9\u5e94\u7684\u7b54\u6848\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>43<br/>2 1<br/>1 1<br/>3 2<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>32<br/>2<br/>3<br/><br/><br/>\u63d0\u793a\u53ca\u6570\u636e\u7ea6\u5b9a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u6b21\u63d2\u5165$2$\uff0c\u6811\u7684\u6839\u8282\u70b9\u4e3a$2$\uff0c\u6545\u7b54\u6848\u4e3a$2$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u6b21\u63d2\u5165$1$\uff0c\u56e0\u4e3a$1 \\\\lt 2$\uff0c\u6240\u4ee5$1$\u662f$2$\u7684\u5de6\u513f\u5b50\u3002$2$\u5230$1$\u7684\u94fe\u4e0a\u7684\u7b2c\u4e00\u4e2a\u8282\u70b9\u4e3a$2$<br/>\u5bf9\u4e8e\u6700\u540e\u4e00\u6b21\u63d2\u5165$3$\uff0c\u56e0\u4e3a$3 \\\\gt 2$\uff0c\u6240\u4ee5$3$\u662f$2$\u7684\u53f3\u513f\u5b50\u3002$2$\u5230$3$\u7684\u94fe\u4e0a\u7684\u7b2c\u4e8c\u4e2a\u8282\u70b9\u662f$3$\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 20,000$\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 90,000$\u3002<br/>\u5bf9\u4e8e$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 100,000$\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u6570\u5217\u5b8c\u5168\u968f\u673a\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 200,000$\uff0c$1 \\\\le x \\\\le n$\uff0c\u4fdd\u8bc1\u6bcf\u6b21\u68c0\u67e5\u7684\u8282\u70b9\u5b58\u5728\u3002",
"url": "blog/2016-5-30/riteme.html"
},
"DevIL\u5feb\u901f\u5165\u95e8": {
"tags": "C/C++ DevIL OpenGL",
"text": "DevIL\u5feb\u901f\u5165\u95e8<br/>DevIL\u5168\u540d\u662f\u201cDeveloper\u2019s Image Library\u201d\uff0c\u5b83\u662f\u4e00\u4e2a\u591a\u529f\u80fd\u7684\u56fe\u50cf\u5e93\uff0c\u80fd\u8fc7\u5f88\u65b9\u4fbf\u5730\u8f7d\u5165\u3001\u4fee\u6539\u548c\u4fdd\u5b58\u56fe\u7247\u3002<br/>\u5176\u539f\u540d\u662fOpenIL\uff0c\u540e\u6765\u662f\u56e0\u4e3aSGI\u7684\u8981\u6c42\u624d\u6539\u540d\u4e3aDevIL1\u3002<br/>\u672c\u6587\u4e3b\u8981\u4ecb\u7ecdDevIL\u8f7d\u5165\u548c\u4fdd\u5b58\u56fe\u7247\u7684\u529f\u80fd\u3002DevIL\u867d\u7136\u6709\u5904\u7406\u56fe\u7247\u7684\u529f\u80fd\uff0c\u4f46\u5e76\u4e0d\u591f\u5f3a\uff0c\u4e0d\u5982\u4f7f\u7528Boost.GIL\uff0c<br/>\u56e0\u6b64\u4e0d\u4ecb\u7ecdDevIL\u5904\u7406\u56fe\u7247\u7684\u529f\u80fd\u3002<br/>\u7279\u70b9<br/>DevIL\u5177\u6709\u51e0\u4e2a\u975e\u5e38\u597d\u7684\u7279\u6027\uff1a<br/><br/>\u652f\u6301\u5305\u62ecPNG\uff0cJPG\uff0cTGA\u7b4930\u591a\u79cd\u56fe\u7247\u683c\u5f0f\u3002  <br/>\u4e0eOpenGL\u7c7b\u4f3c\u7684API\u98ce\u683c\u3002  <br/>\u5341\u5206\u8f7b\u5de7  <br/>\u6709\u8bb8\u591a\u8f85\u52a9\u51fd\u6570\uff08ilut\uff09<br/><br/>\u5b89\u88c5<br/>\u7406\u8bba\u4e0a\u5b89\u88c5DevIL\u4e0d\u4f1a\u5f88\u8270\u96be\u3002\u5bf9\u4e8eUbuntu \u7528\u6237\u800c\u8a00\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e0b\u5217\u547d\u4ee4\u6765\u5b89\u88c5\uff1a<br/>1sudo apt-get install libdevil-dev<br/><br/><br/>\u5177\u4f53\u7684\u4e0b\u8f7d\u3001\u7f16\u8bd1\u3001\u5b89\u88c5\u7684\u9875\u9762\u5728\u6b64\u3002<br/>\u521d\u59cb\u5316<br/>\u63a5\u4e0b\u6765\u6b63\u5f0f\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528DevIL\u3002\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u5934\u6587\u4ef6\uff1a<br/>1#include <IL/il.h><br/><br/><br/>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u52a8\u6001\u94fe\u63a5\u7684DevIL\u4f1a\u81ea\u52a8\u52a0\u8f7d\uff0c\u4e0d\u5fc5\u8c03\u7528\u7279\u5b9a\u7684\u51fd\u6570\u3002\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u80fd\u4e0d\u4f1a\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u517c\u5bb9\u6027\uff0c\u6211\u4eec\u6700\u597d\u624b\u52a8\u8f7d\u5165\uff1a<br/>1<br/>2// \u5728\u7a0b\u5e8f\u5f00\u59cb\u7684\u5730\u65b9<br/>ilInit();<br/><br/><br/>\u4ec5\u4ec5\u4e00\u884c\u4ee3\u7801\uff0c\u5e76\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\u3002<br/>\u52a0\u8f7d\u56fe\u7247<br/>DevIL\u4e2d\u4f7f\u7528\u4e86\u548cOpenGL\u4e00\u6837\u7684\u5bf9\u8c61\u521b\u5efa\u65b9\u5f0f\u3002\u4e3a\u4e86\u52a0\u8f7d\u56fe\u7247\uff0c\u6211\u4eec\u9996\u5148\u8981\u521b\u5efa\u4e00\u4e2a\u56fe\u7247\u5bf9\u8c61\uff1a<br/>1<br/>2<br/>3ILuint image = 0;<br/>ilGenImages(1, &image);<br/>assert(image != 0);  // \u68c0\u67e5\u662f\u5426\u521b\u5efa\u6210\u529f<br/><br/><br/>\u4e5f\u8bb8\u4f60\u4f1a\u53d1\u73b0\u7b2c\u4e8c\u884c\u975e\u5e38\u719f\u6089\uff0c\u786e\u5b9e\u548cOpenGL\u4e2d\u521b\u5efa\u7f13\u51b2\u533a\u7684\u8c03\u7528\u957f\u5f97\u975e\u5e38\u50cf\uff0c\u56e0\u6b64\u5f88\u591a\u4f7f\u7528OpenGL\u7684\u5f00\u53d1\u8005\u80fd\u5f88\u5feb\u4e0a\u624b\u3002<br/>\u5f53\u7136\uff0c\u4f60\u5982\u679c\u89c9\u5f97\u8fd9\u8fd8\u9ebb\u70e6\u4e86\uff0c\u53ef\u4ee5\u53ea\u521b\u5efa\u4e00\u4e2a\uff1a<br/>1ILuint image = ilGenImage();<br/><br/><br/>\u5c31\u50cfOpenGL\u4e00\u6837\uff0c\u9700\u8981\u7ed1\u5b9a\u5f53\u524d\u7684\u56fe\u7247\u5bf9\u8c61\u3002\u7ed1\u5b9a\u540e\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u5728\u6b64\u56fe\u7247\u5bf9\u8c61\u4e0a\u7684\uff0c\u9664\u975e\u89e3\u7ed1\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5ilBindImage(image);<br/><br/>// ...<br/><br/>ilBingImage(0);  // \u89e3\u7ed1\u56fe\u7247\u5bf9\u8c61<br/><br/><br/>\u7ed1\u5b9a\u597d\u56fe\u7247\u5bf9\u8c61\u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528ilLoad\u51fd\u6570\u6765\u52a0\u8f7d\u56fe\u7247\u4e86\uff1a<br/>1ilLoad(IL_PNG, \\ sample.png\\ );<br/><br/><br/>\u4e0a\u9762\u7684IL_PNG\u662f\u6307\u5b9a\u56fe\u7247\u683c\u5f0f\u4e3aPNG\u3002<br/>\u5f53\u7136\uff0c\u53ef\u4ee5\u4f7f\u7528\u66f4\u7b80\u5355\u7684ilLoadImage\uff1a<br/>1ilLoadImage(\\ sample.png\\ );<br/><br/><br/>\u4f7f\u7528ilLoadImage\u5c31\u4e0d\u9700\u8981\u624b\u52a8\u6307\u5b9a\u56fe\u7247\u683c\u5f0f\u4e86\uff0cDevIL\u4f1a\u81ea\u52a8\u68c0\u6d4b\u3002<br/>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528ilGetError\u6765\u67e5\u770b\u9519\u8bef\u3002\u5982\u679c\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u51fa\u9519\uff0cilGetError\u4f1a\u8fd4\u56deIL_NO_ERROR\u3002<br/>1assert(ilGetError() == IL_NO_ERROR);<br/><br/><br/>\u6ce8\u610f<br/>\u5f53\u4f60\u4e0d\u9700\u8981\u518d\u4f7f\u7528\u56fe\u7247\u5bf9\u8c61\u65f6\uff0c\u5e94\u53ca\u65f6\u4f7f\u7528`ilDeleteImage`\u5220\u9664\uff1a<br/><br/>wzxhzdk:9<br/><br/><br/>\u521b\u5efa\u6750\u8d28<br/>\u52a0\u8f7d\u5b8c\u56fe\u7247\u540e\uff0c\u8fd8\u53ea\u662f\u5c06\u6570\u636e\u6258\u7ba1\u5728DevIL\u5185\u90e8\u3002\u4e3a\u4e86\u80fd\u591f\u5c06\u6570\u636e\u63d0\u4f9b\u7ed9OpenGL\u6216DirectX\u6765\u521b\u5efa\u6750\u8d28\uff0c\u6211\u4eec\u4f7f\u7528ilGetData()\u3002<br/>\u540c\u65f6\uff0c\u6211\u4eec\u8fd8\u9700\u83b7\u53d6\u56fe\u7247\u7684\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5982\u5bbd\u5ea6\u3001\u9ad8\u5ea6\u3001\u56fe\u7247\u5b58\u50a8\u683c\u5f0f\u7b49\u7b49\uff0c\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u4f7f\u7528ilGetInteger\u6765\u83b7\u53d6\u3002<br/>\u4e0b\u9762\u662f\u5728OpenGL\u4e2d\u521b\u5efa\u6750\u8d28\u7684\u8fc7\u7a0b\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9ilBindImage(image);                               // \u7ed1\u5b9a\u5f53\u524d\u56fe\u7247\u5bf9\u8c61<br/>GLint    width  = ilGetInteger(IL_IMAGE_WIDTH);   // \u83b7\u53d6\u56fe\u7247\u5bbd\u5ea6<br/>GLint    height = ilGetInteger(IL_IMAGE_HEIGHT);  // \u83b7\u53d6\u56fe\u7247\u9ad8\u5ea6<br/>GLenum   format = ilGetInteger(IL_IMAGE_FORMAT);  // \u83b7\u53d6\u56fe\u7247\u50cf\u7d20\u683c\u5f0f<br/>ILubyte *ptr    = ilGetData();                    // \u83b7\u53d6\u56fe\u7247\u6570\u636e\u7684\u6307\u9488<br/>ilBindImage(0);<br/><br/>// \u521b\u5efa\u6750\u8d28<br/>glTexImage2D(GL_TEXTURE_2D, 0, format, width, height, 0, format, GL_UNSIGNED_BYTE, ptr);<br/><br/><br/>\u63d0\u793a<br/>DevIL\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5f88\u591a\u56fe\u7247\u7684\u4fe1\u606f\uff0c\u9664\u4e86\u5bbd\u5ea6\u3001\u9ad8\u5ea6\u548c\u50cf\u7d20\u683c\u5f0f\u5916\uff0c\u8fd8\u53ef\u4ee5\u83b7\u53d6\u8272\u6df1\uff08IL_IMAGE_DEPTH\uff09\u3001<br/>\u56fe\u7247\u6570\u636e\u7684\u5927\u5c0f\uff08IL_IMAGE_SIZE_OF_DATA\uff09\u3001BPP\uff08\u201dBytes Per Pixel\u201c\uff0c\u6bcf\u4e2a\u50cf\u7d20\u6240\u5360\u5b57\u8282\u6570\uff0cIL_IMAGE_BPP\u6216IL_IMAGE_BYTES_PER_PIXEL\uff09\u3001<br/>Bit Per Pixel\uff08\u6bcf\u4e2a\u50cf\u7d20\u6240\u5360\u4f4d\u6570\uff0cIL_IMAGE_BITS_PER_PIXEL\uff09\u3001\u56fe\u7247\u683c\u5f0f\uff08IL_IMAGE_TYPE\uff09\u3001<br/>\u6c34\u5e73/\u7ad6\u76f4\u5e73\u79fb\u91cf\uff08IL_IMAGE_OFFX\u548cIL_IMAGE_OFFY\uff09\u3001\u56fe\u7247\u539f\u70b9\uff08IL_IMAGE_ORIGIN\uff09\u3001<br/>\u989c\u8272\u901a\u9053\u6570\uff08IL_IMAGE_CHANNELS\uff09\u7b49\u3002<br/><br/>\u63d0\u793a<br/>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u56fe\u7247\u7684\u50cf\u7d20\u683c\u5f0f\u88ab\u76f4\u63a5\u4f20\u5230OpenGL\u7684\u51fd\u6570\u4e2d\u662f\u53ef\u4ee5\u7684\uff0c\u56e0\u4e3aDevIL\u5bf9\u5e94\u7684\u503c\u548cOpenGL\u89c4\u5b9a\u7684\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u4f1a\u6709\u95ee\u9898\u3002<br/>\u5bf9\u4e8eDirectX\uff0c\u9700\u8981\u624b\u5199switch\u6765\u5207\u6362\u3002<br/><br/>\u4fdd\u5b58\u56fe\u7247<br/>DevIL\u4e2d\u4fdd\u5b58\u56fe\u7247\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5148\u7ed1\u5b9a\u56fe\u7247\u5bf9\u8c61\uff0c\u6307\u5b9a\u4fdd\u5b58\u8def\u5f84\u5c31\u53ef\u76f4\u63a5\u4fdd\u5b58\u3002DevIL\u4f1a\u81ea\u52a8\u901a\u8fc7\u6587\u4ef6\u540e\u7f00\u540d\u6765\u786e\u5b9a\u56fe\u7247\u683c\u5f0f\u3002<br/>1<br/>2<br/>3ilBindImage(image);<br/>ilSaveImage(\\ output.png\\ );<br/>ilBindImage(0);<br/><br/><br/>\u53ef\u662f\u6211\u4eec\u5e76\u6ca1\u6709\u5bf9\u56fe\u7247\u505a\u4ec0\u4e48\u5904\u7406\u554a\uff0c\u4fdd\u5b58\u5b83\u6709\u4ec0\u4e48\u7528\uff1f\u786e\u5b9e\uff0c\u6211\u4eec\u4e0d\u4f1a\u53bb\u7528DevIL\u6765\u505a\u4ec0\u4e48\u7279\u6548\u3002\u4f46\u6709\u4e00\u4e2a\u573a\u666f\u5374\u5f88\u5e38\u7528\uff0c\u5c31\u662f\u4fdd\u5b58\u622a\u56fe\u3002<br/>\u5bf9\u4e8eOpenGL\uff0cDevIL\u7684\u5de5\u5177\u5e93ilut\u5df2\u7ecf\u5e2e\u6211\u4eec\u505a\u5230\u4e86\u8fd9\u4e00\u70b9\u3002\u6211\u4eec\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u5199\u51fa\u4fdd\u5b58\u622a\u56fe\u7684\u51fd\u6570\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16#define ILUT_USE_OPENGL  // \u901a\u77e5ilut\u4f7f\u7528OpenGL<br/>#include <IL/ilut.h><br/><br/>// \u4fdd\u5b58\u622a\u56fe<br/>bool TakeScreenshot(const std::string &filepath) {<br/>    ILuint image = ilGenImage();    <br/>    ilBindImage(image);<br/><br/>    ilutGLScreen();                // \u5c06\u5f53\u524dOpenGL\u7684\u989c\u8272\u7f13\u51b2\u533a\u7684\u6570\u636e\u590d\u5236\u5230image\u4e2d<br/>    ilSaveImage(filepath.data());  // \u4fdd\u5b58\u56fe\u7247<br/><br/>    ilBindimage(0);<br/>    ilDeleteImage(image);          // \u8bb0\u5f97\u91ca\u653e\u56fe\u7247\u5bf9\u8c61<br/><br/>    return ilGetError() == IL_NO_ERROR;<br/>}<br/><br/><br/>\u6ca1\u9519\uff0cilutGLScreen\u5e2e\u6211\u4eec\u505a\u4e86\u4e00\u5207\u3002\u53ea\u662f\u975e\u5e38\u53ef\u60dc\uff0c\u622a\u56fe\u7684\u51fd\u6570\u662fOpenGL\u4e13\u5c5e\u7684\u3002<br/>\u4f46\u5b83\u662f\u600e\u4e48\u5de5\u4f5c\u7684\u5462\uff1f\u6211\u5728GitHub\u4e0a\u627e\u5230\u5176\u6e90\u7801\uff0c\u5176\u8fc7\u7a0b\u975e\u5e38\u7b80\u77ed\u3002<br/>\u4e0b\u9762\u662fGitHub\u4e0a\u7684\u6e90\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22//! Takes a screenshot of the current OpenGL window.<br/>ILboolean ILAPIENTRY ilutGLScreen()<br/>{<br/>    ILuint  ViewPort[4];<br/><br/>    ilutCurImage = ilGetCurImage();<br/>    if (ilutCurImage == NULL) {<br/>        ilSetError(ILUT_ILLEGAL_OPERATION);<br/>        return IL_FALSE;<br/>    }<br/><br/>    glGetIntegerv(GL_VIEWPORT, (GLint*)ViewPort);<br/><br/>    if (!ilTexImage(ViewPort[2], ViewPort[3], 1, 3, IL_RGB, IL_UNSIGNED_BYTE, NULL))<br/>        return IL_FALSE;  // Error already set.<br/>    ilutCurImage->Origin = IL_ORIGIN_LOWER_LEFT;<br/><br/>    glPixelStorei(GL_PACK_ALIGNMENT, 1);<br/>    glReadPixels(0, 0, ViewPort[2], ViewPort[3], GL_RGB, GL_UNSIGNED_BYTE, ilutCurImage->Data);<br/><br/>    return IL_TRUE;<br/>}<br/><br/><br/>\u6211\u4eec\u6765\u7b80\u8981\u5206\u6790\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\u5728\u5e72\u4ec0\u4e48\u3002<br/>\u9996\u5148\u662f\u83b7\u53d6\u5f53\u524d\u7ed1\u5b9a\u7684\u56fe\u7247\u5bf9\u8c61\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5ilutCurImage = ilGetCurImage();<br/>if (ilutCurImage == NULL) {  // \u68c0\u67e5\u5e76\u62a5\u9519<br/>    ilSetError(ILUT_ILLEGAL_OPERATION);<br/>    return IL_FALSE;<br/>}<br/><br/><br/>\u7136\u540e\u83b7\u53d6\u5f53\u524dOpenGL\u89c6\u56fe\u7684\u4fe1\u606f\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5ILuint  ViewPort[4];<br/><br/>// ...<br/><br/>glGetIntegerv(GL_VIEWPORT, (GLint*)ViewPort);<br/><br/><br/>\u6b64\u65f6\uff0cViewPort\u4e2d\u5b58\u50a8\u7684\u5206\u522b\u662f\u539f\u70b9\u7684X\u5750\u6807\u548cY\u5750\u6807\uff0c\u4ee5\u53ca\u89c6\u56fe\u7684\u5bbd\u5ea6\u548c\u9ad8\u5ea6\u3002<br/>\u6839\u636e\u83b7\u53d6\u6765\u7684\u89c6\u56fe\u4fe1\u606f\uff0c\u5c31\u9700\u8981\u8c03\u6574\u56fe\u7247\u7684\u53c2\u6570\uff1a<br/>1<br/>2<br/>3<br/>4// ilTexImage\u5206\u522b\u8bbe\u7f6e\u7684\u662f\u56fe\u7247\u7684\u5bbd\u5ea6\u3001\u9ad8\u5ea6\u3001BPP\u3001\u989c\u8272\u901a\u9053\u6570\u91cf\u3001\u50cf\u7d20\u683c\u5f0f\u548c\u6570\u636e\u683c\u5f0f<br/>// \u6700\u540e\u4e00\u4e2a\u53c2\u6570\u662f\u56fe\u7247\u6570\u636e\u7684\u6307\u9488\uff0c\u4f46\u662f\u56fe\u7247\u6570\u636e\u8981\u5728\u4e4b\u540e\u8bfb\u53d6\uff0c\u56e0\u6b64\u8fd9\u91cc\u586bnullptr<br/>if (!ilTexImage(ViewPort[2], ViewPort[3], 1, 3, IL_RGB, IL_UNSIGNED_BYTE, NULL))<br/>    return IL_FALSE;  // \u8bbe\u7f6e\u5931\u8d25<br/><br/><br/>\u7136\u540e\u662f\u4eceOpenGL\u7684\u989c\u8272\u7f13\u51b2\u4e2d\u8bfb\u53d6\u6570\u7ec4\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8// \u56e0\u4e3aOpenGL\u7684\u539f\u70b9\u662f\u5728\u5de6\u4e0b\u89d2\uff0c\u800c\u5c4f\u5e55\u5750\u6807\u7684\u539f\u70b9\u5374\u5728\u5de6\u4e0a\u89d2\uff0c\u56e0\u6b64\u6b64\u5904\u505a\u70b9\u8c03\u6574<br/>ilutCurImage->Origin = IL_ORIGIN_LOWER_LEFT;<br/><br/>// \u66f4\u6539\u6570\u636e\u7684\u5185\u5b58\u5bf9\u9f50\uff0c\u907f\u514d\u8bfb\u51fa\u6765\u7684\u6570\u636e\u683c\u5f0f\u4e0d\u5bf9<br/>glPixelStorei(GL_PACK_ALIGNMENT, 1);<br/><br/>// \u8bfb\u51fa\u6570\u636e<br/>glReadPixels(0, 0, ViewPort[2], ViewPort[3], GL_RGB, GL_UNSIGNED_BYTE, ilutCurImage->Data);<br/><br/><br/>\u90a3\u4e48\u6b64\u65f6\u622a\u56fe\u7684\u65b9\u6cd5\u5df2\u7ecf\u51fa\u6765\u4e86\u3002\u5bf9\u4e8eDirectX\uff0c\u53ea\u9700\u5148\u521b\u5efa\u56fe\u7247\u5bf9\u8c61\u5e76\u91cd\u8bbe\u5176\u53c2\u6570\uff0c<br/>\u7136\u540e\u8bfb\u51fa\u989c\u8272\u6570\u636e\u5230\u56fe\u7247\u4e2d\uff0c\u6700\u540e\u4fdd\u5b58\u5373\u53ef\u3002\u4e0d\u8fc7\u6211\u4e0d\u600e\u4e48\u719f\u6089DirectX\uff0c\u56e0\u6b64\u8fd9\u91cc\u5e76\u6ca1\u6709\u7ed9\u51faDirectX\u7684\u622a\u56fe\u4ee3\u7801\u4e86\u3002<br/>\u7ed3\u5c3e<br/>\u4ece\u4e0a\u9762\u7684\u6587\u7ae0\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86DevIL\u5e93\uff0c\u5e76\u4e14\u80fd\u591f\u8fd0\u7528\u5230\u5b9e\u9645\u5de5\u7a0b\u4e2d\u4e86\u3002<br/>\u4e8b\u5b9e\u4e0a\u7c7b\u4f3c\u7684\u5e93\u8fd8\u6709\u5f88\u591a\uff0c\u4f8b\u5982SOIL\u548cFreeImage\u3002<br/>\u5982\u679c\u4f60\u53ea\u662f\u4e13\u6ce8\u4e8e\u4e00\u79cd\u683c\u5f0f\uff0c\u4e5f\u8bb8\u50cflibpng\u548clibjpg\u66f4\u9002\u5408\u4f60\u3002<br/>\u56e0\u6b64\u5728\u5b9e\u9645\u4e2d\uff0c\u9700\u8981\u6211\u4eec\u914c\u60c5\u9009\u62e9\u5408\u9002\u7684\u5e93\u6765\u63d0\u9ad8\u81ea\u5df1\u7684\u5f00\u53d1\u6548\u7387\u3002<br/><br/><br/><br/><br/>\u5b98\u65b9\u8bf4\u6cd5\u5728\u8fd9\u91cc\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-2-5/devil-usage.html"
},
"Graphviz: \u53ef\u89c6\u5316\u8c03\u8bd5\u5229\u5668": {
"tags": "Graphviz \u53ef\u89c6\u5316 \u8c03\u8bd5",
"text": "Graphviz: \u53ef\u89c6\u5316\u8c03\u8bd5\u5229\u5668<br/>\u5f53\u4f60\u7684\u5404\u79cd\u6811\u51fa\u73b0\u5947\u5947\u602a\u602a\u7684\u95ee\u9898\u65f6\uff0c\u4f60\u662f\u5982\u4f55\u627e\u5230\u9519\u8bef\u7684\u5462\uff1f<br/>printf\uff1fGDB\uff1f\u8089\u773c\uff1f<br/>\u5f53\u7136\u8fd9\u4e9b\u65b9\u6cd5\u5f53\u7136\u53ef\u884c\uff0c\u7136\u800c\u628a\u5b83\u753b\u51fa\u6765\u5c82\u4e0d\u66f4\u79d2\uff1f<br/>\u73b0\u5728\u796d\u51fa\u5229\u5668\uff1aGraphviz<br/>\u7b80\u4ecb<br/><br/>Graphviz is open source graph visualization software. Graph visualization is a way of representing structural information as diagrams of abstract graphs and networks. It has important applications in networking, bioinformatics,  software engineering, database and web design, machine learning, and in visual interfaces for other technical domains. <br/><br/><br/>\u7ffb\u8bd1\uff1a<br/><br/>Graphviz\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u56fe\u5f62\u53ef\u89c6\u5316\u8f6f\u4ef6\u3002\u56fe\u5f62\u53ef\u89c6\u5316\u662f\u8868\u793a\u8bf8\u5982\u56fe\u8868\u7684\u7ed3\u6784\u5316\u7684\u62bd\u8c61\u56fe\u5f62\u6216\u7f51\u7edc\u3002\u5728\u7f51\u7edc\u6280\u672f\u3001\u751f\u7269\u4fe1\u606f\u5b66\u3001\u8f6f\u4ef6\u5de5\u7a0b\u3001\u6570\u636e\u5e93\u3001\u7f51\u9875\u8bbe\u8ba1\u3001\u673a\u5668\u5b66\u4e60\u548c\u53ef\u89c6\u5316\u754c\u9762\u53ca\u5176\u4ed6\u53ef\u4ee5\u9886\u57df\u5927\u6709\u7528\u5904\u3002<br/><br/>\u8be6\u60c5\u53c2\u89c1Graphviz\u5b98\u7f51\u3002<br/>\u5b89\u88c5<br/>\u8fd9\u4e2a\u4e0d\u662f\u672c\u6587\u7684\u91cd\u70b9\u3002\u6211\u53ea\u77e5\u9053\u5bf9\u4e8eDebian/Ubuntu\u7528\u6237\u53ef\u4ee5\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u5b89\u88c5\uff1a<br/>1sudo apt-get install graphviz<br/><br/><br/>\u4f7f\u7528<br/>Graphviz\u4f7f\u7528\u4e00\u79cd\u9886\u57df\u7279\u5b9a\u8bed\u8a00(Domain-Specific Language1)\u6765\u63cf\u8ff0\u4e00\u526f\u56fe\u3002\u8fd9\u91cc\u7684\u56fe\u5c31\u662f\u6307\u56fe\u8bba\u4e2d\u7684\u56fe\u3002\u7136\u540eGraphviz\u901a\u8fc7\u81ea\u52a8\u5e03\u5c40\u5668\u6765\u7ed8\u5236\u51fa\u8fd9\u4e2a\u56fe\u3002\u7531\u4e8e\u5e03\u5c40\u4e0d\u662f\u7531\u6211\u4eec\u624b\u52a8\u51b3\u5b9a\u7684\uff0c\u56e0\u6b64\u751f\u6210\u7684\u56fe\u7684\u8d28\u91cf\u4f9d\u8d56\u4e8e\u5e03\u5c40\u7b97\u6cd5\u3002<br/>\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0cGraphviz\u7684\u9ed8\u8ba4\u5e03\u5c40\u5668dot\u53ef\u4ee5\u80dc\u4efb\u5e03\u5c40\u8fd9\u4e00\u4efb\u52a1\u3002\u4e0b\u9762\u6211\u4eec\u5c06\u4f7f\u7528dot\u3002<br/>Hello, GRAPHVIZ!<br/>\u6309\u7167\u60ef\u4f8b\uff0c\u603b\u5f97\u6709\u4e2aHello, world!\u3002<br/>\u5f53\u7136\u4e0d\u8981\u7740\u6025\uff0c\u6211\u4eec\u5148\u521b\u5efa\u4e00\u4e2adot\u811a\u672c\u6587\u4ef6\uff1a<br/>1touch hello-world.dot<br/><br/><br/>\u7528\u4f60\u559c\u6b22\u7684\u7f16\u8f91\u5668\u6765\u7f16\u8f91\u5b83\uff1a<br/>1vim hello-world.dot<br/><br/><br/>\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\uff0c\u4fdd\u5b58\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5digraph {<br/>    a -> b;<br/>    b -> c;<br/>    a -> c;<br/>}<br/><br/><br/>\u751f\u6210SVG\u56fe\u7247\uff1a<br/>1dot hello-world.dot -Tsvg > hello-world.svg<br/><br/><br/>\u7528\u4f60\u559c\u6b22\u7684\u56fe\u7247\u67e5\u770b\u5668\u6765\u770b\u770b\u6548\u679c\uff1a<br/>1eog hello-world.svg<br/><br/><br/>\u5982\u679c\u4e00\u8def\u4e0a\u4e0d\u51fa\u610f\u5916\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u4e0b\u9762\u7684\u7ed3\u679c\uff1a<br/><br/>\u606d\u559c\u4f60\u6210\u529f\u521b\u5efa\u4e86\u4e00\u5f20\u6709\u5411\u56fe\u3002<br/>\u56fe\u7684\u7c7b\u578b<br/>\u5728\u4e0a\u9762\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u5f20\u5e26\u6709\u4e09\u4e2a\u9876\u70b9\u7684\u6709\u5411\u56fe\u3002\u7136\u800c\u6211\u4eec\u6709\u65f6\u5019\u4e0d\u4e00\u5b9a\u8981\u7684\u5c31\u662f\u6709\u5411\u56fe\u3002<br/>\u5982\u679c\u9700\u8981\u65e0\u5411\u56fe\uff0c\u5c06digraph\u6362\u4e3agraph\uff0c\u5e76\u628a\u6709\u5411\u8fb9\u6362\u4e3a\u65e0\u5411\u8fb9\u5373\u53ef\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5graph {  // <-- Here<br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>}<br/><br/><br/>\u6b64\u65f6\u7684\u56fe\u662f\u8fd9\u6837\u7684\uff1a<br/><br/>\u5f53\u7136\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u5751\u7239\u7684\u5e73\u884c\u8fb9\u548c\u81ea\u73af\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7graph {<br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>    c -- c;  // \u81ea\u73af x 1<br/>    a -- c;  // \u5e73\u884c\u8fb9 x 1<br/>}<br/><br/><br/>\u4e8e\u662f\u4e4e\u56fe\u957f\u8fd9\u6837\uff1a<br/><br/>\u5f53\u7136\uff0c\u5982\u679c\u4f60\u4e0d\u60f3\u8981\u5b83\u4eec\u51fa\u73b0\uff0c\u4f60\u53ef\u4ee5\u5229\u7528strict\u5c06\u8fd9\u5f20\u56fe\u53d8\u4e3a\u4e25\u683c\u7684\u56fe\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7strict graph {  // <-- strict HERE<br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>    c -- c;<br/>    a -- c;<br/>}<br/><br/><br/>\u6b64\u65f6\u5e73\u884c\u8fb9\u5df2\u7ecf\u4e0d\u89c1\u4e86\uff0c\u6bd5\u7adf\u5b83\u4eec\u7684\u542b\u4e49\u662f\u4e00\u6837\u7684\u3002\u4f46\u662f\u81ea\u73af\u8fd8\u662f\u4f1a\u7559\u4e0b\u6765\u7684\uff1a<br/><br/>\u9876\u70b9<br/>\u4e2a\u4eba\u611f\u89c9\u692d\u5706\u5b9e\u5728\u592a\u96be\u770b\uff0c\u7528\u6765\u8c03\u8bd5\u5b8c\u5168\u4f53\u73b0\u4e0d\u51faB\u683c\u3002<br/>\u628a\u5b83\u6362\u6210\u5706\u5f62\u5c31\u597d\u770b\u591a\u4e86\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9graph {<br/>    node [shape = circle];  // \u6240\u6709\u9876\u70b9\u5168\u90e8\u53d8\u6210\u5706\u5f62<br/><br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>    c -- c;<br/>    a -- c;<br/>}<br/><br/><br/>\u5c31\u53d8\u6210\u8fd9\u6837\uff1a<br/><br/><br/>\u554a\uff01\u6211\u60f3\u8ba9c\u53d8\u6210\u6b63\u65b9\u5f62\uff01<br/><br/>\u5f53\u7136\u4e5f\u6ca1\u6709\u95ee\u9898\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10graph {<br/>    node [shape = circle];  // \u6240\u6709\u9876\u70b9\u5168\u90e8\u53d8\u6210\u5706\u5f62<br/>    c [shape = square];  // \u6307\u5b9ac\u53d8\u4e3a\u6b63\u65b9\u5f62<br/><br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>    c -- c;<br/>    a -- c;<br/>}<br/><br/><br/><br/><br/>\u4e0d\u884c\u6211\u8981\u4e09\u89d2\u5f62\uff01<br/><br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10graph {<br/>    node [shape = circle];  // \u6240\u6709\u9876\u70b9\u5168\u90e8\u53d8\u6210\u5706\u5f62<br/>    c [shape = triangle];  // \u6307\u5b9ac\u53d8\u4e3a\u4e09\u89d2\u5f62<br/><br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>    c -- c;<br/>    a -- c;<br/>}<br/><br/><br/><br/>\u597d\u5427\u5982\u679c\u4f60\u8fd8\u8981\u5176\u5b83\u7684\u56fe\u5f62\uff0c\u53ef\u4ee5\u53c2\u89c1http://www.graphviz.org/content/node-shapes\u3002<br/>\u5149\u6709\u5f62\u72b6\u6709\u5375\u7528\uff0c\u52a0\u70b9\u989c\u8272\u624d\u597d\u73a9\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12graph {<br/>    node [shape = circle];<br/>    a [color = blue];  // \u53d8\u84dd\u8272<br/>    b [color = red];\u3000// \u53d8\u7ea2\u8272<br/>    c [fontcolor = green];  // \u5b57\u4f53\u989c\u8272\u53d8\u7eff<br/><br/>    a -- b;<br/>    b -- c;<br/>    a -- c;<br/>    c -- c;<br/>    a -- c;<br/>}<br/><br/><br/><br/>\u66f4\u8be6\u7ec6\u7684\u989c\u8272\u540d\u79f0\u8868\u5728\u6b64\uff1ahttp://www.graphviz.org/content/color-names<br/>\u8fb9<br/>\u73b0\u5728\u6211\u4eec\u6765\u753b\u4e00\u68f5\u4e8c\u53c9\u641c\u7d22\u6811\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12digraph {<br/>    node [shape = circle];<br/><br/>    3 -> 2;<br/>    3 -> 8;<br/>    2 -> 1;<br/>    8 -> 5;<br/>    8 -> 9;<br/>    5 -> 4;<br/>    5 -> 7;<br/>    7 -> 6;<br/>}<br/><br/><br/>\u5f97\u5230\u7684\u7ed3\u679c\u662f\u8fd9\u6837\u7684\uff1a<br/><br/>\u4f3c\u4e4e\u5e76\u4e0d\u5c3d\u4eba\u610f\uff0c\u96be\u4ee5\u5206\u8fa8\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\u3002<br/>\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9876\u70b9\u7684\u65b9\u5411\u6765\u786e\u5b9a\u3002<br/>\u6bcf\u4e2a\u9876\u70b9\u6709\u516b\u4e2a\u65b9\u5411\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12digraph {<br/>    node [shape = circle];<br/><br/>    x :e -> e;<br/>    x :ne -> ne;<br/>    x :n-> n;<br/>    x :nw -> nw;<br/>    x :w -> w;<br/>    x :sw -> sw;<br/>    x :s -> s;<br/>    x :se -> se;<br/>}<br/><br/><br/>\u4e0b\u9762\u7684\u56fe\u7247\u5c55\u793a\u4e86\u9876\u70b9\u7684\u516b\u4e2a\u65b9\u54112(\u8fd9\u5f20\u56fe\u662f\u7528circo\u751f\u6210\u7684\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u4e00\u6837)\uff1a<br/><br/>\u8fd9\u4e9b\u65b9\u5411\u548c\u4e1c\u5357\u897f\u5317\u7684\u8868\u793a\u662f\u4e00\u6837\u7684\u3002<br/>\u521a\u624d\u6211\u4eec\u6307\u5b9a\u7684\u662f\u51fa\u53d1\u7684\u65b9\u5411\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u6307\u5b9a\u8fdb\u5165\u7684\u65b9\u5411\u3002<br/>\u56e0\u6b64\u6211\u4eec\u6765\u5c06\u5de6\u53f3\u513f\u5b50\u7684\u8fb9\u7684\u51fa\u53d1\u65b9\u5411\u4fee\u6539\u4e00\u4e0b\uff0c\u5de6\u5b69\u5b50\u51fa\u53d1\u65b9\u5411\u4e3a:sw\uff0c\u53f3\u5b69\u5b50\u7684\u51fa\u53d1\u65b9\u5411\u4e3a:se\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12digraph {<br/>    node [shape = circle];<br/><br/>    3:sw -> 2;<br/>    3:se -> 8;<br/>    2:sw -> 1;<br/>    8:sw -> 5;<br/>    8:se -> 9;<br/>    5:sw -> 4;<br/>    5:se -> 7;<br/>    7:sw -> 6;<br/>}<br/><br/><br/><br/>\u867d\u7136\u4e0d\u662f\u90a3\u4e48\u89c4\u6574\uff0c\u4f46\u662f\u8db3\u4ee5\u5206\u8fa8\u51fa\u5de6\u53f3\u513f\u5b50\u4e86\u3002<br/>\u5bf9\u4e8e\u6709\u4e9b\u6811\uff0c\u6211\u4eec\u4f1a\u8bb0\u5f55\u7236\u4eb2\u8282\u70b9\uff0c\u56e0\u6b64\u6211\u4eec\u52a0\u4e00\u6761\u6307\u5411\u7236\u4eb2\u7684\u8fb9\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20digraph {<br/>    node [shape = circle];<br/><br/>    3:sw -> 2;<br/>    2 -> 3;<br/>    3:se -> 8;<br/>    8 -> 3;<br/>    2:sw -> 1;<br/>    1 -> 2;<br/>    8:sw -> 5;<br/>    5 -> 8;<br/>    8:se -> 9;<br/>    9 -> 8;<br/>    5:sw -> 4;<br/>    4 -> 5;<br/>    5:se -> 7;<br/>    7 -> 5;<br/>    7:sw -> 6;<br/>    6 -> 7;<br/>}<br/><br/><br/>\u5f97\u5230\u7684\u6548\u679c\u662f\u8fd9\u6837\u7684\uff1a<br/><br/><br/>\u8bdd\u8bf4\u6211\u5206\u4e0d\u6e05\u54ea\u4e2a\u662f\u6307\u5411\u7236\u4eb2\u7684\u94fe\u63a5\u4e86\uff01\uff01\uff01<br/><br/>\u5443\u2026\u6ca1\u5173\u7cfb\uff0c\u6211\u4eec\u628a\u5de6\u53f3\u513f\u5b50\u7684\u94fe\u63a5\u52a0\u7c97\u5c31\u5206\u5f97\u6e05\u4e86\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20digraph {<br/>    node [shape = circle];<br/><br/>    3:sw -> 2 [style = bold];<br/>    2 -> 3;<br/>    3:se -> 8 [style = bold];<br/>    8 -> 3;<br/>    2:sw -> 1 [style = bold];<br/>    1 -> 2;<br/>    8:sw -> 5 [style = bold];<br/>    5 -> 8;<br/>    8:se -> 9 [style = bold];<br/>    9 -> 8;<br/>    5:sw -> 4 [style = bold];<br/>    4 -> 5;<br/>    5:se -> 7 [style = bold];<br/>    7 -> 5;<br/>    7:sw -> 6 [style = bold];<br/>    6 -> 7;<br/>}<br/><br/><br/><br/>\u4e0a\u9762\u662f\u5bf9\u8fb9\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5c06\u8fb9\u52a0\u7c97\u3002<br/><br/>\u6307\u5411\u533a\u522b\u80fd\u66f4\u660e\u663e\u4e9b\u5417\uff1f<br/><br/>\u5e72\u8106\u628a\u5b83\u505a\u6210\u865a\u7684\u5427\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20digraph {<br/>    node [shape = circle];<br/><br/>    3:sw -> 2 [style = bold];<br/>    2 -> 3 [style = dotted];<br/>    3:se -> 8 [style = bold];<br/>    8 -> 3 [style = dotted];<br/>    2:sw -> 1 [style = bold];<br/>    1 -> 2 [style = dotted];<br/>    8:sw -> 5 [style = bold];<br/>    5 -> 8 [style = dotted];<br/>    8:se -> 9 [style = bold];<br/>    9 -> 8 [style = dotted];<br/>    5:sw -> 4 [style = bold];<br/>    4 -> 5 [style = dotted];<br/>    5:se -> 7 [style = bold];<br/>    7 -> 5 [style = dotted];<br/>    7:sw -> 6 [style = bold];<br/>    6 -> 7 [style = dotted];<br/>}<br/><br/><br/><br/>\u50cf\u67d0\u4e9b\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u80fd\u4f1a\u6709Lazy\u6807\u8bb0\u4e4b\u7c7b\u7684\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u5bf9\u8282\u70b9\u4f5c\u7279\u6b8a\u6807\u8bb0\u6765\u6807\u660e\u3002<br/>\u8fd9\u5f53\u7136\u4e5f\u662f\u53ef\u4ee5\u5b9e\u73b0\u7684\uff0c\u53ea\u9700\u63d0\u524d\u58f0\u660e\u597d\u5373\u53ef\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23digraph {<br/>    node [shape = circle];<br/><br/>    3 [color = red];<br/>    5 [color = red];<br/><br/>    3:sw -> 2 [style = bold];<br/>    2 -> 3 [style = dotted];<br/>    3:se -> 8 [style = bold];<br/>    8 -> 3 [style = dotted];<br/>    2:sw -> 1 [style = bold];<br/>    1 -> 2 [style = dotted];<br/>    8:sw -> 5 [style = bold];<br/>    5 -> 8 [style = dotted];<br/>    8:se -> 9 [style = bold];<br/>    9 -> 8 [style = dotted];<br/>    5:sw -> 4 [style = bold];<br/>    4 -> 5 [style = dotted];<br/>    5:se -> 7 [style = bold];<br/>    7 -> 5 [style = dotted];<br/>    7:sw -> 6 [style = bold];<br/>    6 -> 7 [style = dotted];<br/>}<br/><br/><br/><br/>\u7528\u4e8e\u8c03\u8bd5<br/>\u7ecf\u8fc7\u4e0a\u9762\u7684\u7b80\u5355\u4ecb\u7ecd\uff0cGraphviz\u5df2\u7ecf\u53ef\u4ee5\u7528\u4e8e\u8c03\u8bd5\u4e86\u3002<br/>dot\u811a\u672c\u975e\u5e38\u7684\u4fbf\u4e8e\u7a0b\u5e8f\u751f\u6210\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u9014\u751f\u6210\u811a\u672c\uff0c\u7136\u540e\u4f7f\u7528dot\u5c06\u5176\u5904\u7406\u540e\u5e76\u5c55\u793a\u51fa\u6765\u3002<br/>\u5904\u7406\u7684\u4ee3\u7801\u5927\u81f4\u662f\u8fd9\u4e2a\u6837\u5b50\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8function SHOW(x):<br/>    buffer = \\ graph {\\ <br/><br/>    // \u8bfb\u53d6\u6570\u636e\u5e76\u751f\u6210dot\u811a\u672c<br/><br/>    buffer += \\ }\\ <br/>    write buffer to a dot file<br/>    SYSTEM \\ dot a.dot -Tsvg > a.svg && eog a.svg\\ <br/><br/><br/>\u5c0f\u7ed3<br/>Graphviz\u975e\u5e38\u5f3a\u5927\uff0c\u8fd9\u91cc\u53ea\u662f\u4ecb\u7ecd\u4e86\u4e00\u5c0f\u90e8\u5206\u529f\u80fd\uff0c\u5982\u60f3\u6df1\u5165\u5b66\u4e60\u53ef\u4ee5\u53c2\u89c1Graphviz\u5b98\u65b9\u6587\u6863\u6216\u8005Graphviz\u4e2d\u6587\u6559\u7a0b\u6307\u5357\u3002<br/>\u5229\u7528Graphviz\u6211\u4eec\u53ef\u4ee5\u5c06\u56fe\u8bba\u7b97\u6cd5\u3001\u6570\u636e\u7ed3\u6784\u7684\u8c03\u8bd5\u8fc7\u7a0b\u53ef\u89c6\u5316\uff0c\u4ece\u800c\u66f4\u52a0\u65b9\u4fbf\u6211\u4eec\u627e\u5230\u9519\u8bef\u6240\u5728\u3002<br/>\u5f53\u7136\uff0c\u53ef\u4ee5\u5229\u7528Graphviz\u8fdb\u884c\u5bf9\u7b97\u6cd5\u8fc7\u7a0b\u7684\u622a\u56fe\uff0c\u4ece\u800c\u751f\u6210\u6574\u4e2a\u7b97\u6cd5\u7684\u6d41\u7a0b\u3002<br/>\u5982\u679c\u4f60\u60f3\u5229\u7528Graphviz\u6765\u5236\u4f5c\u63d2\u56fe\uff0c\u90a3\u4e48\u81ea\u52a8\u5e03\u5c40\u5c31\u53ef\u80fd\u4e0d\u80fd\u4f7f\u4f60\u6ee1\u610f\u3002\u6b64\u65f6\u4e2a\u4eba\u63a8\u8350ProcessOn\u6216\u8005\u5176\u5b83\u7684\u6d41\u7a0b\u56fe\u5236\u4f5c\u8f6f\u4ef6\u6765\u7ed8\u5236\uff0c\u6548\u679c\u66f4\u597d\u3002<br/><br/><br/><br/><br/>\u7ef4\u57fa\u9875\u9762https://en.wikipedia.org/wiki/Domain-specific_language\u00a0\u21a9<br/><br/><br/>\u4e8b\u5b9e\u4e0a\uff0cGraphviz\u4e2d\u53ef\u4ee5\u5b9a\u4e49\u66f4\u52a0\u66f4\u52a0\u7cbe\u786e\u7684\u65b9\u5411\u3002\u4f46\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u51e0\u4e2a\u65b9\u5411\u8db3\u77e3\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-4-16/graphviz.html"
},
"HNSDFZ #3": {
"tags": "Contests",
"text": "<br/>HNSDFZ\u7b2c3\u6b21\u6b22\u4e50\u4e92\u6d4b<br/><br/><br/><br/><br/><br/>expression<br/>unstring<br/>gambler<br/>starcraft<br/><br/><br/><br/><br/>\u6e90\u6587\u4ef6<br/>expression.cpp<br/>unstring.cpp<br/>gambler.cpp<br/>starcraft.cpp<br/><br/><br/>\u8f93\u5165\u6587\u4ef6<br/>expression.in<br/>unstring.in<br/>gambler.in<br/>starcraft.in<br/><br/><br/>\u8f93\u51fa\u6587\u4ef6<br/>expression.out<br/>unstring.out<br/>gambler.out<br/>starcraft.out<br/><br/><br/>\u65f6\u95f4\u9650\u5236<br/>$1\\\\text{s}$<br/>$1\\\\text{s}$<br/>$1\\\\text{s}$<br/>$1\\\\text{s}$<br/><br/><br/>\u7a7a\u95f4\u9650\u5236<br/>$512\\\\text{MB}$<br/>$128\\\\text{MB}$<br/>$128\\\\text{MB}$<br/>$32\\\\text{MB}$<br/><br/><br/>\u9898\u76ee\u7c7b\u578b<br/>\u4f20\u7edf\u578b<br/>\u4f20\u7edf\u578b<br/>\u4f20\u7edf\u578b<br/>\u4f20\u7edf\u578b<br/><br/><br/>\u51fa\u9898\u4eba<br/>riteme<br/>Link<br/>ruanxingzhi<br/>Haogram<br/><br/><br/><br/><br/>\u62d2\u7eddPascal\u7a0b\u5e8f\u3002<br/>\u5bf9\u4e8eC\\\\C++\u7a0b\u5e8f\uff0c\u4f7f\u7528\u4ee5\u4e0b\u7684\u7f16\u8bd1\u547d\u4ee4\uff1a<br/>1g++ source.cpp -o exec -O2 -std=c++11<br/><br/><br/><br/>A. \u5bc6\u7801\u9501<br/>\u9898\u76ee\u63cf\u8ff0<br/>dyx\u5728\u5bb6\u91cc\u73a9\u800d\u65f6\u53d1\u73b0\u4e86\u4e00\u4e2a\u795e\u5947\u7684\u5bc6\u7801\u9501\u3002\u7136\u800c\u4ed6\u65e9\u5df2\u5fd8\u8bb0\u4e86\u8fd9\u4e2a\u9501\u7684\u5bc6\u7801\uff0c\u4e8e\u662f\u4ed6\u968f\u4fbf\u5c1d\u8bd5\u4e86\u4e00\u4e0b\uff0c\u7ed3\u679c\u9501\u5c31\u6253\u5f00\u4e86......<br/>\u9501\u7684\u5185\u90e8\u6709\u4e00\u4e2a\u5f88\u957f\u7684\u5b57\u7b26\u4e32\uff0c\u673a\u667a\u7684dyx\u9a6c\u4e0a\u5c31\u53d1\u73b0\u8fd9\u5c31\u662f\u5bc6\u7801\u9501\u7684\u6838\u5fc3\u3002\u4e8e\u662f\u4ed6\u7814\u7a76\u4e86\u4e00\u4e0b\u5348\uff0c\u63a2\u5bfb\u8fd9\u628a\u9501\u7684\u5965\u79d8\u3002<br/>\u4ed6\u53d1\u73b0\u8fd9\u4e2a\u5b57\u7b26\u4e32\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u5f62\u5f0f\uff0c\u50cf\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a<br/>1a|b&(!c^d)<br/><br/><br/>\u5176\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u7531\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u7684\u5355\u8bcd\u662f\u4e00\u4e2a\u53d8\u91cf\uff0c\u5bf9\u5e94\u7740\u5bc6\u7801\u9501\u4e0a\u7684\u4e00\u4e2a\u6309\u94ae\u3002\u7531\u4e8e\u6309\u94ae\u53ea\u80fd\u6309\u4e0b\u6216\u4e0d\u6309\u4e0b\uff0c\u4e8e\u662f\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u6bcf\u4e2a\u53d8\u91cf\u662f\u4e00\u4e2a\u5e03\u5c14\u7c7b\u578b\u7684\uff08\u5373\u53ea\u6709$\\\\text{true}$\u548c$\\\\text{false}$\u4e4b\u5206\uff09<br/>\u5176\u4f59\u7684\u5b57\u7b26\u5c31\u53ea\u6709&\u3001|\u3001^\u3001!\u548c\u5de6\u53f3\u5c0f\u62ec\u53f7\u3002dyx\u53d1\u73b0\u62ec\u53f7\u662f\u7528\u6765\u4f18\u5148\u8fd0\u7b97\u7684\uff0c\u610f\u601d\u662f\u8fd9\u662f\u4e00\u4e2a\u4f1a\u5c06\u6240\u6709\u53d8\u91cf\u8fdb\u884c\u8ba1\u7b97\u7684\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e14\u4f18\u5148\u8ba1\u7b97\u62ec\u53f7\u4e2d\u7684\u5b50\u8868\u8fbe\u5f0f\u3002\u540c\u65f6\uff0c&\u3001|\u3001^\u3001!\u90fd\u662f\u8fd0\u7b97\u7b26\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u7684\u662f\u903b\u8f91\u4e0e\u3001\u903b\u8f91\u6216\u3001\u903b\u8f91\u5f02\u6216\u548c\u903b\u8f91\u975e\u3002\u5176\u4e2d\u524d\u4e09\u8005\u8fd0\u7b97\u4f18\u5148\u7ea7\u4e00\u81f4\uff0c\u5f53\u5b83\u4eec\u5728\u540c\u4e00\u7ea7\u51fa\u73b0\u65f6\u4f1a\u4ece\u5de6\u81f3\u53f3\u8fd0\u7b97\uff0c\u903b\u8f91\u975e\u7684\u4f18\u5148\u7ea7\u6bd4\u5b83\u4eec\u9ad8\u3002\u5f53\u6bcf\u4e00\u4e2a\u53d8\u91cf\u90fd\u6709\u76f8\u5e94\u7684\u503c\u65f6\uff0c\u6574\u4e2a\u8868\u8fbe\u5f0f\u5c31\u4f1a\u5c31\u4f1a\u8fdb\u884c\u8ba1\u7b97\uff0c\u5e76\u7ed9\u51fa\u4e00\u4e2a\u5e03\u5c14\u503c\u3002dyx\u8fd8\u53d1\u73b0\uff0c\u5f53\u6574\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a$\\\\text{true}$\u65f6\uff0c\u5bc6\u7801\u9501\u5c31\u4f1a\u6253\u5f00\u3002<br/>\u5f88\u660e\u663e\uff0c\u6574\u4e2a\u5bc6\u7801\u9501\u7684\u8f93\u5165\u65b9\u6848\u5171\u6709$2^n$\u79cd\uff0c\u5176\u4e2d$n$\u662f\u8868\u8fbe\u5f0f\u4e2d\u53d8\u91cf\u7684\u6570\u91cf\u3002\u4e8e\u662fdyx\u77ac\u95f4\u660e\u767d\u4e3a\u4ec0\u4e48\u4ed6\u4e00\u6b21\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5bc6\u7801\u9501\u89e3\u5f00\u4e86\u3002\u7136\u800cdyx\u662f\u4e00\u4e2a\u52c7\u4e8e\u63a2\u7a76\u7684\u4eba\uff0c\u4ed6\u60f3\u77e5\u9053\u5230\u5e95\u6709\u591a\u5c11\u4e2d\u65b9\u6cd5\u53ef\u4ee5\u89e3\u5f00\u4e00\u4e2a\u5bc6\u7801\u9501\u3002<br/>\u4e0d\u77e5\u4e3a\u4f55\uff0cdyx\u53c8\u53d1\u73b0\u4e86\u4e00\u706b\u8f66\u7684\u5bc6\u7801\u9501\u3002\u575a\u6301\u4e0d\u61c8\u7684dyx\u4e0d\u505c\u7684\u8ba1\u7b97\u7740\u6bcf\u4e00\u4e2a\u5bc6\u7801\u9501\u80fd\u89e3\u5f00\u7684\u65b9\u6848\u6570......\u7531\u4e8e\u5bc6\u7801\u9501\u7684\u8868\u8fbe\u5f0f\u8d8a\u6765\u8d8a\u957f\u5e76\u4e14\u4eba\u8111\u8ba1\u7b97\u91cf\u662f$\\\\Theta(1)$\u7684\uff0cdyx\u4e0d\u5f97\u4e0d\u9700\u8981\u4e00\u4e2a\u7a0b\u5e8f\u6765\u5e2e\u52a9\u4ed6\u8ba1\u7b97\u8fd9\u4e2a\u65b9\u6848\u6570\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6bcf\u4e2a\u6d4b\u8bd5\u6570\u636e\u70b9\u6709\u591a\u4e2a\u8868\u8fbe\u5f0f\u3002\u6587\u4ef6\u4ee5EOF\u7ed3\u675f\u3002<br/>\u6bcf\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5360\u4e00\u884c\uff0c\u4e14\u4e2d\u95f4\u53ea\u6709\u5c0f\u5199\u5b57\u6bcd\u548c&\u3001|\u3001^\u3001!\u3001(\u3001)\u3002<br/>\u5bf9\u4e8e&\u3001|\u548c^\u8fd0\u7b97\uff0c\u5b83\u4eec\u5de6\u53f3\u4f1a\u5404\u6709\u4e00\u4e2a\u53d8\u91cf\u6216\u5b50\u8868\u8fbe\u5f0f\u3002\u5176\u8fd0\u7b97\u89c4\u5219\u5982\u4e0b\uff1a<br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ & $b$ ($a \\\\land b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/><br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ | $b$ ($a \\\\lor b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ ^ $b$ ($a \\\\oplus b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/>\u5bf9\u4e8e!\u8fd0\u7b97\uff0c\u5b83\u540e\u9762\u4f1a\u6709\u4e00\u4e2a\u53d8\u91cf\u6216\u5b50\u8868\u8fbe\u5f0f\u3002\u5176\u8fd0\u7b97\u89c4\u5219\u5982\u4e0b\uff1a<br/><br/><br/><br/>$a$<br/>!$a$ ($\\\\lnot a$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/><br/>\u8f93\u5165\u4fdd\u8bc1\u8868\u8fbe\u5f0f\u662f\u6709\u6548\u7684\uff0c\u4e14\u8868\u8fbe\u5f0f\u4e2d\u4e0d\u5b58\u5728\u7f3a\u5c11\u53c2\u6570\u7684\u8fd0\u7b97\u7b26\u548c\u7a7a\u7684\u62ec\u53f7\u3002<br/>\u4e3a\u4e86\u9632\u6b62\u6b64\u9898\u53d8\u6210\u4e0d\u53ef\u505a\u7684NP-hard\u95ee\u9898\uff0c\u8f93\u5165\u4fdd\u8bc1\u8868\u8fbe\u5f0f\u4e2d\u6bcf\u4e00\u4e2a\u53d8\u91cf\u540d\u53ea\u51fa\u73b0\u4e00\u6b21\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u8f93\u51fa\u80fd\u591f\u89e3\u5f00\u5b83\u7684\u65b9\u6848\u603b\u6570\u3002\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u8fc7\u5927\uff0c\u56e0\u6b64\u5c06\u7b54\u6848\u5bf9$10^9 + 7$\u53d6\u6a21\u540e\u8f93\u51fa\u3002<br/>\u4e00\u79cd\u65b9\u6848\u5373\u6307\u5bf9\u6bcf\u4e00\u4e2a\u53d8\u91cf\u7ed9\u5b9a\u4e00\u4e2a\u503c\u3002<br/>\u4e24\u79cd\u65b9\u6848\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u81f3\u5c11\u4e00\u4e2a\u53d8\u91cf\u6240\u7ed9\u5b9a\u7684\u503c\u4e0d\u540c\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3a&b<br/>a|b|c<br/>a|!(b|c)<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>31<br/>7<br/>5<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u53ea\u6709$a = \\\\text{true}, b = \\\\text{true}$\u624d\u4e3a$\\\\text{true}$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\uff0c\u53ea\u8981\u4e09\u8005\u6709\u4e00\u4e2a\u53d8\u91cf\u4e3a$\\\\text{true}$\u5c31\u662f$\\\\text{true}$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5148\u8fd0\u7b97b|c\uff0c\u7136\u540e\u5bf9\u5176\u53d6\u53cd\uff0c\u6700\u540e\u4e0e$a$\u505a\u903b\u8f91\u4e0e\u3002<br/>\u4ee5\u4e0b$n$\u8868\u793a\u53d8\u91cf\u6570\u91cf\uff0c$T$\u8868\u793a\u6d4b\u8bd5\u6570\u636e\u7ec4\u6570\uff0c$L$\u8868\u793a\u8868\u8fbe\u5f0f\u7684\u603b\u957f\u5ea6\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 10,\\\\; T = 15$\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u53ea\u6709\u903b\u8f91\u6216\u8fd0\u7b97\uff0c\u6ca1\u6709\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u903b\u8f91\u975e\u548c\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 500$\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c\u53d8\u91cf\u540d\u957f\u5ea6$\\\\le 4$\uff0c$L \\\\le 10^6$\uff0c$n \\\\le 3\\\\times10^5$\u3002<br/>\u5176\u4e2d$90\\\\% $\u7684\u6570\u636e\uff0c$T \\\\le 5$\u3002<br/><br/>B. UnString<br/>\u9898\u76ee\u63cf\u8ff0<br/>ZY\u5f88\u7d2f\u3002<br/>\u56e0\u4e3a\u6700\u8fd1\u5185\u7f51\u7684\u670d\u52a1\u5668\u5730\u5740\u603b\u662f\u6539\u6765\u6539\u53bb\u3002<br/>\u7136\u800cZY\u53c8\u975e\u5e38\u60f3\u53bb\u6363\u4e71\u3002\u4ed6\u5fc5\u987b\u77e5\u9053\u5185\u7f51\u7684\u670d\u52a1\u5668\u7684\u5730\u5740\u662f\u5565\u3002<br/>\u4f46\u662f\u9634\u9669\u7684Blue\u5374\u662f\u7ed9\u5730\u5740\u52a0\u4e86\u4e2a\u5bc6\uff0c\u8fd8TM\u7adf\u7136\u9690\u85cf\u4e86\u4e00\u4e9b\u5b57\u7b26\u3002<br/>\u4f46\u662fZY\u4e5f\u662f\u86ee\u673a\u667a\u7684\uff0c\u4ed6\u5f97\u5230\u4e86\u4e00\u6bb5\u88ab\u52a0\u5bc6\u7684\u5730\u5740<br/>\u8fd8\u6709Blue\u50bb\u903c\u4e22\u535a\u5ba2\u7684\u5b57\u7b26\u5bf9\u7167\u8868\uff0c\u5982\u679c\u5730\u5740\u548c\u535a\u5ba2\u7684\u5b57\u7b26\u5bf9\u7167\u8868\u76f8\u4f3c<br/>\u90a3\u4e48ZY\u5c31\u77e5\u9053\u4ed6\u5f97\u5230\u7684\u5730\u5740\u662f\u5bf9\u7684\uff0c\u867d\u7136\u4ed6\u4ecd\u7136\u4e0d\u80fd\u77e5\u9053\u5730\u5740\u662f\u5565\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2a\u5b57\u7b26\u4e32$S$\uff0c\u5b57\u7b26\u4e32$S$\u662f\u7531a-b\u7ec4\u6210\u7684\u5b57\u7b26\u4e32<br/>\u7b2c\u4e8c\u884c\u4e00\u4e2a\u5b57\u7b26\u4e32$C$\uff0c\u5b57\u7b26\u4e32$C$\u662f\u7531a-b\u548c?\u7ec4\u6210\u7684\u5b57\u7b26\u4e32<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u6211\u4eec\u5c06?\u8ba4\u4e3a\u662f\u4efb\u4f55\u5b57\u7b26\uff0c\u8be2\u95ee$C$\u662f\u5426\u662f$S$\u7684\u5b50\u4e32<br/>\u8f93\u51faYES\u6216\u8005NO<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2abc<br/>a?c<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1YES<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>$30\\\\% $ $S$\u957f\u5ea6\u5c0f\u4e8e$2000$\uff0c$C$\u957f\u5ea6\u5c0f\u4e8e$20$<br/>$60\\\\% $ $S$\u957f\u5ea6\u5c0f\u4e8e$100000$\uff0c$C$\u957f\u5ea6\u5c0f\u4e8e$500$<br/>$100\\\\% $ $S$\u957f\u5ea6\u4e0d\u8d85\u8fc7$200000$,$C$\u957f\u5ea6\u4e0d\u8d85\u8fc7$2000$<br/><br/>C. \u8d4c\u5f92<br/>\u9898\u76ee\u63cf\u8ff0<br/>HNSDFZ\u6709\u4e00\u5927\u6279\u8d4c\u5f92\u3002\u4ed6\u4eec\u5206\u5e03\u5728\u5316\u5b66\u7ec4\u3001\u751f\u7269\u7ec4\u3001\u673a\u623f\u2026\u2026\u8fd9\u4e9b\u8d4c\u573a\u6709\u9053\u8def\u76f8\u8fde\uff0c\u5f62\u6210\u4e00\u68f5\u6811\u7684\u7ed3\u6784\u3002<br/>\u8d4c\u573a\u91cc\u7684\u4eba\u8d8a\u6765\u8d8a\u591a\u3002\u5982\u679c\u8bb0\u67d0\u4e2a\u8d4c\u573a\u7b2c$n$\u5929\u7684\u4eba\u6570\u4e3a$F_n$\uff0c\u5219\u6709$F_n=2F_{n-2}+3F_{n-1}$\u3002\u6bcf\u4e2a\u8d4c\u573a\u7684$F_1$\u548c$F_2$\u662f\u9884\u5148\u77e5\u9053\u7684\u3002\u5f53\u7136\uff0c\u8d4c\u5f92\u7684\u6570\u91cf\u4e0d\u80fd\u592a\u591a\u3002\u6bcf\u4e2a\u8d4c\u573a\u90fd\u4f1a\u4e0d\u505c\u5730\u6e05\u7406\u4eba\u5458\uff0c\u505a\u6cd5\u662f\u628a\u6bcf\u5929\u7684\u4eba\u6570\u6a21$2333$\u3002<br/>\u73b0\u5728\u662f\u7b2c$m$\u5929\uff0c3\u73ed\u7684\u67d0\u4e2a\u82f1\u8bed\u8001\u5e08\u8981\u6253\u51fb\u8d4c\u5f92\u3002\u5979\u51c6\u5907\u6253\u51fb\u4e00\u6761\u94fe\u4e0a\u7684\u6240\u6709\u8d4c\u5f92\u3002\u4f46\u662f\u5979\u5e76\u4e0d\u77e5\u9053\u81ea\u5df1\u6700\u591a\u80fd\u6253\u5230\u591a\u5c11\u4e2a\u8d4c\u5f92\uff0c\u6240\u4ee5\u628a\u4f60\u6346\u8fc7\u6765\u7b97\u4e00\u7b97\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570\uff0c$n$\u8868\u793a\u8d4c\u573a\u4e2a\u6570\uff0c$m$\u8868\u793a\u5728\u7b2c\u51e0\u5929\u52a8\u624b\u3002<br/>\u63a5\u4e0b\u6765$n$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570$F_1,F_2$\u3002<br/>\u63a5\u4e0b\u6765$n-1$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570$u,v$\u8868\u793a$u$\u548c$v$\u6709\u8fb9\u76f8\u8fde\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4e00\u884c\uff0c\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u8868\u793a\u80fd\u6253\u51fb\u5230\u7684\u8d4c\u5f92\u4e2a\u6570\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>115 1<br/>1 1<br/>1 1<br/>1 1<br/>1 1<br/>1 1<br/><br/>1 2<br/>1 3<br/>2 4<br/>2 5<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>14<br/><br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u8f93\u5165\u6570\u636e\u4e2d\uff1a<br/>\u5728\u7b2c\u4e00\u5929\uff0c\u6240\u6709\u7684\u8d4c\u573a\u90fd\u53ea\u67091\u4e2a\u4eba\u3002<br/>\u5728\u8fd9\u65f6\u6253\u51fb\uff0c\u6700\u591a\u80fd\u6253\u51fb\u52304\u4e2a\u4eba\u3002\u8fd9\u6761\u94fe\u662f$4-2-1-3$\u3002<br/>$n \\\\le 5 \\\\times 10^5$, $m \\\\le 2\\\\times 10^9$<br/><br/>D. \u661f\u9645\u4e89\u9738<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u867d\u7136\u4e8c\u5341\u4e16\u7eaa\u7684\u79d1\u6280\u548c\u6587\u5316\u8fdb\u6b65\u795e\u901f\uff0c\u4f46\u662f\u548c\u5f8c\u4e16\u79d1\u6280\u548c\u6587\u660e\u7684\u8df3\u8dc3\u5f0f\u8fdb\u6b65\u76f8\u6bd4\u8d77\u6765\uff0c \u4e5f\u53ea\u80fd\u7518\u62dc\u4e0b\u98ce\u3002\u5728\u4e8c\u5341\u4e00\u4e16\u7eaa\u7684\u672b\uff0c\u4eba\u7c7b\u7684\u6587\u660e\u7ecf\u5386\u4e86\u5de8\u5927\u800c\u4e14\u96be\u4ee5\u60f3\u50cf\u7684\u8fdb\u6b65\u3002\u5d2d\u65b0\u7684\u79d1\u6280\u4ee5\u96be\u4ee5\u60f3\u50cf\u7684\u901f\u5ea6\u7a9c\u8d77\uff0c\u5373\u4f7f\u662f\u5730\u7403\u4e0a\u6700\u4e3a\u843d\u5f8c\u7684\u56fd\u5bb6\u4e5f\u5f00\u59cb\u62e5\u6709\u8d8a\u6765\u8d8a\u5148\u8fdb\u7684\u7535\u8111\u548c\u8d44\u6599\u5e93\u3002\u5728\u4e1c\u6b27\u5171\u4ea7\u4e3b\u4e49\u89e3\u4f53\u7684\u540c\u65f6\uff0c\u6838\u5b50\u6b66\u5668\u5f00\u59cb\u53d8\u5f97\u968f\u624b\u53ef\u5f97\u3002\u539f\u6765\u56fd\u9645\u52bf\u529b\u7684\u5174\u8870\u662f\u4ee5\u8d44\u4ea7\u548c\u519b\u4e8b\u5f3a\u6743\u6765\u4f5c\u4e3a\u4f9d\u636e\uff0c\u7b2c\u4e09\u4e16\u754c\u7684\u56fd\u5bb6\u5374\u5229\u7528\u8fd9\u4e2a\u673a\u4f1a\u731b\u7136\u7a9c\u8d77\uff0c\u6311\u6218\u8fd9\u4e9b\u5f3a\u6743\uff0c\u6253\u7834\u56fd\u9645\u95f4\u5c40\u52bf\u7684\u5747\u8861\u3002 <br/>\u5f53\u7cfb\u7edf\u63a7\u5de5\u5b66\u3001\u590d\u5236\u548c\u57fa\u56e0\u5de5\u7a0b\u53d8\u6210\u4eba\u4eba\u7686\u53ef\u638c\u63e1\u7684\u79d1\u6280\u4e4b\u5f8c\uff0c\u6fc0\u8fdb\u4eba\u9053\u4e3b\u4e49\u8005\u548c\u72c2\u70ed\u7684\u5b97\u6559\u56e2\u4f53\u5f00\u59cb\u8d28\u7591\u79c1\u4eba\u516c\u53f8\u4ee5\u57fa\u56e0\u5de5\u7a0b\u56fe\u5229\u7684\u6b63\u5f53\u6027\u3002\u5927\u4f17\u5f00\u59cb\u7eb7\u7eb7\u88c5\u7f6e\u7531\u7cbe\u5bc6\u5de5\u5b66\u6240\u7814\u5236\u51fa\u6765\u7684\u4eba\u5de5\u5668\u5b98\uff0c\u5176\u4ed6\u4eba\u5219\u5f00\u59cb\u663e\u73b0\u51fa\u5404\u79cd\u5404\u6837\u7684\u57fa\u56e0\u7a81\u53d8\u6027\u72b6\uff0c\u5305\u62ec\u4e86\u8f83\u4e3a\u9690\u6027\u7684\u5668\u5b98\u53d8\u5f97\u654f\u9510\uff0c\u5230\u660e\u663e\u7684\u5fc3\u7075\u611f\u5e94\u3002\u4eba\u7c7b\u57fa\u56e0\u5e93\u4e2d\u6240\u4ea7\u751f\u7684\u8fd9\u4e9b\u53d8\u5316\uff0c\u8ba9\u5168\u7403\u5404\u5730\u7684\u4eba\u672c\u4e3b\u4e49\u8005\u611f\u5230\u975e\u5e38\u7684\u6050\u614c\u3002 <br/>\u79d1\u6280\u7ee7\u7eed\u8fdb\u6b65\u53ca\u6269\u5f20\uff0c\u4eba\u53e3\u589e\u52a0\u7684\u901f\u5ea6\u4e5f\u5f00\u59cb\u98d9\u5347\u3002\u5728\u4e8c\u5341\u4e16\u7eaa\u7ed3\u675f\u7684\u65f6\u5019\uff0c\u5730\u7403\u4e0a\u6709 \u516d\u5341\u4ebf\u7684\u4eba\u53e3\u3002\u4ec5\u4ec5\u7ecf\u8fc7\u77ed\u77ed\u7684\u4e09\u767e\u5e74\uff0c\u4eba\u53e3\u66b4\u589e\u4e3a\u4e24\u767e\u4e09\u5341\u4ebf\u3002\u6c61\u67d3\u548c\u81ea\u7136\u8d44\u6e90\u3001\u71c3\u6599\u7684\u8017\u7aed\u66f4\u662f\u706b\u4e0a\u52a0\u6cb9\u3002\u5404\u4e2a\u56fd\u5bb6\u83ab\u4e0d\u7aed\u529b\u5bfb\u627e\u964d\u4f4e\u4eba\u53e3\u6210\u957f\u7387\u7684\u65b9\u6cd5\u3002\u5728\u4eba\u53e3\u7206\u70b8\u3001\u57fa\u56e0\u7a81\u53d8\u6a2a\u626b\u6574\u4e2a\u5730\u7403\u7684\u540c\u65f6\uff0c\u4e00\u822c\u4eba\u90fd\u8ba4\u4e3a\u5730\u7403\u5c06\u56e0\u6b64\u800c\u8d70\u5411\u5929\u707e\u5730\u53d8\u7684\u7ed3\u5c40\u3002<br/>\u4e8e\u662f\u4eba\u7c7b\u9020\u51fa\u4e00\u8258\u661f\u9645\u5de8\u8230\uff0c\u5728\u64ce\u5929\u795e\u7684\u9886\u5bfc\u4e0b\uff0c\u98de\u5f80\u65e0\u8fb9\u7684\u592a\u7a7a......<br/>\u6700\u5f8c\uff0c\u5176\u4e2d\u4e00\u8258\u7684\u822a\u8230\u5f15\u64ce\u878d\u6bc1\u4e86\u3002\u5728\u7ecf\u8fc7\u4e8c\u5341\u516b\u5e74\u7684\u66f2\u901f\u65c5\u884c\u4e4b\u5f8c\uff0c\u8fd9\u4e9b\u5de8\u5927\u7684\u8239\u53ea\u91cd\u65b0\u51fa\u73b0\u5728\u4e09\u5ea6\u7a7a\u95f4\u4e2d\uff0c\u9760\u8fd1\u4e00\u4e2a\u53ef\u5c45\u4f4f\u661f\u7cfb\u7684\u5916\u7f18\u3002\u8fd9\u91cc\u8ddd\u79bb\u5730\u7403\u516d\u4e07\u5149\u5e74\u4e4b\u8fdc\uff0c\u4ed6\u4eec\u7684\u66f2\u901f\u5f15\u64ce\u5168\u6bc1\uff0c\u751f\u547d\u7ef4\u6301\u7684\u7cfb\u7edf\u51e0\u4e4e\u5df2\u7ecf\u8017\u7aed\u3002\u6240\u6709\u7684\u8239\u53ea\u53ea\u6709\u8fdb\u5165\u7d27\u6025\u72b6\u51b5\uff0c\u51c6\u5907\u8feb\u964d\u5728\u6700\u63a5\u8fd1\u7684\u53ef\u5c45\u4f4f\u884c\u661f\u4e0a\u3002<br/>\u6bcf\u4e2a\u884c\u661f\u7684\u5c45\u6c11\u52aa\u529b\u7684\u8bd5\u56fe\u5728\u88ab\u79f0\u4e3a\u300e\u65b0\u4e16\u754c\u300f\u7684\u661f\u7403\u4e0a\u751f\u5b58\u3002\u4ed6\u4eec\u5e76\u4e0d\u77e5\u9053\u8fd8\u6709\u5176\u5b83\u7684\u540c\u7c7b\u6323\u624e\u8457\u5728\u522b\u7684\u5730\u65b9\u6c42\u751f\u5b58\uff0c\u53ea\u80fd\u591f\u52aa\u529b\u7684\u5229\u7528\u624b\u8fb9\u7684\u8d44\u6e90\u6d3b\u4e0b\u53bb\u3002<br/>\u7136\u800c\uff0cZerg\u548cProtoss\u7684\u5175\u529b\u6b63\u8fdb\u653b\u8fc7\u6765\uff0c\u80fd\u5426\u6d3b\u4e0b\u8fd8\u662f\u4e2a\u95ee\u9898......<br/>\u4f5c\u4e3a\u91c7\u77ff\u7684\u5de5\u5177\uff0c\u7a7a\u95f4\u5efa\u7b51\u5de5\u7a0b\u8f66 (Space Constrution Vehicle)\uff0c\u7b80\u79f0SCV\uff0c\u5b83\u4eec\u7684\u591a\u6837\u6027\u548c\u65e0\u4ee5\u6bd4\u62df\u7684\u53ef\u9760\u6027\u4f7f\u5f97\u5b83\u4eec\u6210\u4e3a\u4e00\u79cd\u6781\u6709\u4ef7\u503c\u7684\u5efa\u7b51\u5de5\u5177\u3002<br/>\u91c7\u77ff\u7684\u6d41\u7a0b\u5982\u4e0b\uff0c\u7136\u800c\u56fe\u4e0d\u80fd\u52a8\u3002<br/><br/>SCV\u4ece\u6307\u6325\u4e2d\u5fc3 (Command Center) \u51fa\u53d1\uff0c\u79fb\u52a8\u81f3\u6c34\u6676\u77ff\u5904\u5f00\u91c7\u77ff\u7269\uff0c\u4e3a\u4e86\u7b80\u5316\u95ee\u9898\uff0c\u8bbe\u5b9a\u4e3a\u91c7\u77ff\u4e0d\u9700\u8981\u65f6\u95f4\u3002\u91c7\u5b8c\u77ff\u540e\u9700\u8981\u8fd4\u56de\u6307\u6325\u4e2d\u5fc3\u5c06\u77ff\u7269\u9001\u56de\uff0c\u5426\u5219\u4e0d\u80fd\u7b97\u91c7\u5230\u4e86\u77ff\u7269\u3002\u56fe\u7247\u91cc\u65e2\u6709\u6b63\u5728\u91c7\u77ff\u7684\u4e5f\u6709\u624d\u5b8c\u4e86\u77ff\u5e26\u7740\u77ff\u56de\u6307\u6325\u4e2d\u5fc3\u7684\u3002<br/>\u56e0\u4e3a\u5730\u9762\u73af\u5883\u590d\u6742\uff0c\u6240\u4ee5SCV\u6240\u8d70\u7684\u8def\u7ebf\u4e0d\u4e00\u5b9a\u662f\u7b14\u76f4\u7684\uff0c\u800c\u662f\u66f2\u6298\u7684\uff0c\u518d\u6b21\u4f60\u53ef\u4ee5\u5c06\u5176\u7406\u89e3\u4e3a\u4ee5\u6307\u6325\u4e2d\u5fc3\u4e3a\u6839\u7684\u4e00\u9897\u6709\u6839\u6811\uff0c\u800c\u6c34\u6676\u77ff\u5904\u4e8e\u8be5\u6709\u6839\u6811\u7684\u53f6\u5b50\u8282\u70b9\u5904\u3002\u6709\u6839\u6811\u7684\u6bcf\u4e00\u6761\u8fb9\u90fd\u6709\u8ddd\u79bb\uff0c\u957f\u5ea6\u5355\u4f4d\u4e3a\u5b87\u5b99\u5355\u4f4d\u3002\u5b9a\u4e49SCV\u901f\u5ea6\u4e3a 1 \u5b87\u5b99\u5355\u4f4d/s\u3002\u4e3a\u7b80\u5316\u95ee\u9898\uff0cSCV\u4e00\u6b21\u91c7\u77ff\u53ef\u4ee5\u5c06\u8be5\u6c34\u6676\u77ff\u91c7\u5b8c\u3002<br/>\u6709\u65f6\u4f1a\u6709\u4e00\u4e9b\u5b87\u5b99\u751f\u7269\uff08\u6bd4\u5982\u5361\u62c9\u517d\uff09\u4f1a\u722c\u884c\u81f3\u91c7\u77ff\u8def\u5f84\u4e0a\u7684\u4e00\u4e9b\u70b9\u5bfc\u81f4\u8be5\u8def\u5f84\u4e0d\u901a\u3002\u589e\u52a0\u91c7\u77ff\u96be\u5ea6\u3002\u51fa\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u5730\u56fe\u4f1a\u4e0d\u65ad\u66f4\u65b0\uff0c\u77ff\u7269\u5c31\u4f1a\u6062\u590d\u539f\u72b6\uff0c\u5361\u62c9\u517d\u4e5f\u4f1a\u88ab\u66f4\u65b0\u81f3\u4e00\u4e2a\u65b0\u7684\u8282\u70b9\u3002<br/>Zerg\u548cProtoss\u7684\u8fdb\u653b\u5df2\u7ecf\u5f88\u8fd1\u4e86\uff0c\u4f60\u9700\u8981\u5c3d\u5feb\u91c7\u66f4\u591a\u7684\u8d44\u6e90......<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u6709$2$\u4e2a\u6b63\u6574\u6570$n$\uff0c$m$\uff0c\u8868\u793a\u56fe\u4e0a\u6709$n$\u4e2a\u70b9\uff0c\u5730\u56fe\u66f4\u65b0$m$\u6b21\u3002<br/>\u63a5\u4e0b\u6765$n-1$\u884c\uff0c\u6bcf\u884c$3$\u4e2a\u6b63\u6574\u6570$p$\uff0c$f$\uff0c$l$\uff0c\u4ee3\u8868\u63cf\u8ff0\u7b2c$p$\u4e2a\u70b9\uff0c\u5176\u7236\u8282\u70b9\u4e3a$f$\uff0c\u4e0e\u7236\u8282\u70b9\u7684\u8fde\u8fb9\u957f\u4e3a$l$\u3002<br/>\u63a5\u4e0b\u6765$x$\u884c\uff0c\u6709$2$\u4e2a\u6b63\u6574\u6570$p$\uff0c$w$\uff0c\u8868\u793a\u7b2c$p$\u53f7\u8282\u70b9\u6709$w$\u6c34\u6676\u77ff\u3002$x$\u4e3a\u53f6\u8282\u70b9\u4e2a\u6570\u3002<br/>\u63a5\u4e0b\u6765$m$\u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6b63\u6574\u6570$p$\uff0c$t$\uff0c\u8868\u793a\u5730\u56fe\u66f4\u65b0\u540e\uff0c\u6709\u4e00\u53ea\u5361\u62c9\u517d\u5728$p$\u53f7\u8282\u70b9\u4f4d\u7f6e\u4e0a\uff0cZerg\u548cProtoss\u7684\u8fdb\u653b\u5c06\u5728$t$\u79d2\u540e\u6765\u4e34\u3002\u5982\u679c$p$\u4e3a$0$\uff0c\u8868\u793a\u6ca1\u6709\u5361\u62c9\u517d\u5728\u5730\u56fe\u4e0a\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5730\u56fe\u6bcf\u6b21\u66f4\u65b0\u4f1a\u5c06\u91c7\u5b8c\u7684\u77ff\u56de\u590d\u539f\u72b6\u3002<br/>\u8f93\u51fa\u5171$m$\u884c\uff0c\u6bcf\u884c\u5bf9\u4e8e\u4e00\u6b21\u5730\u56fe\u66f4\u65b0\uff0c\u8f93\u51fa\u5728\u8fdb\u653b\u6765\u4e34\u524d\u91c7\u96c6\u5230\u7684\u6700\u591a\u77ff\u7269\u6570\u91cf\u3002<br/>\u6837\u4f8b\u8f93\u51651<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>83 3<br/>2 1 35<br/>3 1 24<br/>2 100<br/>3 65<br/>0 60<br/>1 23<br/>3 33<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa1<br/>1<br/>2<br/>365<br/>0<br/>0<br/><br/><br/><br/>\u6837\u4f8b\u8f93\u51652<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>189 4<br/>2 1 8<br/>3 1 10<br/>5 2 25<br/>6 2 13<br/>7 3 22<br/>4 1 26<br/>8 4 12<br/>9 4 23<br/>5 78<br/>6 66<br/>7 48<br/>8 50<br/>9 80<br/>0 257<br/>3 200<br/>2 230<br/>1 500<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa2<br/>1<br/>2<br/>3<br/>4242<br/>194<br/>130<br/>0<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 20, m \\\\le 5$<br/>\u5bf9\u4e8e$20\\\\% $\u7684\u6570\u636e: $n \\\\le 20, m \\\\le 500$<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c\u5730\u56fe\u6ca1\u6709\u5361\u62c9\u517d<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 1000, m \\\\le 50$<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 1000, m \\\\le 500, t \\\\le 50000$<br/>\u6307\u6325\u4e2d\u5fc3\u7684\u7f16\u53f7\u59cb\u7ec8\u4e3a$1$\uff0c\u5730\u56fe\u81f3\u591a\u6709\u4e00\u53ea\u5361\u62c9\u517d",
"url": "blog/2016-7-1/hnsdfz-3.html"
},
"HNSDFZ2016 #1": {
"tags": "HNSDFZ \u4e92\u6d4b 2016",
"text": "HNSDFZ2016 #1<br/>A. ZY\u7684\u94bb\u77f3\u6811 (Link)<br/>\u65f6\u95f4\u9650\u5236: 1s / \u5185\u5b58\u9650\u5236: 250MB<br/>\u9898\u76ee\u63cf\u8ff0<br/>ZY\u662f\u4e00\u4e2a\u5f88\u795e\u7684\u5b69\u5b50\uff0c\u5bf9\u4e8e\u4ed6\u6765\u8bf4\u4e00\u5207\u90fd\u662fO(1)\u7684\u3002 <br/>ZY\u4e5f\u662f\u4e00\u4e2a\u5f88\u559c\u6b22\u73a9MC\u7684\u5b69\u5b50\u3002 <br/>\u8fd9\u5929\uff0cZY\u767b\u9646\u4e86\u4ed6\u7684MC\uff0c\u4ed6\u53d1\u73b0\u4ed6\u5bb6\u4e0d\u77e5\u9053\u88ab\u54ea\u4e2a\u718a\u5b69\u5b50\u7cdf\u8e4b\u4e86\u3002 <br/>\u4ed6\u7684\u5bb6\u53d8\u6210\u4e86\u4e00\u9897\u6709N\u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6bcf\u4e2a\u6811\u90fd\u6709\u4e00\u79cd\u94bb\u77f3\u5757(\u79cd\u7c7b\u662f1-1000000\u7684\u6574\u6570\u8868\u793a)\u3002 <br/>\u5947\u602a\u7684\u662f\uff0c\u540c\u79cd\u7684\u94bb\u77f3\u5757ZY\u53ea\u80fd\u62ff\u4e00\u4e2a\u3002 <br/>\u66f4\u52a0\u5947\u602a\u7684\u662f\uff0c\u4e0d\u540c\u65f6\u523b\u67d0\u4e9b\u94bb\u77f3\u5757\u8fd8\u4f1a\u6539\u53d8\u81ea\u5df1\u7684\u79cd\u7c7b\u3002 <br/>ZY\u56e0\u6b64\u60f3\u77e5\u9053\uff0c\u4ee5\u67d0\u4e2a\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u94bb\u77f3\u5757 <br/>1\u53f7\u8282\u70b9\u4e3a\u6811\u7684\u6839 <br/>\u4e24\u79cd\u64cd\u4f5c\uff1a <br/>1 x \u8be2\u95eex\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u94bb\u77f3\u5757 <br/>0 x val \u4fee\u6539x\u8282\u70b9\u7684\u94bb\u77f3\u5757\u79cd\u7c7b\u4e3aval<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884cN\uff0c\u4ee3\u8868\u6811\u7684\u8282\u70b9\u6570 \u7b2c\u4e8c\u884cN\u4e2a\u6570\uff0c\u4ee3\u8868\u6bcf\u4e2a\u8282\u70b9\u7684\u94bb\u77f3\u5757\u79cd\u7c7b \u7136\u540eN-1\u884c\u4ee3\u8868\u54ea\u4e24\u4e2a\u70b9\u8fde\u63a5 \u4e00\u884cM\u4ee3\u8868\u64cd\u4f5c\u6570 \u4e4b\u540eM\u884c\u4ee3\u8868\u64cd\u4f5c<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u8f93\u51fa\u5176\u7b54\u6848<br/>\u6837\u4f8b\u8f93\u5165<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>197<br/>1 2 3 4 5 6 7<br/>1 2 <br/>1 7 <br/>2 3 <br/>2 6 <br/>3 4 <br/>3 5 <br/>10<br/>1 5 <br/>0 7 22<br/>1 2 <br/>0 6 10 <br/>0 4 2 <br/>0 4 45 <br/>1 5 <br/>1 2 <br/>0 2 12 <br/>1 1 <br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>3<br/>4<br/>51<br/>5<br/>1<br/>5<br/>7<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>m,n<=100000<br/>B. ZY\u7684\u6838\u7535\u7ad9 (riteme)<br/>\u65f6\u95f4\u9650\u5236: 5 s / \u5185\u5b58\u9650\u5236: 256 MB / \u6253\u5f00O2\u4f18\u5316<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>\u201cZY\u559c\u6b22\u73a9\u6838\u7535\u7ad9\u3002\u201d<br/><br/>ZY\u7684\u6838\u7535\u7ad9\u975e\u5e38\u7279\u6b8a\u3002\u65e9\u57282038\u5e74\uff0cZY\u5c31\u53d1\u73b0\u4e86\u9ad8\u5206\u5b50\u6709\u673a\u7269\u7684\u5b8c\u5168\u88c2\u89e3\u53ef\u4ee5\u91ca\u653e\u5927\u91cf\u7684\u6838\u80fd\u7684\u539f\u7406\uff08\u8fd9\u53e5\u8bdd\u7eaf\u5c5eFP\uff09\u3002\u56e0\u6b64ZY\u7684\u6838\u7535\u7ad9\u53cd\u5e94\u5806\u91cc\u9762\u5168\u662f\u9ad8\u5206\u5b50\u6709\u673a\u7269\uff0c\u53ef\u60dc\u53ea\u6709\u4e00\u4e2a\u3002<br/>\u4e3a\u4e86\u4f7f\u53d1\u7535\u91cf\u5c3d\u53ef\u80fd\u5927\uff0cZY\u627e\u5230\u4e86\u4e00\u79cd\u80fd\u4f7f\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u7684\u65b9\u5f0f\uff0c\u4f7f\u91ca\u653e\u51fa\u6765\u7684\u80fd\u91cf\u6700\u5927\u3002\u7531\u4e8e\u8fd9\u662fZY\u7684\u6709\u673a\u7269\uff0c\u56e0\u6b64\u88c2\u89e3\u65b9\u5f0f\u4e5f\u975e\u5e38\u5947\u8469\u3002\u4e0b\u9762\u662fZY\u57282039\u5e74\u7684\u8bba\u6587\u300a\u8bbaZY\u5bf9MC1\u6838\u7535\u7ad9\u7684\u5de8\u5927\u8d21\u732e\u300b\u4e2d\u7684\u8282\u9009\u7247\u6bb5\uff1a<br/><br/>......<br/>\u6211\u4eec\u7684\u6709\u673a\u7269\u662f\u7531$n$\u4e2a\u5404\u79cd\u539f\u5b50\u6784\u6210\u7684\uff0c\u539f\u5b50\u4e4b\u95f4\u901a\u8fc7\u4e0d\u540c\u7684\u5171\u4ef7\u952e\u76f8\u8fde\u3002<br/><br/>($\\\\text{H}$\u592a\u591a\u4e86\uff0c\u5230\u65f6\u5019\u8fd9\u4e9b\u6ca1\u7528\u7684\u6c22\u539f\u5b50\u90fd\u4f1a\u88abZY\u4e22\u6389)<br/>......<br/>\u4e3a\u4e86\u65b9\u4fbf\u8fdb\u884c\u88c2\u89e3\uff0c\u8fd9\u4e2a\u6709\u673a\u7269\u662f\u6ca1\u6709\u73af\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8282\u7ea6\u6210\u672c\u6765\u4e70**V*P***......<br/>......<br/>\u6bcf\u6b21\u88c2\u89e3\u90fd\u4f1a\u65ad\u5f00\u4e00\u4e2a\u5171\u4ef7\u952e\uff0c\u6b64\u65f6\u8fd9\u4e2a\u6709\u673a\u7269\u4f1a\u5206\u4e3a\u4e24\u90e8\u5206\u3002\u5e76\u4e14\u91ca\u653e\u5927\u91cf\u7684\u80fd\u91cf......<br/>\u8bbe\u653e\u51fa\u7684\u80fd\u91cf\u4e3a$E$\uff0c\u6709\u673a\u7269\u88c2\u89e3\u540e\u7684\u4e24\u90e8\u5206\u7684\u5171\u4ef7\u952e\u7684\u96c6\u5408\u5206\u522b\u4e3a$A$\u548c$B$\uff0c\u5219\uff1a\u3001<br/>$$ E = \\\\sum_{a\\\\in A} a.\\\\text{energy} \\\\cdot \\\\sum_{b\\\\in B} b.\\\\text{energy} \\\\tag{ZY's energy theorem}$$<br/>\u5176\u4e2d$\\\\text{energy}$\u8868\u793a\u5171\u4ef7\u952e\u7684\u80fd\u91cf\u3002<br/>......<br/>\u4e3a\u4e86\u5145\u5206\u5229\u7528\u6709\u673a\u7269\u4e2d\u7684\u80fd\u91cf\uff0c\u6bcf\u88c2\u89e3\u4e00\u4e2a\u5171\u4ef7\u952e\u540e\uff0c\u6211\u4eec\u6709\u529e\u6cd5\u65e0\u635f\u8017\u65e0\u6210\u672c\u7684\u5c06\u5176\u8fd8\u539f\uff0c\u5373\u6709\u673a\u7269\u4f1a\u53d8\u5f97\u548c\u88c2\u89e3\u524d\u4e00\u6837\u3002\u4f46\u662f\u51fa\u4e8e\u79cd\u79cd\u539f\u56e0\uff0c\u8fd9\u4e2a\u5171\u4ef7\u952e\u5c31\u4e0d\u80fd\u518d\u6b21\u8fdb\u884c\u88c2\u89e3\u4e86\u3002\u9664\u975eZY\u53d1\u51faSB\u4e4b\u795e\u529b\u6765\u4f7f\u6240\u6709\u7684\u5171\u4ef7\u952e\u590d\u6d3b......<br/>......<br/>\u90a3\u4e48\uff0c\u4e00\u4e2a\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u6240\u80fd\u653e\u51fa\u7684\u80fd\u91cf\u4e3a\u6240\u6709\u5171\u4ef7\u952e\u88c2\u89e3\u4e00\u6b21\u540e\u6240\u653e\u51fa\u7684\u80fd\u91cf\u4e4b\u548c\u3002<br/>......<br/><br/>(\u5b9e\u9645\u4e0a\uff0cZY\u7684\u8fd9\u7bc7\u8bba\u6587\u957f\u8fbe$2147483647$\u5b57)<br/>\u5f53\u7136\uff0cZY\u7684\u667a\u5546\u7406\u8bba\u4e0a\u4e3a$-\\\\infty$\u3002\u56e0\u6b64\u5b83\u7684\u6838\u7535\u7ad9\u5176\u5b9e\u975e\u5e38\u8fa3\u9e21\u3002\u53cd\u5e94\u5806\u4e2d\u7684\u6709\u673a\u7269\u4e0d\u4e00\u5b9a\u662f\u7a33\u5b9a\u7684\uff0c\u4f46\u662fZY\u5229\u7528LCT\u7b97\u6cd5\u4ee5$O(\\\\infty!)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6210\u529f\u5730\u4fdd\u8bc1\u4e86\u6709\u673a\u7269\u7684\u7ed3\u6784\uff0c\u8fd9\u6837\u5c31\u65b9\u4fbfZY\u53d1\u51faSB\u4e4b\u795e\u529b\u3002\u4f46\u662f\u4ee4ZY\u60f3\u8df3\u697c\u7684\u662f\uff0c\u603b\u6709\u4e00\u4e2a\u5171\u4ef7\u952e\u7684\u80fd\u91cf\u5728\u7ef4\u62a4\u6709\u673a\u7269\u7ed3\u6784\u65f6\u4f1a\u53d8\u52a8\u3002\u7136\u800c\u201d\u673a\u667a\u201d\u7684ZY\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e9b\u53d8\u5316\u3002<br/>ZY\u53ea\u5e0c\u671b\u80fd\u591f\u5feb\u901f\u7b97\u51fa\u5f53\u524d\u7684\u6709\u673a\u7269\u901a\u8fc7\u5b8c\u5168\u88c2\u89e3\u7a76\u7adf\u80fd\u653e\u51fa\u591a\u5c11\u80fd\u91cf\u3002\u7531\u4e8eZY\u7684\u6570\u5b66\u53ea\u6709\u5b66\u524d\u73ed\u6c34\u5e73\uff0c\u6240\u4ee5\u6bcf\u5f53\u5979\u7b97\u5230\u4e00\u534a\u65f6\uff0c\u8fd9\u4e2a\u6709\u673a\u7269\u53c8\u5f00\u59cb\u4e71\u641e\u4e86\uff0cZY\u5c31\u53ea\u80fd\u7528LCT\u6765\u91cd\u65b0\u7ef4\u62a4\u5b83\u3002<br/>\u4e00\u5e74\u4e4b\u5185\uff0cZY\u7684\u6838\u7535\u7ad9\u4ec0\u4e48\u7535\u90fd\u6ca1\u6709\u53d1\u3002\u4e3a\u4e86\u5feb\u901f\u8ba1\u7b97\uff0cZY\u627e\u5230\u4e86\u4f60\u8fd9\u4e2a**\u3002<br/>ZY\u5e0c\u671b\u4f60\u80fd\u7ed9\u51fa\u4e00\u4e2a\u597d\u65b9\u6cd5\u6765\u5e2e\u52a9\u5979\u8ba1\u7b97\u5f53\u524d\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u80fd\u653e\u51fa\u7684\u80fd\u91cf\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c$1$\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570$n$\uff0c$m$\u3002$n$\u8868\u793a\u6709\u673a\u7269\u4e2d\u539f\u5b50\u7684\u6570\u91cf\uff0c$m$\u8868\u793aZY\u7ef4\u62a4\u6709\u673a\u7269\u7ed3\u6784\u7684\u6b21\u6570\u3002<br/>\u63a5\u4e0b\u6765$n - 1$\u884c\u63cf\u8ff0\u4e00\u4e2a\u6709\u673a\u7269\u3002\u5bf9\u4e8e\u6bcf\u4e00\u884c\u8f93\u5165\u4e09\u4e2a\u6574\u6570$u$\uff0c$v$\u548c$e$\uff0c\u8868\u793a\u7b2c$u$\u53f7\u539f\u5b50\u548c\u7b2c$v$\u53f7\u539f\u5b50\u4e4b\u95f4\u4ee5\u80fd\u91cf\u4e3a$e$\u7684\u5171\u4ef7\u952e\u76f8\u8fde\u3002<br/>\u63a5\u4e0b\u6765$m$\u884c\uff0c\u6bcf\u4e00\u884c\u63cf\u8ff0\u4e00\u4e2a\u5171\u4ef7\u952e\u7684\u952e\u80fd\u53d8\u5316\u3002\u6bcf\u884c\u8f93\u5165\u4e09\u4e2a\u6574\u6570$u$\uff0c$v$\u548c$e$\uff0c\u8868\u793a\u7b2c$u$\u53f7\u539f\u5b50\u548c\u7b2c$v$\u53f7\u539f\u5b50\u4e4b\u95f4\u7684\u5171\u4ef7\u952e\u7684\u80fd\u91cf\u53d8\u4e3a$e$\u3002\u4fdd\u8bc1\u7b2c$u$\u53f7\u539f\u5b50\u548c\u7b2c$v$\u53f7\u539f\u5b50\u4e4b\u95f4\u5b58\u5728\u5171\u4ef7\u952e\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u6b21\u5171\u4ef7\u952e\u80fd\u91cf\u7684\u53d8\u52a8\uff0c\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u952e\u80fd\u6539\u53d8\u540e\u7684\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u80fd\u653e\u51fa\u7684\u80fd\u91cf\u3002<br/>\u8f93\u5165\u6837\u4f8b<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>127 4<br/>1 2 2<br/>1 7 1<br/>2 3 2<br/>2 6 1<br/>3 4 1<br/>3 5 1<br/><br/>1 2 2<br/>1 2 3<br/>2 3 3<br/>1 2 0<br/><br/><br/>\u8f93\u51fa\u6837\u4f8b<br/>1<br/>2<br/>3<br/>413<br/>15<br/>16<br/>10<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8be2\u95ee:<br/>\u88c2\u89e3$1$\u548c$2$\u4e4b\u95f4\u7684\u5171\u4ef7\u952e: $1 \\\\times (2 + 1 + 1 + 1) = 5$<br/>\u88c2\u89e3$2$\u548c$3$\u4e4b\u95f4\u7684\u5171\u4ef7\u952e: $(2 + 1 + 1) \\\\times (1 + 1) = 8$<br/>\u5176\u4f59\u7684\u5171\u4ef7\u952e\u88c2\u89e3\u5f97\u5230\u7684\u80fd\u91cf\u5747\u4e3a$0$\u3002<br/>\u56e0\u6b64\u7b54\u6848\u4e3a$13$\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 1,000, \\\\; m \\\\le 5,000$<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 10,000, \\\\; m \\\\le 500,000$<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 100,000, \\\\; m \\\\le 100$<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 10,000, \\\\; m \\\\le 1,000,000$<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e: \u6709\u673a\u7269\u6ca1\u6709\u652f\u94fe\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e: $n \\\\le 200,000, \\\\; m \\\\le 1,000,000, \\\\; e \\\\le 10 $<br/>C. ZY\u7684\u4ed9\u4eba\u638c (blue)<br/>\u65f6\u95f4\u9650\u5236: 2 s / \u5185\u5b58\u9650\u5236: 512 MB<br/>\u9898\u76ee\u63cf\u8ff0<br/>ZY\u662f\u4e2a\u5f88\u559c\u6b22\u6253MC\u7684\u5b69\u5b50\uff0c\u52a8\u6001\u4ed9\u4eba\u638c\u5bf9\u4ed6\u6765\u8bf4\u662f$O(1)$\u7684\u3002 <br/>ZY\u767b\u5f55MC\uff0c\u53d1\u73b0\u81ea\u5df1\u5728\u4e00\u4e2a\u4ed9\u4eba\u638c\u5305\u56f4\u7684\u5de8\u5927\u76d2\u5b50\u91cc\u3002\u8fd9\u662f$n\\\\times n$\u7684\u5de8\u5927\u7f51\u683c\uff0c\u53ef\u4ee5\u8d70\u5230\u4e0a\u4e0b\u5de6\u53f3\u76f8\u90bb\u7684\u683c\u5b50\uff0c\u4f46\u662f\u4e0d\u80fd\u659c\u8d70\u3002 <br/>ZY\u8ba4\u4e3a\uff0c\u65e2\u7136\u6765\u4e86\uff0c\u5c31\u8981\u6f47\u6d12\u8d70\u4e00\u56de\u3002\u4ed6tp\u5230\u4e00\u4e2a\u7f51\u683c\uff0c\u51c6\u5907\u6b65\u884c\u524d\u5f80\u53e6\u4e00\u4e2a\u7f51\u683c\u3002 <br/>\u4f46\u662fblue\u663e\u7136\u4e0d\u613f\u610f\u770b\u5230ZY\u5982\u6b64\u60a0\u95f2\u3002\u6240\u4ee5\uff0c\u6bcf\u6b21ZY\u4f5c\u51fa\u8ba1\u5212\uff0cblue\u90fd\u4f1a\u8ba9\u67d0\u4e2a\u683c\u5b50\u957f\u51fa\u4ed9\u4eba\u638c\u3002\uff08ZY\u600e\u6562\u8e0f\u8fc7\u4ed9\u4eba\u638c\uff09<br/>\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff1a\u7ed9\u51faZY\u7684\u8ba1\u5212\u548cblue\u7684\u64cd\u4f5c\uff0c\u8be2\u95eeZY\u80fd\u5426\u5b8c\u6210\u8ba1\u5212\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\uff0c\u4e24\u4e2a\u6574\u6570$n$\u3001$m$\uff0c\u8868\u793a\u76d2\u5b50\u662f$n\\\\times n$\u7684\uff0cZY\u6709$m$\u4e2a\u8ba1\u5212\u3002 \u63a5\u4e0b\u6765$m$\u884c\uff0c\u6bcf\u884c\u4e09\u4e2a\u70b9\u5bf9\uff1a$(x_1,y_1)$\u8868\u793aZY\u7684\u51fa\u53d1\u70b9\uff0c$(x_2,y_2)$\u8868\u793aZY\u7684\u76ee\u6807\u70b9\uff0c$(x_3,y_3)$\u8868\u793ablue\u8ba9\u8fd9\u4e2a\u70b9\u957f\u51fa\u4ed9\u4eba\u638c\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u8f93\u51fa\u5171$m$\u884c\uff0c\u63cf\u8ff0ZY\u7684\u8ba1\u5212\u80fd\u5426\u5b8c\u6210\u3002 \u5982\u679c\u80fd\u5b8c\u6210\uff0c\u8f93\u51faYes\uff0c\u5426\u5219\u8f93\u51faNo<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>45 3<br/>1 1 4 4 2 2<br/>1 1 3 3 1 2<br/>1 1 3 3 3 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>3Yes<br/>Yes<br/>No<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u6570\u636e\u6709\u68af\u5ea6\uff0c\u66b4\u529b\u53ef\u62ff\u5206\u3002<br/>\u53ef\u80fd\u5728\u540c\u4e00\u4e2a\u5730\u70b9\u957f\u4ed9\u4eba\u638c\uff1b\u4e5f\u53ef\u80fdZY\u4ece\u4ed9\u4eba\u638c\u51fa\u53d1\u6216\u8005\u5230\u8fbe\u4ed9\u4eba\u638c\u3002\u5982\u679c\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u8bf7\u76f4\u63a5\u8f93\u51fa<br/>No<br/>n <= 1000 ?<br/>D. ZY\u7684\u4e09\u5143\u7ec4 (blue)<br/>\u65f6\u95f4\u9650\u5236: 1 s / \u5185\u5b58\u9650\u5236: 233 MB<br/>\u9898\u76ee\u63cf\u8ff0<br/>ZY\u662f\u4e2a\u5f88\u795e\u7684\u5b69\u5b50\uff0c\u8ba1\u7b97\u52fe\u80a1\u6570\u5bf9\u4ed6\u6765\u8bf4\u662f$O(1)$\u7684\u3002<br/>\u5bf9\u4e8e $a,b,c \\\\in Z^+$\uff0c\u4e14$a<=b<=c$ \u6709 $a^k+b^k=c^k$\uff0c\u800c\u4e14$a:b:c$\u4e3a\u6700\u7b80\u6574\u6570\u6bd4\uff0c\u5e76\u4e14$c-b$\u4e0d\u8d85\u8fc73\uff0c\u5219\u79f0\u4e09\u5143\u7ec4$(a,b,c)$\u4e3a\u8d3c\u8fbek\u62c9\u65af\u4e09\u5143\u7ec4\u3002<br/>\u7ed9\u5b9a$n$\u548c$m$\uff0c\u5b57\u5178\u5e8f\u8f93\u51fa\u6240\u6709$c<=n$\uff0c$2<=k<=m$\u7684\u8d3c\u8fbek\u62c9\u65af\u4e09\u5143\u7ec4\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u4e00\u884c\uff0c$n,m$<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u6bcf\u884c\u4e00\u4e2a\u8d3c\u8fbek\u62c9\u65af\u4e09\u5143\u7ec4\u3002 \u5982\u679c\u6ca1\u6709\u5c31\u4e0d\u8f93\u51fa.<br/>\u6837\u4f8b\u8f93\u5165<br/>1100 3<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>93 4 5<br/>5 12 13<br/>7 24 25<br/>8 15 17<br/>9 40 41<br/>11 60 61<br/>12 35 37<br/>13 84 85<br/>16 63 65<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u6570\u636e\u8303\u56f4<br/>$n<=100000$\uff0c$2<=k<=1000$\u3002<br/>\u9898\u89e3<br/>A (Missing)<br/>B<br/>\u9898\u76ee\u63cf\u8ff0\u4e0d\u7528\u770b\uff0c\u770b\u6837\u4f8b\u5c31\u597d\u4e86\u2026<br/>\u7ed9\u4f60\u4e00\u68f5\u65e0\u6839\u6811\uff0c\u6bcf\u6761\u8fb9\u6709\u8fb9\u6743\u3002\u5c06\u4e00\u6761\u8fb9\u65ad\u5f00\u4f1a\u51fa\u73b0\u4e24\u68f5\u6811\uff0c\u8fd9\u4e24\u68f5\u6811\u7684\u5404\u81ea\u7684\u8fb9\u6743\u4e4b\u548c\u76f8\u4e58\u5c31\u662f\u88c2\u89e3\u4e00\u6b21\u7684\u80fd\u91cf\u3002\u5b8c\u5168\u88c2\u89e3\u5c31\u662f\u6bcf\u4e00\u6761\u90fd\u8fd9\u6837\u8ba1\u7b97\u4e00\u4e0b\u3002<br/>\u5982\u679c\u53ea\u8981\u8ba1\u7b97\u4e00\u6b21\uff0c\u8003\u8651\u5c06\u65e0\u6839\u6811\u8f6c\u4e3a\u6709\u6839\u6811\uff0c\u7136\u540eDFS\u4e00\u904d\u8ba1\u7b97\u4ee5\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u4e2d\u7684\u8fb9\u6743\u4e4b\u548c\u3002\u6839\u8282\u70b9\u7684\u8fd9\u4e2a\u503c\u5c31\u662f\u603b\u8fb9\u6743\u4e4b\u548c\u3002\u7528\u5bf9\u4e8e\u6bcf\u6761\u8fb9\uff0c\u7528\u6df1\u5ea6\u8f83\u5927\u7684\u8282\u70b9\u6765\u8bb0\u5f55\u8fd9\u6761\u8fb9\u4e0a\u7684\u4fe1\u606f$a$\u548c$b$\u3002$a$\u8868\u793a\u5b50\u6811\u4e2d\u7684\u8fb9\u6743\u4e4b\u548c\uff0c$b$\u8868\u793a\u5b50\u6811\u5916\u7684\u8fb9\u6743\u4e4b\u548c(\u5f53\u7136\u8981\u9664\u53bb\u8fd9\u6761\u8fb9)\u3002\u7136\u540e\u5728$\\\\Theta(n)$\u7684\u65f6\u95f4\u5185\u53ef\u4ee5\u8ba1\u7b97\u51fa\u7b54\u6848\u3002<br/>\u63a5\u4e0b\u6765\u8003\u8651\u7ef4\u62a4\u7b54\u6848\u3002\u5bf9\u4e8e\u6bcf\u6761\u8fb9\u7684\u4fee\u6539\uff0c\u81ea\u5df1\u7684$a$\u548c$b$\u4e0d\u4f1a\u6709\u5f71\u54cd\uff0c\u5bf9\u4e8e\u4ece\u8fd9\u6761\u8fb9\u5230\u6839\u8282\u70b9\u7684\u94fe\u4e0a\u7684\u6bcf\u4e00\u6761\u8fb9\u7684$a$\u503c\u90fd\u4f1a\u589e\u52a0\uff0c\u800c\u5bf9\u4e8e\u5176\u5b83\u7684\u8fb9\u7684$b$\u503c\u90fd\u4f1a\u589e\u52a0\u3002\u56e0\u6b64\u6211\u4eec\u7528$\\\\Delta a$\u548c$\\\\Delta b$\u6765\u8bb0\u5f55\u6bcf\u4e00\u6761\u8fb9\u7684\u589e\u91cf\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u5229\u7528\u6811\u94fe\u5256\u5206+\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\uff0c\u94fe\u4e0a\u7684\u8fb9\u76f4\u63a5\u589e\u52a0\uff0c\u5176\u5b83\u8fb9\u5148\u5168\u5c40\u6253\u4e0a\u6807\u8bb0\uff0c\u7136\u540e\u5bf9\u4e0d\u9700\u8981\u7684\u8fb9\u6253\u4e0a\u53cd\u6807\u8bb0\u5373\u53ef\u3002<br/>\u6700\u540e\u5728\u7ebf\u6bb5\u6811\u7684\u6839\u8282\u70b9\u7edf\u8ba1\u7b54\u6848\uff0c\u5229\u7528\u6c42\u548c\u7684\u6027\u8d28\u5373\u53ef\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum^n_{i=1} a^,_i b^,_i & = \\\\sum^n_{i=1} (a_i + \\\\Delta a)(b_i + \\\\Delta b) \\\\\\\\<br/>& = \\\\sum^n_{i=1} a_ib_i + \\\\Delta a\\\\sum^n_{i=1}b_i + \\\\Delta b\\\\sum^n_{i=1} a_i + n\\\\Delta a\\\\Delta b<br/>\\\\end{aligned}<br/>$$<br/>\u4ece\u8fd9\u4e5f\u80fd\u770b\u51fa\u7ef4\u62a4\u4e09\u4e2a\u548c\u5f0f\u548c\u4e24\u4e2a\u6807\u8bb0\u5c31\u53ef\u5b8c\u6210\u7ef4\u62a4\u3002\u603b\u590d\u6742\u5ea6\u4e3a$O(n\\\\log^2n)$\u3002<br/>C (Missing)<br/>D (Missing)<br/><br/><br/><br/><br/>ZY\u4ece\u4e0d\u6253\u6446\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-5-31/hnsdfz2016-1.html"
},
"HNSDFZ2016 #2": {
"tags": "HNSDFZ \u4e92\u6d4b 2016",
"text": "HNSDFZ2016 #2<br/>\u8fd9\u662f\u4e00\u573a\u75de\u9898\u5927\u6218\u3002<br/>A. \u4e8c\u5341\u56db\u70b9 (blue)<br/>\u65f6\u95f4\u9650\u5236: 0.4s / \u5185\u5b58\u9650\u5236: 128MB<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u7ed9\u5b9a\u56db\u4e2a\u6570\uff0c\u5224\u65ad\u80fd\u5426\u6784\u6210\u4e8c\u5341\u56db\u70b9\u3002\u4ec5\u5141\u8bb8\uff1a+ - * / () [] {}\u8fd9\u51e0\u79cd\u7b26\u53f7\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\uff0c\u4e00\u4e2a\u6b63\u6574\u6570$n$\uff0c\u8868\u793a\u6709$n$\u7ec4\u6570\u636e\u3002 \u63a5\u4e0b\u6765$n$\u884c\uff0c\u6bcf\u884c\u56db\u4e2a\u6b63\u6574\u6570\uff0c\u8868\u793a\u7ed9\u4f60\u7684\u724c\u3002 \u4fdd\u8bc1\uff1a\u8fd9\u4e9b\u6b63\u6574\u6570$\\\\in[1,13]$\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>$n$\u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u63cf\u8ff0\u662f\u5426\u80fd\u6784\u6210\u4e8c\u5341\u56db\u70b9\u3002 \u80fd\u5219\u8f93\u51fa$Yes$\uff0c\u4e0d\u80fd\u5219\u8f93\u51fa$No$\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>32<br/>5 5 5 1<br/>9 9 9 9<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2Yes<br/>No<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u6700\u591a5000\u7ec4\u3002<br/>B. BST\u5382\u957f (riteme)<br/>\u65f6\u95f4\u9650\u5236: 1 s / \u5185\u5b58\u9650\u5236: 128 MB<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>\u4e8c\u53c9\u6811\u771f\u662f\u8ff7\u4eba......<br/><br/>\u968f\u7740\u65f6\u4ee3\u7684\u8fdb\u6b65\uff0c\u4e8c\u53c9\u641c\u7d22\u6811(Binary Search Tree)\u53d1\u6325\u7740\u8d8a\u6765\u8d8a\u5927\u7684\u4f5c\u7528\u3002\u4f5c\u4e3aHNSDFZ\u4e0a\u673a\u90e8\u957fXL\uff0c\u62c5\u8d1f\u7740\u4e3a\u5b66\u6821\u5236\u9020\u5404\u79cdBST\u7684\u4efb\u52a1\u3002\u5b83\u4eec\u4f1a\u7528\u4e8e\u5404\u79cd\u7528\u9014\uff1a\u6210\u7ee9\u6392\u540d\u3001\u85aa\u6c34\u53d1\u653e\u3001PY**......<br/>\u672c\u6765\u5b66\u6821\u5bf9BST\u7684\u9700\u6c42\u5e76\u4e0d\u662f\u5f88\u5927\uff0c\u4f46\u662f\u81ea\u4eceZY\u52a0\u5165\u4e86\u4e0a\u673a\u7ec4\u540e\uff0cBST\u7684\u9700\u6c42\u8d8a\u6765\u8d8a\u5927......<br/>\u4f5c\u4e3aXL\uff0c\u65e9\u5df2\u6309\u637a\u4e0d\u4f4f\u3002\u4e8e\u662fXL\u5229\u7528\u901a\u7528\u6280\u672f\u6559\u5b66\u697c\u5efa\u7acb\u4e86\u4e00\u4e2a\u5382\u623f\uff0c\u4e13\u95e8\u5236\u9020\u5404\u79cdBST\u3002<br/>\u8fd9\u4e2a\u5382\u5b50\u4f1a\u6536\u5230\u5404\u79cd\u5404\u6837\u7684\u8ba2\u5355\u3002\u6bcf\u4e2a\u8ba2\u5355\u90fd\u4f1a\u662f\u4e00\u4e2a\u5f88\u957f\u7684\u6570\u5217\uff0c\u5176\u4e2d\u6ca1\u6709\u4e24\u4e2a\u6570\u662f\u76f8\u540c\u7684\u3002\u800cXL\u8981\u505a\u7684\u5c31\u662f\u5c06\u8fd9\u4e9b\u6570\u5b57\u4f9d\u6b21\u63d2\u5165\u5230\u4e00\u68f5\u7a7a\u7684BST\u4e2d\uff0c\u7136\u540e\u5c06BST\u53d1\u9001\u51fa\u53bb\u3002<br/>\u7136\u800c\u4eba\u5de5\u5e72\u8fd9\u4ef6\u4e8b\u5b9e\u5728\u662f\u592a\u9ebb\u70e6\u4e86\uff0c\u56e0\u6b64XL\u5c06ZY\u6293\u8fc7\u6765\u9020BST\u3002\u7136\u800cZY\u66f4\u61d2\uff0c\u628aLink\u6293\u8fc7\u6765\u8981\u5b83\u5e2e<br/>ZY\u5199\u4e2a\u7a0b\u5e8f\u6765\u6784\u5efaBST\u3002\u7136\u800cLink\u5e76\u4e0d\u5c51\u4e8e\u5199\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u4e8e\u662f\u8fd9\u4e2a\u4efb\u52a1\u83ab\u540d\u5176\u5999\u5730\u4f20\u5230\u4e86\u4f60\u624b\u4e0a......<br/>\u5f53\u7136XL\u4e0d\u4f1a\u5c31\u8fd9\u6837\u653e\u624b\u4e0d\u7ba1\uff0cXL\u4f1a\u968f\u65f6\u6765\u68c0\u67e5\u8fd9\u68f5BST\u662f\u5426\u662f\u6b63\u786e\u7684\uff0c\u4ee5\u9632\u4f60\u5728\u4e71\u9020BST\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6b63\u6574\u6570$n$\uff0c\u8868\u793a\u8ba2\u5355\u4e2d\u6570\u5217\u7684\u957f\u5ea6\u3002<br/>\u63a5\u4e0b\u6765$n$\u884c\uff0c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570$x$\u548c$k$\u3002\u8868\u793a\u5c06$x$\u63d2\u5165\u5230\u5f53\u524d\u7684BST\u4e2d\u3002\u521d\u59cb\u65f6\u662f\u7a7a\u6811\u3002$k$\u5219\u8868\u793aXL\u7684\u68c0\u67e5\u3002\u4ed6\u4f1a\u95ee\u4f60\u6839\u8282\u70b9\u5230\u65b0\u63d2\u5165\u7684\u8282\u70b9$x$\u7684\u94fe\u4e0a\u7b2c$k$\u4e2a\u8282\u70b9\u662f\u8c01\u3002\u9ed8\u8ba4\u4ece$1$\u5f00\u59cb\u6570\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u6b21XL\u7684\u68c0\u67e5\uff0c\u8f93\u51fa\u5bf9\u5e94\u7684\u7b54\u6848\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>43<br/>2 1<br/>1 1<br/>3 2<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>32<br/>2<br/>3<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u6b21\u63d2\u5165$2$\uff0c\u6811\u7684\u6839\u8282\u70b9\u4e3a$2$\uff0c\u6545\u7b54\u6848\u4e3a$2$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u6b21\u63d2\u5165$1$\uff0c\u56e0\u4e3a$1 \\\\lt 2$\uff0c\u6240\u4ee5$1$\u662f$2$\u7684\u5de6\u513f\u5b50\u3002$2$\u5230$1$\u7684\u94fe\u4e0a\u7684\u7b2c\u4e00\u4e2a\u8282\u70b9\u4e3a$2$<br/>\u5bf9\u4e8e\u6700\u540e\u4e00\u6b21\u63d2\u5165$3$\uff0c\u56e0\u4e3a$3 \\\\gt 2$\uff0c\u6240\u4ee5$3$\u662f$2$\u7684\u53f3\u513f\u5b50\u3002$2$\u5230$3$\u7684\u94fe\u4e0a\u7684\u7b2c\u4e8c\u4e2a\u8282\u70b9\u662f$3$\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 20,000$\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 90,000$\u3002<br/>\u5bf9\u4e8e$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 100,000$\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u6570\u5217\u5b8c\u5168\u968f\u673a\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 200,000$\uff0c$1 \\\\le x \\\\le n$\uff0c\u4fdd\u8bc1\u6bcf\u6b21\u68c0\u67e5\u7684\u8282\u70b9\u5b58\u5728\u3002<br/>C. \u9c7c\u7684\u8bb0\u5fc6 (Link)<br/>\u65f6\u95f4\u9650\u5236: 3s / \u5185\u5b58\u9650\u5236: 100MB<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u5bf9\u4e8e\u53ea\u67097\u79d2\u8bb0\u5fc6\u7684\u9c7c\u6765\u8bf4\uff0c\u4ed6\u80fd\u591f\u8bb0\u4f4f\u7684\u4e1c\u897f\u592a\u5c11\u4e86\u3002 <br/>\u4f46\u662f\u9c7c\u5bf9\u4e8e\u7f8e\u7684\u8ffd\u6c42\u5374\u4e0d\u4f1a\u56e0\u4e3a\u4ed6\u7684\u8bb0\u5fc6\u800c\u653e\u5f03\u3002 <br/>\u4ed6\u60f3\u77e5\u9053\u5728\u4ed6\u7684\u8bb0\u5fc6\u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4e8b\u7269\u6709\u591a\u5c11\u4e2a\u4e8b\u7269\u6ca1\u6709\u8fd9\u4e2a\u4e8b\u7269\u7f8e\u4e3d\u3002 <br/>\u6bcf\u4e00\u4ef6\u4e8b\u7269\u90fd\u6709\u4e09\u4e2a\u7ef4\u5ea6\u7684\u8bc4\u4ef7\uff0c\u9c7c\u80fd\u591f\u5f88\u5feb\u7684\u77e5\u9053\u8bc4\u4ef7\u662f\u591a\u5c11\u3002 <br/>\u4f46\u662f\u4ed6\u5e76\u6ca1\u6709\u529e\u6cd5\u77e5\u9053\u6bcf\u4e2a\u4e8b\u7269\u6709\u591a\u5c11\u4e2a\u4e8b\u7269\u6ca1\u6709\u8fd9\u4e2a\u4e8b\u7269\u7f8e\u4e3d\u3002 <br/>\u5982\u679c\u4e00\u4e2a\u4e8b\u7269\u7684\u4e09\u4e2a\u7ef4\u5ea6\u90fd>=\u53e6\u5916\u4e00\u4e2a\u4e8b\u7269\u7684\u4e09\u4e2a\u7ef4\u5ea6\u5e76\u4e14\u8fd9\u4e2a\u4e8b\u7269\u88ab\u9c7c\u770b\u5230\u7684\u65f6\u95f4\u4e0d\u80fd\u6bd4\u5176\u5148\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2an\uff0c\u8868\u793a\u9c7c\u89c1\u5230\u7684\u4e8b\u7269\u4e2a\u6570 \u7b2c2\u5230n+1\u884c\u5206\u522b\u4e3a4\u4e2a\u6574\u6570\u3002 \u5206\u522b\u662f\u524d3\u7ef4\u548c\u65f6\u95f4<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u8f93\u51fan\u884c\uff0c\u5206\u522b\u662f\u6709\u591a\u5c11\u4e2a\u4e8b\u7269\u6ca1\u8fd9\u4e2a\u4e8b\u7269\u7f8e\u4e3d<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>43  <br/>1 2 3 5  <br/>2 1 1 6  <br/>1 1 1 5  <br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>31  <br/>1  <br/>0  <br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>10%  N<=1000 <br/>10%  N<=30000 <br/>80%  N<=100000 <br/>\u6ca1\u9519\uff0c\u5c31\u662f4\u7ef4\u7684\u3002 <br/>\u524d\u97623\u7ef4\u5c0f\u4e8e100000 <br/>\u7b2c4\u7ef4<=7 \u9c7c\u7684\u8bb0\u5fc6\u53ea\u67097\u79d2 <br/>D. ZY\u7684\u94c1\u5957\u88c5 (Haogram)<br/>\u65f6\u95f4\u9650\u5236: 1s / \u5185\u5b58\u9650\u5236: 250MB<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u5728\u9644\u4e2d\u5185\u7f51MC\u4f0a\u59cb\u4e4b\u65f6\uff0cRLB(\u6392\u540d\u4e0d\u5206\u5148\u540e)\u4e09\u4fa0\u52aa\u529b\u5730\u6316\u77ff\u9020\u5bb6\u6253\u810f\u6bd4\uff0c\u6bcf\u5929\u5e78\u798f\u5145\u5b9e\u7684\u751f\u6d3b\u7740\uff0cMC\u7740\u3002<br/>\u7136\u800cZY\u7a81\u7136\u51fa\u73b0\uff0c\u593a\u8d70\u4e86RLB\u6240\u6709\u7684\u94c1\u5757\uff0c\u6253\u9020\u4e86\u4e00\u8eab\u65f6\u5c1a\u65f6\u5c1a\u6700\u65f6\u5c1a\u7684\u94c1\u5957\u88c5\u3002<br/>RLB\u51b3\u5fc3\u653b\u51fbZY\uff0c\u6536\u56de\u94c1\u5957\u88c5\u3002\u6bd5\u7adf\u6316\u77ff\u5f88\u96be\u3002<br/>\u4e8e\u662fRLB\u4e09\u4fa0\u62ff\u8d77\u4e86\u6b66\u5668\u80cc\u5305\uff0c\u5411ZY\u53d1\u8d77\u8fdb\u653b\uff0c\u5e76\u51b3\u5fc3\u4e8b\u540e\u5c01ZY\u7684id\u3002<br/>\u7531\u4e8eZY\u7684\u94c1\u5957\u88c5\u5341\u5206\u65f6(qiang)\u5c1a(da)\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u8fde\u51fb$L$\u6b21\u624d\u80fd\u6253\u8d25ZY\u3002<br/>RLB\u4e09\u4fa0\u6709$N$\u4e2a\u6b66\u5668\uff0c\u6bcf\u4e2a\u6b66\u5668\u672c\u53ef\u4ee5\u5728\u4e24\u4e2a\u65f6\u523b\u53d1\u52a8\u653b\u51fb\uff0c\u7136\u800cZY\u7684\u94c1\u5957\u88c5\u592a\u5f3a\uff0c\u6bcf\u4e2a\u6b66\u5668\u4f7f\u7528\u4e00\u6b21\u5c31\u62a5\u5e9f\u4e86\u3002<br/>\u6bcf\u6b21\u653b\u51fb\u8981\u4ece1\u65f6\u523b\u5f00\u59cb\u5411ZY\u653b\u51fb\uff0c\u663e\u7136\uff0c\u5982\u679cRLB\u6ca1\u6709\u53ef\u4ee5\u57281\u65f6\u523b\u653b\u51fb\u7684\u6b66\u5668\uff0c\u90a3\u5c31\u4e00\u6b21\u4e5f\u4e0d\u80fd\u6253\u5230ZY\u4e86\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u6709\u4e24\u4e2a\u6570\uff0c$N$\u548c$L$\u3002 \u63a5\u4e0b\u6765\u7684$N$\u884c\uff0c\u6bcf\u4e00\u884c\u6709\u4e24\u4e2a\u6570$a$,$b$\uff0c\u8868\u793a\u8be5\u6b66\u5668\u53ef\u4ee5\u5728$a$\u6216$b$\u65f6\u523b\u653b\u51fbZY\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u8f93\u51fa\u4e00\u884c\uff0c\u5982\u679c RLB \u80fd\u653b\u51fb ZY \u81f3\u5c11$L$\u6b21\uff0c\u8f93\u51fa\u201dYes\u201d,\u5426\u5219\u201dNo\u201d\u3002(\u533a\u5206\u5927\u5c0f\u5199)\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>43 2<br/>1 2<br/>2 3<br/>4 5<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1Yes<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u8f93\u51fa\u6837\u4f8b1 \u89e3\u91ca\uff1a<br/>1\u65f6\u523b\uff0cRLB\u75281\u53f7\u6b66\u5668\u653b\u51fb, 1\u53f7\u6b66\u5668\u62a5\u5e9f<br/>2\u65f6\u523b\uff0cRLB\u75282\u53f7\u6b66\u5668\u653b\u51fb, 2\u53f7\u6b66\u5668\u62a5\u5e9f<br/>3\u65f6\u523b\uff0cRLB\u6ca1\u6709\u53ef\u4ee5\u57283\u65f6\u523b\u653b\u51fbZY\u7684\u6b66\u5668\uff0c\u653b\u51fb\u7ed3\u675f\u3002<br/>\u4e00\u5171\u653b\u51fb2\u6b21\uff0c\u6b63\u597d\u6253\u8d25ZY\uff01<br/>\u6570\u636e\u8303\u56f4\uff1a<br/>\u5bf9\u4e8e30% \u7684\u6570\u636e\uff0c\u4fdd\u8bc1N <= 1000<br/>\u5bf9\u4e8e100% \u7684\u6570\u636e\uff0c\u4fdd\u8bc1N <= 1000000<br/>\u653b\u51fbZY\u7684\u65f6\u523b 0 < a,b <= 10000<br/>\u9898\u89e3<br/>A<br/>\u66b4\u529b\u66b4\u529b\u66b4\u529b......<br/>B<br/>\u7528\u5e73\u8861\u6811\u7ef4\u62a4\u5f53\u524d\u4e8c\u53c9\u6811\u4e2d\u80fd\u591f\u88ab\u63d2\u5165\u7684\u8282\u70b9\uff0c\u6bcf\u6b21\u63d2\u5165\u8282\u70b9\u65f6\u5728\u5e73\u8861\u6811\u4e0a\u4e8c\u5206\u627e\u51fa\u65b0\u8282\u70b9\u7684\u8303\u56f4\uff0c\u7136\u540e\u5229\u7528\u500d\u589e\u6cd5\u8ba1\u7b97LCA\u6765\u786e\u5b9a\u7236\u4eb2\uff0c\u6700\u540e\u66f4\u65b0\u500d\u589e\u6570\u7ec4\u7684\u503c\u3002<br/>\u67e5\u8be2\u65f6\u5229\u7528\u500d\u589e\u4e0a\u8df3\u5373\u53ef\u3002<br/>C<br/>\u5bf9\u4e8e\u540c\u4e00\u65f6\u95f4\u5185\uff0c\u5229\u7528CDQ\u5206\u6cbb\u5c31\u53ef\u4ee5\u89e3\u51b3(\u50cfMokia\u6216\u964c\u4e0a\u82b1\u5f00\u4e00\u6837)<br/>\u7531\u4e8e\u6709\u4e2a\u65f6\u95f4\u8f74\uff0c\u5f53\u65f6\u5374\u53ea\u67097\uff0c\u56e0\u6b64\u8fdb\u884c7\u6b21CDQ\u5206\u6cbb......<br/>\u56e0\u8be5\u8981\u6ce8\u610f\u4e0b\u7ec6\u8282\uff0c\u6211\u5e76\u6ca1\u6709\u5199......<br/>Link\u771f\u662f\u8111\u6d1e\u5927\u5f00......<br/>D<br/>\u5c06\u539f\u95ee\u9898\u8f6c\u6362\u4e3a\u4e00\u4e2a\u4e8c\u5206\u56fe\u5339\u914d\u7684\u95ee\u9898\uff0c\u7136\u540e\u5308\u7259\u5229\u7b97\u6cd5\u76f4\u63a5\u8dd1\u3002<br/>\u5373\u7b2c$i$\u4ef6\u6b66\u5668\u4e0e\u5bf9\u5e94\u7684\u5929\u76f8\u8fde\u6765\u6784\u5efa\u4e8c\u5206\u56fe\u3002<br/>\u4e00\u7fa4\u8d2a\u5fc3100\u5206......",
"url": "blog/2016-5-31/hnsdfz2016-2.html"
},
"HNSDFZ2016 #3": {
"tags": "HNSDFZ \u4e92\u6d4b 2016",
"text": "HNSDFZ2016 #3<br/>\u5927\u5bb6\u90fd\u5728\u51fa\u6c34\u9898\u3002<br/>A. \u5bc6\u7801\u9501 (riteme)<br/>\u9898\u76ee\u63cf\u8ff0<br/>dyx\u5728\u5bb6\u91cc\u73a9\u800d\u65f6\u53d1\u73b0\u4e86\u4e00\u4e2a\u795e\u5947\u7684\u5bc6\u7801\u9501\u3002\u7136\u800c\u4ed6\u65e9\u5df2\u5fd8\u8bb0\u4e86\u8fd9\u4e2a\u9501\u7684\u5bc6\u7801\uff0c\u4e8e\u662f\u4ed6\u968f\u4fbf\u5c1d\u8bd5\u4e86\u4e00\u4e0b\uff0c\u7ed3\u679c\u9501\u5c31\u6253\u5f00\u4e86......<br/>\u9501\u7684\u5185\u90e8\u6709\u4e00\u4e2a\u5f88\u957f\u7684\u5b57\u7b26\u4e32\uff0c\u673a\u667a\u7684dyx\u9a6c\u4e0a\u5c31\u53d1\u73b0\u8fd9\u5c31\u662f\u5bc6\u7801\u9501\u7684\u6838\u5fc3\u3002\u4e8e\u662f\u4ed6\u7814\u7a76\u4e86\u4e00\u4e0b\u5348\uff0c\u63a2\u5bfb\u8fd9\u628a\u9501\u7684\u5965\u79d8\u3002<br/>\u4ed6\u53d1\u73b0\u8fd9\u4e2a\u5b57\u7b26\u4e32\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u5f62\u5f0f\uff0c\u50cf\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a<br/>1a|b&(!c^d)<br/><br/><br/>\u5176\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u7531\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u7684\u5355\u8bcd\u662f\u4e00\u4e2a\u53d8\u91cf\uff0c\u5bf9\u5e94\u7740\u5bc6\u7801\u9501\u4e0a\u7684\u4e00\u4e2a\u6309\u94ae\u3002\u7531\u4e8e\u6309\u94ae\u53ea\u80fd\u6309\u4e0b\u6216\u4e0d\u6309\u4e0b\uff0c\u4e8e\u662f\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u6bcf\u4e2a\u53d8\u91cf\u662f\u4e00\u4e2a\u5e03\u5c14\u7c7b\u578b\u7684\uff08\u5373\u53ea\u6709$\\\\text{true}$\u548c$\\\\text{false}$\u4e4b\u5206\uff09<br/>\u5176\u4f59\u7684\u5b57\u7b26\u5c31\u53ea\u6709&\u3001|\u3001^\u3001!\u548c\u5de6\u53f3\u5c0f\u62ec\u53f7\u3002dyx\u53d1\u73b0\u62ec\u53f7\u662f\u7528\u6765\u4f18\u5148\u8fd0\u7b97\u7684\uff0c\u610f\u601d\u662f\u8fd9\u662f\u4e00\u4e2a\u4f1a\u5c06\u6240\u6709\u53d8\u91cf\u8fdb\u884c\u8ba1\u7b97\u7684\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e14\u4f18\u5148\u8ba1\u7b97\u62ec\u53f7\u4e2d\u7684\u5b50\u8868\u8fbe\u5f0f\u3002\u540c\u65f6\uff0c&\u3001|\u3001^\u3001!\u90fd\u662f\u8fd0\u7b97\u7b26\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u7684\u662f\u903b\u8f91\u4e0e\u3001\u903b\u8f91\u6216\u3001\u903b\u8f91\u5f02\u6216\u548c\u903b\u8f91\u975e\u3002\u5176\u4e2d\u524d\u4e09\u8005\u8fd0\u7b97\u4f18\u5148\u7ea7\u4e00\u81f4\uff0c\u5f53\u5b83\u4eec\u5728\u540c\u4e00\u7ea7\u51fa\u73b0\u65f6\u4f1a\u4ece\u5de6\u81f3\u53f3\u8fd0\u7b97\uff0c\u903b\u8f91\u975e\u7684\u4f18\u5148\u7ea7\u6bd4\u5b83\u4eec\u9ad8\u3002\u5f53\u6bcf\u4e00\u4e2a\u53d8\u91cf\u90fd\u6709\u76f8\u5e94\u7684\u503c\u65f6\uff0c\u6574\u4e2a\u8868\u8fbe\u5f0f\u5c31\u4f1a\u5c31\u4f1a\u8fdb\u884c\u8ba1\u7b97\uff0c\u5e76\u7ed9\u51fa\u4e00\u4e2a\u5e03\u5c14\u503c\u3002dyx\u8fd8\u53d1\u73b0\uff0c\u5f53\u6574\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a$\\\\text{true}$\u65f6\uff0c\u5bc6\u7801\u9501\u5c31\u4f1a\u6253\u5f00\u3002<br/>\u5f88\u660e\u663e\uff0c\u6574\u4e2a\u5bc6\u7801\u9501\u7684\u8f93\u5165\u65b9\u6848\u5171\u6709$2^n$\u79cd\uff0c\u5176\u4e2d$n$\u662f\u8868\u8fbe\u5f0f\u4e2d\u53d8\u91cf\u7684\u6570\u91cf\u3002\u4e8e\u662fdyx\u77ac\u95f4\u660e\u767d\u4e3a\u4ec0\u4e48\u4ed6\u4e00\u6b21\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5bc6\u7801\u9501\u89e3\u5f00\u4e86\u3002\u7136\u800cdyx\u662f\u4e00\u4e2a\u52c7\u4e8e\u63a2\u7a76\u7684\u4eba\uff0c\u4ed6\u60f3\u77e5\u9053\u5230\u5e95\u6709\u591a\u5c11\u4e2d\u65b9\u6cd5\u53ef\u4ee5\u89e3\u5f00\u4e00\u4e2a\u5bc6\u7801\u9501\u3002<br/>\u4e0d\u77e5\u4e3a\u4f55\uff0cdyx\u53c8\u53d1\u73b0\u4e86\u4e00\u706b\u8f66\u7684\u5bc6\u7801\u9501\u3002\u575a\u6301\u4e0d\u61c8\u7684dyx\u4e0d\u505c\u7684\u8ba1\u7b97\u7740\u6bcf\u4e00\u4e2a\u5bc6\u7801\u9501\u80fd\u89e3\u5f00\u7684\u65b9\u6848\u6570......\u7531\u4e8e\u5bc6\u7801\u9501\u7684\u8868\u8fbe\u5f0f\u8d8a\u6765\u8d8a\u957f\u5e76\u4e14\u4eba\u8111\u8ba1\u7b97\u91cf\u662f$\\\\Theta(1)$\u7684\uff0cdyx\u4e0d\u5f97\u4e0d\u9700\u8981\u4e00\u4e2a\u7a0b\u5e8f\u6765\u5e2e\u52a9\u4ed6\u8ba1\u7b97\u8fd9\u4e2a\u65b9\u6848\u6570\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6bcf\u4e2a\u6d4b\u8bd5\u6570\u636e\u70b9\u6709\u591a\u4e2a\u8868\u8fbe\u5f0f\u3002\u6587\u4ef6\u4ee5EOF\u7ed3\u675f\u3002<br/>\u6bcf\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5360\u4e00\u884c\uff0c\u4e14\u4e2d\u95f4\u53ea\u6709\u5c0f\u5199\u5b57\u6bcd\u548c&\u3001|\u3001^\u3001!\u3001(\u3001)\u3002<br/>\u5bf9\u4e8e&\u3001|\u548c^\u8fd0\u7b97\uff0c\u5b83\u4eec\u5de6\u53f3\u4f1a\u5404\u6709\u4e00\u4e2a\u53d8\u91cf\u6216\u5b50\u8868\u8fbe\u5f0f\u3002\u5176\u8fd0\u7b97\u89c4\u5219\u5982\u4e0b\uff1a<br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ & $b$ ($a \\\\land b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ | $b$ ($a \\\\lor b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ ^ $b$ ($a \\\\oplus b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/>\u5bf9\u4e8e!\u8fd0\u7b97\uff0c\u5b83\u540e\u9762\u4f1a\u6709\u4e00\u4e2a\u53d8\u91cf\u6216\u5b50\u8868\u8fbe\u5f0f\u3002\u5176\u8fd0\u7b97\u89c4\u5219\u5982\u4e0b\uff1a<br/><br/><br/><br/>$a$<br/>!$a$ ($\\\\lnot a$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/><br/>\u8f93\u5165\u4fdd\u8bc1\u8868\u8fbe\u5f0f\u662f\u6709\u6548\u7684\uff0c\u4e14\u8868\u8fbe\u5f0f\u4e2d\u4e0d\u5b58\u5728\u7f3a\u5c11\u53c2\u6570\u7684\u8fd0\u7b97\u7b26\u548c\u7a7a\u7684\u62ec\u53f7\u3002<br/>\u4e3a\u4e86\u9632\u6b62\u6b64\u9898\u53d8\u6210\u4e0d\u53ef\u505a\u7684NP-hard\u95ee\u9898\uff0c\u8f93\u5165\u4fdd\u8bc1\u8868\u8fbe\u5f0f\u4e2d\u6bcf\u4e00\u4e2a\u53d8\u91cf\u540d\u53ea\u51fa\u73b0\u4e00\u6b21\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u8f93\u51fa\u80fd\u591f\u89e3\u5f00\u5b83\u7684\u65b9\u6848\u603b\u6570\u3002\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u8fc7\u5927\uff0c\u56e0\u6b64\u5c06\u7b54\u6848\u5bf9$10^9 + 7$\u53d6\u6a21\u540e\u8f93\u51fa\u3002<br/>\u4e00\u79cd\u65b9\u6848\u5373\u6307\u5bf9\u6bcf\u4e00\u4e2a\u53d8\u91cf\u7ed9\u5b9a\u4e00\u4e2a\u503c\u3002<br/>\u4e24\u79cd\u65b9\u6848\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u81f3\u5c11\u4e00\u4e2a\u53d8\u91cf\u6240\u7ed9\u5b9a\u7684\u503c\u4e0d\u540c\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3a&b<br/>a|b|c<br/>a|!(b|c)<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>31<br/>7<br/>5<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u53ea\u6709$a = \\\\text{true}, b = \\\\text{true}$\u624d\u4e3a$\\\\text{true}$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\uff0c\u53ea\u8981\u4e09\u8005\u6709\u4e00\u4e2a\u53d8\u91cf\u4e3a$\\\\text{true}$\u5c31\u662f$\\\\text{true}$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5148\u8fd0\u7b97b|c\uff0c\u7136\u540e\u5bf9\u5176\u53d6\u53cd\uff0c\u6700\u540e\u4e0e$a$\u505a\u903b\u8f91\u4e0e\u3002<br/>\u4ee5\u4e0b$n$\u8868\u793a\u53d8\u91cf\u6570\u91cf\uff0c$T$\u8868\u793a\u6d4b\u8bd5\u6570\u636e\u7ec4\u6570\uff0c$L$\u8868\u793a\u8868\u8fbe\u5f0f\u7684\u603b\u957f\u5ea6\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 10,\\\\; T = 15$\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u53ea\u6709\u903b\u8f91\u6216\u8fd0\u7b97\uff0c\u6ca1\u6709\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u903b\u8f91\u975e\u548c\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 500$\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c\u53d8\u91cf\u540d\u957f\u5ea6$\\\\le 4$\uff0c$L \\\\le 10^6$\uff0c$n \\\\le 3\\\\times10^5$\u3002<br/>\u5176\u4e2d$90\\\\% $\u7684\u6570\u636e\uff0c$T \\\\le 5$\u3002<br/>B. UnString (Link)<br/>\u9898\u76ee\u63cf\u8ff0<br/>ZY\u5f88\u7d2f\u3002<br/>\u56e0\u4e3a\u6700\u8fd1\u5185\u7f51\u7684\u670d\u52a1\u5668\u5730\u5740\u603b\u662f\u6539\u6765\u6539\u53bb\u3002<br/>\u7136\u800cZY\u53c8\u975e\u5e38\u60f3\u53bb\u6363\u4e71\u3002\u4ed6\u5fc5\u987b\u77e5\u9053\u5185\u7f51\u7684\u670d\u52a1\u5668\u7684\u5730\u5740\u662f\u5565\u3002<br/>\u4f46\u662f\u9634\u9669\u7684Blue\u5374\u662f\u7ed9\u5730\u5740\u52a0\u4e86\u4e2a\u5bc6\uff0c\u8fd8TM\u7adf\u7136\u9690\u85cf\u4e86\u4e00\u4e9b\u5b57\u7b26\u3002<br/>\u4f46\u662fZY\u4e5f\u662f\u86ee\u673a\u667a\u7684\uff0c\u4ed6\u5f97\u5230\u4e86\u4e00\u6bb5\u88ab\u52a0\u5bc6\u7684\u5730\u5740<br/>\u8fd8\u6709Blue\u50bb\u903c\u4e22\u535a\u5ba2\u7684\u5b57\u7b26\u5bf9\u7167\u8868\uff0c\u5982\u679c\u5730\u5740\u548c\u535a\u5ba2\u7684\u5b57\u7b26\u5bf9\u7167\u8868\u76f8\u4f3c<br/>\u90a3\u4e48ZY\u5c31\u77e5\u9053\u4ed6\u5f97\u5230\u7684\u5730\u5740\u662f\u5bf9\u7684\uff0c\u867d\u7136\u4ed6\u4ecd\u7136\u4e0d\u80fd\u77e5\u9053\u5730\u5740\u662f\u5565\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2a\u5b57\u7b26\u4e32$S$\uff0c\u5b57\u7b26\u4e32$S$\u662f\u7531a-b\u7ec4\u6210\u7684\u5b57\u7b26\u4e32<br/>\u7b2c\u4e8c\u884c\u4e00\u4e2a\u5b57\u7b26\u4e32$C$\uff0c\u5b57\u7b26\u4e32$C$\u662f\u7531a-b\u548c?\u7ec4\u6210\u7684\u5b57\u7b26\u4e32<br/>\u591a\u7ec4\u6570\u636e\u8f93\u5165 (Link\u8fd9\u8d27\u5751\u7239)<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u6211\u4eec\u5c06?\u8ba4\u4e3a\u662f\u4efb\u4f55\u5b57\u7b26\uff0c\u8be2\u95ee$C$\u662f\u5426\u662f$S$\u7684\u5b50\u4e32<br/>\u8f93\u51faYES\u6216\u8005NO<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2abc<br/>a?c<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1YES<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>$30\\\\% $ $S$\u957f\u5ea6\u5c0f\u4e8e$2000$\uff0c$C$\u957f\u5ea6\u5c0f\u4e8e$20$<br/>$60\\\\% $ $S$\u957f\u5ea6\u5c0f\u4e8e$100000$\uff0c$C$\u957f\u5ea6\u5c0f\u4e8e$500$<br/>$100\\\\% $ $S$\u957f\u5ea6\u4e0d\u8d85\u8fc7$200000$,$C$\u957f\u5ea6\u4e0d\u8d85\u8fc7$2000$<br/>C. \u8d4c\u5f92 (ruanxingzhi)<br/>\u9898\u76ee\u63cf\u8ff0<br/>HNSDFZ\u6709\u4e00\u5927\u6279\u8d4c\u5f92\u3002\u4ed6\u4eec\u5206\u5e03\u5728\u5316\u5b66\u7ec4\u3001\u751f\u7269\u7ec4\u3001\u673a\u623f\u2026\u2026\u8fd9\u4e9b\u8d4c\u573a\u6709\u9053\u8def\u76f8\u8fde\uff0c\u5f62\u6210\u4e00\u68f5\u6811\u7684\u7ed3\u6784\u3002<br/>\u8d4c\u573a\u91cc\u7684\u4eba\u8d8a\u6765\u8d8a\u591a\u3002\u5982\u679c\u8bb0\u67d0\u4e2a\u8d4c\u573a\u7b2c$n$\u5929\u7684\u4eba\u6570\u4e3a$F_n$\uff0c\u5219\u6709$F_n=2F_{n-2}+3F_{n-1}$\u3002\u6bcf\u4e2a\u8d4c\u573a\u7684$F_1$\u548c$F_2$\u662f\u9884\u5148\u77e5\u9053\u7684\u3002\u5f53\u7136\uff0c\u8d4c\u5f92\u7684\u6570\u91cf\u4e0d\u80fd\u592a\u591a\u3002\u6bcf\u4e2a\u8d4c\u573a\u90fd\u4f1a\u4e0d\u505c\u5730\u6e05\u7406\u4eba\u5458\uff0c\u505a\u6cd5\u662f\u628a\u6bcf\u5929\u7684\u4eba\u6570\u6a21$2333$\u3002<br/>\u73b0\u5728\u662f\u7b2c$m$\u5929\uff0c3\u73ed\u7684\u67d0\u4e2a\u82f1\u8bed\u8001\u5e08\u8981\u6253\u51fb\u8d4c\u5f92\u3002\u5979\u51c6\u5907\u6253\u51fb\u4e00\u6761\u94fe\u4e0a\u7684\u6240\u6709\u8d4c\u5f92\u3002\u4f46\u662f\u5979\u5e76\u4e0d\u77e5\u9053\u81ea\u5df1\u6700\u591a\u80fd\u6253\u5230\u591a\u5c11\u4e2a\u8d4c\u5f92\uff0c\u6240\u4ee5\u628a\u4f60\u6346\u8fc7\u6765\u7b97\u4e00\u7b97\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570\uff0c$n$\u8868\u793a\u8d4c\u573a\u4e2a\u6570\uff0c$m$\u8868\u793a\u5728\u7b2c\u51e0\u5929\u52a8\u624b\u3002<br/>\u63a5\u4e0b\u6765$n$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570$F_1,F_2$\u3002<br/>\u63a5\u4e0b\u6765$n-1$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570$u,v$\u8868\u793a$u$\u548c$v$\u6709\u8fb9\u76f8\u8fde\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4e00\u884c\uff0c\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u8868\u793a\u80fd\u6253\u51fb\u5230\u7684\u8d4c\u5f92\u4e2a\u6570\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>115 1<br/>1 1<br/>1 1<br/>1 1<br/>1 1<br/>1 1<br/><br/>1 2<br/>1 3<br/>2 4<br/>2 5<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>14<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u8f93\u5165\u6570\u636e\u4e2d\uff1a<br/>\u5728\u7b2c\u4e00\u5929\uff0c\u6240\u6709\u7684\u8d4c\u573a\u90fd\u53ea\u67091\u4e2a\u4eba\u3002<br/>\u5728\u8fd9\u65f6\u6253\u51fb\uff0c\u6700\u591a\u80fd\u6253\u51fb\u52304\u4e2a\u4eba\u3002\u8fd9\u6761\u94fe\u662f$4-2-1-3$\u3002<br/>$n \\\\le 5 \\\\times 10^5$, $m \\\\le 2\\\\times 10^9$<br/>D. \u661f\u9645\u4e89\u9738 (Haogram)<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u867d\u7136\u4e8c\u5341\u4e16\u7eaa\u7684\u79d1\u6280\u548c\u6587\u5316\u8fdb\u6b65\u795e\u901f\uff0c\u4f46\u662f\u548c\u5f8c\u4e16\u79d1\u6280\u548c\u6587\u660e\u7684\u8df3\u8dc3\u5f0f\u8fdb\u6b65\u76f8\u6bd4\u8d77\u6765\uff0c \u4e5f\u53ea\u80fd\u7518\u62dc\u4e0b\u98ce\u3002\u5728\u4e8c\u5341\u4e00\u4e16\u7eaa\u7684\u672b\uff0c\u4eba\u7c7b\u7684\u6587\u660e\u7ecf\u5386\u4e86\u5de8\u5927\u800c\u4e14\u96be\u4ee5\u60f3\u50cf\u7684\u8fdb\u6b65\u3002\u5d2d\u65b0\u7684\u79d1\u6280\u4ee5\u96be\u4ee5\u60f3\u50cf\u7684\u901f\u5ea6\u7a9c\u8d77\uff0c\u5373\u4f7f\u662f\u5730\u7403\u4e0a\u6700\u4e3a\u843d\u5f8c\u7684\u56fd\u5bb6\u4e5f\u5f00\u59cb\u62e5\u6709\u8d8a\u6765\u8d8a\u5148\u8fdb\u7684\u7535\u8111\u548c\u8d44\u6599\u5e93\u3002\u5728\u4e1c\u6b27\u5171\u4ea7\u4e3b\u4e49\u89e3\u4f53\u7684\u540c\u65f6\uff0c\u6838\u5b50\u6b66\u5668\u5f00\u59cb\u53d8\u5f97\u968f\u624b\u53ef\u5f97\u3002\u539f\u6765\u56fd\u9645\u52bf\u529b\u7684\u5174\u8870\u662f\u4ee5\u8d44\u4ea7\u548c\u519b\u4e8b\u5f3a\u6743\u6765\u4f5c\u4e3a\u4f9d\u636e\uff0c\u7b2c\u4e09\u4e16\u754c\u7684\u56fd\u5bb6\u5374\u5229\u7528\u8fd9\u4e2a\u673a\u4f1a\u731b\u7136\u7a9c\u8d77\uff0c\u6311\u6218\u8fd9\u4e9b\u5f3a\u6743\uff0c\u6253\u7834\u56fd\u9645\u95f4\u5c40\u52bf\u7684\u5747\u8861\u3002 <br/>\u5f53\u7cfb\u7edf\u63a7\u5de5\u5b66\u3001\u590d\u5236\u548c\u57fa\u56e0\u5de5\u7a0b\u53d8\u6210\u4eba\u4eba\u7686\u53ef\u638c\u63e1\u7684\u79d1\u6280\u4e4b\u5f8c\uff0c\u6fc0\u8fdb\u4eba\u9053\u4e3b\u4e49\u8005\u548c\u72c2\u70ed\u7684\u5b97\u6559\u56e2\u4f53\u5f00\u59cb\u8d28\u7591\u79c1\u4eba\u516c\u53f8\u4ee5\u57fa\u56e0\u5de5\u7a0b\u56fe\u5229\u7684\u6b63\u5f53\u6027\u3002\u5927\u4f17\u5f00\u59cb\u7eb7\u7eb7\u88c5\u7f6e\u7531\u7cbe\u5bc6\u5de5\u5b66\u6240\u7814\u5236\u51fa\u6765\u7684\u4eba\u5de5\u5668\u5b98\uff0c\u5176\u4ed6\u4eba\u5219\u5f00\u59cb\u663e\u73b0\u51fa\u5404\u79cd\u5404\u6837\u7684\u57fa\u56e0\u7a81\u53d8\u6027\u72b6\uff0c\u5305\u62ec\u4e86\u8f83\u4e3a\u9690\u6027\u7684\u5668\u5b98\u53d8\u5f97\u654f\u9510\uff0c\u5230\u660e\u663e\u7684\u5fc3\u7075\u611f\u5e94\u3002\u4eba\u7c7b\u57fa\u56e0\u5e93\u4e2d\u6240\u4ea7\u751f\u7684\u8fd9\u4e9b\u53d8\u5316\uff0c\u8ba9\u5168\u7403\u5404\u5730\u7684\u4eba\u672c\u4e3b\u4e49\u8005\u611f\u5230\u975e\u5e38\u7684\u6050\u614c\u3002 <br/>\u79d1\u6280\u7ee7\u7eed\u8fdb\u6b65\u53ca\u6269\u5f20\uff0c\u4eba\u53e3\u589e\u52a0\u7684\u901f\u5ea6\u4e5f\u5f00\u59cb\u98d9\u5347\u3002\u5728\u4e8c\u5341\u4e16\u7eaa\u7ed3\u675f\u7684\u65f6\u5019\uff0c\u5730\u7403\u4e0a\u6709 \u516d\u5341\u4ebf\u7684\u4eba\u53e3\u3002\u4ec5\u4ec5\u7ecf\u8fc7\u77ed\u77ed\u7684\u4e09\u767e\u5e74\uff0c\u4eba\u53e3\u66b4\u589e\u4e3a\u4e24\u767e\u4e09\u5341\u4ebf\u3002\u6c61\u67d3\u548c\u81ea\u7136\u8d44\u6e90\u3001\u71c3\u6599\u7684\u8017\u7aed\u66f4\u662f\u706b\u4e0a\u52a0\u6cb9\u3002\u5404\u4e2a\u56fd\u5bb6\u83ab\u4e0d\u7aed\u529b\u5bfb\u627e\u964d\u4f4e\u4eba\u53e3\u6210\u957f\u7387\u7684\u65b9\u6cd5\u3002\u5728\u4eba\u53e3\u7206\u70b8\u3001\u57fa\u56e0\u7a81\u53d8\u6a2a\u626b\u6574\u4e2a\u5730\u7403\u7684\u540c\u65f6\uff0c\u4e00\u822c\u4eba\u90fd\u8ba4\u4e3a\u5730\u7403\u5c06\u56e0\u6b64\u800c\u8d70\u5411\u5929\u707e\u5730\u53d8\u7684\u7ed3\u5c40\u3002<br/>\u4e8e\u662f\u4eba\u7c7b\u9020\u51fa\u4e00\u8258\u661f\u9645\u5de8\u8230\uff0c\u5728\u64ce\u5929\u795e\u7684\u9886\u5bfc\u4e0b\uff0c\u98de\u5f80\u65e0\u8fb9\u7684\u592a\u7a7a......<br/>\u6700\u5f8c\uff0c\u5176\u4e2d\u4e00\u8258\u7684\u822a\u8230\u5f15\u64ce\u878d\u6bc1\u4e86\u3002\u5728\u7ecf\u8fc7\u4e8c\u5341\u516b\u5e74\u7684\u66f2\u901f\u65c5\u884c\u4e4b\u5f8c\uff0c\u8fd9\u4e9b\u5de8\u5927\u7684\u8239\u53ea\u91cd\u65b0\u51fa\u73b0\u5728\u4e09\u5ea6\u7a7a\u95f4\u4e2d\uff0c\u9760\u8fd1\u4e00\u4e2a\u53ef\u5c45\u4f4f\u661f\u7cfb\u7684\u5916\u7f18\u3002\u8fd9\u91cc\u8ddd\u79bb\u5730\u7403\u516d\u4e07\u5149\u5e74\u4e4b\u8fdc\uff0c\u4ed6\u4eec\u7684\u66f2\u901f\u5f15\u64ce\u5168\u6bc1\uff0c\u751f\u547d\u7ef4\u6301\u7684\u7cfb\u7edf\u51e0\u4e4e\u5df2\u7ecf\u8017\u7aed\u3002\u6240\u6709\u7684\u8239\u53ea\u53ea\u6709\u8fdb\u5165\u7d27\u6025\u72b6\u51b5\uff0c\u51c6\u5907\u8feb\u964d\u5728\u6700\u63a5\u8fd1\u7684\u53ef\u5c45\u4f4f\u884c\u661f\u4e0a\u3002<br/>\u6bcf\u4e2a\u884c\u661f\u7684\u5c45\u6c11\u52aa\u529b\u7684\u8bd5\u56fe\u5728\u88ab\u79f0\u4e3a\u300e\u65b0\u4e16\u754c\u300f\u7684\u661f\u7403\u4e0a\u751f\u5b58\u3002\u4ed6\u4eec\u5e76\u4e0d\u77e5\u9053\u8fd8\u6709\u5176\u5b83\u7684\u540c\u7c7b\u6323\u624e\u8457\u5728\u522b\u7684\u5730\u65b9\u6c42\u751f\u5b58\uff0c\u53ea\u80fd\u591f\u52aa\u529b\u7684\u5229\u7528\u624b\u8fb9\u7684\u8d44\u6e90\u6d3b\u4e0b\u53bb\u3002<br/>\u7136\u800c\uff0cZerg\u548cProtoss\u7684\u5175\u529b\u6b63\u8fdb\u653b\u8fc7\u6765\uff0c\u80fd\u5426\u6d3b\u4e0b\u8fd8\u662f\u4e2a\u95ee\u9898......<br/>\u4f5c\u4e3a\u91c7\u77ff\u7684\u5de5\u5177\uff0c\u7a7a\u95f4\u5efa\u7b51\u5de5\u7a0b\u8f66 (Space Constrution Vehicle)\uff0c\u7b80\u79f0SCV\uff0c\u5b83\u4eec\u7684\u591a\u6837\u6027\u548c\u65e0\u4ee5\u6bd4\u62df\u7684\u53ef\u9760\u6027\u4f7f\u5f97\u5b83\u4eec\u6210\u4e3a\u4e00\u79cd\u6781\u6709\u4ef7\u503c\u7684\u5efa\u7b51\u5de5\u5177\u3002<br/>\u91c7\u77ff\u7684\u6d41\u7a0b\u5982\u4e0b\uff0c\u7136\u800c\u56fe\u4e0d\u80fd\u52a8\u3002<br/><br/>SCV\u4ece\u6307\u6325\u4e2d\u5fc3 (Command Center) \u51fa\u53d1\uff0c\u79fb\u52a8\u81f3\u6c34\u6676\u77ff\u5904\u5f00\u91c7\u77ff\u7269\uff0c\u4e3a\u4e86\u7b80\u5316\u95ee\u9898\uff0c\u8bbe\u5b9a\u4e3a\u91c7\u77ff\u4e0d\u9700\u8981\u65f6\u95f4\u3002\u91c7\u5b8c\u77ff\u540e\u9700\u8981\u8fd4\u56de\u6307\u6325\u4e2d\u5fc3\u5c06\u77ff\u7269\u9001\u56de\uff0c\u5426\u5219\u4e0d\u80fd\u7b97\u91c7\u5230\u4e86\u77ff\u7269\u3002\u56fe\u7247\u91cc\u65e2\u6709\u6b63\u5728\u91c7\u77ff\u7684\u4e5f\u6709\u624d\u5b8c\u4e86\u77ff\u5e26\u7740\u77ff\u56de\u6307\u6325\u4e2d\u5fc3\u7684\u3002<br/>\u56e0\u4e3a\u5730\u9762\u73af\u5883\u590d\u6742\uff0c\u6240\u4ee5SCV\u6240\u8d70\u7684\u8def\u7ebf\u4e0d\u4e00\u5b9a\u662f\u7b14\u76f4\u7684\uff0c\u800c\u662f\u66f2\u6298\u7684\uff0c\u518d\u6b21\u4f60\u53ef\u4ee5\u5c06\u5176\u7406\u89e3\u4e3a\u4ee5\u6307\u6325\u4e2d\u5fc3\u4e3a\u6839\u7684\u4e00\u9897\u6709\u6839\u6811\uff0c\u800c\u6c34\u6676\u77ff\u5904\u4e8e\u8be5\u6709\u6839\u6811\u7684\u53f6\u5b50\u8282\u70b9\u5904\u3002\u6709\u6839\u6811\u7684\u6bcf\u4e00\u6761\u8fb9\u90fd\u6709\u8ddd\u79bb\uff0c\u957f\u5ea6\u5355\u4f4d\u4e3a\u5b87\u5b99\u5355\u4f4d\u3002\u5b9a\u4e49SCV\u901f\u5ea6\u4e3a 1 \u5b87\u5b99\u5355\u4f4d/s\u3002\u4e3a\u7b80\u5316\u95ee\u9898\uff0cSCV\u4e00\u6b21\u91c7\u77ff\u53ef\u4ee5\u5c06\u8be5\u6c34\u6676\u77ff\u91c7\u5b8c\u3002<br/>\u6709\u65f6\u4f1a\u6709\u4e00\u4e9b\u5b87\u5b99\u751f\u7269\uff08\u6bd4\u5982\u5361\u62c9\u517d\uff09\u4f1a\u722c\u884c\u81f3\u91c7\u77ff\u8def\u5f84\u4e0a\u7684\u4e00\u4e9b\u70b9\u5bfc\u81f4\u8be5\u8def\u5f84\u4e0d\u901a\u3002\u589e\u52a0\u91c7\u77ff\u96be\u5ea6\u3002\u51fa\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u5730\u56fe\u4f1a\u4e0d\u65ad\u66f4\u65b0\uff0c\u77ff\u7269\u5c31\u4f1a\u6062\u590d\u539f\u72b6\uff0c\u5361\u62c9\u517d\u4e5f\u4f1a\u88ab\u66f4\u65b0\u81f3\u4e00\u4e2a\u65b0\u7684\u8282\u70b9\u3002<br/>Zerg\u548cProtoss\u7684\u8fdb\u653b\u5df2\u7ecf\u5f88\u8fd1\u4e86\uff0c\u4f60\u9700\u8981\u5c3d\u5feb\u91c7\u66f4\u591a\u7684\u8d44\u6e90......<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u6709$2$\u4e2a\u6b63\u6574\u6570$n$\uff0c$m$\uff0c\u8868\u793a\u56fe\u4e0a\u6709$n$\u4e2a\u70b9\uff0c\u5730\u56fe\u66f4\u65b0$m$\u6b21\u3002<br/>\u63a5\u4e0b\u6765$n-1$\u884c\uff0c\u6bcf\u884c$3$\u4e2a\u6b63\u6574\u6570$p$\uff0c$f$\uff0c$l$\uff0c\u4ee3\u8868\u63cf\u8ff0\u7b2c$p$\u4e2a\u70b9\uff0c\u5176\u7236\u8282\u70b9\u4e3a$f$\uff0c\u4e0e\u7236\u8282\u70b9\u7684\u8fde\u8fb9\u957f\u4e3a$l$\u3002<br/>\u63a5\u4e0b\u6765$x$\u884c\uff0c\u6709$2$\u4e2a\u6b63\u6574\u6570$p$\uff0c$w$\uff0c\u8868\u793a\u7b2c$p$\u53f7\u8282\u70b9\u6709$w$\u6c34\u6676\u77ff\u3002$x$\u4e3a\u53f6\u8282\u70b9\u4e2a\u6570\u3002<br/>\u63a5\u4e0b\u6765$m$\u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6b63\u6574\u6570$p$\uff0c$t$\uff0c\u8868\u793a\u5730\u56fe\u66f4\u65b0\u540e\uff0c\u6709\u4e00\u53ea\u5361\u62c9\u517d\u5728$p$\u53f7\u8282\u70b9\u4f4d\u7f6e\u4e0a\uff0cZerg\u548cProtoss\u7684\u8fdb\u653b\u5c06\u5728$t$\u79d2\u540e\u6765\u4e34\u3002\u5982\u679c$p$\u4e3a$0$\uff0c\u8868\u793a\u6ca1\u6709\u5361\u62c9\u517d\u5728\u5730\u56fe\u4e0a\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5730\u56fe\u6bcf\u6b21\u66f4\u65b0\u4f1a\u5c06\u91c7\u5b8c\u7684\u77ff\u56de\u590d\u539f\u72b6\u3002<br/>\u8f93\u51fa\u5171$m$\u884c\uff0c\u6bcf\u884c\u5bf9\u4e8e\u4e00\u6b21\u5730\u56fe\u66f4\u65b0\uff0c\u8f93\u51fa\u5728\u8fdb\u653b\u6765\u4e34\u524d\u91c7\u96c6\u5230\u7684\u6700\u591a\u77ff\u7269\u6570\u91cf\u3002<br/>\u6837\u4f8b\u8f93\u51651<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>83 3<br/>2 1 35<br/>3 1 24<br/>2 100<br/>3 65<br/>0 60<br/>1 23<br/>3 33<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa1<br/>1<br/>2<br/>365<br/>0<br/>0<br/><br/><br/>\u6837\u4f8b\u8f93\u51652<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>189 4<br/>2 1 8<br/>3 1 10<br/>5 2 25<br/>6 2 13<br/>7 3 22<br/>4 1 26<br/>8 4 12<br/>9 4 23<br/>5 78<br/>6 66<br/>7 48<br/>8 50<br/>9 80<br/>0 257<br/>3 200<br/>2 230<br/>1 500<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa2<br/>1<br/>2<br/>3<br/>4242<br/>194<br/>130<br/>0<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 20, m \\\\le 5$<br/>\u5bf9\u4e8e$20\\\\% $\u7684\u6570\u636e: $n \\\\le 20, m \\\\le 500$<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c\u5730\u56fe\u6ca1\u6709\u5361\u62c9\u517d<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 1000, m \\\\le 50$<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 1000, m \\\\le 500, t \\\\le 50000$<br/>\u6307\u6325\u4e2d\u5fc3\u7684\u7f16\u53f7\u59cb\u7ec8\u4e3a$1$\uff0c\u5730\u56fe\u81f3\u591a\u6709\u4e00\u53ea\u5361\u62c9\u517d<br/>\u9898\u89e3<br/>A<br/>\u4efb\u9009\u4e00\u79cd\u65b9\u6cd5\u5efa\u7acbAST\uff0c\u6807\u7a0b\u4f7f\u7528\u7684\u662f\u9012\u5f52\u4e0b\u964d\u5f0f\u89e3\u6790\u5668\u3002<br/>\u7136\u540e\u5728AST\u4e0aDP\u5373\u53ef\u5f97\u5230\u7b54\u6848\u3002<br/>B<br/>\u6a21\u7cca\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u4f7f\u7528AC\u81ea\u52a8\u673a\uff0c\u597d\u50cf\u6709\u8bba\u6587\u4ec0\u4e48\u7684......<br/>\u539f\u6765\u7684B\u9898\u88ab\u51fa\u9898\u4eba\u5f03\u4e86\uff0c\u4e8e\u662f\u51fa\u9898\u4eba\u5341\u5206\u4e0d\u8d1f\u8d23\u5730\u653e\u88f8\u9898\uff0c\u6570\u636e\u8fd8\u4e00\u5927\u5806\u95ee\u9898......<br/>AC\u81ea\u52a8\u673a\u641e\u6cd5\u7eaf\u5c5e\u66b4\u529b\uff01<br/>\u6b64\u9898\u6b63\u89e3\u662fFFT\uff0c\u4e0d\u77e5\u9053HJWJBSR\u7a76\u7adf\u662f\u600e\u4e48\u641e\u7684\u3002<br/>\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u672a\u77e5......<br/>\u6b64\u5916\u8fd8\u53ef\u4ee5\u7528bitset\u6c34\u8fc7\u53bb\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O({nm \\\\over T})$\uff0c$T$\u662f\u673a\u5668\u7684\u6574\u578b\u957f\u5ea6\u3002\u5177\u4f53\u505a\u6cd5\u662f\u7528\u6240\u6709\u5b57\u7b26\u5230\u539f\u4e32\u4e2d\u5339\u914d\uff0c\u5339\u914d\u4e0a\u5c31\u586b$1$\u5426\u5219\u586b$0$\uff0c\u5f97\u5230\u4e0d\u540c\u7684\u5e03\u5c14\u6570\u7ec4\u3002\u5bf9\u4e8e\u95ee\u53f7\uff0c\u5c31\u5168\u90e8\u586b$1$\u3002\u76ee\u6807\u5c31\u662f\u6309\u7167\u6a21\u5f0f\u4e32\u7684\u6bcf\u4e2a\u5b57\u7b26\u987a\u5e8f\u6392\u653e\uff0c\u627e\u5230\u4e00\u4e2a\u659c\u5217\u5168\u662f$1$\u5373\u53ef\u3002\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528bitset\uff0c\u6bcf\u6b21\u5148\u5de6\u79fb\u4e00\u5b9a\u7684\u4f4d\u7f6e\u7136\u540e\u6309\u4f4d\u4e0e\u3002\u5982\u679c\u6700\u540e\u5f97\u5230\u7684bitset\u4e2d\u6709$1$\u5219\u8868\u793a\u5339\u914d\u6210\u529f\u3002<br/>\u6700\u540e\uff0cbitset\u8dd1\u5f97\u6bd4\u6807\u89e3FFT\u5feb\u5f88\u591a......<br/>C<br/>\u6bcf\u4e2a\u70b9\u7528\u77e9\u9635\u5feb\u901f\u8ba1\u7b97\u70b9\u6743\uff0c\u7136\u540eDFS\u627e\u52a0\u6743\u76f4\u5f84\u3002<br/>D<br/>\u53ef\u4ee5\u5c06\u6bcf\u4e00\u4e2a\u53f6\u8282\u70b9\u89c6\u4e3a\u4e00\u4e2a\u6709\u4ee3\u4ef7\u6709\u4ef7\u503c\u7684\u7269\u54c1\uff0c\u7136\u540e\u505a01\u80cc\u5305\u3002<br/>\u5bf9\u4e8e\u80fd\u591f\u5220\u9664\u4e00\u4e9b\u7269\u54c1\u540e\u518d\u8ba1\u7b97\u597d\u50cf\u6ca1\u6709\u4ec0\u4e48\u597d\u529e\u6cd5\uff0c\u6807\u7a0b\u5c31\u662f\u6bcf\u6b21\u8be2\u95ee\u66b4\u529b......<br/>\u5750\u7b49HJWJBSR\u7ed9\u51fa\u725b\u903c\u641e\u6cd5\u3002<br/>HJWJBSR\u8bf4\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u505a\u5230$O(nt)$\u3002",
"url": "blog/2016-7-9/hnsdfz-3.html"
},
"HNSDFZ2016 #4": {
"tags": "HNSDFZ \u4e92\u6d4b 2016",
"text": "HNSDFZ2016 #4<br/>A. 24\u70b9\u52a0\u5f3a\u7248 (ruanxingzhi)<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u8fd9\u662f\u4e00\u9053\u63d0\u4ea4\u7b54\u6848\u7684\u9632AK\u6c34\u9898\u3002<br/>\u7ed9\u5b9a$n$\u4e2a\u6b63\u6574\u6570,\u4ee5\u56db\u5219\u8fd0\u7b97\u3001\u5c0f\u62ec\u53f7\u62fc\u51fa$k$\u3002<br/>\u81ea\u7136,\u6bcf\u4e2a\u6570\u90fd\u8981\u7528\u4e14\u4ec5\u7528\u4e00\u6b21\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c,\u4e24\u4e2a\u6b63\u6574\u6570,\u8868\u793a$n$\u548c$k$\u3002<br/>\u7b2c\u4e8c\u884c,$n$\u4e2a\u6b63\u6574\u6570,\u610f\u4e49\u5982\u9898\u76ee\u6240\u8ff0\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4e00\u884c,\u4e00\u4e2a\u56db\u5219\u8fd0\u7b97\u7684\u8868\u8fbe\u5f0f\u3002\u6ce8\u610f\u6240\u6709\u62ec\u53f7\u90fd\u662f\u5c0f\u62ec\u53f7,\u53ef\u4ee5\u62ec\u53f7\u5d4c\u5957\u3002<br/>\u6837\u4f8b\u8f93\u51651<br/>1<br/>24 24<br/>6 6 6 6<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa1<br/>1()6+(6+(6)+6)<br/><br/><br/>\u6837\u4f8b\u8f93\u51652<br/>1<br/>24 24<br/>2 7 1 7<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa2<br/>1(7*7-1)/2<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u4ef6k_.in,\u4f60\u9700\u8981\u63d0\u4ea4\u4e00\u4e2a\u8f93\u51fa\u6587\u4ef6k_.out.<br/>\u5171\u6709$7$\u4e2a\u6d4b\u8bd5\u70b9\u3002\u524d$4$\u4e2a\u6d4b\u8bd5\u70b9\u6bcf\u4e2a$10$\u5206,\u540e$3$\u4e2a\u6d4b\u8bd5\u70b9\u6bcf\u4e2a$20$\u5206\u3002<br/>$k$-SBK\u53d8\u6362 (riteme)<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u6570\u5b66\u5bb6Lunk\u6700\u8fd1\u53d1\u73b0\u4e86\u4e00\u79cd\u9017\u903c\u7684SBK\u53d8\u6362\u3002\u5728Lunk\u773c\u91cc\uff0cSBK\u53d8\u6362\u662f\u8fd9\u6837\u7684\uff1a<br/><br/>\u7ed9\u4f60\u4e00\u4e2a$1$\u81f3$n$\u7684\u6392\u5217$A$\u548c\u4e00\u4e2a$1$\u81f3$n$\u7684\u6392\u5217$P$\uff0c$P$\u5bf9$A$\u505a\u4e00\u6b21SBK\u53d8\u6362\u540e\u5c06\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u6392\u5217$B$\uff0c\u5176\u4e2d\uff1a<br/>$$ B_{P_i} = A_i \\\\tag{SBK Transformation}$$<br/><br/>\u7136\u800c\u505a\u4e00\u6b21SBK\u53d8\u6362\u592a\u8fc7\u65e0\u804a\uff0c\u4e8e\u662fLunk\u51b3\u5b9a\u8fde\u7eed\u505a\u591a\u6b21SBK\u53d8\u6362\u3002\u5373\u5c06\u6bcf\u6b21\u53d8\u6362\u540e\u7684\u7ed3\u679c$B$\u53d8\u4e3a$A$\uff0c\u7136\u540e\u7ee7\u7eed\u7528$P$\u5bf9$A$\u505aSBK\u53d8\u6362\u3002Lunk\u60f3\u77e5\u9053\u8fde\u7eed\u5bf9$A$\u505a$k$\u6b21SBK\u53d8\u6362\u540e\u7684\u7ed3\u679c\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6574\u6570$n$\u548c$k$\uff0c\u8868\u793a\u6392\u5217\u7684\u957f\u5ea6\u548c\u8fde\u7eed\u505aSBK\u53d8\u6362\u7684\u6b21\u6570\u3002<br/>\u7b2c\u4e8c\u884c\u8f93\u5165$n$\u4e2a\u6574\u6570\u8868\u793a\u6392\u5217$A$\u3002<br/>\u7b2c\u4e09\u884c\u8f93\u5165$n$\u4e2a\u6574\u6570\u8868\u793a\u6392\u5217$P$\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4e00\u884c\u8f93\u51fa$n$\u4e2a\u6574\u6570\uff0c\u8868\u793a$k$\u6b21SBK\u53d8\u6362\u540e\u7684\u7ed3\u679c\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>35 2<br/>1 2 3 4 5<br/>2 3 4 5 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>14 5 1 2 3<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca<br/>\u505a\u5b8c\u7b2c\u4e00\u6b21SBK\u53d8\u6362\u540e\uff1a 5 1 2 3 4<br/>\u505a\u5b8c\u7b2c\u4e8c\u6b21SBK\u53d8\u6362\u540e\uff1a 4 5 1 2 3<br/>\u6570\u636e\u8303\u56f4\u53ca\u7ea6\u5b9a<br/>\u5171$10$\u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u7684\u6570\u636e\u8303\u56f4\u5982\u4e0b\u8868\u6240\u793a\uff1a<br/><br/><br/><br/>\u6570\u636e\u70b9<br/>$n$\u7684\u89c4\u6a21<br/>$k$\u7684\u89c4\u6a21<br/><br/><br/><br/><br/>1<br/>$\\\\le10^3$<br/>$\\\\le10^3$<br/><br/><br/>2<br/>$\\\\le10^3$<br/>$\\\\le10^3$<br/><br/><br/>3<br/>$\\\\le10^4$<br/>$\\\\le10^5$<br/><br/><br/>4<br/>$\\\\le10^4$<br/>$\\\\le2\\\\times10^5$<br/><br/><br/>5<br/>$\\\\le4\\\\times10^5$<br/>$\\\\le2^{30}$<br/><br/><br/>6<br/>$\\\\le4\\\\times10^5$<br/>$\\\\le2^{33}$<br/><br/><br/>7<br/>$\\\\le6\\\\times10^5$<br/>$\\\\le2^{63}$<br/><br/><br/>8<br/>$\\\\le6\\\\times10^5$<br/>$\\\\le2^{63}$<br/><br/><br/>9<br/>$\\\\le10^6$<br/>$\\\\le2^{63}$<br/><br/><br/>10<br/>$\\\\le2.3\\\\times10^6$<br/>$\\\\le2^{63}$<br/><br/><br/><br/>C. \u7a00\u5947\u53e4\u602a\u7684\u6839 (Link)<br/>\u9898\u76ee\u63cf\u8ff0<br/>DYX\u662f\u4e00\u4e2a\u5f88ZY\u7684ZY,\u4f46\u662f\u4ed6\u4e0d\u60f3ZY\u4e00\u6837ZY\u3002<br/>\u4ed6\u7279\u522b\u559c\u6b22\u6363\u9f13\u4e00\u4e9b\u65e0\u4e0e\u4f26\u6bd4\u7684\u6811\u3002<br/>\u4ed6\u4e5f\u7279\u522b\u559c\u6b22\u9006\u5e8f\u5bf9\u8fd9\u79cd\u4e1c\u897f,\u56e0\u6b64\u4ed6\u60f3\u628a\u9006\u5e8f\u5bf9\u62d3\u5c55\u5230\u6811\u4e0a\u6765\u3002<br/>DYX\u5bf9\u4e8e\u6811\u4e0a\u7684\u9006\u5e8f\u5bf9\u7684\u5b9a\u4e49\u662f\u8fd9\u6837\u7684:<br/>\u6811\u4e0a\u7684\u67d0\u4e2a\u70b9\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u6743\u503c\u6bd4\u4ed6\u5927\u7684\u8282\u70b9\u548c\u4ed6\u6784\u6210\u9006\u5e8f\u5bf9<br/>\u6362\u53e5\u8bdd\u6765\u8bf4,\u5c31\u662f\u6307,\u6811\u4e0a\u67d0\u4e2a\u8282\u70b9\u80fd\u548c\u4ed6\u6784\u6210\u9006\u5e8f\u5bf9\u7684\u8282\u70b9\u662f\u4ed6\u7684\u5b50\u6811\u4e2d<br/>\u6743\u503c\u6bd4\u4ed6\u5c0f\u7684\u6216\u8005\u662f\u4ed6\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u6743\u503c\u6bd4\u4ed6\u5927\u7684<br/>\u806a\u660e\u7684DYX\u5f88\u5feb\u5c31\u628a\u4ed6\u63a8\u5e7f\u5230\u6811\u4e0a\u4e86\u3002<br/>\u6700\u8fd1DYX\u5b66\u4f1a\u4e86LCT,\u91cc\u9762\u7684\u6362\u6839\u64cd\u4f5c\u6253\u52a8\u4e86\u4ed6\u3002<br/>\u56e0\u6b64\u4ed6\u5728\u60f3\u80fd\u4e0d\u80fd\u628aLCT\u7684\u6362\u6839\u62d3\u5c55\u5230\u4ed6\u7684\u6811\u4e0a<br/>\u5b9a\u4e49\u6811\u4e0a\u4e24\u4e2a\u8282\u70b9$X$\u548c$Y$,\u4e14$X$\u662f$Y$\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u9762\u7684\u4e00\u4e2a\u8282\u70b9<br/>\u5b9a\u4e49$X$\u548c$Y$\u6784\u6210\u9006\u5e8f\u5bf9\u5f53\u4e14\u4ec5\u5f53$X$\u7684\u6743\u503c\u6bd4$Y$\u7684\u5927<br/>\u7ed9\u4f60\u4e00\u68f5\u6811,\u8be2\u95ee\u4ee5\u67d0\u4e2a\u8282\u70b9\u4e3a\u6839\u7684\u65f6\u5019\u8fd9\u68f5\u6811\u603b\u5171\u6709\u591a\u5c11\u7ec4\u9006\u5e8f\u5bf9<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c$n$\u548c$m$\u8868\u793a\u6811\u7684\u8282\u70b9\u4e2a\u6570\u548c\u8be2\u95ee\u4e2a\u6570<br/>\u7b2c\u4e8c\u884c$n$\u4e2a\u6570\u8868\u793a\u6bcf\u4e2a\u8282\u70b9\u7684\u6743\u503c<br/>\u7136\u540e$n-1$\u884c\u4e24\u4e2a\u6570$X$,$Y$.\u8868\u793a\u70b9$X$\u548c$Y$\u6709\u4e00\u6761\u8fb9\u8fde\u63a5<br/>\u7136\u540e$m$\u884c\u6bcf\u884c$1$\u4e2a\u6570$X$,\u8868\u793a\u4ee5$X$\u4e3a\u6839\u7684\u65f6\u5019\u6811\u4e2d\u6709\u591a\u5c11\u7ec4\u9006\u5e8f\u5bf9<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u8f93\u51fa$m$\u884c,\u6bcf\u884c\u4e00\u4e2a\u6574\u6570,\u8868\u793a\u4ee5$X$\u4e3a\u6839\u7684\u6811\u4e2d\u6709\u591a\u5c11\u7ec4\u9006\u5e8f\u5bf9<br/>\u6837\u4f8b\u8f93\u5165<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>1610 5<br/>1 2 3 4 5 6 7 8 9 10<br/>1 2<br/>1 3<br/>3 4<br/>3 5<br/>3 7<br/>2 9<br/>2 10<br/>2 6<br/>2 8<br/>3<br/>2<br/>1<br/>7<br/>10<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>3<br/>4<br/>52<br/>1<br/>0<br/>8<br/>10<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>$30\\\\% $ $n,\\\\;m \\\\le 1000$<br/>$50\\\\% $ $n,\\\\;m \\\\le20000$, \u4e14\u6743\u503c\u4e0d\u5927\u4e8e$20000$<br/>$100\\\\% $ $n,\\\\;m \\\\le 100000$, \u4fdd\u8bc1\u6240\u6709\u6570\u636e\u5728int\u8303\u56f4\u5185<br/>\u63d0\u4f9b\u4e24\u4e2a\u7c7b:<br/>LCT\u548c\u4e3b\u5e2d\u6811,\u8981\u7684\u8bf7\u627e\u51fa\u9898\u4eba\u3002<br/>\u8981\u4e86\u7684\u8bdd\u5c31\u00ad1\u5206<br/>D. \u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217 (Haogram)<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u7ed9\u5b9a\u4e24\u4e2a\u6b63\u6574\u6570\u5e8f\u5217,\u6bcf\u4e2a\u5e8f\u5217\u4e2d\u5143\u7d20\u4e24\u4e24\u4e0d\u540c,\u4e14\u8303\u56f4\u90fd\u5728$[1,\\\\;n^2]$\u3002\u6c42\u5176\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570$t$, \u8868\u793a\u6570\u636e\u7ec4\u6570\u3002\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e:<br/>\u7b2c\u4e00\u884c\u4e09\u4e2a\u6570$n$, $p$, $q$, $n$, \u542b\u4e49\u5982\u9898, $p$, $q$\u5206\u522b\u4e3a\u4e24\u4e2a\u5e8f\u5217\u7684\u957f\u5ea6\u3002<br/>\u63a5\u4e0b\u6765\u4e24\u884c\u63cf\u8ff0\u4e24\u4e2a\u5e8f\u5217\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5171$t$\u884c$t$\u4e2a\u6574\u6570,\u8868\u793a\u7b54\u6848\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>41<br/>3 7 8<br/>1 7 5 4 8 3 9<br/>1 4 3 5 6 2 8 9<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>14<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e$30\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 30$<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c$2 \\\\le n \\\\le 250,\\\\;1 \\\\lt p,\\\\;q \\\\le n^2,\\\\;t\\\\le10$<br/>E. ZY\u7684\u91d1\u5777\u5783 (HJWJBSR)<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>Zy:\u91d1\u5777\u5783\u597d\u5904\u90fd\u6709\u5565,\u8c01\u8bf4\u5bf9\u4e86\u5c31\u7ed9\u4ed6<br/>zy:\u80a5\u6599\u63ba\u4e86\u91d1\u5777\u5783,\u4e0d\u6d41\u5931,\u4e0d\u84b8\u53d1,\u96f6\u6d6a\u8d39<br/>zY:\u80a5\u6599\u63ba\u4e86\u91d1\u5777\u5783,\u80fd\u5438\u6536\u4e24\u7c73\u4e0b\u7684\u6c2e\u78f7\u94be<br/>zy:\u4e16\u754c\u80a5\u6599\u90fd\u6da8\u4ef7,\u80a5\u6599\u63ba\u4e86\u91d1\u5777\u5783,\u4e00\u888b\u80fd\u9876\u4e24\u888b\u6492<br/>zY:\u7528\u4e86\u91d1\u5777\u5783,\u5c0f\u9ea6\u4ea9\u4ea7\u4e00\u5343\u516b\u3002\u65e5\u672c\u7684\u7cae\u98df\u518d\u4e5f\u4e0d\u5411\u7f8e\u56fd\u8fdb\u53e3\u4e86!hhhhhhhh<br/>Zy:\u5c0f\u9b3c\u5b50,\u771f\u4e0d\u50bb!\u91d1\u5777\u5783\u7ed9\u4e86\u4ed6\u5bf9\u7f8e\u56fd\u519c\u4e1a\u5371\u5bb3\u5927,\u51b3\u4e0d\u80fd\u7ed9\u4e86\u4ed6!<br/>Zy:\u975e\u6d32\u519c\u4e1a\u4e0d\u53d1\u8fbe,\u6211\u4eec\u90fd\u8981\u652f\u63f4\u4ed6\u3002\u91d1\u5777\u5783,\u4f60\u4eec\u65e5\u672c\u522b\u60f3\u4e86!<br/>zY:\u72e1\u733e,\u72e1\u733e\u3002\u6ca1\u6709\u91d1\u5777\u5783,\u600e\u4e48\u79cd\u5e84\u7a3c!\u91d1\u5777\u5783!\u91d1\u5777\u5783!(\u6b8b\u5ff5\u8138<br/><br/>zy\u6700\u8fd1\u4ece\u5c0f\u9b3c\u5b50\u624b\u4e2d\u62a2\u5230\u4e86\u91d1\u5777\u5783\u3002\u5f00\u59cb\u8003\u8651\u600e\u4e48\u6492\u3002\u4ed6\u5bb6\u7684\u5730\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a$n\\\\times m$\u7684\u65b9\u9635\u3002<br/>\u7531\u4e8e\u975e\u6d32\u519c\u4e1a\u4e0d\u53d1\u8fbe,zy\u5bb6\u7684\u5730\u6709\u4e9b\u5730\u65b9\u5e76\u4e0d\u80fd\u591f\u64ad\u6492\u3002<br/>\u5e76\u4e14\u91d1\u5777\u5783\u662f\u5168\u7403\u77a9\u76ee\u7684\u7126\u70b9\u662f\u519c\u4e1a\u79d1\u6280\u7684\u524d\u6cbf,\u6240\u4ee5\u64ad\u6492\u7684\u65b9\u5f0f\u4e5f\u6bd4\u8f83\u4e0d\u4e00\u6837:\u6bcf\u6b21\u9700\u8981\u9009\u62e9\u4e00\u4e2a\u6ca1\u88ab\u9009\u62e9\u8fc7\u7684\u77e9\u5f62<br/>\u5e76\u5747\u5300\u6492\u4e0a\u91d1\u5777\u5783,\u4e14\u5fc5\u987b\u5c06\u6240\u6709\u77e9\u5f62\u90fd\u64ad\u6492\u4e00\u6b21\u3002<br/>\u6bcf\u6b21\u64ad\u6492\u7684\u82b1\u8d39\u7684\u91d1\u5777\u5783\u888b\u6570\u662f\u77e9\u5f62\u5305\u542b\u7684\u683c\u5b50\u4e2a\u6570\u7684\u5e73\u65b9\u3002<br/>zy\u60f3\u77e5\u9053\u4ed6\u8981\u4e70\u591a\u5c11\u91d1\u5777\u5783\u624d\u591f\u7528\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u7ed9\u51fa\u4e24\u4e2a\u6b63\u6574\u6570$n$\u548c$m$\u4ee3\u8868zy\u5bb6\u7684\u5730\u7684\u957f\u548c\u5bbd\u3002<br/>\u4e0b\u9762$n$\u884c\u6bcf\u884c\u4e00\u4e2a\u957f\u5ea6$m$\u768401\u4e32\u63cf\u8ff0\u4e86zy\u5bb6\u5730\u7684\u72b6\u6001\u3002$0$\u4ee3\u8868\u8fd9\u4e2a\u5730\u4e0d\u80fd\u6492,$1$\u4ee3\u8868\u80fd\u6492\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u4ee3\u8868\u91d1\u5777\u5783\u81f3\u5c11\u8981\u591a\u5c11\u888b\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>4<br/>5<br/>65 5<br/>01001<br/>11000<br/>00010<br/>00000<br/>10001<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>115<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e$30\\\\% $\u7684\u6570\u636e, \u4fdd\u8bc1$n,\\\\;m \\\\le 10$\u3002<br/>\u5bf9\u4e8e$50\\\\% $\u7684\u6570\u636e,\u4fdd\u8bc1$n,\\\\;m \\\\le 100$\u3002<br/>\u5bf9\u4e8e\u6240\u6709\u6570\u636e,\u4fdd\u8bc1$n,\\\\;m \\\\le 1000$\u3002<br/>\u9898\u89e3<br/>A<br/>\u8fd9\u9053\u9898\u9996\u5148\u9700\u8981\u4f60\u67091\u4e2a\u5c0f\u65f6\u3002<br/>\u7136\u540e\u5c31\u53ef\u4ee5A\u6389\u4e86\u3002<br/>\u9632AK\u4ec0\u4e48\u9b3c......<br/>B<br/><br/>20\u5206: \u6a21\u62df ($\\\\Theta(nk)$)<br/>80\u5206:<br/>\u6392\u5217\u77e9\u9635\u5feb\u901f\u5e42 ($\\\\Theta(n \\\\log k)$\uff0c\u6392\u5217\u77e9\u9635\u7684\u4e58\u6cd5\u53ef\u4ee5\u5728$\\\\Theta(n)$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97)<br/>\u5bfb\u627e\u5faa\u73af\u8282\uff0c\u500d\u589e\u627e\u5230\u6bcf\u4e2a\u503c ($O(n\\\\log k)$)<br/><br/><br/>100\u5206: \u5bfb\u627e\u5faa\u73af\u8282\uff0c\u53d6\u6a21\u627e\u5230\u6bcf\u4e2a\u503c ($\\\\Theta(n)$)<br/><br/>C<br/>\u9996\u5148\u9700\u8981\u8ba1\u7b97DFS\u5e8f\u3002<br/>\u7136\u540e\u7528\u53ef\u6301\u4e45\u5316\u5e73\u8861\u6811\u6765\u7ef4\u62a4\u5b83\u4e0a\u9762\u7684\u503c\u3002<br/>\u9996\u5148\u4ee5$1$\u4e3a\u6839\uff0c\u8ba1\u7b97\u6bcf\u68f5\u5b50\u6811\u4e2d\u6bd4\u6811\u6839\u5c0f\u7684\u503c\u6709\u591a\u5c11\u4e2a\uff0c\u52a0\u8d77\u6765\u5c31\u662f$1$\u7684\u7b54\u6848\u3002<br/>\u7136\u540e\u4ece$1$\u5f00\u59cbDFS\u4e00\u904d\uff0c\u8003\u8651\u5728\u77e5\u9053\u5f53\u524d\u8282\u70b9\u7684\u7b54\u6848\u7684\u60c5\u51b5\u4e0b\uff0c\u6362\u6839\u5230\u81ea\u5df1\u7684\u4e00\u4e2a\u513f\u5b50\u5904\uff0c\u7b54\u6848\u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u5728$\\\\Theta(\\\\log n)$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa\u6765\u3002<br/>\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u7684$\\\\Theta(1)$\u56de\u7b54\u5566~~~<br/>D<br/>\u5c06\u5176\u4e2d\u4e00\u4e2a\u5e8f\u5217\u7684\u503c\u4f9d\u6b21\u91cd\u65b0\u7f16\u53f7\uff0c\u7136\u540e\u5c06\u53e6\u5916\u4e00\u4e2a\u5e8f\u5217\u4e5f\u540c\u6b65\u4fee\u6539\u4e00\u4e0b\u3002<br/>\u7136\u540e\u5c31\u8f6c\u6210\u4e86\u6c42\u53e6\u5916\u4e00\u4e2a\u5e8f\u5217\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u95ee\u9898\u3002<br/>\u8fd9\u4e2a\u53ef\u4ee5\u5728$\\\\Theta(n\\\\log n)$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u3002<br/>E<br/>\u5f15\u7528\u4e00\u6bb5\u8bdd\uff1a<br/><br/>\u9898\u89e3\uff1a<br/>\u672c\u6765\u6253\u7b97\u51fa\u4e86\u53e6\u5916\u4e00\u9053\u9898\uff0c\u540e\u6765\u624d\u53d1\u73b0\u6b63\u786e\u6027\u4e0d\u592a\u597d\u3002\u53c8\u4e0d\u60f3\u53d8\u6210\u53ea\u80fd\u51fa\u6570\u636e\u7ed3\u6784\u9898\u7684\u9009\u624b\uff0c\u5c31\u4e34\u65f6\u6362\u4e86\u8fd9\u4e2a\u6bd4\u8f83\u88f8\u7684\u9898\u3002<br/>\uff08\u51fa\u9898\u597d\u96be<br/>\u5f88\u660e\u663e\u5982\u679c\u77e9\u5f62\u4ee3\u4ef7\u90fd\u662f1\u90a3\u4e48\u80af\u5b9a\u5c31\u662f\u76f4\u63a5\u60ac\u7ebf\u6cd5\u3002<br/>\u5426\u5219\u4ed6\u8981\u7b97\u8fd9\u4e2a\u7684\u4ee3\u4ef7\u5c31\u5728\u60ac\u7ebf\u6cd5\u91cc\u9762\u52a0\u7279\u6280\uff1a\u6bcf\u6b21\u76f8\u5f53\u4e8e\u8981\u4ece\u4e00\u4e2a\u957f\u5bbd\u5206\u522b\u4e3an*m\u7684\u77e9\u5f62\u91cc\u9762\u7b97\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u7684\u5b50\u77e9\u5f62\u7684\u7b54\u6848\u3002\u8fd9\u6837\u5c31\u4e0d\u4f1a\u91cd\u590d\u3002<br/>\u76f8\u5f53\u4e8e$\\\\sum_{i=y_0}^{y_1} i^2 \\\\times \\\\text{\u6a2a\u7740\u7684\u7b54\u6848}$\u3002<br/>\u6a2a\u7740\u7684\u7b54\u6848\uff1a$\\\\sum_{i=1}^m i^2 \\\\cdot (n-i+1)$\u3002<br/>\u7136\u540e\u5c31\u6ca1\u4e86\u3002<br/>",
"url": "blog/2016-8-15/hnsdfz-4.html"
},
"HNSDFZ2016 #5": {
"tags": "HNSDFZ \u4e92\u6d4b 2016",
"text": "HNSDFZ2016 #5<br/>A. \u5fae\u5c0f\u7684\u6570\u5b66 (ruanxingzhi)<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>\u5230\u4e86\u9644\u4e2d\u6211\u8fd9\u4e09\u5e74\u4e5f\u6ca1\u6709\u4ec0\u4e48\u522b\u7684,\u5927\u6982\u4e09\u4ef6\u4e8b:\u4e00\u4e2a,\u7b97\u51fa\u4e86$\\\\varphi(n)$\u4e86; \u7b2c\u4e8c\u4e2a,\u7b97\u51fa\u4e86$\\\\mu(n)$; \u7b2c\u4e09\u4e2a,\u5c31\u662f\u7b97\u51fa$\\\\varphi \\\\times \\\\mu$\u4e86\u3002<br/>\u5982\u679c\u8fd8\u8bf4\u6709\u4e00\u70b9\u6210\u7ee9\u5c31\u662f\u79d1\u666e\u4e86\u675c\u6559\u7b5b......\u8fd8\u6709\u4e0a\u5468\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u4e5f\u662f\u5f88\u5927\u7684\u3002\u4f46\u8fd9\u4e9b\u90fd\u662f\u6b21\u8981\u7684\u3002<br/>\u6211\u4e3b\u8981\u5e72\u7684\u5c31\u662f\u4e09\u4ef6\u4e8b,\u5f88\u60ed\u6127,\u5c31\u505a\u4e86\u4e00\u70b9\u5fae\u5c0f\u7684\u6570\u5b66\u3002<br/>\u2014\u2014 Gromah<br/>\u73b0\u5728\u8bf7\u4f60\u8ffd\u968fGromah\u7684\u811a\u6b65,\u6765\u8650\u6389\u8fd9\u4e2a\u9898,\u505a\u4e00\u70b9\u5fae\u5c0f\u7684\u6570\u5b66\u5427\u3002<br/>\u2014\u2014 ruanxingzhi<br/><br/>\u4e00\u53e5\u8bdd\u9898\u610f:\u6c42\uff1a<br/>$$<br/>\\\\sum_{i=1}^n\\\\sum_{d \\\\mid i} \\\\varphi(d) \\\\mu(\\\\frac{i}d)<br/>$$<br/>\u8f93\u5165\u683c\u5f0f<br/>\u4ec5\u4e00\u884c,\u4e00\u4e2a\u6b63\u6574\u6570$n$\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u4ec5\u4e00\u884c,\u4e00\u4e2a\u6b63\u6574\u6570,\u8868\u793a\u7b54\u6848\u3002<br/>\u6837\u4f8b\u8f93\u51651<br/>113<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa1<br/>138<br/><br/><br/>\u6837\u4f8b\u8f93\u51652<br/>1233<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa2<br/>110138<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e,\u6709$n \\\\le 32$\u3002<br/>\u5bf9\u4e8e$30\\\\% $\u7684\u6570\u636e,\u6709$n \\\\le 1000$\u3002<br/>\u5bf9\u4e8e$50\\\\% $\u7684\u6570\u636e,\u6709$n \\\\le 100000$\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e,\u6709$n \\\\le 50000000$<br/>B. \u4e00\u5708\u4e00\u5708 (Haogram)<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>\u201c\u6709\u4e9b\u4e8b,\u6211\u90fd\u5df2\u5fd8\u8bb0,\u4f46\u6211\u73b0\u5728\u8fd8\u8bb0\u5f97,\u5566\u5566\u5566\u5566\u5566......\u201d<br/>\u201c\u4e00\u5708\u4e00\u5708\u4f3c\u722a\u7259,\u4f3c\u9b54\u9b3c\u7684\u6b65\u4f10,\u5566\u5566\u5566\u5566......\u201d<br/>\u4f20\u95fb\u300a\u6211\u7684\u6ed1\u677f\u978b\u300b\u4f5c\u8005\u7ea6\u745f\u7ff0\u00b7\u5e9e\u9ea6\u90ce\u5373\u5c06\u63a8\u51fa\u65b0\u6b4c\u300a\u4e00\u5708\u4e00\u5708\u300b,\u5e76\u4e14mv\u4e2d\u8981\u914d\u4e0a\u9b3c\u755c\u7684\u821e\u8e48,\u4e8e\u662f\u4ed6\u8d34\u51fa\u4e86\u5e94\u8058\u5e7f\u544a,Hagram\u4eec\u81ea\u7136\u4e0d\u60f3\u653e\u5f03\u8fd9\u4e2a\u8d5a\u94b1\u7684\u597d\u673a\u4f1a,\u6bc5\u7136\u51b3\u7136\u5730\u524d\u5f80\u5e94\u8058......<br/><br/>\u7ea6\u745f\u7ff0\u00b7\u5e9e\u9ea6\u90ce\u4e00\u5171\u5e94\u8058\u4e86$k$\u4e2aHagram\uff0c$k$\u4e2aHagram\u90fd\u8981\u53c2\u4e0e\u821e\u8e48\u3002Hagram\u4eec\u88ab\u8981\u6c42\u5728\u4e00\u4e2a$n$\u884c$m$\u5217\u7684\u77e9\u9635\u4e0a\u8df3\u821e\uff0c\u5f53\u7136\u4e00\u4e2a\u683c\u5b50\u53ea\u80fd\u7ad9\u4e00\u4e2aHagram\u3002\u4e3a\u4e86\u4fdd\u8bc1\u821e\u8e48\u7684\u9b3c\u755c\u6027\uff0c\u77e9\u9635\u7684\u7b2c$c$\u4e2a\u5708\u4e0a\u5fc5\u987b\u56db\u8fb9\u90fd\u8981\u6709Hagram\u5b58\u5728\uff0c\u5708\u6570\u662f\u4ece\u6700\u5916\u5c42\u5f80\u5185\u6570\u7684\u3002<br/>\u4e24\u4e2a\u821e\u8e48\u961f\u5f62\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u5176\u4e2d\u4e00\u4e2a\u65b9\u6848\u7684\u4e00\u4e2a\u683c\u5b50\u4e0a\u6709Hagram\u800c\u53e6\u4e00\u4e2a\u65b9\u6848\u6ca1\u6709\u3002<br/>\u5982\u679c\u6709\u4e00\u4e2aHagram\u5728\u67d0\u4e00\u5708\u7684\u9876\u70b9\u4e0a\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u5176\u65e2\u5728\u884c\u4e0a\uff0c\u53c8\u5728\u5217\u4e0a\u3002<br/>\u73b0\u5728\u7ea6\u745f\u7ff0\u00b7\u5e9e\u9ea6\u90ce\u60f3\u77e5\u9053\u4e00\u5171\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u65b9\u6848\uff0c\u7b54\u6848\u5bf9$10^9+7$\u53d6\u6a21\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff0c\u56db\u4e2a\u6570\uff1a$n,\\\\;m,\\\\;k,\\\\;c$<br/>\u5f53$n=m=k=c=0$\u65f6\u7ed3\u675f\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff0c\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570\u8868\u793a\u7b54\u6848\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>4<br/>52 2 1 1<br/>2 2 2 1<br/>3 3 1 2<br/>3 3 2 2<br/>0 0 0 0<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>3<br/>40<br/>2<br/>1<br/>8<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e$30\\\\% $\u7684\u6570\u636e\uff0c$n,\\\\;m \\\\le 3$\uff0c$k \\\\le 10$\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c$n,\\\\;m \\\\le 50$\uff0c$k \\\\le 3 \\\\times 10^3$\u3002<br/>\u4fdd\u8bc1$c$\u5408\u6cd5\u3002<br/>C. KFight (Link)<br/>\u9898\u76ee\u63cf\u8ff0<br/>Zy\u4ed6\u662f\u4e00\u4f4d\u5728\u5f02\u754c\u95fb\u540d\u7684\u52c7\u58eb\u3002<br/>Zy\u5728\u77e5\u9053\u516c\u4e3bZY\u88ab\u6076\u9f99BigGayY\u6293\u8d70\u540e\uff0c\u5185\u5fc3\u53ca\u5176\u4e0d\u5e73\u9759\u3002<br/>Zy\u77e5\u9053\u4ed6\u8d70\u5411\u4eba\u751f\u5dc5\u5cf0\uff0c\u8fce\u5a36\u516c\u4e3b\u7684\u65f6\u5019\u5230\u4e86\u3002\u4ed6\u8981\u53bb\u627e\u5230BigGayY\uff0c\u7136\u540e\u6253\u6446\u4ed6\u3002<br/>\u4f46\u662f\uff0cBigGayY\u65e9\u5c31\u77e5\u9053\u95fb\u540d\u7684\u52c7\u58ebZy\u4f1a\u6765\u3002<br/>\u56e0\u6b64\u503e\u5fc3\u4e8e\u4ed6\u7684\u516c\u4e3bSAMA\u627e\u5230\u4e86\u4ed6\u7684\u9a91\u58eb\u4eec\u963b\u6b62Zy\u7684\u5230\u6765\u3002<br/>\u9a91\u58eb\u6709$N$\u4e2a\uff0c\u4ed6\u4eec\u6321\u5728\u4e86Zy\u53bb\u6253\u6446\u6076\u9f99\u7684\u8def\u4e0a\u3002Zy\u8981\u60f3\u529e\u6cd5\u6253\u8d25\u4ed6\u4eec\uff0c\u4f46\u662f\u4ed6\u4e0d\u80fd\u51fa\u5168\u529b\u3002<br/>\u4e0d\u7136\u7684\u8bdd\uff0c\u5230\u65f6\u5019\u6ca1\u529b\u6c14\u6253\u6446BigGayY\u3002\u56e0\u6b64\u4ed6\u53ea\u80fd\u51fa$K$\u62f3\u3002<br/>\u9a91\u58eb\u4eec\u5f88\u9017\u903c\uff0c\u4ed6\u4eec\u6709\u4e9b\u4eba\u4f1a\u7ec4\u6210\u56e2\u6765\u548cZy\u6218\u6597\uff0c\u6709\u4e9b\u4eba\u5206\u5f00\u548cZy\u6218\u6597\u3002<br/>\u4f5c\u4e3a\u52c7\u58eb\u7684Zy\u5f88\u5f3a\uff0c\u4ed6\u6bcf\u6b21\u4e00\u62f3\u90fd\u53ef\u4ee5\u6253\u6b7b\u4e00\u4e2a\u4eba\u6216\u8005\u4e00\u56e2\u4eba\u3002<br/>\u4f46\u662f\u9a91\u58eb\u56e2\u91cc\u9762\u8fd8\u6709\u5176\u4ed6\u7684ZY\uff0c\u4f5c\u4e3aZy\uff0c\u4ed6\u4e0d\u80fd\u591f\u53bb\u6253\u8d25\u8fd9\u4e9bZY\uff0c\u8fd9\u4e9bZY\u4e5f\u4e0d\u4f1a\u53bb\u963b\u6b62\u4ed6\u3002  <br/>\u4f5c\u4e3a\u5f02\u754c\u738b\u8005\u7684\u56fd\u738b\uff0c\u5f88\u60f3\u77e5\u9053Zy\u4e0d\u80fd\u591f\u6551\u51fa\u516c\u4e3b\u7684\u6982\u7387\u662f\u591a\u5c11\uff0c\u4ed6\u5e76\u4e0d\u60f3\u8ba9Zy\u627e\u5230\u516c\u4e3b\u3002<br/>\u56e0\u6b64\u4ed6\u627e\u5230\u4e86\u4f60\uff0c\u60f3\u77e5\u9053Zy\u4e0d\u80fd\u6551\u51fa\u516c\u4e3b\u7684\u6982\u7387\u662f\u591a\u5c11\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u4e00\u4e2aT\u8868\u793a\u6709T\u6ce2\u9a91\u58eb\u6765\u963b\u6321\u4e86Zy\u3002<br/>\u7b2c\u4e8c\u884c\u4e09\u4e2a\u6570$N,\\\\;K,\\\\;Q$\uff0c\u5206\u522b\u8868\u793a\u6bcf\u4e00\u6ce2\u6709$N$\u4e2a\u9a91\u58eb\u6765\u88ad\uff0cZy\u53ea\u80fd\u6253$K$\u62f3\uff0c\u7136\u540e\u8fd9\u4e00\u6ce2\u9a91\u58eb\u91cc\u9762\u6709$Q$\u4e2aZY\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u6ce2\u9a91\u58eb\uff0c\u8f93\u51faZy\u6253\u4e0d\u8fc7\u7684\u6982\u7387\uff0c\u4fdd\u7559$10$\u4f4d\u5c0f\u6570\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>21<br/>3 1 0<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>10.8000000000<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u6ce8\u610f\u7cbe\u5ea6,\u7531\u4e8e\u53d6\u7684\u5c0f\u6570\u4f4d\u5f88\u591a\uff0c\u6ce8\u610f\u7cbe\u5ea6\u95ee\u9898\u3002<br/>\u5bf9\u4e8e$30\\\\% $\u7684\u6570\u636e\u6709$K \\\\le N \\\\le 4,\\\\;Q = 0,\\\\;T \\\\le 10$\u3002<br/>\u5bf9\u4e8e$60\\\\% $\u7684\u6570\u636e\u6709$K \\\\le N \\\\le 20,\\\\;Q \\\\le 10,\\\\;T \\\\le 2000$\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\u6709$K \\\\le N \\\\le 30,\\\\;Q \\\\le 20,\\\\;T \\\\le 2000$\u3002<br/>D. \u7a7a\u88ad (riteme)<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u8fd9\u662f\u4e00\u9053\u4ea4\u4e92\u9898\u3002<br/>\u6ce8\u610f\u672c\u4ea4\u4e92\u5e93\u4e0d\u63d0\u4f9bPascal\u652f\u6301\u3002\u53ea\u652f\u6301C\\\\C++\u3002<br/>\u7edf\u8ba1\u5b66\u5bb6Lunk\u6240\u5c45\u4f4f\u7684\u57ce\u5e02\u906d\u5230\u7684\u8f6f\u65af\u5170\u56fd\u7684\u7a7a\u88ad\uff0c\u5f04\u5f97Lunk\u5fc3\u795e\u4e0d\u5b9a\u3002<br/>\u7136\u800c\u4f1f\u5927\u7684\u7edf\u8ba1\u5b66\u5bb6\u600e\u4e48\u4f1a\u5c31\u56e0\u4e3a\u7a7a\u88ad\u800c\u56db\u5904\u907f\u96be\u5462\uff1fLunk\u51b3\u5b9a\u5f04\u51fa\u4e2a\u5927\u65b0\u95fb\u3002<br/>\u7531\u4e8e\u5404\u79cd\u539f\u56e0\uff0cLunk\u6240\u5c45\u4f4f\u7684\u57ce\u5e02\u7684\u5e02\u533a\u7684\u5f62\u72b6\u5341\u5206\u5947\u602a\u3002Lunk\u5c06\u5176\u5927\u81f4\u7684\u8f6e\u5ed3\u753b\u5728\u5730\u56fe\u4e0a\uff0c\u5f62\u6210\u4e86\u4e00\u4e2a\u591a\u8fb9\u5f62\u7684\u5f62\u72b6\u3002\u8f6f\u65af\u5170\u56fd\u7684\u98de\u673a\u6bcf\u4e22\u4e0b\u4e00\u679a\u70b8\u5f39\uff0cLunk\u5c31\u4f1a\u9a6c\u4e0a\u89c2\u6d4b\u5230\u70b8\u5f39\u7684\u4f4d\u7f6e\uff0c\u5e76\u5c06\u5176\u753b\u5728\u5730\u56fe\u4e0a\u3002\u4f46\u662f\uff0c\u4ed6\u6240\u60f3\u8981\u7edf\u8ba1\u7684\u53ea\u662f\u667a\u969c\u7684\u8f6f\u65af\u5170\u56fd\u6709\u591a\u5c11\u679a\u70b8\u5f39\u653b\u51fb\u5230\u4e86\u5e02\u533a\u3002<br/>\u4e8e\u662fLunk\u653e\u5f03\u4e86\u5728\u5730\u56fe\u4e0a\u753b\u4e0b\u6bcf\u4e00\u4e2a\u70b8\u5f39\u7684\u4f4d\u7f6e\uff0c\u800c\u662f\u8f6c\u800c\u5728\u5730\u4e0b\u5ba4\u91cc\u76f4\u63a5\u7edf\u8ba1\u3002<br/>\u73b0\u5728\u5b83\u6240\u9700\u8981\u7684\u5c31\u662f\u4e00\u4e2a\u80fd\u5e2e\u4ed6\u7edf\u8ba1\u7684\u7a0b\u5e8f\u3002\u4ed6\u5e0c\u671b\u80fd\u5728\u4f60\u4eec\u5199\u7684\u7a0b\u5e8f\u4e2d\u9009\u51fa\u4e00\u4e2a\u7cbe\u786e\u5ea6\u9ad8\u5e76\u4e14\u8dd1\u5f97\u6bd4\u9999\u6e2f\u8bb0\u8005\u8fd8\u5feb\u7684\u7a0b\u5e8f\u6765\u5e2e\u52a9\u5b83\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\u3002<br/>\u6211\u8be5\u5982\u4f55\u7f16\u5199\u8fd9\u4e2a\u7a0b\u5e8f<br/>\u9009\u624b\u76ee\u5f55\u4e0b\u5c06\u4f1a\u4e0b\u53d1interface.h\u8fd9\u4e2a\u6587\u4ef6\u3002<br/>\u4f60\u9700\u8981\u5b9e\u73b0interface.h\u4e2d\u7684\u63a5\u53e3\u3002<br/>\u4f60\u9700\u8981\u5728\u540c\u4e00\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6airstrike.cpp\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a<br/>1<br/>2<br/>3#include \\ interface.h\\ <br/><br/>// \u5b9e\u73b0\u90e8\u5206<br/><br/><br/>\u4f60\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\u5728\u5934\u6587\u4ef6\u4e2d\u6709\u7b80\u8981\u8bf4\u660e\u3002\u8fd9\u91cc\u505a\u8be6\u7ec6\u8bf4\u660e\u3002<br/>1void initialize(const double *x, const double *y, const size_t n, const int id);<br/><br/><br/>\u662f\u8f7d\u5165\u7a0b\u5e8f\u7684\u5165\u53e3\u3002\u5728\u8fdb\u884c\u67e5\u8be2\u4e4b\u524d\uff0c\u4f1a\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u3002<br/>\u8f7d\u5165\u6240\u7528\u7684\u65f6\u95f4\u4e0d\u4f1a\u8ba1\u5165\u4f60\u7684\u7a0b\u5e8f\u7528\u65f6\u3002\u4f46\u662f\u8f7d\u5165\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc7$3\\\\text{s}$\u3002<br/>x\u548cy\u662f\u4e24\u4e2a\u6570\u7ec4\uff0c\u7ed9\u51fa\u7684\u662f\u5e02\u533a\u7684\u8f6e\u5ed3\uff0c\u5373Lunk\u7ed8\u5236\u7684\u591a\u8fb9\u5f62\u7684\u9876\u70b9\uff0c\u6309\u7167\u9006\u65f6\u9488\u987a\u5e8f\u7ed9\u51fa\u3002<br/>n\u662f\u591a\u8fb9\u5f62\u7684\u9876\u70b9\u6570\u91cf\u3002<br/>id\u662f\u5f53\u524d\u6570\u636e\u70b9\u7684\u6807\u53f7\uff0c\u5728\u4e0b\u6587\u4f1a\u6709\u89e3\u91ca\u3002<br/>1bool query(const double dx, const double dy);<br/><br/><br/>\u662fLunk\u7684\u64cd\u4f5c\uff0c\u6bcf\u6b21\u8c03\u7528\u5373\u67e5\u8be2\u70b8\u5f39\u662f\u5426\u70b8\u5728\u5e02\u533a\u5185\u3002\u5982\u679c\u70b8\u5728\u5e02\u533a\u5185\u5219\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002<br/>dx\u548cdy\u662f\u70b8\u5f39\u70b8\u5230\u7684\u5750\u6807\u3002<br/>\u8be5\u51fd\u6570\u7684\u7528\u65f6\u4f1a\u88ab\u8ba1\u5165\u7a0b\u5e8f\u7528\u65f6\u3002<br/>1void finalize();<br/><br/><br/>\u662f\u7ed3\u675f\u7a0b\u5e8f\u3002\u8fd9\u4e2a\u51fd\u6570\u5c06\u5728\u6240\u6709\u67e5\u8be2\u4efb\u52a1\u5b8c\u6210\u540e\u8c03\u7528\u3002<br/>\u7528\u4e8e\u91ca\u653e\u4f60\u7684\u7a0b\u5e8f\u6240\u7528\u7684\u8d44\u6e90\u3002<br/>\u8be5\u51fd\u6570\u7684\u7528\u65f6\u4e0d\u4f1a\u8ba1\u5165\u7a0b\u5e8f\u7528\u65f6\uff0c\u4f46\u662f\u5176\u8fd0\u884c\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc7$3\\\\text{s}$\u3002<br/>\u6ce8\u610f\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528delete[]\u5220\u9664\u6389\u4e4b\u524dinitialize\u53c2\u6570\u4e2d\u7ed9\u4f60\u7684\u9876\u70b9\u6570\u7ec4\uff0c\u5426\u5219\u540e\u679c\u81ea\u8d1f\u3002<br/>\u6211\u8be5\u5982\u4f55\u6d4b\u8bd5\u8fd9\u4e2a\u7a0b\u5e8f<br/>\u9009\u624b\u76ee\u5f55\u4e0b\u5c06\u4f1a\u4e0b\u53d1main.cpp\u8fd9\u4e2a\u6587\u4ef6\u3002<br/>\u9996\u5148\u4f60\u9700\u8981\u6709\u8f93\u5165\u7684\u6570\u636e\uff0c\u5176\u683c\u5f0f\u5c06\u5728\u4e0b\u6587\u7ed9\u51fa\u3002<br/>\u5047\u8bbe\u4f60\u7684\u7a0b\u5e8f\u6587\u4ef6\u662fairstrike.cpp\uff0c\u90a3\u4e48\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u7f16\u8bd1\uff1a<br/>1g++ main.cpp airstrike.cpp -std=c++11 -o main<br/><br/><br/>\u6216\u8005\u4f60\u9700\u8981\u8c03\u8bd5\uff1a<br/>1g++ main.cpp airstrike.cpp -std=c++11 -o main -g<br/><br/><br/>\u6253\u5f00-O2\u4f18\u5316\uff1a<br/>1g++ main.cpp airstrike.cpp -std=c++11 -o main -O2<br/><br/><br/>\u5bf9\u4e8eC\u8bed\u8a00\uff0c\u5c06main.cpp\u6539\u540d\u4e3amain.c\uff0c\u4f7f\u7528gcc\uff0c\u5e76\u4e14\u5c06-std=c++11\u6539\u4e3a-std=c11\u5373\u53ef\u3002<br/>\u7136\u540e\u4f7f\u7528\uff1a<br/>1./main<br/><br/><br/>\u6765\u8fd0\u884c\u7a0b\u5e8f\u3002<br/>\u5982\u679c\u9700\u8981\u4f7f\u7528\u6587\u4ef6\u8f93\u5165\u8f93\u51fa\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\uff0c\u4e5f\u53ef\u4ee5\u4fee\u6539main.cpp\uff0c\u5c06\u5176\u4e2d\u7684\u4e24\u884c\u5e26\u6709\u6ce8\u91ca\u7684freopen\u53d6\u6d88\u6ce8\u91ca\uff0c\u7136\u540e\u91cd\u65b0\u7f16\u8bd1\u5373\u53ef\u3002<br/>\u6ce8\u610f\uff0c\u8be5\u7a0b\u5e8f\u4e0d\u4f1a\u6d4b\u8bd5\u4f60\u7684\u7528\u65f6\u5e76\u7ed9\u4f60\u8bc4\u5206\u3002\u5e76\u4e14\u4e0e\u6700\u7ec8\u8bc4\u6d4b\u65f6\u7684\u8fd0\u884c\u7a0b\u5e8f\u4e0d\u540c\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6b64\u5904\u7684\u8f93\u5165\u683c\u5f0f\u662f\u6839\u636e\u4e0a\u9762\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u6240\u8bf4\u7684\u3002<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6574\u6570$n$\u548c$d$\uff0c\u8868\u793a\u9876\u70b9\u6570\u91cf\u548c\u6570\u636e\u7f16\u53f7\u3002<br/>\u4e0b\u9762$n$\u884c\u63cf\u8ff0\u5e02\u533a\uff0c\u6bcf\u4e00\u884c\u7ed9\u51fa\u4e00\u4e2a\u6574\u70b9$(x,\\\\;y)$\uff0c\u8868\u793a\u4e00\u4e2a\u9876\u70b9\u3002<br/>\u4e4b\u540e\u7ed9\u51fa\u82e5\u5e72\u884c\uff0c\u4e00\u76f4\u5230\u6587\u4ef6\u5c3e\uff0c\u6bcf\u884c\u7ed9\u51fa\u4e00\u4e2a\u6574\u70b9$(x_q,\\\\;y_q)$\uff0c\u8868\u793a\u70b8\u5f39\u7684\u4f4d\u7f6e\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2aLunk\u7684\u8be2\u95ee\uff0c\u8f93\u51fa\u5bf9\u5e94\u7684\u4fe1\u606f (YES\u6216NO)\u3002<br/>\u6837\u4f8b\u8f93\u51651<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>93 1<br/>0 0<br/>6 1<br/>8 7<br/><br/>6 5<br/>2 7<br/>8 1<br/>3 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa1<br/>1<br/>2<br/>3<br/>4YES<br/>NO<br/>NO<br/>YES<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca1<br/>\u6837\u4f8b\u8f93\u51651\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u6837\u4f8b\u8f93\u51652<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>157 1<br/>1 1<br/>7 1<br/>4 2<br/>3 4<br/>7 5<br/>5 6<br/>1 6<br/><br/>0 4<br/>2 4<br/>4 4<br/>5 3<br/>5 5<br/>3 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa2<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6NO<br/>YES<br/>NO<br/>NO<br/>YES<br/>YES<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca2<br/>\u6837\u4f8b\u8f93\u51652\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u6570\u636e\u9650\u5236<br/>\u5171$7$\u4e2a\u6570\u636e\u6d4b\u8bd5\u70b9\uff0c\u9650\u5236\u5982\u4e0b\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>$n$\u7684\u89c4\u6a21<br/>\u7279\u6b8a\u9650\u5236<br/><br/><br/><br/><br/>$1$<br/>$\\\\le 10$<br/>\u65e0<br/><br/><br/>$2$<br/>$\\\\le 10^3$<br/>\u65e0<br/><br/><br/>$3$<br/>$\\\\le 10^5$<br/>\u65e0<br/><br/><br/>$4$<br/>$\\\\le 2 \\\\times 10^5$<br/>\u65e0<br/><br/><br/>$5$<br/>$\\\\le 10^6$<br/>\u5de6\u53f3\u7684\u8fb9\u4e0e$y$\u8f74\u5e73\u884c\uff0c\u4e0b\u8fb9\u4e0e$x$\u8f74\u5e73\u884c\uff0c\u4e0a\u8fb9\u9876\u70b9$x$\u9012\u589e\uff0c\u5747\u9ad8\u4e8e\u4e0b\u8fb9\uff0c\u8f93\u5165\u6570\u636e\u4ece\u5de6\u4e0b\u89d2\u5f00\u59cb\u3002<br/><br/><br/>$6$<br/>$\\\\le 10^6$<br/>\u51f8\u591a\u8fb9\u5f62<br/><br/><br/>$7$<br/>$\\\\le 10^3$<br/>$0 \\\\le x,\\\\;y \\\\le 10^3$<br/><br/><br/><br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c\u6ee1\u8db3$3 \\\\le n \\\\le 10^6,\\\\;|x|,\\\\;|y|,\\\\;|x_q|,\\\\;|y_q| \\\\le 10^9$\u3002<br/>\u9876\u70b9\u6309\u7167\u9006\u65f6\u9488\u987a\u5e8f\u8f93\u5165\uff0c\u6ca1\u6709\u4e24\u4e2a\u9876\u70b9\u4e00\u6837\uff0c\u5e76\u4e14\u4e3a\u7b80\u5355\u591a\u8fb9\u5f62\u3002<br/>\u8bc4\u5206\u6807\u51c6<br/>\u5bf9\u4e8e\u4e0d\u540c\u7684\u6570\u636e\u70b9\uff0c\u5206\u503c\u548c\u65f6\u95f4\u9650\u5236\u5982\u4e0b\u8868\u6240\u793a\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>\u5206\u503c<br/>\u65f6\u95f4\u9650\u5236<br/><br/><br/><br/><br/>$1$<br/>$5$<br/>$0.1\\\\text{s}$<br/><br/><br/>$2$<br/>$10$<br/>$1\\\\text{s}$<br/><br/><br/>$3$<br/>$15$<br/>$1\\\\text{s}$<br/><br/><br/>$4$<br/>$30$<br/>$1\\\\text{s}$<br/><br/><br/>$5$<br/>$10$<br/>$1\\\\text{s}$<br/><br/><br/>$6$<br/>$15$<br/>$1\\\\text{s}$<br/><br/><br/>$7$<br/>$15$<br/>$1\\\\text{s}$<br/><br/><br/><br/>\u5728\u65f6\u95f4\u9650\u5236\u5185\uff0c\u5982\u679c\u7a0b\u5e8f\u4e0d\u51fa\u610f\u5916 (\u5982\u8fd0\u884c\u65f6\u9519\u8bef)\uff0c\u5c06\u4f1a\u4e0d\u65ad\u7684\u7ed9\u51fa\u8be2\u95ee\u3002\u8bbe\u4f60\u7684\u7a0b\u5e8f\u5b8c\u6210\u7684\u8be2\u95ee\u4e2a\u6570\u4e3a$x$\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u7684\u8bc4\u5206\u6807\u51c6\u5982\u4e0b\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>$20\\\\% $<br/>$40\\\\% $<br/>$60\\\\% $<br/>$80\\\\% $<br/>$100\\\\% $<br/><br/><br/><br/><br/>$1$<br/>$\\\\ge 10^5$<br/>$\\\\ge 2\\\\times 10^5$<br/>$\\\\ge 3 \\\\times 10^5$<br/>$\\\\ge 4 \\\\times 10^5$<br/>$\\\\ge 5 \\\\times 10^5$<br/><br/><br/>$2$<br/>$\\\\ge 5 \\\\times 10^4$<br/>$\\\\ge 10^5$<br/>$\\\\ge 2 \\\\times 10^6$<br/>$\\\\ge 3 \\\\times 10^6$<br/>$\\\\ge 4 \\\\times 10^6$<br/><br/><br/>$3$<br/>$\\\\ge 5 \\\\times 10^2$<br/>$\\\\ge 10^3$<br/>$\\\\ge 2 \\\\times 10^5$<br/>$\\\\ge 4 \\\\times 10^5$<br/>$\\\\ge  5 \\\\times 10^5$<br/><br/><br/>$4$<br/>$\\\\ge 10^3$<br/>$\\\\ge 1 \\\\times 10^5$<br/>$\\\\ge 2 \\\\times 10^5$<br/>$\\\\ge 3 \\\\times 10^5$<br/>$\\\\ge 4 \\\\times 10^5$<br/><br/><br/>$5$<br/>$\\\\ge 10^3$<br/>$\\\\ge 8 \\\\times 10^5$<br/>$\\\\ge 10^6$<br/>$\\\\ge 1.2 \\\\times 10^6$<br/>$\\\\ge 1.4 \\\\times 10^6$<br/><br/><br/>$6$<br/>$\\\\ge 5 \\\\times 10^2$<br/>$\\\\ge 8 \\\\times 10^5$<br/>$\\\\ge 10^6$<br/>$\\\\ge 1.2 \\\\times 10^6$<br/>$\\\\ge 1.4 \\\\times 10^6$<br/><br/><br/>$7$<br/>$\\\\ge 10^6$<br/>$\\\\ge 2 \\\\times 10^6$<br/>$\\\\ge 3 \\\\times 10^6$<br/>$\\\\ge 4 \\\\times 10^6$<br/>$\\\\ge 10^7$<br/><br/><br/><br/>\u4f60\u7684$x$\u9700\u8981\u8fbe\u5230\u5bf9\u5e94\u7684\u8981\u6c42\u624d\u80fd\u5f97\u5230\u5bf9\u5e94\u7684\u767e\u5206\u6bd4\u3002\u8bc4\u6d4b\u7a0b\u5e8f\u5c06\u9009\u53d6\u4f60\u80fd\u8fbe\u5230\u7684\u6700\u9ad8\u7684\u767e\u5206\u6bd4\u3002<br/>\u5176\u4e2d\u767e\u5206\u6bd4\u662f\u5c06\u8be5\u70b9\u603b\u5206\u4e58\u4e0a\u8be5\u767e\u5206\u6bd4\u5e76\u5411\u4e0b\u53d6\u6574\uff0c\u4f5c\u4e3a\u4f60\u8be5\u70b9\u7684\u5206\u6570\u3002<br/>\u5982\u679c\u8be2\u95ee\u56de\u7b54\u9519\u8bef\uff0c\u5c06\u6bcf\u56de\u7b54\u9519\u8bef\u4e00\u6b21\u6263\u9664$1$\u5206\uff0c\u6263\u5206\u5230$0$\u5206\u4e3a\u6b62\uff0c\u5206\u6570\u4e0d\u4f1a\u53d8\u4e3a\u8d1f\u6570\u3002<br/>\u5982\u679c\u53d1\u751f\u8fd0\u884c\u65f6\u9519\u8bef\uff0c\u6216\u8005\u8fd0\u884c\u4e25\u91cd\u8d85\u65f6\uff0c\u5c06\u5bfc\u81f4\u8be5\u70b9\u5f97$0$\u5206\u3002<br/>\u5982\u679c\u4f60\u7684initialize\u6216finalize\u8d85\u65f6\uff0c\u8be5\u70b9\u5f97$0$\u5206\u3002<br/>\u5173\u4e8e\u8bc4\u6d4b\u673a<br/>\u51fa\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0cGCC\u7f16\u8bd1\u51fa\u6765\u7684\u8bc4\u6d4b\u5668\u5e76\u4e0d\u662f\u5f88\u7a33\u5b9a\uff0c\u53ef\u80fd\u51fa\u73b0\u6210\u7ee9\u6ce2\u52a8\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8bc4\u6d4b\u65f6\u6700\u597d\u91c7\u7528Clang\u8fdb\u884c\u7f16\u8bd1\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4f1a\u7a33\u5b9a\u4e00\u4e9b\u3002<br/>\u5982\u679c\u4f60\u5bf9\u4f60\u7684\u7b97\u6cd5\u5341\u5206\u81ea\u4fe1\uff0c\u7136\u800c\u5728\u8bc4\u6d4b\u65f6\u5374\u6ca1\u6709\u5f97\u5230\u6ee1\u5206\uff0c\u53ef\u4ee5\u8fdb\u884c\u91cd\u6d4b\u3002<br/>\u6e29\u99a8\u63d0\u793a<br/>\u8bc4\u6d4b\u65f6\u9650\u5f88\u957f\uff0c\u8bf7\u4e0d\u8981\u6076\u610f\u5361\u8bc4\u6d4b\uff0c\u8c22\u8c22\u5408\u4f5c\uff01<br/>\u90e8\u5206\u9898\u89e3<br/>A<br/>raunxingzhi\u603b\u662f\u559c\u6b22\u51fa\u8fd9\u79cd\u9898\u76ee\uff0c\u83ab\u540d\u5176\u5999\u3002<br/>\u9996\u5148\u662f$O(n \\\\ln n)$\u7684\u505a\u6cd5\uff0c\u4ee4\uff1a<br/>$$<br/>f(n) = \\\\sum_{d \\\\mid n} \\\\varphi(d) \\\\mu(\\\\frac{n}d)<br/>$$<br/>\u5bf9\u5176\u8fdb\u884c\u9006\u53cd\u6f14\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\varphi(n) = \\\\sum_{d \\\\mid n} f(d)<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$<br/>f(n) = \\\\varphi(n) - \\\\sum_{d \\\\mid n,\\\\;d \\\\lt n} f(d)<br/>$$<br/>\u6240\u4ee5\u6b27\u62c9\u51fd\u6570\u53ef\u4ee5$\\\\Theta(n)$\u9884\u5904\u7406\uff0c\u800c\u540e\u9762\u7684\u90e8\u5206\u53ef\u4ee5\u6309\u7167\u8d21\u732e\u8ba1\u7b97\uff0c\u505a\u5230$O(n \\\\ln n)$\u3002<br/>mdzz\uff0c$O(n \\\\ln n)$\u600e\u6562\u8fc7......<br/>\u5176\u6b21\u662f\u4e24\u79cd\u66f4\u5feb\u7b97\u6cd5\u3002<br/>\u7b2c\u4e00\u79cd\u662f\u4e71\u641e\u7b97\u6cd5\uff0c\u662f\u4e00\u4e2a\u5206\u5757\u6253\u8868\u3002<br/>\u7531\u4e8e\u6211\u4eec\u8ba1\u7b97\u4e00\u4e2a$\\\\sum_{d \\\\mid n} \\\\varphi(d) \\\\mu(\\\\frac{n}d)$\u5c31\u9700\u8981$\\\\Theta(\\\\sqrt{n})$\u7684\u65f6\u95f4\uff0c\u8003\u8651\u63d0\u524d\u5c06\u4e00\u4e9b\u7b54\u6848\u8ba1\u7b97\u51fa\u6765\u3002<br/>\u8bbe\u6bcf\u9694$T$\u4e2a\u6253\u4e00\u4e2a\u8868\uff0c\u90a3\u4e48\u603b\u5171\u4f1a\u6253$n / T$\u4e2a\u8868\uff0c\u6bcf\u6b21\u8be2\u95ee\u7684\u65f6\u95f4\u4e3a$O(T\\\\sqrt{n})$\u3002\u56e0\u6b64\uff0c\u53ea\u8981\u4f60\u7684\u6587\u4ef6\u5b58\u5f97\u4e0b\uff0c$T$\u8d8a\u5c0f\u8fd9\u4e2a\u901f\u5ea6\u8d8a\u5feb\u3002<br/>\u7b2c\u4e8c\u79cd\u662f$\\\\Theta(n)$\u7684\u7b97\u6cd5\u3002\u9996\u5148\u8003\u8651\u5c06\u5f0f\u5b50\u53d8\u5f62\uff0c\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\uff1a<br/>$$<br/>\\\\sum_{i=1}^n \\\\sum_{d \\\\mid i} \\\\varphi(d) \\\\mu(\\\\frac{i}d) \\\\Longrightarrow \\\\sum_{d = 1}^n \\\\varphi(d) \\\\sum_{k = 1}^{\\\\left\\\\lfloor \\\\frac{n}d \\\\right\\\\rfloor} \\\\mu(k)<br/>$$<br/>\u53d8\u6210\u4e86\u5148\u679a\u4e3e\u56e0\u5b50\uff0c\u7136\u540e\u679a\u4e3e\u56e0\u5b50\u7684\u500d\u6570\u3002\u4e8e\u662f\u5c31\u53d8\u6210\u4e86\u6b27\u62c9\u51fd\u6570\u548c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u524d\u7f00\u548c\u4e4b\u79ef\u3002<br/>\u6ce8\u610f\u4e0d\u8981\u5199\u51fa\u4ee5\u4e0b\u4ee3\u7801\uff1a<br/>1typedef int int64;<br/><br/><br/>\u5426\u5219\u4f1a\u6302\u5f97\u5f88\u60e8\u3002<br/>B<br/>Haogram\u7684\u9898\u4f3c\u4e4e\u6709\u5f88\u591a\u505a\u6cd5\uff0c\u6211\u90fd\u4e0d\u592a\u8bb0\u5f97\u4e86\uff0c\u8fd9\u91cc\u778eBB\u4e00\u4e0b\uff1a<br/>\u6211\u7684\u505a\u6cd5\u662f\u751f\u6210\u51fd\u6570\u3002\u4e00\u4e2a\u6700\u539f\u59cb\u7684\u60f3\u6cd5\u662f\u679a\u4e3e\u73af\u4e0a\u56db\u6761\u8fb9\u6709\u591a\u5c11\u4e2a\u4eba\uff0c\u8fd9\u6837\u5c06\u56db\u6761\u8fb9\u4e0a\u7684\u7b54\u6848\u76f8\u4e58\u5e76\u4e14\u4e58\u4e0a\u7ad9\u5728\u73af\u5916\u7684\u65b9\u6848\u6570\u5c31\u662f\u5f53\u524d\u7b54\u6848\u3002<br/>\u8fd9\u6837\u7eaf\u679a\u4e3e\u662f$\\\\Theta(n^4)$\u7684\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u975e\u5e38\u7c7b\u4f3c\u4e8e\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u6362\u6210\u751f\u6210\u51fd\u6570\u7684\u89c2\u70b9\uff0c\u5c31\u662f\u5c06\u7b54\u6848\u7ec4\u5408\u8d77\u6765\u3002<br/>\u4e8e\u662f\u8bbe\u56db\u4e2a\u751f\u6210\u51fd\u6570\uff0c\u5206\u522b\u8868\u793a\u4e00\u6761\u8fb9\u4e0a\u7ad9$0,\\\\;1,\\\\;2,\\\\;\\\\dots$\u4e2a\u4eba\u7684\u65b9\u6848\u6570\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u7ec4\u5408\u6570\uff0c\u7136\u540e\u66b4\u529b\u5c06\u591a\u9879\u5f0f\u4e58\u8d77\u6765 (\u56e0\u4e3a$n$\u5f88\u5c0f)\uff0c\u53ef\u4ee5\u505a\u5230$\\\\Theta(n^2)$\u7684\u590d\u6742\u5ea6\u3002<br/>\u5982\u679c$n$\u5f88\u5927\u53ef\u4ee5\u6362\u6210FFT\u6216NTT\u3002\u6ce8\u610f\u4f7f\u7528NTT\u65f6\uff0c\u56e0\u4e3a\u9898\u76ee\u4e2d\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a\u6a21\u6570\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u6a21\u6570\u6216\u591a\u6216\u5c11\u4f1a\u6709\u4e00\u4e9b\u51b2\u7a81\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u3002<br/>\u7136\u540e\u5c31\u662f\u7559\u4e0b\u56db\u4e2a\u89d2\u7684\u7279\u6b8a\u60c5\u51b5\u3002\u4e4b\u524d\u6211\u4eec\u9700\u8981\u5728\u8fb9\u4e0a\u7684\u4eba\u4e0d\u80fd\u7ad9\u5728\u89d2\u4e0a\u3002\u73b0\u5728\u6765\u94a6\u5b9a\u8fd9\u56db\u4e2a\u89d2\u4e0a\u6709\u6ca1\u6709\u4eba\u3002\u6700\u540e\u4f60\u4e00\u5171\u8981\u624b\u52a8\u679a\u4e3e$7$\u4e2d\u60c5\u51b5orzorz......<br/>\u6ce8\u610f\u5176\u4e2d\u4e00\u6761\u8fb9\u9000\u5316\u4e3a$1$\u7684\u60c5\u51b5\u3002<br/>\u6807\u89e3\u662f\u4f7f\u7528\u5bb9\u65a5\u539f\u7406\u3002\u56e0\u4e3a\u4e0d\u8003\u8651\u90a3\u4e2a\u83ab\u540d\u5176\u5999\u7684\u8981\u6c42\uff0c\u76f4\u63a5\u8ba1\u6570\u662f\u5f88\u7b80\u5355\u7684\u3002\u7136\u540e\u5c31\u9700\u8981\u8003\u8651\u53bb\u6389\u4e0d\u5408\u6cd5\u7684\u60c5\u51b5\u3002\u57fa\u7840\u60c5\u51b5\u81ea\u7136\u662f\u4e00\u6761\u8fb9\u4e0a\u6ca1\u6709\u4eba\u3002<br/>\u8fd0\u7528\u5bb9\u65a5\u539f\u7406\u4e71\u641e\u5c31\u597d\u4e86~~\u53ea\u6709$4$\u4e2a\u6761\u4ef6\u6240\u4ee5\u901f\u5ea6\u5f88\u5feb\u3002<br/>C<br/>\u4f60\u4eec\u81ea\u5df1\u95eeLink\u5427\uff0c\u6211\u4e5f\u4e0d\u4f1a......<br/>D<br/>\u539f\u6765\u53ea\u8981\u51fa\u4ea4\u4e92\u9898\u5c31\u53ef\u4ee5\u505a\u5230\u5168\u573a\u7206$\\\\color{red}{0}$\uff0c\u66fe\u7ecf\u6709\u4eba\u51fa\u8fc7\u63d0\u7b54\u9898\uff0c\u7ed3\u679c\u5168\u573aAC......<br/>60\u5206\u4e0d\u5199\u5c31\u7b97\u4e86\uff0c40\u5206\u667a\u969c\u5206\u4e5f\u4e0d\u5199\u4f60\u4eec\u597d\u52b2\u554a\uff01\u4e00\u9897\u8d5b\u8247\u554a\uff01<br/>\u9996\u5148\u767e\u5ea6\u4e00\u4e0b\u548c\u8c37\u6b4c\u4e00\u4e0b\u7684\u7b2c\u4e00\u7248\u7684\u7b97\u6cd5\u57fa\u672c\u4e0a\u5c31$10$\u5230$20$\u5de6\u53f3\u5427\u3002\u5c04\u7ebf\u6cd5\u548c\u89d2\u5ea6\u5224\u522b\u6cd5\u90fd\u662f$\\\\Theta(n)$\u7684\u7b97\u6cd5\u3002<br/>\u7136\u540e\u540e\u9762$40$\u5206\u662f\u4e9b\u667a\u969c\u6570\u636e\u70b9\u3002\u7b2c$5$\u4e2a\u70b9\u662f\u4e0a\u8fb9\u4f1a\u4e0a\u4e0b\u8d77\u4f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u627e\u51fa\u5bf9\u5e94\u7684\u8fb9\uff0c\u7136\u540e\u53c9\u79ef\u5224\u65ad\u5373\u53ef\u3002<br/>\u7b2c$6$\u4e2a\u70b9\u51f8\u591a\u8fb9\u5f62\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u4e09\u89d2\u5256\u5206\uff0c\u7136\u540e\u5229\u7528\u89d2\u5ea6\u4e8c\u5206\u627e\u5230\u5bf9\u5e94\u7684\u4e09\u89d2\u5f62\uff0c\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u5224\u5b9a\u4e86\u3002\u8fd9\u4e9b\u8fc7\u7a0b\u5747\u53ef\u7528\u53c9\u79ef\u3002<br/>\u7b2c$7$\u4e2a\u70b9\u76f4\u63a5\u5728initialize\u91cc\u9762\u5168\u90e8\u9884\u5904\u7406\u5c31OK\u4e86\u3002\u6ce8\u610f\u67e5\u8be2\u7684\u70b9\u53ef\u80fd\u4e0d\u5728\u90a3\u4e2a\u8303\u56f4\u5185\uff0c\u9700\u8981\u7279\u5224\u4e00\u4e0b\u3002<br/>\u63a5\u4e0b\u6765\u662f\u6807\u51c6\u89e3\u6cd5\u3002<br/>\u9996\u5148\u8003\u8651\u4e00\u4e2a\u79bb\u7ebf\u7b97\u6cd5\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u6211\u662f\u4ece\u68af\u5f62\u5316\u4e09\u89d2\u5256\u5206\u91cc\u501f\u9274\u5230\u7684\u3002\u9996\u5148\u5c06\u6240\u6709\u8fb9\u5efa\u7acb\u4e24\u4e2a\u4e8b\u4ef6\uff0c\u5de6\u7aef\u70b9\u63d2\u5165\u548c\u53f3\u7aef\u70b9\u5220\u9664\uff0c\u7136\u540e\u6392\u5e8f\u3002\u67e5\u8be2\u4e5f\u8981\u6392\u5e8f\u3002<br/>\u7136\u540e\u505a\u4e00\u6761\u4ece\u5de6\u81f3\u53f3\u7684\u7ad6\u76f4\u626b\u63cf\u7ebf\uff0c\u7528\u4e00\u68f5\u5e73\u8861\u6811\u6765\u7ef4\u62a4\u5f53\u524d\u7a7f\u8fc7\u626b\u63cf\u7ebf\u7684\u8fb9\u3002<br/>\u5f88\u660e\u663e\u7684\u4e00\u70b9\u5c31\u662f\u5e73\u8861\u6811\u4e2d\u7684\u8fb9\u4e0d\u4f1a\u76f8\u4ea4\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u65b9\u4fbf\u5730\u786e\u5b9a\u4e24\u6761\u8fb9\u4e4b\u95f4\u7684\u6bd4\u8f83\u5173\u7cfb\u3002<br/>\u9996\u5148\u5982\u679c\u4e00\u6761\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u90fd\u5728\u53e6\u4e00\u6761\u8fb9\u6240\u5728\u7684\u76f4\u7ebf\u4e0b\u9762\uff0c\u90a3\u4e48\u8fd9\u6761\u8fb9\u80af\u5b9a\u5728\u5728\u53e6\u4e00\u6761\u8fb9\u4e0b\u9762\u3002<br/>\u5229\u7528\u8fd9\u4e00\u70b9\u5c31\u53ef\u786e\u5b9a\u5927\u5c0f\u5173\u7cfb\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a<br/><br/>\u6b64\u65f6$A$\u663e\u7136\u5728$B$\u4e0b\u9762\uff0c\u7136\u800c\u5982\u679c\u7528$A$\u53bb\u5224\u5b9a$B$\u5c31\u4f1a\u5f97\u5230\u9519\u8bef\u7684\u7ed3\u679c (\u56e0\u4e3a$B$\u6709\u4e00\u4e2a\u70b9\u5728$A$\u6240\u5728\u76f4\u7ebf\u4e0b\u65b9)\u3002<br/>\u6211\u4eec\u6240\u8981\u505a\u7684\u5c31\u662f\uff0c\u5f53\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u65f6\uff0c\u4ea4\u6362$A$\u548c$B$\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002<br/>\u8fd9\u6837\u6211\u4eec\u6bcf\u626b\u63cf\u5b8c\u4e00\u4e2a$x$\uff0c\u5c31\u53ef\u4ee5\u9010\u4e2a\u56de\u7b54\u5f53\u524d\u7684\u8be2\u95ee\u4e86\u3002\u5728\u5e73\u8861\u6811\u4e0a\u4e8c\u5206\u627e\u5230\u4e0a\u4e0b\u8fb9\uff0c\u7136\u540e\u5224\u5b9a\u8fd9\u4e2a\u70b9\u662f\u5426\u5728\u8fd9\u4e24\u6761\u8fb9\u6240\u8868\u793a\u7684\u534a\u5e73\u9762\u4ea4\u7684\u8303\u56f4\u5185\u3002<br/>\u7531\u4e8e\u662f\u4ea4\u4e92\u9898\uff0c\u88ab\u5f3a\u5236\u5728\u7ebf\u4e86\u3002\u4e3a\u4e86\u80fd\u591f\u5728\u7ebf\uff0c\u6211\u4eec\u9700\u8981\u6bcf\u4e00\u4e2a$x$\u5904\u7684\u5e73\u8861\u6811\u6765\u5728\u7ebf\u56de\u7b54\u3002\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u5229\u7528\u53ef\u6301\u4e45\u5316\u5e73\u8861\u6811\u9ad8\u6548\u5730\u5b58\u4e0b\u6765\u3002",
"url": "blog/2016-8-28/hnsdfz-5.html"
},
"Hall \u5b9a\u7406": {
"tags": "\u56fe\u8bba \u4e8c\u5206\u56fe Hall \u5b9a\u7406",
"text": "Hall \u5b9a\u7406<br/>\u57fa\u672c\u5f62\u5f0f<br/>Hall \u5b9a\u7406\u662f\u4e00\u4e2a\u7528\u4e8e\u5224\u5b9a\u4e8c\u5206\u56fe\u662f\u5426\u5177\u6709\u5b8c\u7f8e\u5339\u914d\u7684\u5b9a\u7406\u3002<br/>\u9996\u5148\u5bf9\u4e8e\u4e8c\u5206\u56fe $G = (X \\\\cup Y, E)$\uff0c\u70b9\u96c6\u88ab\u5206\u4e3a\u4e86 $X$ \u548c $Y$ \u4e24\u90e8\u5206\u3002<br/>\u662f\u5426\u5177\u6709\u5b8c\u7f8e\u5339\u914d\uff0c\u9996\u5148\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u6761\u4ef6\u5c31\u662f $|X| = |Y|$\u3002<br/>Hall \u5b9a\u7406\u5219\u5728\u6b64\u57fa\u7840\u4e0a\u7ed9\u51fa\u4e86\u4e00\u4e2a\u66f4\u5f3a\u7684\u6761\u4ef6\u3002<br/>\u9996\u5148\u5bf9\u4e8e\u4e00\u4e2a\u70b9\u96c6 $T \\\\subseteq X$\uff0c\u5b9a\u4e49 $\\\\Gamma(T)$ \u5982\u4e0b\uff1a<br/>$$<br/>\\\\Gamma(T) = \\\\{v \\\\mid u \\\\rightarrow v \\\\in E,\\\\; u \\\\in T,\\\\; v \\\\in Y\\\\}<br/>$$<br/>\u5373\u8868\u793a $T$ \u4e2d\u6240\u6709\u70b9\u80fd\u591f\u76f4\u63a5\u5230\u8fbe\u7684 $Y$ \u4e2d\u7684\u70b9\u7684\u96c6\u5408\u3002<br/><br/>\u4e0a\u56fe\u4e2d\uff0c$\\\\Gamma(\\\\{1,\\\\;3\\\\}) = \\\\{4,\\\\;5,\\\\;6\\\\}$\u3002<br/>Hall \u6761\u4ef6\u7528\u4e8e\u5224\u65ad\u4e00\u4e2a\u4e8c\u5206\u56fe\u662f\u5426\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002\u5982\u679c\u5bf9\u4e8e\u4efb\u610f\u7684\u70b9\u96c6 $T \\\\subseteq X$\uff0c\u5747\u5b58\u5728\uff1a<br/>$$<br/>|T| \\\\le |\\\\Gamma(T)|<br/>$$<br/>\u79f0\u6b64\u4e8c\u5206\u56fe\u6ee1\u8db3 Hall \u6761\u4ef6\u3002Hall \u5b9a\u7406\u7684\u8868\u8ff0\u5982\u4e0b\uff1a<br/><br/>\u4e8c\u5206\u56fe $G(X \\\\cup Y,E)$ \u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u5f53\u4e14\u4ec5\u5f53 $|X| = |Y|$ \u5e76\u4e14\u6ee1\u8db3 Hall \u6761\u4ef6\u3002<br/><br/>\u672c\u6587\u4f1a\u4f7f\u7528 $C = A - B$ \u8868\u793a\u96c6\u5408\u4e4b\u5dee\uff0c\u5373 $C = A \\\\cap \\\\overline B$\u3002<br/>\u8bc1\u660e<br/>\u9996\u5148\uff0c\u5f53 $|X| \\\\neq |Y|$ \u65f6\uff0c\u4e8c\u5206\u56fe\u4e0d\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002\u5982\u679c\u4e8c\u5206\u56fe\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\uff0c\u5219\u610f\u5473\u7740 $|X| = |Y|$\u3002\u6b64\u5916\uff0c\u4e0a\u8ff0\u5b9a\u7406\u7684\u5145\u5206\u6027\u975e\u5e38\u663e\u7136\uff0c\u56e0\u4e3a\u5982\u679c $|\\\\Gamma(T)| < |T|$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5b50\u96c6 $T$ \u662f\u65e0\u6cd5\u627e\u51fa\u5b8c\u7f8e\u5339\u914d\u7684\u3002<br/>\u73b0\u5728\u6765\u8bc1\u660e\u5fc5\u8981\u6027\u3002\u8bb0 $n = |X|$\uff0c\u4e0d\u96be\u53d1\u73b0\u5f53 $n = 0$ \u6216 $n = 1$ \u65f6\uff0cHall \u5b9a\u7406\u662f\u6210\u7acb\u7684\u3002<br/>\u5c1d\u8bd5\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u6765\u8bc1\u660e $n > 1$ \u7684\u60c5\u5f62\u3002\u5047\u8bbe\u5bf9\u4e8e\u4efb\u610f $n < k$ \u7684\u60c5\u51b5\u90fd\u662f\u6210\u7acb\u7684\uff0c\u5219\u9700\u8981\u8bc1\u660e\u5f53 $n = k$ \u65f6\u4e5f\u662f\u6210\u7acb\u7684\u3002\u5148\u6765\u8003\u8651\u6761\u4ef6\u6700\u4e3a\u82db\u523b\u7684\u4e00\u7c7b\u975e\u7a7a\u771f\u5b50\u96c6 $T \\\\subset X$\uff0c\u5b83\u6ee1\u8db3 $|\\\\Gamma(T)| = |T|$\u3002\u5bf9\u4e8e\u5b50\u96c6 $S \\\\subseteq X - T$\uff0c\u7531\u4e8e\u6ee1\u8db3 Hall \u6761\u4ef6\uff0c\u6240\u4ee5 $|\\\\Gamma(S  \\\\cap T)| \\\\geq |S \\\\cap T|$\uff0c\u53c8\u56e0\u4e3a $|\\\\Gamma(T)| = |T|$\uff0c\u6240\u4ee5 $|\\\\Gamma(S) - \\\\Gamma(T)| \\\\geq |S|$\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u56fe $G$ \u4e2d\u5220\u53bb $T$ \u548c $\\\\Gamma(T)$ \u4e2d\u7684\u6240\u6709\u70b9\u5f97\u5230\u65b0\u56fe $G'(X' \\\\cup Y',E')$\uff0c\u5219 $|X'| < k$ \u4e14\u4f9d\u7136\u6ee1\u8db3 Hall \u6761\u4ef6\uff0c\u6545 $G'$ \u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002\u7531\u4e8e $T$ \u662f\u771f\u5b50\u96c6\uff0c\u6240\u4ee5 $|T| < k$\uff0c\u6240\u4ee5 $G$ \u5173\u4e8e\u70b9\u96c6 $T \\\\cup \\\\Gamma(T)$ \u7684\u5bfc\u51fa\u5b50\u56fe\u4e00\u5b9a\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002\u5373 $G$ \u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002<br/>\u6ce8\u610f\u5230\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u7684\u975e\u7a7a\u771f\u5b50\u96c6 $T$ \u5e76\u4e0d\u603b\u662f\u5b58\u5728\u3002\u5f53\u4e0d\u5b58\u5728\u7684\u65f6\u5019\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>|\\\\Gamma(T)| \\\\geq |T| + 1 \\\\;\\\\;\\\\;\\\\; (\\\\forall \\\\; T \\\\subset X)<br/>$$<br/>\u8fd9\u4e2a\u65f6\u5019\u4efb\u610f\u5220\u53bb\u56fe $G$ \u7684\u4efb\u610f\u4e00\u6761\u5339\u914d\u8fb9\uff0c\u4e0d\u4f1a\u4f7f $G$ \u4e0d\u7b26\u5408 Hall \u6761\u4ef6\u3002\u7531\u4e8e $n$ \u51cf\u5c11\u4e86 $1$\uff0c\u6240\u4ee5\u5220\u53bb\u8be5\u5339\u914d\u8fb9\u540e\u7684\u56fe\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002<br/>\u8ba1\u7b97\u6240\u6709\u6ee1\u8db3 Hall \u6761\u4ef6\u7684\u5b50\u96c6<br/>\u5bf9\u4e8e\u4e00\u5f20\u4e8c\u5206\u56fe\u800c\u8a00\uff0c\u5982\u4f55\u786e\u5b9a $X$ \u6216 $Y$ \u7684\u4e00\u4e2a\u5b50\u96c6\u662f\u5426\u6ee1\u8db3 Hall \u6761\u4ef6\uff1f<br/>\u4ee4 $n$ \u4e3a $|X|$\u3002\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5b9a\u4e49\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5b50\u96c6\u679a\u4e3e\u81ea\u5df1\u7684\u5b50\u96c6\u3002\u91c7\u7528 DP\uff0c\u53ef\u4ee5\u63a8\u7b97\u51fa\u6240\u6709\u5b50\u96c6\u7684\u7b54\u6848\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(3^n)$\u3002<br/>\u8003\u8651\u5230\u76f4\u63a5\u679a\u4e3e\u5b50\u96c6\u8fc7\u4e8e\u66b4\u529b\uff0c\u56e0\u6b64\u5148\u9009\u62e9\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\u70b9 $u$\uff0c\u5c06\u5176\u5220\u53bb\uff0c\u5c06\u4f1a\u5f97\u5230\u4e00\u4e2a\u66f4\u5c0f\u7684\u5b50\u96c6\uff0c\u8fd9\u4e2a\u503c\u5df2\u7ecf\u88ab\u63d0\u524d\u8ba1\u7b97\u8fc7\u4e86\uff0c\u56e0\u6b64\u4e00\u5927\u90e8\u5206\u7684\u5b50\u96c6\u7684\u7b54\u6848\u5c31\u90fd\u88ab\u7b97\u5165\u5176\u4e2d\u4e86\u3002\u5269\u4e0b\u7684\u8fd8\u672a\u8003\u8651\u5230\u7684\u5b50\u96c6\u5747\u5305\u542b $u$\uff0c\u4f46\u662f\u9664\u4e86\u96c6\u5408\u672c\u8eab\u5916\uff0c\u5269\u4f59\u7684\u5b50\u96c6\u5747\u4f1a\u76f8\u5dee\u81f3\u5c11\u4e00\u4e2a\u70b9\u3002\u56e0\u6b64\u6211\u4eec\u679a\u4e3e\u6240\u6709\u96c6\u5408\u4e2d\u7684\u70b9\u5e76\u53bb\u6389\uff0c\u7528\u5f97\u5230\u7684\u65b0\u7684\u66f4\u5c0f\u7684\u96c6\u5408\u7684 DP \u503c\u6765\u66f4\u65b0\u5f53\u524d\u96c6\u5408\uff0c\u6700\u540e\u518d\u8ba1\u7b97\u81ea\u5df1\u662f\u5426\u6ee1\u8db3\u4e0d\u7b49\u5f0f\u3002\u8fd9\u6837\u8ba1\u7b97\u7684\u65f6\u95f4\u662f $O(2^n \\\\cdot n)$ \u7684\u3002<br/>\u5927\u81f4\u7684\u4ee3\u7801\u5982\u4e0b\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5f = [True] * 2^n  // DP\u6570\u7ec4<br/>for s in [0, 2^n):<br/>    for u in [0, n):<br/>        f[s] &= f[s ^ (1 << u)]<br/>    # \u68c0\u67e5s\u672c\u8eab\u662f\u5426\u53ef\u884c\uff0c\u66f4\u65b0f[s]<br/><br/><br/>\u7b80\u5355\u8fd0\u7528<br/>Hall \u5b9a\u7406\u4e00\u822c\u6ca1\u6709\u4ec0\u4e48\u4f18\u5316\u7b97\u6cd5\u590d\u6742\u5ea6\u4e0a\u7684\u7528\u9014\uff0c\u4f46\u662f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u601d\u7ef4\u5de5\u5177\u3002<br/>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a\u95ee\u9898\uff1a<br/>[Russian Code Cup 2016 - Finals] A. Closing ceremony<br/>\u5927\u610f\u662f\u6709\u4e00\u4e2a $n\\\\times m$ \u7684\u7f51\u683c\u548c $n \\\\times m$ \u4e2a\u4eba\uff0c\u6bcf\u4e2a\u4eba\u90fd\u8981\u8d70\u5230\u4e00\u4e2a\u7f51\u683c\u4e0a\u7684\u4e00\u70b9\uff0c\u6bcf\u4e2a\u70b9\u53ea\u80fd\u88c5\u4e0b\u4e00\u4e2a\u4eba\u3002<br/>\u540c\u65f6\u5b9a\u4e49\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e3a\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u6bcf\u4e2a\u4eba\u6709\u81ea\u5df1\u884c\u8d70\u7684\u8def\u7a0b\u4e0a\u9650\u3002<br/>\u73b0\u5728\u8fd9 $n \\\\times m$ \u4e2a\u4eba\u5206\u6210\u4e24\u6279\uff0c\u4ece $(0,\\\\;0)$ \u548c $(0,\\\\;m+1)$ \u51fa\u53d1\uff0c\u95ee\u4f60\u662f\u5426\u5b58\u5728\u4e00\u79cd\u5b89\u6392\u6bcf\u4e2a\u4eba\u7684\u6700\u7ec8\u4f4d\u7f6e\u7684\u65b9\u6848\uff0c\u6765\u6ee1\u8db3\u6bcf\u4e2a\u4eba\u8d70\u5230\u5bf9\u5e94\u4f4d\u7f6e\u65f6\u7684\u8def\u7a0b\u4e0d\u8d85\u8fc7\u81ea\u5df1\u7684\u4e0a\u9650\u3002<br/>\u4ee4\u70b9 $A$ \u4e3a $(0,\\\\;0)$\uff0c\u70b9 $B$ \u4e3a $(0,\\\\;m+1)$\u3002\u5e76\u4e14\u8bbe $f(i,\\\\;j)$ \u8868\u793a\u79bb $A$ \u8ddd\u79bb\u81f3\u5c11\u4e3a $i$\uff0c\u79bb $B$ \u8ddd\u79bb\u81f3\u5c11\u4e3a $j$ \u7684\u683c\u5b50\u7684\u4e2a\u6570\u3002<br/>\u8bbe $S_A(i)$ \u8868\u793a\u5728 $A$ \u6700\u8fdc\u8ddd\u79bb\u81f3\u5c11\u4e3a $i$ \u7684\u4eba\u6570\uff0c\u540c\u7406\uff0c$S_B(i)$ \u8868\u793a\u5728 $B$ \u5904\u6700\u8fdc\u8ddd\u79bb\u81f3\u5c11\u4e3a $i$ \u7684\u4eba\u6570\u3002\u7531\u4e8e\u6bcf\u4e2a\u4eba\u548c\u4e00\u4e2a\u4f4d\u7f6e\u5f62\u6210\u4e86\u4e00\u4e2a\u4e00\u4e00\u5bf9\u5e94\u7684\u5173\u7cfb\uff0c\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u4e8c\u5206\u56fe\uff0c\u5e76\u4e14\u6211\u4eec\u6240\u8981\u505a\u7684\u5c31\u662f\u5224\u5b9a\u8fd9\u4e2a\u4e8c\u5206\u56fe\u662f\u5426\u5177\u6709\u5b8c\u7f8e\u5339\u914d\u3002<br/>\u4e8b\u5b9e\u4e0a\u7531\u4e8e\u5b58\u5728\u5355\u8c03\u6027\uff0c\u5229\u7528 Hall \u5b9a\u7406\u53ef\u4ee5\u77e5\u9053\uff0c\u6211\u4eec\u53ea\u7528\u5224\u5b9a\u662f\u5426\u5bf9\u4e8e\u6240\u6709\u7684 $f(i,\\\\;j)$ \u5747\u4e0d\u5927\u4e8e $S_A(i) + S_B(j)$\uff0c\u5982\u679c\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4e8c\u5206\u56fe\u5c31\u6709\u6700\u5927\u5339\u914d\u3002<br/>\u90a3\u4e48\u73b0\u5728\u7684\u95ee\u9898\u5c31\u662f\u6c42\u5f97 $f$\u3002\u7531\u4e8e\u66fc\u54c8\u987f\u8ddd\u79bb\u4e3a $i$ \u7684\u7b49\u8ddd\u7ebf\u5b9e\u9645\u4e0a\u662f\u4e00\u6761\u659c\u7387\u4e3a $1$ \u6216 $-1$ \u7684\u76f4\u7ebf\uff0c\u6240\u4ee5 $f(i,\\\\;j)$ \u5c31\u662f\u4e24\u6761\u76f4\u7ebf\u5728\u7f51\u683c\u4e2d\u56f4\u6210\u7684\u9762\u79ef\u3002<br/>\u5e76\u4e14\u6ce8\u610f\u5230\u5b83\u53ef\u4ee5\u9012\u5f52\u8ba1\u7b97\uff1a<br/>$$<br/>f(i,\\\\;j) = f(i+1,\\\\;j) + f(i,\\\\;j+1) - f(i+1,\\\\;j+1)<br/>$$<br/>\u5e76\u4e14\u9700\u8981\u8003\u8651\u8fd9\u4e24\u6761\u76f4\u7ebf\u7684\u4ea4\u70b9\u662f\u5426\u4f1a\u5360\u7528\u4e00\u4e2a\u683c\u5b50\u3002\u6240\u4ee5\u6211\u4eec\u7684\u505a\u6cd5\u5c31\u662f\u679a\u4e3e\u4ea4\u70b9\uff0c\u786e\u5b9a\u662f\u90a3\u4e24\u6761\u76f4\u7ebf\u76f8\u4ea4\uff0c\u5e76\u4e14\u8d4b\u7ed9\u5bf9\u5e94\u7684 $f$ \u53bb\uff0c\u7136\u540e\u5bf9 $f$ \u8ba1\u7b97\u540e\u7f00\u548c\u5c31\u662f\u6211\u4eec\u60f3\u8981\u7684\u4e1c\u897f\u5566\uff5e",
"url": "blog/2016-9-19/hall-theorem.html"
},
"Home Page": {
"tags": "Home",
"text": "\u6b22\u8fce\u6765\u5230 riteme\u2019s site\uff01<br/>\u8fd9\u662f riteme \u7684\u4e2a\u4eba\u4e3b\u9875\u3002<br/>\u5168\u90e8\u6362\u6210 Material Design \u5566\uff0c\u867d\u7136\u8fd8\u662f\u4e0d\u6e05\u771f\u2026<br/>\u535a\u5ba2\u66f4\u65b0\u6bd4\u8f83\u7f13\u6162\uff0c\u53ef\u80fd\u4f1a\u957f\u671f\u4e0d\u66f4......<br/>\u535a\u5ba2\u91cc\u5927\u591a\u5173\u4e8e\u7f16\u7a0b\u4e0e OI\uff0c\u5927\u5bb6\u968f\u610f\u7ffb\u9605~~<br/>\u6700\u8fd1\u66f4\u65b0<br/>\u6570\u5b66\u95ee\u9898\u6742\u8bb0\u4e00\u4e9b\u6bd4\u8f83\u6709\u610f\u601d\u7684\u6570\u5b66\u95ee\u9898Read More\u2026<br/>\u675c\u6559\u7b5b\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790Read More\u2026<br/>\u9644\u4e2d 2018 \u590f\u4ee4\u8425\u8bfe\u4ef6Read More\u2026<br/>\u6700\u5c0f\u6811\u5f62\u56fe\u6700\u5c0f\u6811\u5f62\u56fe\u6731\u5218\u7b97\u6cd5\u4ee5\u53ca Tarjan \u7684\u6539\u8fdb\u7248\u672cRead More\u2026<br/>\u780d\u6728\u68cd\u95ee\u9898\u5c06\u4e00\u6839\u957f\u4e3a $a$ \u7684\u6728\u68cd\u6bcf\u6b21\u968f\u673a\u780d\u6389\u4e00\u6bb5\uff0c\u671f\u671b\u591a\u5c11\u6b21\u540e\u6728\u68cd\u957f\u5ea6\u5c0f\u4e8e $b$ \uff1fRead More\u2026<br/>\u4f4d\u8fd0\u7b97\u5377\u79ef\u4e0e FWT\u4ecb\u7ecd\u4e86\u4f4d\u8fd0\u7b97\u5377\u79ef\u4ee5\u53ca\u5feb\u901f\u8ba1\u7b97\u7684 FWT \u7b97\u6cd5Read More\u2026<br/>\u533a\u95f4\u52a0\u591a\u9879\u5f0f\u95ee\u9898\u7684\u7814\u7a76Read More\u2026<br/>\u8ba1\u7b97\u7eaf\u7535\u963b\u7f51\u7edc\u7684\u7b49\u6548\u7535\u963bRead More\u2026<br/>OI Coding Guidelines\u4e2a\u4eba\u5bf9 OI \u7f16\u7a0b\u7684\u4e00\u4e9b\u7ecf\u9a8cRead More\u2026<br/>\u8ba1\u7b97\u5206\u62c6\u6570\u7684\u4e00\u79cd\u65b9\u6cd5\u4f7f\u7528\u591a\u9879\u5f0f\u4e58\u6cd5\u52a0\u901f\u8ba1\u7b97\u5206\u62c6\u6570Read More\u2026<br/>\u67e5\u770b\u5168\u90e8",
"url": "index.html"
},
"Int 2048": {
"tags": "Problems",
"text": "Int 2048<br/>\u65f6\u95f4\u9650\u5236\uff1a$1 \\\\mathrm{s}$<br/>\u7a7a\u95f4\u9650\u5236\uff1a$1024 \\\\mathrm{MB}$<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u8fd9\u662f\u4e00\u9053\u4ea4\u4e92\u9898\u3002<br/>\u6ce8\u610f\u672c\u4ea4\u4e92\u5e93\u4e0d\u63d0\u4f9bPascal\\\\C\u652f\u6301\uff0c\u53ea\u652f\u6301C++\u3002<br/>L\u8bed\u8a00\u4e4b\u7236Lunk\u6700\u8fd1\u58f0\u79f0\u7528\u8be5\u8bed\u8a00\u7f16\u5199\u8ba1\u6570\u95ee\u9898\u4e0d\u8981\u53d6\u6a21\uff0c\u56e0\u4e3aLunk\u53d1\u660e\u4e86$256 \\\\mathrm{\\\\ Byte}$\u7684int2048_t\uff0c\u5e76\u4e14\u5df2\u7ecf\u5185\u7f6e\u5230L\u8bed\u8a00\u4e2d\u3002<br/>\u7136\u800c\u5c41\u6c11\u4eec\u5e76\u4e0d\u76f8\u4fe1\uff0c\u56e0\u4e3aLunk\u7684int2048_t\u8fd8\u4e0d\u652f\u6301Xntel\u516c\u53f8\u7684CSB\u6307\u4ee4 (Count Set Bits\uff0c\u8ba1\u6570\u88ab\u8bbe\u7f6e\u7684\u4f4d\u7684\u6570\u91cf)\uff0c\u4e8e\u662f\u4f17\u4ebaD\u4e4b\u3002Lunk\u4e3a\u4e86\u633d\u56de\u81ea\u5df1\u7684\u8138\u9762\uff0c\u51b3\u5b9a\u5b9e\u73b0\u4e00\u4e2aCSB\u547d\u4ee4\u6765\u6559\u8bad\u4e00\u4e0b\u8fd9\u7fa4\u667a\u969c\u3002<br/>CSB\u6307\u4ee4\u662f\u4e00\u4e2a\u8fd9\u6837\u7684\u6307\u4ee4\uff1a\u5b83\u7528\u4e8e\u8ba1\u6570\u4e00\u4e2a\u6574\u578b\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u7684$1$\u7684\u4e2a\u6570\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u6574\u578b\u4e2d\uff1a<br/>$$01001101$$<br/>\u5176\u6267\u884cCSB\u7684\u7ed3\u679c\u662f$4$\u3002<br/>Lunk\u4e0d\u60f3\u518d\u641e\u4e2a\u65b0\u4e1c\u897f\u6765\u652f\u6301\u8fd9\u4e2a\u5783\u573e\u73a9\u610f\uff0c\u4ed6\u53ea\u51c6\u5907\u5229\u7528\u73b0\u6709\u7684\u529f\u80fd\u6765\u5b9e\u73b0\u5b83\u3002\u76ee\u524dint2048_t\u6240\u652f\u6301\u7684\u529f\u80fd\u5982\u4e0b\u8868\u6240\u793a\uff1a<br/><br/><br/><br/>\u7b26\u53f7<br/>\u8bf4\u660e<br/>\u793a\u4f8b<br/>\u4ee3\u4ef7<br/>\u5b9e\u9645\u590d\u6742\u5ea6<br/><br/><br/><br/><br/>(constructor)<br/>\u6784\u9020\u4e00\u4e2aint2048_t<br/>int2048_t<br/>$0$<br/>$\\\\Theta(n)$<br/><br/><br/>(constructor)<br/>\u4ece\u4e00\u4e2a\u5b57\u7b26\u4e32\u6784\u9020\u4e00\u4e2aint2048_t<br/>int2048_t(\\ 110\\ )<br/>$0$<br/>$\\\\Theta(n)$<br/><br/><br/>+<br/>\u52a0\u6cd5<br/>0011 = 0010 + 0001<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/>-<br/>\u53d6\u8d1f\u6570 (\u8ba1\u7b97\u5176\u8865\u7801)<br/>1111 = -0001<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/>-<br/>\u51cf\u6cd5 (\u9700\u8981\u6267\u884c\u4e00\u4e2a\u53d6\u8d1f\u6570\u548c\u52a0\u6cd5)<br/>1101 = 1111 - 0010<br/>$2$<br/>$\\\\Theta(n)$<br/><br/><br/>~<br/>\u5c06\u5404\u4f4d\u53d6\u53cd<br/>1010 = ~0101<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/>&<br/>\u6309\u4f4d\u4e0e<br/>0010 = 1011 & 0110<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/>|<br/>\u6309\u4f4d\u6216<br/>1111 = 1011 | 0110<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/>^<br/>\u6309\u4f4d\u5f02\u6216<br/>1101 = 1011 ^ 0110<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/><<<br/>\u5de6\u79fb<br/>1100 = 1011 << 2<br/>$1$<br/>$O(n)$<br/><br/><br/>>><br/>\u53f3\u79fb<br/>0010 = 1011 >> 2<br/>$1$<br/>$O(n)$<br/><br/><br/>==<br/>\u5224\u65ad\u662f\u5426\u76f8\u7b49<br/>0010 == 0010<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/>!=<br/>\u5224\u65ad\u662f\u5426\u4e0d\u7b49<br/>0010 != 1010<br/>$1$<br/>$\\\\Theta(n)$<br/><br/><br/><<br/>\u5c0f\u4e8e<br/>0010 < 0100<br/>$1$<br/>$O(n)$<br/><br/><br/>><br/>\u5927\u4e8e<br/>0110 > 0100<br/>$1$<br/>$O(n)$<br/><br/><br/><=<br/>\u5c0f\u4e8e\u7b49\u4e8e<br/>0100 <= 0100<br/>$1$<br/>$O(n)$<br/><br/><br/>>=<br/>\u5927\u4e8e\u7b49\u4e8e<br/>0010 >= 0010<br/>$1$<br/>$O(n)$<br/><br/><br/>(bool)<br/>\u8f6c\u4e3abool\u7c7b\u578b (\u5982\u679c\u4e3a$0$\u5219\u4e3a$\\\\mathrm{false}$\uff0c\u5426\u5219\u4e3a$\\\\mathrm{true}$)<br/>if (a)<br/>$1$<br/>$O(n)$<br/><br/><br/><br/>\u5728\u4e0a\u8868\u4e2d\uff0c\u4ee3\u4ef7\u662f\u667a\u969c\u4eec\u8bc4\u5b9a\u8fd0\u884c\u5feb\u6162\u7684\u6807\u51c6\uff0c\u5b9e\u9645\u590d\u6742\u5ea6\u662f\u5728\u5b9e\u9645\u8fd0\u884c (\u5373\u4f60\u7684\u7a0b\u5e8f) \u4e2d\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5176\u4e2d$n$\u8868\u793aint2048_t\u7684\u4e8c\u8fdb\u5236\u4f4d\u6570\uff0c\u5373$2048$\u3002<br/>\u667a\u969c\u5c41\u6c11\u4eec\u5c06\u4f1a\u7ed9\u51fa\u4e00\u5806\u7684\u6d4b\u8bd5\uff0c\u5982\u679cLunk\u7684CSB\u6307\u4ee4\u5199\u6302\u4e86\uff0c\u90a3\u4e48\u5b83\u4eec\u5c06\u4f1a\u6253$0$\u5206\u3002\u5982\u679cLunk\u7684CSB\u6307\u4ee4\u592a\u6162\uff0c\u5b83\u4eec\u5c31\u53c8\u4e0d\u9ad8\u5174\u3002\u4e8e\u662fLunk\u8bf7\u4f60\u5e2e\u4ed6\u7f16\u5199\u4e00\u4e2a\u5feb\u901f\u7684CSB\u6307\u4ee4\u7684\u5b9e\u73b0\u3002<br/>\u5b9e\u73b0<br/>\u9009\u624b\u76ee\u5f55\u4e0b\u5c06\u4f1a\u4e0b\u53d1int2048_t.hpp\u548cint.h\u4e24\u4e2a\u6587\u4ef6\u3002<br/>int2048_t.hpp\u662fLunk\u7684int2048_t\u7684\u5b9e\u73b0\uff0c\u5df2\u7ecf\u88abint.h\u5305\u542b\uff0c\u9009\u624b\u4e0d\u7528\u81ea\u884c\u5305\u542b\u3002<br/>\u9009\u624b\u9700\u8981\u5b9e\u73b0\u4e00\u4e2aevaluate\u51fd\u6570\uff0c\u8868\u793aCSB\u6307\u4ee4\u3002\u5176\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a<br/>1int evaluate(const int2048_t &num);<br/><br/><br/>\u5f53\u4ea4\u4e92\u5e93\u8fd0\u884c\u65f6\uff0c\u4f1a\u5c06\u6d4b\u8bd5\u6570\u636e\u901a\u8fc7num\u4f20\u5165\uff0c\u800c\u8be5\u51fd\u6570\u7684\u76ee\u7684\u5c31\u662f\u8fd4\u56deCSB\u6307\u4ee4\u5728num\u4e0a\u7684\u7ed3\u679c\u3002<br/>\u6837\u4f8b\u4ea4\u4e92\u5e93<br/>\u9009\u624b\u76ee\u5f55\u4e0b\u5c06\u4f1a\u4e0b\u53d1implementer.cpp\u8fd9\u4e2a\u6587\u4ef6\u3002<br/>\u5047\u8bbe\u4f60\u7684\u5b9e\u73b0\u7684\u6e90\u6587\u4ef6\u662fint.cpp\uff0c\u90a3\u4e48\u4f7f\u7528\u4e0b\u9762\u7684\u7f16\u8bd1\u547d\u4ee4\u6765\u7f16\u8bd1\uff1a<br/>1g++ int.cpp implementer.cpp -std=c++11 -o exec<br/><br/><br/>\u7136\u540e\u5c06\u4f1a\u5f97\u5230\u53ef\u6267\u884c\u6587\u4ef6exec\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6b64\u5904\u7684\u8f93\u5165\u683c\u5f0f\u503c\u9488\u5bf9\u6837\u4f8b\u4ea4\u4e92\u5e93\u800c\u8a00\u7684\u3002<br/>\u8f93\u5165\u53ea\u6709\u4e00\u884c\uff0c\u8868\u793a\u6d4b\u8bd5\u7684\u6574\u5f62\uff0c\u4ee5\u4e8c\u8fdb\u5236\u5f62\u5f0f\u7ed9\u51fa\u3002\u8bf7\u786e\u4fdd\u8f93\u5165\u4e0d\u8d85\u8fc72048\u4f4d\uff0c\u5426\u5219\u5c06\u5bfc\u81f4\u4e0d\u6b63\u5e38\u7ed3\u679c\u3002<br/>\u7531\u4e8eint2048_t\u662f\u6709\u7b26\u53f7\u6574\u578b\uff0c\u51fa\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0c\u6700\u7ec8\u6d4b\u8bd5\u6570\u636e\u7684\u8f93\u5165\u7684\u6700\u9ad8\u4f4d\u90fd\u662f$0$\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u6b64\u5904\u7684\u8f93\u51fa\u683c\u5f0f\u662f\u9488\u5bf9\u6837\u4f8b\u4ea4\u4e92\u5e93\u800c\u8a00\u7684\u3002<br/>\u6837\u4f8b\u4ea4\u4e92\u5e93\u5c06\u4f1a\u4ece\u8f93\u5165\u5f97\u77e5\u7b54\u6848\uff0c\u5e76\u5c06\u8f93\u5165\u8f6c\u4e3aint2048_t\uff0c\u7136\u540e\u6267\u884cevaluate\u5f97\u5230\u4f60\u7684\u7b54\u6848\u3002\u5982\u679c\u4e24\u8005\u7b54\u6848\u4e00\u81f4\uff0c\u5c06\u4f1a\u8f93\u51fa\u4f60\u6240\u4f7f\u7528\u7684\u4ee3\u4ef7\u603b\u548c\u3002\u5426\u5219\u5c06\u8f93\u51faWrong answer\uff0c\u5e76\u7ed9\u51fa\u6b63\u786e\u7b54\u6848\u548c\u4f60\u7684\u7b54\u6848\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>101111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/><br/><br/>\u6837\u4f8b\u7b54\u6848<br/>12047<br/><br/><br/>\u8bc4\u5206\u6807\u51c6<br/>\u6b64\u9898\u5171$10$\u4e2a\u6570\u636e\u70b9\uff0c\u6bcf\u4e2a\u6570\u636e\u70b9$10$\u5206\u3002<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6570\u636e\u70b9\u800c\u8a00\uff0c\u5982\u679c\u4f60\u7684\u7b54\u6848\u4e0d\u6b63\u786e\uff0c\u90a3\u4e48\u5c06\u8bb0$0$\u5206\u3002<br/>\u5426\u5219\uff0c\u8bb0$a$\u4e3a\u4f60\u7684evaluate\u6267\u884c\u7684\u4ee3\u4ef7\u603b\u548c\uff0c$v_{\\\\min}$\u548c$v_{\\\\max}$\u662f\u6bcf\u4e2a\u6570\u636e\u70b9\u7684\u7279\u5b9a\u7684\u53c2\u6570\uff0c\u90a3\u4e48\u4f60\u7684\u5f97\u5206\u5c06\u662f\uff1a<br/>$$<br/>\\\\left\\\\lfloor \\\\max\\\\left\\\\{ 10 \\\\cdot\\\\min\\\\left\\\\{ 1, \\\\; { v_{\\\\max} - a \\\\over v_{\\\\max} - v_{\\\\min} } \\\\right\\\\}, \\\\; 0 \\\\right\\\\} \\\\right\\\\rfloor<br/>$$<br/>\u6570\u636e\u9650\u5236<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6570\u636e\u70b9\uff0c\u5176\u9650\u5236\u5982\u4e0b\u8868\u6240\u793a (\u5176\u4e2d$x$\u8868\u793a\u7b54\u6848)\uff1a<br/><br/><br/><br/>\u6570\u636e\u70b9\u7f16\u53f7<br/>$x$<br/>$v_{\\\\min}$<br/>$v_{\\\\max}$<br/><br/><br/><br/><br/>$1$\uff0c$2$\uff0c$3$<br/>$ \\\\leqslant 400 $<br/>$6140$<br/>$6144$<br/><br/><br/>$4$\uff0c$5$\uff0c$6$<br/>$ \\\\leqslant 200 $<br/>$801$<br/>$1201$<br/><br/><br/>$7$\uff0c$8$\uff0c$9$\uff0c$10$<br/>$ \\\\leqslant 2047 $<br/>$76$<br/>$120$<br/><br/><br/><br/>\u63d0\u793a<br/>\u4e00\u4e2a\u6574\u578b\u7684\u539f\u7801\u5c31\u662f\u5176\u4e8c\u8fdb\u5236\u8868\u793a\uff1a<br/>$$<br/>13 \\\\rightarrow 00001101<br/>$$<br/>\u5176\u53cd\u7801\u5c31\u662f\u5c06\u9664\u4e86\u7b26\u53f7\u4f4d (\u5373\u6700\u9ad8\u4f4d) \u7684\u6240\u6709\u53d6\u53cd\uff1a<br/>$$<br/>00001101 \\\\rightarrow 01110010<br/>$$<br/>\u5bf9\u4e8e\u8d1f\u6570\uff0c\u5176\u7b26\u53f7\u4f4d\u4e3a$1$\uff1a<br/>$$<br/>01110010 \\\\rightarrow 11110010<br/>$$<br/>\u4e8c\u8fdb\u5236\u6570\u7684\u8865\u7801\u5c31\u662f\u5c06\u5176\u53cd\u7801\u52a0\u4e0a$1$\uff0c\u540c\u65f6\u5bf9\u4e8e\u6ea2\u51fa\u7684\u4f4d\u76f4\u63a5\u4e22\u5f03\uff0c\u7b26\u53f7\u4f4d\u4e5f\u53c2\u4e0e\u8ba1\u7b97\uff1a<br/>$$<br/>-13 \\\\rightarrow 11110011 \\\\\\\\<br/>-0 \\\\rightarrow 11111111 + 1 \\\\rightarrow 100000000 \\\\rightarrow 00000000<br/>$$<br/>\u56e0\u6b64\u91c7\u7528\u8865\u7801\u5b58\u50a8\u8d1f\u6570\uff0c\u539f\u7801\u5b58\u50a8\u81ea\u7136\u6570\uff0c\u8fd9\u6837\u51cf\u6cd5\u53ef\u4ee5\u53d8\u4e3a\u52a0\u6cd5\uff1a<br/>$$<br/>1 - 13 = 1 + (-13) \\\\rightarrow 00000001 + 11110011 = 11110100 \\\\rightarrow -12<br/>$$<br/>\u6240\u4ee5\u51cf\u6cd5\u9700\u8981\u82b1\u8d39$2$\u7684\u4ee3\u4ef7\u3002",
"url": "blog/2016-11-24/int.html"
},
"Lesson 16": {
"tags": "English",
"text": "Lesson 16: Mary had a little lamb (\u739b\u4e3d\u6709\u4e00\u5934\u5c0f\u7f94\u7f8a)<br/>Mary and her husband Dimitri lived in the tiny village of Perachora in southern Greece. One of Mary\u2019s prize possessions was a little white lamb which her husband had given her. She kept it tied to a tree in a field during the day and went to fetch it every evening. One evening, however, the lamb was missing. The rope had been cut, so it was obvious that the lamb had been stolen.  When Dimitri came in from the fields,His wife told him what had happened.Dimitri at once set out to find the thief. He knew it would not prove difficult in such a small village. After telling several of his friends about the theft, Dimitri found out that his neighbour, Aleko, had suddenly acquired a new lamb. Dimitri immediately went to Aleko\u2019s house and angrily accused him of stealing the lamb. He told him he had better return it or he would call the police. Aleko denied taking it and led Dimitri into his back-yard. It was true that he had just bought a lamb, he explained, but his lamb was black. Ashamed of having acted so rashly, Dimitri apologized to Aleko for having accused him. While they were talking it began to rain and Dimitri stayed in Aleko\u2019s house until the rain stopped. When he went outside half an hour later, he was astonished to find that the little black lamb was almost white. Its wool, which had been dyed black, had been washed clean by the rain!",
"url": "blog/english/16.html"
},
"NOIP2014 \u5bfb\u627e\u9053\u8def\u9898\u89e3": {
"tags": "NOIP BFS \u56fe\u8bba \u9898\u89e3",
"text": "[NOIP2014] \u5bfb\u627e\u9053\u8def<br/>\u539f\u9898\u9898\u610f<br/>\u7ed9\u4f60\u4e00\u5f20$ n(n \\\\le 1000) $\u4e2a\u70b9\u548c$ m(m\\\\le200000) $\u6761\u8fb9\u6743\u4e3a1\u7684\u65e0\u5411\u8fb9\u7684\u56fe\uff0c\u627e\u51fa\u4e00\u6761\u7b26\u5408\u4e0b\u5217\u8981\u6c42\u7684\u8def\u5f84\uff1a<br/>1. \u8def\u5f84\u4e0a\u7684\u6240\u6709\u70b9\u7684\u51fa\u8fb9\u6240\u6307\u5411\u7684\u70b9\u90fd\u76f4\u63a5\u6216\u95f4\u63a5\u4e0e\u7ec8\u70b9\u8fde\u901a\u3002<br/>2. \u5728\u6ee1\u8db3\u6761\u4ef6 1 \u7684\u60c5\u51b5\u4e0b\u4f7f\u8def\u5f84\u6700\u77ed\u3002<br/>\u505a\u6cd5<br/>\u65e2\u7136\u8def\u5f84\u4e0a\u7684\u6240\u6709\u70b9\u90fd\u8981\u6ee1\u8db3\u8981\u6c421,\u4e8e\u662f\u6211\u4eec\u5148\u6c42\u51fa\u8fd9\u5f20\u6709\u5411\u56fe\u4e2d\u54ea\u4e9b\u70b9\u6ee1\u8db3\u8981\u6c42\u3002<br/>\u6211\u4eec\u4f7f\u7528\u4e00\u4e2avalid\u6570\u7ec4\u6765\u5b58\u50a8\u67d0\u4e2a\u70b9\u662f\u5426\u76f4\u63a5\u6216\u95f4\u63a5\u5730\u5230\u7ec8\u70b9\u7684\u5e03\u5c14\u503c\uff0c\u6545\u6700\u66b4\u529b\u7684\u65b9\u6cd5\u5c31\u662f\u6bcf\u4e2a\u70b9DFS\u3002\u5176\u5b9e\u53ea\u9700\u8981\u4e00\u6b21DFS\u5373\u53ef\uff0c\u56e0\u4e3a\u53ea\u8981\u4efb\u610f\u4e00\u4e2a\u4e0e\u67d0\u4e2a\u70b9\u7684\u51fa\u8fb9\u76f8\u8fde\u63a5\u7684\u70b9\u80fd\u591f\u5230\u8fbe\u7ec8\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u4e5f\u53ef\u4ee5\u5230\u8fbe\u7ec8\u70b9\uff0c\u5426\u5219\u4e0d\u884c\u3002\u8fd9\u6837\u5728\u5199\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6bd4\u8f83\u9ebb\u70e6\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u8bfb\u5165\u56fe\u7684\u65f6\u5019\u540c\u65f6\u6784\u9020\u4e00\u5f20\u53cd\u5411\u56fe\uff0c\u5373\u6bcf\u6761\u8fb9\u4e0e\u539f\u56fe\u65b9\u5411\u76f8\u53cd\uff0c\u7136\u540e\u4ece\u7ec8\u70b9BFS\uff0c\u5c06\u6bcf\u4e2a\u53ef\u4ee5\u4fbf\u5229\u5230\u7684\u70b9\u6253\u4e0a\u6807\u8bb0\u3002<br/>\u505a\u5b8c\u8fd9\u4e2a\u5904\u7406\u540e\uff0c\u53ea\u9700\u8981\u4ece\u8d77\u70b9BFS\u5c31\u80fd\u6c42\u51fa\u7b54\u6848\u3002",
"url": "blog/2016-2-1/find-path.html"
},
"NOIP2015 \u4fe1\u606f\u4f20\u9012\u9898\u89e3": {
"tags": "NOIP DFS \u56fe\u8bba \u9898\u89e3",
"text": "[NOIP2015] \u4fe1\u606f\u4f20\u9012<br/>\u539f\u9898\u9898\u610f<br/>\u7ed9\u4f60\u4e00\u5f20$ n \\\\; (n \\\\le 200000) $\u4e2a\u70b9\u7684\u6709\u5411\u56fe\uff0c\u8bf7\u4f60\u627e\u51fa\u5176\u4e2d\u6700\u77ed\u7684\u6709\u5411\u73af\uff0c\u8f93\u51fa\u6b64\u73af\u7684\u957f\u5ea6\u3002<br/>\u505a\u6cd5<br/>\u4f7f\u7528DFS\u5c06\u56fe\u904d\u5386\uff0c\u627e\u51fa\u6709\u5411\u73af\u7edf\u8ba1\u6700\u5c0f\u3002<br/>\u904d\u5386\u662f\u5bf9\u8282\u70b9\u8fdb\u884c\u6807\u8bb0\uff0c\u5982\u679c\u904d\u5386\u4e2d\u53d1\u73b0\u5df2\u7ecf\u88ab\u6807\u8bb0\u7684\u8282\u70b9\uff0c\u5219\u8868\u793a\u627e\u5230\u4e86\u4e00\u4e2a\u73af\u3002<br/>\u9700\u8981\u6ce8\u610f\u51e0\u70b9\uff1a<br/><br/>\u4e00\u6b21DFS\u4e0d\u4e00\u5b9a\u80fd\u5c06\u6574\u5f20\u56fe\u904d\u5386\uff0c\u56e0\u6b64\u9700\u8981\u68c0\u67e5\u6bcf\u4e2a\u70b9\uff0c\u591a\u6b21DFS\u3002  <br/>\u6ce8\u610fDFS\u7684\u8d77\u70b9\u800c\u5bfc\u81f4\u7684\u51b2\u7a81\u3002<br/>   \u4e3a\u4e86\u8bf4\u660e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u653e\u4e00\u5f20\u56fe\u89e3\u91ca\u4e00\u4e0b\u3002<br/>   \u4e0b\u9762\u662f\u4e00\u5f20\u6709\u5411\u56fe\uff1a<br/><br/>   \u5047\u5982\u6211\u4eec\u7b2c\u4e00\u6b21\u4ece2\u51fa\u53d1\uff0cDFS\u5b8c\u540e\u5c062\u4e4b\u540e\u7684\u70b9\u90fd\u6253\u4e0a\u4e86\u6807\u8bb0\u3002<br/>   \u7136\u540e\u4ece1\u51fa\u53d1\u7ee7\u7eed\u5bfb\u627e\uff0c\u53d1\u73b02\u88ab\u6253\u4e0a\u4e86\u6807\u8bb0\uff0c\u4f1a\u8bef\u8ba4\u4e3a\u662f\u4e00\u4e2a\u73af\uff0c\u5bfc\u81f4\u9519\u8bef\u7684\u7ed3\u679c\u3002<br/>   \u89e3\u51b3\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u7ed9\u6bcf\u6b21DFS\u4e00\u4e2a\u4e0d\u540c\u7684\u7f16\u53f7\uff0c\u901a\u5e38\u4ece1\u5f00\u59cb\u3002<br/>   \u6211\u4eec\u9ed8\u8ba4\u5982\u679c\u70b9\u7684\u6807\u8bb0\u4e3a0\u8868\u793a\u8fd8\u6ca1\u6709\u8bbf\u95ee\u8fc7\u3002<br/>   \u5982\u679c\u8fd8\u6ca1\u6709\u8bbf\u95ee\uff0c\u505a\u7684\u6807\u8bb0\u5c31\u662f\u672c\u6b21DFS\u7684\u7f16\u53f7\u3002\u56e0\u6b64\uff0c\u53ea\u8981\u53d1\u73b0\u88ab\u6807\u8bb0\u7684\u70b9\u662f\u81ea\u5df1\u6253\u4e0a\u7684\uff0c\u624d\u8bf4\u660e\u53d1\u73b0\u4e86\u73af\u3002<br/>   \u5982\u679c\u53d1\u73b0\u4e86\u522b\u7684DFS\u6253\u4e0a\u7684\u6807\u8bb0\uff0c\u5c31\u4e0d\u5fc5\u7ee7\u7eed\u641c\u7d22\u4e86\u3002<br/>\u6709\u5411\u73af\u7684\u957f\u5ea6\u8ba1\u7b97\u3002<br/>   \u8fd9\u4e2a\u5f88\u597d\u529e\uff0cDFS\u4e2d\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a$dist$\u6570\u7ec4\uff0c\u8868\u793a\u5230\u672c\u6b21\u641c\u7d22\u8d77\u70b9\u7684\u8ddd\u79bb\u3002<br/>   \u5f53\u53d1\u73b0\u6709\u5411\u73af\u65f6\uff0c\u53ef\u4ee5\u5229\u7528\u6b64\u6570\u7ec4\u7b97\u51fa\u6765\u3002<br/>\u9012\u5f52\u4f18\u5316\u3002<br/>   \u8fd9\u4e2aDFS\u7531\u4e8e\u4e0d\u9700\u8981\u56de\u6eaf\u4e4b\u7c7b\u7684\u64cd\u4f5c\uff0c\u5e76\u4e14\u9898\u76ee\u4e2d\u7ed9\u51fa\u6bcf\u4e2a\u4eba\u53ea\u4f1a\u5c06\u4fe1\u606f\u4f20\u7ed9\u4e00\u4e2a\u4eba\uff0c<br/>   \u90a3\u4e48\u8bf4\u660e\u6bcf\u4e2a\u70b9\u7684\u51fa\u5ea6\u4e3a1\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06DFS\u6539\u6210\u9012\u63a8\u7684\u5f62\u5f0f\uff1a<br/><br/>1<br/>2<br/>3<br/>4def dfs(s):<br/>    while next(s) is not marked:<br/>        # \u5904\u7406s<br/>        s = next(s)<br/><br/>",
"url": "blog/2016-2-1/message.html"
},
"OI Coding Guidelines": {
"tags": "\u80e1\u8a00\u4e71\u8bed",
"text": "OI Coding Guidelines<br/>\u524d\u6bb5\u65f6\u95f4\u88ab XL \u62d6\u8fc7\u53bb\u778e\u8bb2\u4e86\u4e00\u5802\u8bfe\uff0c\u8fd9\u91cc\u628a\u8bfe\u4ef6\u653e\u51fa\u6765\uff0c\u4ee5\u4f9b\u5927\u5bb6\u53c2\u8003\u3002<br/>\u524d\u8a00<br/>\u8fd9\u4efd\u7b80\u5355\u7684\u6307\u5357\u4e3b\u8981\u662f\u5173\u4e8e\u4ee5\u4e0b\u4e24\u4e2a\u65b9\u9762\uff1a<br/><br/>OI \u8d5b\u573a\u4e0a C++ \u8bed\u8a00\u7684\u4e00\u4e9b\u5e38\u7528\u6280\u5de7\u548c\u6ce8\u610f\u4e8b\u9879\u3002<br/>NOI Linux (Ubuntu) \u4e2d\u5e38\u7528\u7684\u5de5\u5177\u3002<br/><br/>\u7531\u4e8e\u5927\u591a\u662f\u6211\u4e2a\u4eba\u7684\u611f\u53d7\uff0c\u800c\u672c\u4eba\u53c8\u662f\u4e00\u4e2a\u83dc\u9e21\u88ab\u7ebf\u8e29\u9009\u624b\uff0c\u6240\u4ee5\u540e\u9762\u7684\u5185\u5bb9\u5927\u5bb6\u7b80\u5355\u770b\u770b\u5c31\u597d\u3002<br/>\u4e0b\u9762\u6709\u4e9b\u6bb5\u843d\u524d\u9762\u4f1a\u6807\u4e0a \u201c*\u201d \u53f7\uff0c\u8868\u793a\u8fd9\u4e00\u90e8\u5206\u7684\u5185\u5bb9\u5728\u6b63\u5f0f\u8d5b\u573a\u4e0a\u4e0d\u80fd\u4f7f\u7528\uff0c\u56e0\u4e3a\u81f3\u5c11\u9700\u8981 C++11 \u7684\u652f\u6301\u3002<br/>\u7b2c\u4e00\u90e8\u5206\uff1aC++ \u8bed\u8a00<br/>CCF \u5df2\u7ecf\u53d1\u4e86\u516c\u544a\uff0c\u4e0d\u4e45\u540e\u5c06\u4f1a\u9010\u6b65\u53d6\u6d88 Pascal \u548c C \u8bed\u8a00\u3002\u5bf9\u4e8e\u4f7f\u7528 Pascal \u7684\u540c\u5b66\uff0c\u9700\u8981\u5c3d\u5feb\u8f6c\u5230 C++ \u4e0a\u9762\u6765\u3002\u800c\u5bf9\u4e8e\u4f7f\u7528 C \u8bed\u8a00\u7684\u540c\u5b66\uff0c\u6211\u89c9\u5f97\u8fd9\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u56e0\u4e3a OI \u4e2d\u9c9c\u6709\u4f7f\u7528\u4e00\u4e9b C++ \u9ad8\u7ea7\u7279\u6027\u7684\u573a\u666f\uff0c\u90a3\u4e48 C \u8bed\u8a00\u9009\u624b\u548c C++ \u9009\u624b\u7684\u4e3b\u8981\u533a\u522b\u5c31\u53ea\u5269\u662f\u5426\u4f7f\u7528 STL\u3002<br/>\u8fd9\u91cc\u6211\u5c06\u4f1a\u5199\u4e00\u70b9\u4e00\u822c OIer \u5bb9\u6613\u5ffd\u89c6\u7684\u4e00\u4e9b C++ \u8bed\u6cd5\u548c\u6280\u5de7\uff0c\u5e0c\u671b\u5bf9\u4f60\u4eec\u6709\u7528\u3002<br/>\u4ee3\u7801\u7ed3\u6784<br/>\u6211\u770b\u8fc7\u7684\u5927\u90e8\u5206\u4ee3\u7801\u90fd\u662f\u4e0b\u9762\u8fd9\u4e2a\u7ed3\u6784\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34// \u5f00\u5934\u6ce8\u91ca\uff0c\u6216\u662f\u4e00\u4e9b\u5947\u602a\u7684\u4e1c\u897f<br/><br/>#include <...><br/>#include <...><br/>#include <...><br/>// #include <bits/stdc++.h>: someone may love it. This is OK in NOI.<br/><br/>// \u82b1\u5f0f\u5b8f\u5b9a\u4e49<br/>// \u4e00\u4e9b\u7b80\u5355\u7684\u51fd\u6570<br/><br/>struct XXPoint {<br/>    // \u67d0\u67d0 struct<br/>};<br/><br/>struct XXTree {<br/>    // \u67d0\u67d0\u6570\u636e\u7ed3\u6784<br/>};<br/><br/>void aaa() {<br/>    // ...<br/>}<br/><br/>inline int bbb() {<br/>    // ...<br/>}<br/><br/>// ...<br/><br/>int main() {<br/>    // \u5f00\u6587\u4ef6<br/>    init();<br/>    work();<br/>    return 0;<br/>}<br/><br/><br/>\u81f3\u4e8e\u5230\u5e95\u8be5\u600e\u4e48\u5199\uff0c\u8fd9\u90fd\u662f\u4e2a\u4eba\u7684\u4e60\u60ef\u548c\u7231\u597d\u3002\u8fd9\u91cc\u53ea\u662f\u5efa\u8bae\u6bcf\u4e2a\u51fd\u6570\u4e0d\u5b9c\u8fc7\u957f\uff0c\u6700\u597d\u4e0d\u8981\u6709\u8d85\u8fc7 $20$ \u884c\u7684\u51fd\u6570\uff0c\u56e0\u4e3a\u8fd9\u79cd\u5f88\u957f\u7684\u51fd\u6570\u4e0d\u5229\u4e8e\u4ee3\u7801\u8c03\u8bd5\u3002<br/>\u7a7a\u683c\u4e0e\u7a7a\u884c<br/>\u901a\u5e38\uff0c\u5f88\u591a\u8868\u8fbe\u5f0f\u7684\u4e2d\u95f4\u6211\u4eec\u90fd\u4f1a\u6253\u4e0a\u4e00\u4e2a\u7a7a\u683c\uff0c\u7528\u6765\u51f8\u663e\u8fd0\u7b97\u7b26\u7684\u4f4d\u7f6e\u3002\u4e00\u4e2a\u5f88\u957f\u7684\u8868\u8fbe\u5f0f\u6ca1\u6709\u7a7a\u95f4\uff0c\u90fd\u662f\u6bd4\u8f83\u96be\u4ee5\u9605\u8bfb\u7684\u3002\u5982\u4e0b\u9762\u8fd9\u4e2a\u8868\u8fbe\u5f0f\uff1a<br/>1x1=-b+sqrt(b*b-4*a*c)/2/a;x2=-b-sqrt(b*b-4*a*c)/(2*a);// \u89e3\u65b9\u7a0b<br/><br/><br/>\u666e\u904d\u4f1a\u5199\u6210\u8fd9\u6837\uff1a<br/>1<br/>2x1 = -b + sqrt(b * b - 4 * a * c) / 2 / a;<br/>x2 = -b - sqrt(b * b - 4 * a * c) / (2 * a);  // \u6ce8\u91ca\u4e0e\u4ee3\u7801\u4e4b\u95f4\u901a\u5e38\u4e5f\u6709 1-2 \u4e2a\u7684\u7a7a\u683c<br/><br/><br/>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u4e0b\u9762\u8fd9\u4e2a\u5728\u4ee3\u7801\u4e2d\u5c31\u6e05\u6670\u5f88\u591a\u3002\u5f53\u7136\uff0c\u5982\u679c\u4f60\u89c9\u5f97\u50cf 4 * a * c \u8fd9\u79cd\u53ef\u4ee5\u5199\u7684\u548c\u6570\u5b66\u516c\u5f0f $4ac$ \u4e00\u6837\u7d27\u51d1\uff0c4*a*c \u4e5f\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u6253\u8fd9\u79cd\u7a7a\u683c\u5e76\u4e0d\u9700\u8981\u82b1\u8d39\u4ec0\u4e48\u65f6\u95f4\uff0c\u53ea\u8981\u591a\u8bd5\u51e0\u6b21\uff0c\u81ea\u7136\u5c31\u719f\u6089\u4e86\u3002\u6211\u4eec\u7684\u76ee\u7684\u5728\u4e8e\u5e0c\u671b\u901a\u8fc7\u8fd9\u79cd\u4e60\u60ef\u6027\u7684\u7a7a\u683c\u6765\u51cf\u5c11\u81ea\u5df1\u68c0\u67e5\u9519\u8bef\u7684\u65f6\u95f4\u3002<br/>\u7a7a\u884c\u901a\u5e38\u7528\u4e8e\u5206\u9694\u4e24\u6bb5\u4f5c\u7528\u6709\u660e\u663e\u5dee\u5f02\u7684\u4ee3\u7801\u5757\uff0c\u5982\u4e24\u4e2a\u51fd\u6570\u4e4b\u95f4\u3001\u540c\u4e00\u4e2a\u51fd\u6570\u7684\u4e0d\u540c\u6b65\u9aa4\u4e4b\u95f4\u3002\u8fd9\u4e2a\u65f6\u5019\u5199\u70b9\u6ce8\u91ca\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u4e0a\u4e86\u8003\u573a\uff0c\u7531\u4e8e\u65f6\u95f4\u539f\u56e0\uff0c\u5927\u5bb6\u666e\u904d\u4e0d\u4f1a\u5199\u6ce8\u91ca......<br/>\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u6211\u662f\u968f\u4fbf\u4ece UOJ \u4e0a\u622a\u7684\u4e00\u6bb5\u6539\u7684\uff0c\u4f53\u4f1a\u4e00\u4e0b\u5c31\u597d\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24sieve();<br/><br/>for (int i = 1; i <= h; i++)<br/>    if (!(a[1] %  pri[i])) p[++tot] = pri[i];<br/><br/>for (int i = 1; i <= n; i++) {<br/>    i64 t = gcd(a[1], a[i]);<br/><br/>    if (t == 1) {<br/>        printf(\\ -1 \\ );<br/>        continue;<br/>    }<br/><br/>    bool flag = 1;<br/>    for (int j = 1; j <= tot && 1LL * p[j] * p[j] <= t; j++) {<br/>        if (!(t %  p[j])){<br/>            printf(\\ % lld \\ , t / p[j]);<br/>            flag = 0;<br/>            break;<br/>        }<br/>    }<br/><br/>    if (flag) printf(\\ 1 \\ );  // t\u4e3a\u8d28\u6570<br/>}<br/><br/><br/>\u5982\u679c\u60a8\u662f\u4e00\u4e2a\u70ed\u8877\u4e8e\u7f29\u884c\u7684\u9752\u5c11\u5e74\uff0c\u4e0a\u9762\u7684\u8bdd\u60a8\u53ef\u4ee5\u65e0\u89c6......<br/>\u547d\u540d\u4e60\u60ef<br/>\u901a\u5e38\u666e\u904d\u4e3a\u5927\u5bb6\u6240\u63a5\u53d7\u7684\u5c31\u662f\u4f7f\u7528\u82f1\u6587\uff08\u6216\u7b80\u5199\uff09\uff0c\u800c\u4e0d\u662f\u62fc\u97f3\u4e43\u81f3\u62fc\u97f3\u7b80\u5199\u3002\u6211\u89c1\u8fc7\u4e00\u4e2a\u6bd4\u8f83\u6781\u7aef\u7684\u4f8b\u5b50\u5c31\u662f ksm\u3002\u4e4d\u4e00\u770b\u4e0d\u77e5\u9053\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\uff0c\u76f4\u5230\u770b\u4e86\u4ee3\u7801\u624d\u77e5\u9053\u662f \u201c\u5feb\u901f\u5e42\u201d \u7684\u610f\u601d......\u4e00\u822c\u8fd9\u79cd\u51fd\u6570\u901a\u5e38\u90fd\u4f1a\u5199\u505a quick_pow \u6216\u8005\u662f qpow\u3002\u5f53\u7136\uff0c\u4e0a\u9762\u7684\u7ed3\u8bba\u662f\u57fa\u4e8e\u65b9\u4fbf\u4ed6\u4eba\u7406\u89e3\u4f60\u7684\u4ee3\u7801\u800c\u5f97\u51fa\u7684\u3002\u5728 OI \u4e2d\uff0c\u57fa\u672c\u6ca1\u4eba\u4f1a\u5728\u610f\u4f60\u662f\u600e\u4e48\u5199\u7684\u3002\u6240\u4ee5\u5982\u679c\u4f60\u66f4\u719f\u6089\u6211\u4eec\u7684\u56fd\u8bed\uff0c\u4f7f\u7528\u62fc\u97f3\u547d\u540d\u6cd5\u4e5f\u65e0\u59a8\u3002<br/>\u517c\u987e\u9605\u8bfb\u6548\u7387\u548c\u7f16\u7801\u6548\u7387\uff0c\u6211\u7684\u63a8\u8350\u662f\u540d\u79f0\u6700\u597d $2$-$4$ \u4e2a\u5b57\u7b26\uff0c\u8d85\u8fc7 $6$ \u4e2a\u5b57\u7b26\u662f\u4e0d\u592a\u9002\u5408\u7684\u3002\u4e4b\u6240\u4ee5\u4e0d\u63a8\u8350 $1$ \u4e2a\u5b57\u7b26\uff0c\u662f\u56e0\u4e3a\u5bb9\u6613\u4ea7\u751f\u547d\u540d\u51b2\u7a81\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u5bb9\u6613\u5199\u9519\u4ee3\u7801\u3002<br/>\u4e0b\u9762\u5217\u4e3e\u4e86\u4e00\u4e9b\u5728 OI \u4e2d\u5e38\u89c1\u7684\u5199\u6cd5\u53ca\u5176\u542b\u4e49\uff1a<br/><br/><br/><br/>\u5199\u6cd5<br/>\u539f\u59cb\u5355\u8bcd / \u7b26\u53f7<br/>\u6ce8\u91ca<br/><br/><br/><br/><br/>aha<br/>Aha!<br/>dalao HJWJBSR \u6700\u7231<br/><br/><br/>ans<br/>answer<br/><br/><br/><br/>arr<br/>array<br/><br/><br/><br/>buc<br/>bucket<br/>\u6876\u6392\u5e8f\u76f8\u5173<br/><br/><br/>buf<br/>buffer<br/>\u7f13\u5b58\u3001\u7f13\u51b2<br/><br/><br/>ch<br/>child / children<br/>\u901a\u5e38\u6307\u6811\u4e0a\u7684\u513f\u5b50<br/><br/><br/>chk<br/>check<br/><br/><br/><br/>cls<br/>clear screen<br/>\u6e05\u7a7a\u5c4f\u5e55<br/><br/><br/>cmp, comp<br/>compare<br/>\u60f3\u5fc5\u4f60\u5728 sort \u4e2d\u7528\u8fc7<br/><br/><br/>cnt<br/>count<br/><br/><br/><br/>cur<br/>current<br/><br/><br/><br/>del<br/>delete<br/><br/><br/><br/>dist, dis<br/>distance<br/><br/><br/><br/>div<br/>divisor<br/>\u56e0\u5b50<br/><br/><br/>div<br/>divide<br/>\u9664\u6cd5<br/><br/><br/>e, E<br/>$\\\\mathrm{e} = 2.71828...$<br/>\u81ea\u7136\u5bf9\u6570\u51fd\u6570\u7684\u5e95\u6570<br/><br/><br/>eps, EPS<br/>$\\\\varepsilon$ (epsilon)<br/>\u901a\u5e38\u8868\u793a\u7cbe\u5ea6\u8bbe\u5b9a\uff08\u6d6e\u70b9\u6570\u4e2d\uff09<br/><br/><br/>equ<br/>equal<br/><br/><br/><br/>err<br/>error<br/><br/><br/><br/>eval<br/>evaluate<br/>\u8ba1\u7b97<br/><br/><br/>expr<br/>expression<br/>\u8868\u8fbe\u5f0f<br/><br/><br/>f, g, h, dp<br/>-<br/>\u4e00\u822c\u7684 DP \u6570\u7ec4<br/><br/><br/>fa<br/>father<br/><br/><br/><br/>func<br/>function<br/>\u51fd\u6570<br/><br/><br/>g, G<br/>graph / primive root<br/>\u56fe / \u6570\u8bba\u4e2d\u7684\u539f\u6839<br/><br/><br/>i, j, k<br/>-<br/>\u5404\u79cd\u4e0b\u6807<br/><br/><br/>inf, INF<br/>infinity<br/>#define INF 0x3f3f3f3f?<br/><br/><br/>init<br/>initialize<br/><br/><br/><br/>ins<br/>insert<br/><br/><br/><br/>interp<br/>interpolate<br/>\u7ebf\u6027\u63d2\u503c\uff0c$\\\\vec c = (1-t)\\\\vec a + t \\\\vec b$<br/><br/><br/>inv<br/>inverse<br/>\u9006\u5143<br/><br/><br/>iX (X = 16, 32, 64, 128)<br/>signed integer<br/>\u6709\u7b26\u53f7\u6574\u578b<br/><br/><br/>jmp<br/>jump<br/><br/><br/><br/>l, r, m<br/>left, right, middle<br/>\u5e38\u7528\u4e8e\u4e8c\u5206\u4e2d<br/><br/><br/>lch<br/>left child<br/><br/><br/><br/>len<br/>length<br/><br/><br/><br/>ll, LL<br/>long long (in C++)<br/><br/><br/><br/>mi, mx<br/>min, max<br/>\uff08\u6211\u4e2a\u4eba\u4e0d\u559c\u6b22 mi\uff09<br/><br/><br/>mid<br/>middle<br/><br/><br/><br/>mod, MOD<br/>modulo<br/>$10^9 + 7,\\\\;998244353$, your best friends<br/><br/><br/>mul<br/>multiply<br/><br/><br/><br/>num<br/>number<br/><br/><br/><br/>nxt<br/>next<br/><br/><br/><br/>pi, PI<br/>$\\\\pi = 3.14159...$<br/><br/><br/><br/>pos<br/>position<br/><br/><br/><br/>pre<br/>prefix<br/>\u524d\u7f00<br/><br/><br/>pre, prev<br/>previous<br/>\u4e0a\u4e00\u4e2a<br/><br/><br/>pri<br/>prime<br/><br/><br/><br/>ptr<br/>pointer<br/>\u6307\u9488<br/><br/><br/>rand, rnd<br/>random<br/><br/><br/><br/>rch<br/>right child<br/><br/><br/><br/>ref<br/>reference<br/>\u5f15\u7528<br/><br/><br/>res<br/>result<br/><br/><br/><br/>ret<br/>return<br/><br/><br/><br/>rev<br/>reverse<br/><br/><br/><br/>S<br/>set<br/>\u901a\u5e38\u8868\u793a\u96c6\u5408<br/><br/><br/>s, t<br/>source, sink (target)<br/>\u6e90\u70b9\u548c\u6c47\u70b9\uff0c\u5728\u7f51\u7edc\u6d41\u548c\u6700\u77ed\u8def\u4e2d\u5e38\u89c1<br/><br/><br/>seg<br/>segment<br/>You must know segment trees.<br/><br/><br/>seq<br/>sequence<br/><br/><br/><br/>sqr<br/>square<br/>$x^2$<br/><br/><br/>sqrt<br/>square root<br/>$\\\\sqrt x$<br/><br/><br/>stk<br/>stack<br/><br/><br/><br/>str<br/>string<br/><br/><br/><br/>suf<br/>suffix<br/>\u540e\u7f00<br/><br/><br/>tmp<br/>temporary<br/>\u4e34\u65f6\u7684<br/><br/><br/>tot<br/>total<br/>\u4f3c\u4e4e Pascal \u9009\u624b\u559c\u6b22\u7528\uff1f<br/><br/><br/>u, v, w<br/>vertexes and weight<br/>\u56fe\u8bba\u9898\u4e2d\u5929\u5929\u6709<br/><br/><br/>upd<br/>update<br/><br/><br/><br/>uX (X = 16, 32, 64, 128)<br/>unsigned integer<br/>\u65e0\u7b26\u53f7\u6574\u578b<br/><br/><br/>val<br/>value<br/><br/><br/><br/><br/>\u5f53\u7136\uff0c\u6bcf\u4e2a\u4eba\u90fd\u4f1a\u6709\u81ea\u5df1\u7684\u559c\u597d\uff0c\u4f60\u53ef\u4ee5\u53c2\u7167\u4e0a\u9762\u6765\u7b80\u5316\u4f60\u7684\u547d\u540d\u89c4\u8303\u3002<br/>\u5168\u5c40\u4e2d\u7684\u53d8\u91cf\u548c\u51fd\u6570<br/>\u8fd9\u4e00\u90e8\u5206\u4e3b\u8981\u662f\u63d0\u4e00\u4e0b inline \u548c static \u5173\u952e\u5b57\u3002inline \u5173\u952e\u5b57\u7528\u4e8e\u51fd\u6570\uff0c\u8868\u793a\u63d0\u9192\u7f16\u8bd1\u5668\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u51fd\u6570\u5c55\u5f00\u5185\u8054\u4f18\u5316\uff0c\u7b80\u5355\u7684\u8bf4\u5c31\u662f\u5c06\u51fd\u6570\u7684\u4ee3\u7801\u76f4\u63a5\u5199\u51fa\u6765\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u3002\u8fd9\u91cc\u7ed9\u4e00\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8int func(int n) {<br/>    return n + 5;<br/>}<br/><br/>int main() {<br/>    printf(\\ % d\\\\n\\ , func(10));  // \u8f93\u51fa 15<br/>    return 0;<br/>}<br/><br/><br/>\u90a3\u4e48\u5185\u8054\u5c55\u5f00\u540e\u7684\u7ed3\u679c\u5e94\u8be5\u7b49\u4ef7\u4e8e\uff1a<br/>1<br/>2<br/>3<br/>4int main() {<br/>    printf(\\ % d\\\\n\\ , 10 + 5);  // \u8f93\u51fa 15<br/>    return 0;<br/>}<br/><br/><br/>\u4ece\u5b9e\u9645\u7684\u6c47\u7f16\u4ee3\u7801\u6765\u770b\uff0c\u5982\u679c\u4e0d\u5199 inline\uff0c\u5f97\u5230\u7684\u4ee3\u7801\u662f\u8fd9\u6837\u7684\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13.LC0:  // \u5b57\u7b26\u4e32 \\ % d\\\\n\\  \u7684\u58f0\u660e<br/>    .string \\ % d\\\\n\\ <br/>    .text<br/>    .globl main<br/>    .type main, @function<br/><br/>// main \u51fd\u6570\u4e2d<br/>movl $10, % edi    // \u586b\u5165\u53c2\u6570 10<br/>call func         // \u6267\u884c func<br/>movl % eax, % esi   // \u5c06 func \u7684\u8fd4\u56de\u7ed3\u679c\u586b\u5165 printf \u7684\u53c2\u6570<br/>movl $.LC0, % edi  // \u5c06 \\ % d\\\\n\\  \u586b\u5165\u53c2\u6570<br/>movl $0, % eax     // \u7531\u4e8e printf \u4f7f\u7528\u4e86\u53d8\u957f\u53c2\u6570\u5217\u8868\uff0c\u6240\u4ee5\u8fd9\u91cc\u5e94\u8be5\u662f\u586b\u4e86\u4e00\u4e2a\u7ec8\u6b62\u6807\u8bb0\uff1f<br/>call printf       // \u8c03\u7528 printf<br/><br/><br/>\u800c\u8fdb\u884c\u4e86\u5185\u8054\u4f18\u5316\u4e4b\u540e\uff0c\u5c31\u4f1a\u53d8\u6210\u8fd9\u6837\u5b50\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7movl $10, -4(% rbp)<br/>movl -4(% rbp), % eax<br/>addl $5, % eax  // \u76f4\u63a5\u6267\u884c 10 + 5 (eax \u5904\u539f\u662f 10)<br/>movl % eax, % esi<br/>movl $.LC0, % edi<br/>movl $0, % eax<br/>call printf<br/><br/><br/>\u4e0a\u9762\u7684\u8fc7\u7a0b\u5728\u4e0d\u5f00\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\u662f\u4e0d\u4f1a\u8fdb\u884c\u7684\uff0c\u8fd9\u91cc\u6211\u662f\u901a\u8fc7\u5f3a\u5236 GCC \u6267\u884c\u5185\u8054\u624d\u5f97\u5230\u7684\u7ed3\u679c\u3002\u6b64\u5916\uff0c\u5bf9\u4e8e\u9012\u5f52\u51fd\u6570\uff0c\u7f16\u8bd1\u5668\u662f\u4e0d\u4f1a\u8fdb\u884c\u5185\u8054\u4f18\u5316\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u9012\u5f52\u51fd\u6570\u524d\u9762\u52a0\u4e0a inline \u6ca1\u6709\u4efb\u4f55\u7528\u5904\u3002\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5f88\u957f\u6216\u8005\u5f88\u590d\u6742\uff0c\u7f16\u8bd1\u5668\u4e5f\u901a\u5e38\u4e0d\u4f1a\u8fdb\u884c\u4f18\u5316\u3002\u6211\u7684\u63a8\u8350\u662f\u5982\u679c\u884c\u6570\u4e0d\u8d85\u8fc7 $7$ \u884c\uff0c\u5c31\u5199\u4e00\u4e2a inline\uff0c\u5426\u5219\u5c31\u6ca1\u6709\u5fc5\u8981\u6d6a\u8d39\u65f6\u95f4\u3002<br/>static \u53ef\u4ee5\u7528\u4e8e\u51fd\u6570\u548c\u53d8\u91cf\u524d\u3002\u5728\u51fd\u6570\u524d\u5199\u4e2a static \u7eaf\u5c5e\u753b\u86c7\u586b\u8db3\uff0c\u56e0\u4e3a OI \u4e2d\u6ca1\u6709\u4efb\u4f55\u7528\u5904\uff0c\u4f46\u5728\u53d8\u91cf\u524d\u5199\u4e2a static\uff0c\u53ef\u4ee5\u4f7f\u4f60\u5c11\u5199\u4e00\u4e2a\u6e05\u96f6\u3002\u88ab\u58f0\u660e\u4e3a static \u7684\u539f\u59cb\u7c7b\u578b\u53d8\u91cf\u521d\u59cb\u9ed8\u8ba4\u90fd\u662f $0$\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u968f\u673a\u7684\u503c\u3002<br/>\u5728\u51fd\u6570\u4e2d\u7684\u9759\u6001\u53d8\u91cf\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u53ea\u662f\u51fd\u6570\u5916\u90e8\u4e0d\u53ef\u4ee5\u8bbf\u95ee\u5230\u5b83\u3002\u8fd9\u4e2a\u7279\u6027\u901a\u5e38\u88ab\u62ff\u6765\u505a\u8ba1\u6570\u5668\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5// \u8c03\u7528 5 \u6b21 cnt \u5c06\u5206\u522b\u8fd4\u56de 1 2 3 4 5<br/>int cnt() {<br/>    static int tot;  // \u521d\u59cb\u4e3a 0<br/>    return ++tot;<br/>}<br/><br/><br/>\u6a21\u5757\u5316<br/>\u867d\u7136\u5927\u90e8\u5206\u9898\u76ee\u53ea\u4f1a\u6d89\u53ca\u5230\u4e00\u4e24\u4e2a\u7b97\u6cd5\uff0c\u4f46\u662f OI \u4e2d\u4e0d\u7f3a\u4e4f\u4ee3\u7801\u91cf\u5927\u3001\u6d89\u53ca\u7b97\u6cd5\u548c\u65b9\u6cd5\u6bd4\u8f83\u591a\u7684\u9898\u76ee\uff0c\u4f8b\u5982\u9700\u8981\u6253\u5404\u79cd\u516c\u5f0f\u7684 \u201c\u3010\u6e05\u534e\u96c6\u8bad2016\u3011\u5b9a\u5411\u8d8a\u91ce \u201d\u3001\u4e3a\u4e86\u7ed9\u90e8\u5206\u5206\u800c\u9020\u51fa\u7684\u4e09\u5408\u4e00 \u201c\u3010NOI2015\u3011\u5c0f\u56ed\u4e01\u4e0e\u8001\u53f8\u673a \u201d\uff0c\u4ee5\u53ca NOIP \u4e09\u5408\u4e00\u7684 \u201c\u3010WC2013\u3011\u5e73\u9762\u56fe \u201d\u3002\u5982\u679c\u4ee3\u7801\u6ca1\u6709\u826f\u597d\u7684\u89c4\u5212\uff0c\u90a3\u4e48\u5728\u8003\u573a\u4e0a\u5199\u8fd9\u79cd\u9898\u76ee\u51fa\u9519\u7684\u6982\u7387\u5c06\u5927\u5927\u589e\u52a0\u3002<br/>\u6a21\u5757\u5316\u901a\u5e38\u662f\u5c06\u6ca1\u6709\u4ec0\u4e48\u5173\u8054\u7684\u4ee3\u7801\u5757\u505a\u51fa\u9002\u5f53\u7684\u9694\u79bb\u3002\u6700\u9700\u8981\u8fd9\u79cd\u65b9\u6cd5\u7684\u60c5\u51b5\u662f\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7684\u7b97\u6cd5\u89e3\u51b3\u4e0d\u540c\u8981\u6c42\u7684\u95ee\u9898\u7684\u65f6\u5019\uff0c\u901a\u5e38\u4ee3\u7801\u4f1a\u6709\u4e0b\u9762\u7684\u7ed3\u6784\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36struct NAIVE {<br/>    // \u66b4\u529b\u7b97\u6cd5<br/><br/>    void main() {<br/>        // ...<br/>    }<br/>};<br/><br/>struct Solver1 {<br/>    // \u9a97\u5206\u7b97\u6cd5 1<br/><br/>    void main() {<br/>        // ...<br/>    }<br/>};<br/><br/>struct Solver2 {<br/>    // \u9a97\u5206\u7b97\u6cd5 2<br/><br/>    void main() {<br/>        // ...<br/>    }<br/>};<br/><br/>int main() {<br/>    if (n <= 1000)<br/>        (new NAIVE)->main();    // \u4f7f\u7528\u66b4\u529b\u7b97\u6cd5<br/>    else if (something met)<br/>        (new Solver1)->main();  // \u91c7\u7528\u7b97\u6cd5\u4e00<br/>    else if (something else met)<br/>        (new Solver2)->main();  // \u91c7\u7528\u7b97\u6cd5\u4e8c<br/>    else  // ***k the problem<br/>        puts(\\ orz\\ );            // \u8868\u793a\u5bf9\u51fa\u9898\u4eba\u5d07\u9ad8\u7684\u656c\u610f<br/><br/>    return 0;<br/>}<br/><br/><br/>\u8fd9\u6837\u505a\u76f8\u6bd4\u4e8e\u6240\u6709\u7b97\u6cd5\u90fd\u5199\u5728\u5168\u5c40\u7684\u597d\u5904\u5728\u4e8e\u5b83\u9996\u5148\u907f\u514d\u4e86\u7b97\u6cd5\u4e4b\u95f4\u7684\u547d\u540d\u51b2\u7a81\u3002\u5176\u6b21\uff0c\u5982\u679c\u4e00\u4e2a\u7b97\u6cd5\u5c06\u4e0d\u4f1a\u88ab\u4f7f\u7528\uff0c\u90a3\u4e48\u5b83\u6240\u9700\u8981\u7684\u5185\u5b58\u4e5f\u4e0d\u4f1a\u88ab\u7533\u8bf7\uff0c\u907f\u514d\u4e86\u5168\u90e8\u5f00\u5728\u5168\u5c40\u800c\u5bfc\u81f4\u8d85\u51fa\u5185\u5b58\u9650\u5236\u7684\u9690\u60a3\u3002\u8bf7\u6ce8\u610f\uff0c\u5728 NOI \u7684\u8bc4\u6d4b\u673a\u4e2d\uff0c\u4f60\u5f00\u4e86\u591a\u5927\u7684\u6570\u7ec4\u5c31\u4f1a\u8ba1\u5165\u591a\u5c11\u7684\u5185\u5b58\uff0c\u800c\u4e0d\u662f\u67d0\u4e9b\u8bc4\u6d4b\u673a\uff0c\u5373\u4f7f\u5f00\u4e86 $512\\\\mathrm{MB}$ \u7684\u6570\u7ec4\uff0c\u4f46\u662f\u5982\u679c\u53ea\u7528\u4e86 $32\\\\mathrm{MB}$\uff0c\u5c31\u53ea\u4f1a\u8bb0\u4f60 $32\\\\mathrm{MB}$\u3002<br/>\u9664\u4e86\u4f7f\u7528 class/struct \u8fd9\u79cd\u65b9\u6cd5\u4e4b\u5916\uff0c\u4e00\u4e9b\u4eba\u8fd8\u4f1a\u4f7f\u7528 namespace\u3002\u867d\u7136\u6211\u4e2a\u4eba\u89c9\u5f97 namespace \u5728 OI \u4e2d\u6ca1\u4ec0\u4e48\u7528\uff0c\u56e0\u4e3a\u5b83\u7684\u4f5c\u7528\u53ef\u4ee5\u8bf4\u53ea\u662f\u628a\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u6240\u6709\u540d\u5b57\u5168\u90e8\u52a0\u4e86\u4e2a\u524d\u7f00\u3002\u6bd4\u5982 STL \u4e2d\u7684\u6240\u6709\u4e1c\u897f\u5168\u90e8\u88ab\u653e\u5728\u4e86\u4e00\u4e2a\u53eb\u505a std \u7684\u547d\u540d\u7a7a\u95f4\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u7a0b\u5e8f\u524d\u9762\u4e0d\u7528 using namespace std\uff0c\u90a3\u4e48\u4f7f\u7528 STL \u4e2d\u7684\u51fd\u6570\u5c31\u90fd\u9700\u8981\u52a0\u4e0a\u4e00\u4e2a std::\uff0c\u5982 std::sort\u3002<br/>class \u4e0e struct<br/>\u5728 C++ \u4e2d\uff0cclass \u4e0e struct \u7684\u552f\u4e00\u533a\u522b\u5728\u4e8e\uff1aclass \u7684\u6210\u5458\u9ed8\u8ba4\u4f7f\u7528 private \u4fee\u9970\uff0c\u800c struct \u4e2d\u9ed8\u8ba4\u4f7f\u7528 public\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e0b\u9762\u7684\u8fd9\u4e2a\u5b9a\u4e49\uff1a<br/>1<br/>2<br/>3<br/>4class A {<br/> public:<br/>    // ...<br/>};<br/><br/><br/>\u4e0e struct A {}; \u662f\u7b49\u4ef7\u7684\u3002\u5728 OI \u4e2d\uff0c\u6ca1\u6709\u5fc5\u8981\u5173\u5fc3\u6210\u5458\u5e94\u8be5\u88ab\u58f0\u660e\u4e3a public \u8fd8\u662f private\uff0c\u6240\u4ee5\u5927\u5bb6\u666e\u904d\u4f7f\u7528 struct\u3002\u51fa\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c\u4e0b\u6587\u4e2d\u5c06\u4e0d\u4f1a\u518d\u63d0\u53ca class\u3002<br/>\u6784\u9020\u51fd\u6570\u662f struct \u4e00\u4e2a\u5f88\u65b9\u4fbf\u7684\u7279\u6027\uff0c\u4e00\u822c\u88ab\u7528\u4e8e\u7ed9\u7b97\u6cd5\u6216\u6570\u636e\u7ed3\u6784\u63d0\u4f9b\u53c2\u6570\uff0c\u6216\u8005\u7528\u4e8e\u521d\u59cb\u5316\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u6784\u9020\u51fd\u6570\u4e0d\u662f\u666e\u901a\u7684\u51fd\u6570\u3002\u6784\u9020\u51fd\u6570\u7684\u8c03\u7528\u610f\u5473\u7740\u4e00\u4e2a\u65b0\u7684\u5b9e\u4f8b\u7684\u521b\u5efa\uff0c\u56e0\u6b64\u4e00\u822c\u4e0d\u4f1a\u9012\u5f52\u7684\u8c03\u7528\u6784\u9020\u51fd\u6570\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u8fd9\u4efd\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10struct Aha {<br/>    int arr[1000000];<br/><br/>    Aha(int n) {<br/>        if (!n)<br/>            return;<br/>        printf(\\ % d\\\\n\\ , arr[0]);  // \u9632\u6b62\u7f16\u8bd1\u5668\u4f18\u5316<br/>        Aha(n - 1);<br/>    }<br/>};<br/><br/><br/>\u5982\u679c\u6267\u884c new Aha(1000)\uff0c\u5c06\u610f\u5473\u7740\u4f1a\u6709 $1000$ \u4e2a Aha \u4f1a\u88ab\u521b\u5efa\uff0c\u610f\u5473\u7740 $10^6 \\\\times 10^3 = 10^9$ \u4e2a int \u88ab\u521b\u5efa\uff0c\u610f\u5473\u7740\u4f60\u4f1a\u83b7\u5f97 Memory Limit Exceeded \u6216\u8005 Runtime Error\u3002\u610f\u601d\u662f\uff0c\u6bcf\u4e00\u6b21 Aha \u6784\u9020\u51fd\u6570\u7684\u9012\u5f52\uff0c\u90fd\u662f\u5728\u4e00\u4e2a\u65b0\u7684 Aha \u4e0a\u8fdb\u884c\u7684\uff0c\u800c\u4e0d\u662f\u5728\u540c\u4e00\u4e2a\u4e0a\u3002\u6240\u4ee5\uff0c\u50cf\u7ebf\u6bb5\u6811\u8fd9\u79cd\u666e\u904d\u4f7f\u7528\u9012\u5f52\u6765\u6784\u9020\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4e00\u822c\u4f1a\u65b0\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\u6765\u6784\u5efa\u3002<br/>\u6b64\u5916\uff0c\u6784\u9020\u51fd\u6570\u5728 OI \u4e2d\u66f4\u666e\u904d\u7684\u5e94\u7528\u662f\u7b80\u5355\u6570\u636e\u7684\u58f0\u660e\uff0c\u5982 Point\u3001Vector \u548c Line \u4e4b\u7c7b\u7684\u4e1c\u897f\u3002\u4f8b\u5982\u5728\u9700\u8981\u8ba1\u7b97\u51e0\u4f55\u7684\u4ee3\u7801\u4e2d\uff0c\u901a\u5e38\u4f1a\u6709\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7struct Point {<br/>    Point() : x(0), y(0) {}  // \u9ed8\u8ba4\u6784\u9020\u51fd\u6570<br/>    Point(double _x, double _y) : x(_x), y(_y) {}<br/>    Point(const Point &p) : x(p.x), y(p.y) {}  // \u590d\u5236\u6784\u9020\u51fd\u6570<br/><br/>    double x, y;<br/>};<br/><br/><br/>\u90a3\u4e48\uff0c\u4f7f\u7528 Point() \u5c06\u4f1a\u5f97\u5230\u4e00\u4e2a\u4f4d\u4e8e\u539f\u70b9\u7684\u70b9\uff0c\u800c\u4f7f\u7528 Point(2, 3) \u5c06\u4f1a\u5f97\u5230\u4e00\u4e2a\u5750\u6807\u5728 $(2,\\\\;3)$ \u7684\u70b9\u3002<br/>OIer \u666e\u904d\u4e0d\u4f1a\u5173\u5fc3\u5185\u5b58\u56de\u6536\u7684\u95ee\u9898\uff0c\u9664\u975e\u662f\u786e\u5b9e\u4e0d\u56de\u6536\u4f1a\u5bfc\u81f4\u8d85\u5185\u5b58\u3002\u6240\u4ee5\u5927\u5bb6\u7684\u4ee3\u7801\u4e2d\u90fd\u9c9c\u6709\u6790\u6784\u51fd\u6570\u7684\u51fa\u73b0\u3002\u4e00\u822c\u6790\u6784\u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u5220\u9664\u4e00\u4e9b\u7528 new \u6216\u8005 malloc \u7533\u8bf7\u51fa\u7684\u7a7a\u95f4\uff0c\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\u5c31\u662f\u7ebf\u6bb5\u6811\u548c\u5e73\u8861\u6811\u7684\u5220\u9664\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16struct Node {<br/>    Node(int l, int r)  // \u6784\u9020\u51fd\u6570<br/>        : left(l), right(r), lch(NULL), rch(NULL) {<br/>        dat = new int;<br/>    }<br/><br/>    ~Node() {<br/>        delete dat;<br/>        delete lch;<br/>        delete rch;<br/>    }<br/><br/>    int left, right;<br/>    int *dat;<br/>    Node *lch, *rch;<br/>};<br/><br/><br/>\u5047\u8bbe root \u662f\u6811\u6839\uff0c\u90a3\u4e48 delete root \u5c06\u4f1a\u56de\u6536\u6574\u4e2a\u7ebf\u6bb5\u6811\uff0c\u56e0\u4e3a delete lch \u548c delete rch \u610f\u5473\u7740\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\u7684\u6790\u6784\u51fd\u6570\u4e5f\u4f1a\u88ab\u9012\u5f52\u7684\u8c03\u7528\u3002\u4e5f\u8bb8\u4f60\u4f1a\u95ee\u5f53 lch \u6216 rch \u4e3a NULL \u7684\u65f6\u5019\u4f1a\u600e\u4e48\u6837\uff0c\u5176\u5b9e\u4ec0\u4e48\u4e8b\u90fd\u4e0d\u4f1a\u53d1\u751f\uff0c\u56e0\u4e3a\u5982\u679c delete \u4e00\u4e2a\u7a7a\u6307\u9488\uff080\u3001NULL \u6216\u8005 C++11 \u4e2d\u7684 nullptr\uff09\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5c06\u4f1a\u88ab\u65e0\u89c6\u3002<br/>\u53e6\u5916\u4e00\u4e2a\u5e38\u7528\u7684\u7279\u6027\u5c31\u662f\u8fd0\u7b97\u7b26\u91cd\u8f7d\u3002\u57fa\u672c\u4e0a\u4f60\u80fd\u60f3\u5230\u7684\u8fd0\u7b97\u7b26\u90fd\u662f\u53ef\u4ee5\u91cd\u8f7d\u7684\uff0c\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u5728 cppreference (http://en.cppreference.com/w/cpp/language/operators) \u4e0a\u770b\u5230\u3002\u63a5\u4e0b\u6765\u53ea\u4ecb\u7ecd\u51e0\u4e2a\u5e38\u7528\u7684\u91cd\u8f7d\u3002<br/>\u91cd\u8f7d\u6bd4\u8f83\u5173\u7cfb\u7b26\uff0c\u5927\u4e8e\u5c0f\u4e8e\u7b49\u4e8e\u4e4b\u7c7b\u7684\uff0c\u5982\u679c\u91cd\u8f7d\u4e86\u5c0f\u4e8e\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528 std::sort \u6392\u5e8f\u800c\u4e0d\u7528\u5199 cmp\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29#include <cmath>  // For hypot<br/><br/>#define EPS 1e-8<br/><br/>inline bool equ(double a, double b) {<br/>    return a - EPS < b && b < a + EPS;<br/>}<br/><br/>struct Point {<br/>    double x, y;<br/><br/>    // \u8ba1\u7b97\u6a21\u957f<br/>    double len() const {<br/>        return hypot(x, y);<br/>    }<br/><br/>    bool operator<(const Point &b) const {<br/>        return len() < b.len();  // \u6309\u6a21\u957f\u957f\u77ed\u6392\u5e8f\u3002<br/>    }<br/><br/>    // \u76f8\u7b49\u548c\u4e0d\u7b49<br/>    bool operator==(const Point &b) const {<br/>        return equ(x, b.x) && equ(y, b.y);<br/>    }<br/><br/>    bool operator!=(const Point &b) const {<br/>        return !(*this == b);<br/>    }<br/>};<br/><br/><br/>\u901a\u5e38\uff0c\u8fd0\u7b97\u7b26\u91cd\u8f7d\u8fd8\u53ef\u4ee5\u7528\u53cb\u5143\u51fd\u6570\u6765\u5199\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u7528\u53cb\u5143\u51fd\u6570\u6765\u5199\u5c31\u662f\u8fd9\u6837\u7684\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13struct Point {<br/>    double x, y;<br/><br/>    double len() const {<br/>        return hypot(x, y);<br/>    }<br/><br/>    friend bool operator<(const Point &a, const Point &b);<br/>};<br/><br/>bool operator<(const Point &a, const Point &b) {<br/>    return a.len() < b.len();<br/>}<br/><br/><br/>\u8fd9\u5c31\u7c7b\u4f3c\u4e8e\u5199 cmp \u8fd9\u79cd\u4e1c\u897f\u4e86\u3002<br/>\u50cf\u5411\u91cf\u8fd9\u79cd\u4e1c\u897f\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u9700\u8981\u91cd\u8f7d\u52a0\u51cf\u3001\u6570\u4e58\u3001\u53c9\u79ef\u548c\u70b9\u79ef\u8fd0\u7b97\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd0\u7b97\u7b26\u91cd\u8f7d\u3002\u5177\u4f53\u7684\u5199\u6cd5\u4f60\u4eec\u53ef\u4ee5\u81ea\u5df1\u8111\u8865\u3002\u6211\u4e00\u822c\u628a\u6570\u4e58\u548c\u70b9\u79ef\u91cd\u8f7d\u4e3a * \u53f7\uff0c\u628a\u53c9\u79ef\u91cd\u8f7d\u4e3a %  \u53f7\u3002<br/>\u6b64\u5916\uff0c\u51fd\u6570\u8c03\u7528\u4e5f\u53ef\u4ee5\u91cd\u8f7d\uff08\u5c31\u662f\u51fd\u6570\u8c03\u7528\u540e\u7684\u90a3\u4e00\u5bf9\u62ec\u53f7......\uff09\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u63d0\u4f9b\u7ed9 std::map \u548c std::priority_queue \u4e4b\u7c7b\u7684 cmp\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8struct cmp {<br/>    bool operator()(int a, int b) const {<br/>        return a > b;<br/>    }<br/>};<br/><br/>static priority_queue<int, vector<int>, cmp> q;  // \u8f6c\u53d8\u4e3a\u5c0f\u6839\u5806<br/>static cmp func;  // \u53ef\u4ee5\u76f4\u63a5\u628a func \u5f53\u51fd\u6570\u7528\u3002<br/><br/><br/>\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7<br/>C++ \u4e2d\u4e66\u5199\u8868\u8fbe\u5f0f\u7684\u65f6\u5019\u4e0d\u53ef\u907f\u514d\u7684\u5c31\u662f\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u7684\u8003\u8651\uff0c\u5c24\u5176\u662f\u542b\u6709\u4f4d\u8fd0\u7b97\u7684\u8868\u8fbe\u5f0f\u4e2d\u3002\u4e86\u89e3 C++ \u4e2d\u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u6709\u5229\u4e8e\u6211\u4eec\u5728\u8003\u573a\u4e0a\u8282\u7ea6\u65f6\u95f4\u548c\u7cbe\u529b\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u53ea\u8981\u77e5\u9053\u4ee5\u4e0b\u51e0\u4e2a\u76f8\u5bf9\u987a\u5e8f\u5c31\u53ef\u4ee5\u4e86\uff1a<br/><br/>\u4e58\u6cd5\u3001\u9664\u6cd5\u3001\u53d6\u6a21 (*, /, % )<br/>\u52a0\u6cd5\u3001\u51cf\u6cd5 (+, -)<br/>\u6309\u4f4d\u5de6\u79fb\u3001\u53f3\u79fb (<<, >>)<br/>\u5927\u4e8e\u3001\u5c0f\u4e8e\u3001\u4e0d\u5927\u4e8e\u3001\u4e0d\u5c0f\u4e8e (>, <, <=, >=)<br/>\u76f8\u7b49\u3001\u4e0d\u76f8\u7b49 (==, !=)<br/>\u6309\u4f4d\u4e0e (&)<br/>\u6309\u4f4d\u5f02\u6216 (^)<br/>\u6309\u4f4d\u6216 (|)<br/>\u903b\u8f91\u4e0e (&&)<br/>\u903b\u8f91\u6216 (||)<br/><br/>\u6bd4\u8f83\u5bb9\u6613\u5199\u9519\u7684\u662f\u6709\u6309\u4f4d\u5de6\u79fb\u3001\u53f3\u79fb\u7684\uff0c\u8981\u6ce8\u610f\u52a0\u6cd5\u51cf\u6cd5\u7684\u4f18\u5148\u7ea7\u6bd4\u6309\u4f4d\u5de6\u79fb\u53f3\u79fb\u9ad8\uff0c\u56e0\u6b64 1 << 3 + 7 \u7684\u7ed3\u679c\u4e0d\u662f $2^3 + 7$\uff0c\u800c\u662f $2^{10}$\u3002\u6b64\u5916\u7531\u4e8e\u6bd4\u8f83\u8fd0\u7b97\u7b26\u7684\u4f18\u5148\u7ea7\u6ca1\u6709\u6309\u4f4d\u5de6\u79fb\u3001\u53f3\u79fb\u9ad8\uff0c\u6240\u4ee5\u5982\u679c\u6bd4\u8f83\u7b26\u4e24\u8fb9\u7684\u6309\u4f4d\u5e73\u79fb\u8981\u7528\u62ec\u53f7\u5305\u8d77\u6765\u3002\u53e6\u5916\uff0c\u4e0e\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u6216\u7684\u4f18\u5148\u7ea7\u3002\u5982\u679c\u8003\u8bd5\u65f6\u5fd8\u8bb0\u4e86\uff0c\u90a3\u4f60\u6700\u597d\u8fd8\u662f\u591a\u5199\u51e0\u4e2a\u62ec\u53f7\u4ee5\u514d\u51fa\u9519\u3002<br/>\u8be6\u7ec6\u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u4e5f\u53ef\u4ee5\u5728 cppreference  (http://en.cppreference.com/w/cpp/language/operator_precedence) \u4e0a\u770b\u5230\u3002<br/>\u6a21\u677f<br/>\u8fd9\u91cc\u5c06\u4ecb\u7ecd\u4e00\u4e9b\u7b80\u5355\u7684\u6a21\u677f\uff08template\uff09\u7684\u4f7f\u7528\u3002\u4e00\u822c\u662f\u7528\u4e8e\u4e00\u4e9b\u7b80\u5355\u7684\u51fd\u6570\uff0c\u5982 max\uff1a<br/>1<br/>2<br/>3<br/>4template <typename T><br/>inline T max(const T &a, const T &b) {<br/>    return b < a ? a : b;<br/>}<br/><br/><br/>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 max(1, 2)\uff0c\u5b83\u5c06\u8fd4\u56de 2\u3002\u5b9e\u9645\u4e0a\u662f\u7f16\u8bd1\u5668\u53d1\u73b0\u4f60\u586b\u5165\u7684\u53c2\u6570 a \u548c b \u90fd\u662f int\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u53ef\u4ee5\u63a8\u65ad\u51fa template \u4e2d\u7684\u58f0\u660e T \u5e94\u8be5\u662f int\u3002\u4e8e\u662f\u7f16\u8bd1\u5668\u5c06\u4e0a\u9762\u7684 max \u51fd\u6570\u8865\u5168\uff0c\u7136\u540e\u4ea7\u751f\u4e86\u4e0b\u9762\u7684\u4ee3\u7801\uff1a<br/>1<br/>2<br/>3inline int max(const int &a, const int &b) {<br/>    return b < a ? a : b;<br/>}<br/><br/><br/>\u8fd9\u662f\u6a21\u677f\u7684\u672c\u8d28\u3002\u5b9e\u9645\u4e0a\uff0c\u7f16\u8bd1\u5668\u53ef\u80fd\u6709\u65f6\u5019\u65e0\u6cd5\u63a8\u65ad\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u5c31\u6bd4\u5982\u4e0b\u9762\u8fd9\u6bb5\u5feb\u8bfb\u7684\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17template <typename T><br/>inline T read() {<br/>    T x = 0, f = 1;<br/>    char c;<br/>    do {<br/>        c = getchar();<br/>        if (c == '-')<br/>            f = -1;<br/>    } while (!isdigit(c));<br/><br/>    do {<br/>        x = x * 10 + c - '0';<br/>        c = getchar();<br/>    } while (isdigit(c));<br/><br/>    return f * x;<br/>}<br/><br/><br/>\u6b64\u65f6\uff0c\u5982\u679c\u4f60\u60f3\u8bfb\u5165\u4e00\u4e2a int\uff0c\u5c31\u9700\u8981\u8c03\u7528 read<int>()\uff0c\u901a\u8fc7\u5c16\u62ec\u53f7\u5185\u7684\u5185\u5bb9\u544a\u8bc9\u7f16\u8bd1\u5668 T \u5e94\u8be5\u662f\u4ec0\u4e48\u4e1c\u897f\u3002\u5f53\u7136\uff0c\u4e00\u822c\u7684\u5feb\u8bfb\u4e0d\u4f1a\u8fd9\u4e48\u5199\uff0c\u56e0\u4e3a\u5728\u6027\u80fd\u8981\u6c42\u5f88\u9ad8\u7684\u60c5\u51b5\u4e0b\u8fd4\u56de\u503c\u53ef\u80fd\u4f1a\u589e\u5927\u5e38\u6570\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u662f\u5f15\u7528\u53c2\u6570\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5template <typename T><br/>inline void read(T &x) {<br/>    x = 0;<br/>    // \u4e0b\u9762\u57fa\u672c\u4e00\u81f4<br/>}<br/><br/><br/>\u8fd9\u6837\u5c31\u4e0d\u7528\u586b\u6a21\u677f\u53c2\u6570\u4e86\uff0c\u76f4\u63a5\u50cf read(n) \u4e00\u6837\u4f7f\u7528\u5c31\u597d\u3002<br/>\u6a21\u677f\u5f53\u7136\u53ef\u4ee5\u591a\u653e\u51e0\u4e2a\u5f85\u5b9a\u7684\u7c7b\u578b\uff0c\u4f8b\u5982\uff0c\u6211\u4e00\u822c\u5199\u7684\u5224\u65ad\u4e24\u4e2a\u6d6e\u70b9\u6570\u662f\u5426\u76f8\u540c\u7684\u4ee3\u7801\u662f\u8fd9\u6837\u7684\uff1a<br/>1<br/>2<br/>3<br/>4template <typename T1, typename T2><br/>inline bool equ(const T1 a, const T2 b) {<br/>    return fabs(a - b) < EPS;<br/>}<br/><br/><br/>\u5982\u679c a \u548c b \u53ea\u58f0\u660e\u4e00\u4e2a T\uff0c\u90a3\u4e48\u5f53\u8c03\u7528 equ(1.0f, 1.0) \u4f1a\u51fa\u73b0\u7f16\u8bd1\u9519\u8bef\uff0c\u56e0\u4e3a a \u662f float \u800c b \u662f double\uff0cT \u4e0d\u80fd\u540c\u65f6\u662f\u4e24\u4e2a\u7c7b\u578b\u3002<br/>\u4f60\u53ef\u4ee5\u4e3a\u7279\u5b9a\u7684\u7c7b\u578b\u5199\u7279\u5316\u7684\u51fd\u6570\u3002\u8fd8\u662f\u62ff\u4e4b\u524d\u5feb\u8bfb\u505a\u4f8b\u5b50\uff0c\u8bfb\u5165\u6574\u578b\u5e94\u8be5\u662f\u90a3\u4e48\u8bfb\uff0c\u4f46\u8bfb\u5165\u5b57\u7b26\u4e32\u5c31\u8981\u6362\u4e00\u79cd\u65b9\u5f0f\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8fd9\u4e48\u5199\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18template <><br/>// read<char> \u53ef\u4ee5\u7b80\u5199\u4e3a read\uff0c\u56e0\u4e3a T = char \u53ef\u4ee5\u4ece\u53c2\u6570\u4e2d\u63a8\u51fa<br/>inline void read<char>(char &ch) {<br/>    do {<br/>        ch = getchar();<br/>    } while (!isalpha(ch));<br/><br/>    char *str = &ch;<br/>    size_t pos = 1;<br/>    do {<br/>        str[pos++] = getchar();<br/>    } while (isalpha(str[pos - 1]));<br/>    str[pos - 1] = 0;<br/>}<br/><br/>// \u8f93\u5165 \\ owengetmad\\ <br/>char buf[233];<br/>read(buf[0]);  // buf = \\ owengetmad\\ <br/><br/><br/>\u4e0a\u9762\u662f\u5c06 T \u6307\u5b9a\u4e3a char \u65f6\u7684\u7279\u5316\uff0c\u8bf4\u767d\u4e86\u5c31\u662f\u5c06 T \u66ff\u6362\u6389\u518d\u5199\u4e00\u904d\u3002\u4e4b\u6240\u4ee5\u4e0d\u7279\u5316\u4e3a char []\uff0c\u662f\u56e0\u4e3a\u4e4b\u524d\u8bfb\u53d6\u6574\u6570\u7684\u6a21\u677f\u4f7f\u7528\u7684\u662f\u5f15\u7528\u53c2\u6570\uff0c\u800c\u6570\u7ec4\u7c7b\u578b\u4e0d\u80fd\u4e3a\u5f15\u7528\uff0c\u6240\u4ee5\u53ea\u80fd\u6298\u4e2d\u4e00\u4e0b\u4f7f\u7528 char\uff0c\u5bf9 ch \u53d6\u4e2a\u5730\u5740\u5c31\u53ef\u5f97\u5230\u5b57\u7b26\u6570\u7ec4\u7684\u5730\u5740\u3002<br/>class \u548c struct \u4e5f\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\uff0c\u867d\u7136\u8fd9\u5728 OI \u4e2d\u4e0d\u5e38\u7528\u3002\u6211\u6240\u5728 OI \u89c1\u5230\u7684\u4e5f\u5c31\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\uff1a<br/>1<br/>2<br/>3<br/>4template <typename T><br/>struct Point {<br/>    T x, y;<br/>};<br/><br/><br/>\u5982\u679c\u9700\u8981\u7279\u5316\uff0c\u4f1a\u5199\u6210\u8fd9\u6837\uff1a<br/>1<br/>2<br/>3<br/>4template <><br/>struct Point<int> {<br/>    int x, y;<br/>};<br/><br/><br/>* \u5269\u4e0b\u4e00\u4e2a\u5e38\u7528\u7684\u5c31\u662f\u53d8\u957f\u6a21\u677f\u53c2\u6570\uff0cOI \u4e2d\u4e00\u822c\u7528\u4e8e\u8f93\u51fa\u8c03\u8bd5\u4fe1\u606f\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6template <typename ... Args><br/>void DEBUG(const char *str, const Args & ... args) {<br/>    printf(\\ (debug) \\ );<br/>    printf(str, args...);<br/>    putchar('\\\\n');<br/>}<br/><br/><br/>\u4f7f\u7528 DEBUG(\\ BOY\u2642% s\u2642DOOR % d\\ , \\ NEXT\\ , 123) \u4f1a\u8f93\u51fa \u201c(debug) BOY\u2642NEXT\u2642DOOR 123\u201d\u3002<br/>\u5b8f\u5b9a\u4e49<br/>\u5b8f\u5b9a\u4e49\u7684\u672c\u8d28\u662f\u6587\u672c\u66ff\u6362\uff0c\u901a\u5e38\u7528\u4e8e\u8282\u7ea6\u4ee3\u7801\u91cf\u3002\u5f53\u9700\u8981\u91cd\u590d\u6253\u5f88\u591a\u5f62\u5f0f\u5dee\u4e0d\u591a\u7684\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5b8f\u662f\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u5de5\u5177\u3002\u4f8b\u5982 \u201c\u3010NOIP2015\u3011\u6597\u5730\u4e3b \u201c\u52a0\u5f3a\u201d \u7248 \u201d \u7684 \u201c\u7206\u641c + DP\u201d \u505a\u6cd5\uff0c\u5176 DP \u8f6c\u79fb\u51e0\u4e4e\u957f\u5f97\u4e00\u6a21\u4e00\u6837\uff0c\u4f46\u662f\u6570\u91cf\u5f88\u591a\uff0c\u56e0\u6b64\u8fd9\u91cc\u4f7f\u7528\u5b8f\u5b9a\u4e49\u53ef\u4ee5\u5927\u5927\u8282\u7ea6\u65f6\u95f4\u3002<br/>for \u901a\u5e38\u4f1a\u88ab\u4f17\u591a OIer \u5f04\u6210\u5b8f\u51fd\u6570\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6#define rep(i, l, r) for (int i = l; i <= (r); i++)<br/>#define rrep(i, r, l) for (int i = r; i >= (l); i--)<br/><br/>rep(i, 1, n) rep(j, 1, m) {<br/>    // ...<br/>}<br/><br/><br/>\u8fd9\u6837\u5c31\u4e0d\u7528\u5199 for \u4e2d\u90a3\u91cd\u590d\u800c\u53c8\u67af\u71e5\u65e0\u5473\u7684\u90e8\u5206\u4e86\u3002\u5728\u7ef4\u6570\u6bd4\u8f83\u591a\u7684 DP \u4e2d\uff0c\u5199\u51fa\u6765\u7684\u4ee3\u7801\u4f1a\u7b80\u6d01\u8bb8\u591a\u3002\u4e00\u4e9b\u4eba\u4e5f\u559c\u6b22\u7528 per \u6765\u8868\u793a\u5012\u5e8f\u904d\u5386\u3002<br/>* \u5bf9\u4e8e STL \u5bb9\u5668\u7684\u904d\u5386 (vector, map \u4e4b\u7c7b)\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u6837\u7684\u8bed\u6cd5\uff1a<br/>1<br/>2<br/>3<br/>4vector<int> vec;<br/>for (auto &v : vec) {<br/>    // Do something with v<br/>}<br/><br/><br/>\u5b8f\u5f00\u5173\u7ecf\u5e38\u7528\u6765\u6253\u5f00 / \u5173\u95ed\u8c03\u8bd5\u4fe1\u606f\uff0c\u5982\u5b9a\u4e49 NDBEUG \u5b8f\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7// #define NDEBUG<br/><br/>#ifdef NDEBUG  // \u5982\u679c NDEBUG \u6253\u5f00 (\u53d6\u6d88\u7b2c\u4e00\u884c\u7684\u6ce8\u91ca)<br/>#define DEBUG(...)  // \u7a7a\u7684\u8c03\u8bd5\u4fe1\u606f\u8f93\u51fa\u51fd\u6570<br/>#else<br/>#define DEBUG(msg, ...) printf(\\ (% s #% d) \\  msg, __FUNCTION__, __LINE__, __VA_ARGS__);  // \u5426\u5219\u542f\u7528\u8c03\u8bd5<br/>#endif<br/><br/><br/>\u4e0a\u9762\u7684 \u201c...\u201d \u8ddf\u4e4b\u524d\u6a21\u677f\u4e2d\u7684\u53d8\u957f\u53c2\u6570\u7c7b\u4f3c\uff0c\u4f7f\u7528 __VA_ARGS__ \u8fd9\u4e2a\u7279\u6b8a\u7684\u5b8f\u53ef\u4ee5\u5c06 \u201c...\u201d \u6240\u6307\u4ee3\u7684\u53c2\u6570\u653e\u5165\u3002__FUNCTION__ \u548c __LINE__ \u662f\u53e6\u5916\u4e24\u4e2a\u7279\u6b8a\u7684\u5b8f\uff0c\u5b83\u4eec\u53ef\u4ee5\u8bb0\u5f55\u4e0b DEBUG \u5b8f\u51fd\u6570\u88ab\u8c03\u7528\u7684\u5730\u65b9\u6240\u5904\u7684\u51fd\u6570\u540d\u79f0\u548c\u884c\u53f7\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528 __PRETTY_FUNCTION__\uff0c\u5b83\u4f1a\u8bb0\u5f55\u4e0b\u6240\u5904\u7684\u51fd\u6570\u7684\u8be6\u7ec6\u58f0\u660e\uff0c\u53ef\u4ee5\u7528\u4e8e\u533a\u5206\u91cd\u8f7d\u7684\u51fd\u6570 \u3002\u53e6\u5916\uff0cassert \u7684\u6253\u5f00\u548c\u5173\u95ed\u4e5f\u662f\u53d7 NDEBUG \u5f71\u54cd\u3002assert \u610f\u601d\u662f\u65ad\u8a00\uff0c\u5373\u505a\u4e00\u4e2a\u5047\u8bbe\uff0c\u5982\u679c\u5047\u8bbe\u4e0d\u6210\u7acb\u5219\u7ec8\u6b62\u7a0b\u5e8f \uff08\u8c03\u7528 abort\uff09\uff0c\u5b83\u5305\u542b\u5728 cassert \u5934\u6587\u4ef6\u4e2d\u3002\u4e00\u822c\u7684\u7528\u6cd5\u5982\u4e0b\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5#include <cassert><br/><br/>int a = 1 + 1;<br/>assert(a == 2);  // \u60f3\u5fc5 a = 2<br/>assert(a == 3);  // a \u663e\u7136\u4e0d\u7b49\u4e8e 3\uff0c\u6240\u4ee5\u8fd9\u91cc\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u7ec8\u6b62<br/><br/><br/>\u5584\u7528 assert \u662f\u4e00\u4e2a\u826f\u597d\u7684\u4e60\u60ef\u3002\u5728\u6bd4\u8f83\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u4e00\u4e9b\u5730\u65b9\u53ef\u4ee5\u6dfb\u52a0\u51e0\u4e2a\u65ad\u8a00\uff0c\u6bd4\u5982\u5728\u8bbf\u95ee\u4e00\u4e2a\u6307\u9488\u524d assert \u4e00\u4e0b\u770b\u6307\u9488\u662f\u5426\u4e3a\u7a7a\u3002\u4ece\u800c\u5728\u8c03\u8bd5\u7684\u65f6\u5019\uff0c\u5982\u679c\u51fa\u73b0\u5f02\u5e38\uff0c\u53ef\u4ee5\u5f88\u5feb\u7684\u53d1\u73b0\u9519\u8bef\u7684\u4f4d\u7f6e\u3002\u6700\u540e\u63d0\u4ea4\u6587\u4ef6\u7684\u65f6\u5019\u5728\u5f00\u5934\u58f0\u660e\u4e00\u4e0b NDEBUG\uff0c\u5c31\u53ef\u4ee5\u5173\u6389\u6240\u6709\u7684\u8c03\u8bd5\u4fe1\u606f\u548c\u65ad\u8a00\u3002<br/>\u4f5c\u4e3a\u4e00\u4e2a\u7b80\u5355\u7684\u6587\u672c\u66ff\u6362\uff0c\u5b8f\u7684\u5f0a\u7aef\u5728\u4e8e\u5bb9\u6613\u4f7f\u4eba\u72af\u9519\u3002\u9996\u5148\u5c31\u662f\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u7684\u95ee\u9898\u3002\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\u5c31\u662f\u5f00\u4e00\u4e2a\u5927\u5c0f\u4e3a $2n$ \u7684\u6570\u7ec4\u3002OI \u4e2d\u7531\u4e8e\u4e0d\u662f\u5f88\u5173\u5fc3\u6d6a\u8d39\u7684\u4e00\u70b9\u70b9\u7a7a\u95f4\uff0c\u6240\u4ee5\u6709\u4eba\u53ef\u80fd\u4f1a\u5199\u51fa\u8fd9\u6837\u7684\u4ee3\u7801\uff1a<br/>1<br/>2#define NMAX 100000 + 5<br/>int arr[NMAX * 2];  // arr \u7684\u5927\u5c0f\u4e3a 100010 \u800c\u4e0d\u662f\u6240\u671f\u671b\u7684 200010<br/><br/><br/>\u8fd9\u79cd\u9519\u8bef\u662f\u4f1a\u8ba9\u4eba\u975e\u5e38\u82e6\u607c\u7684\uff0c\u56e0\u4e3a\u4f60\u7684\u7a0b\u5e8f\u5c0f\u6570\u636e\u4e0d\u4f1a\u6709\u4e8b\uff0c\u800c\u5927\u6570\u636e\u4f1a\u4e0d\u505c\u7684 Runtime Error\uff0c\u53ef\u4f60\u5374\u4e00\u76f4\u770b\u4e0d\u51fa\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u8fd8\u6709\u5c31\u662f\u4e4b\u524d\u7684 rep \u7684\u5b9a\u4e49\u4e2d\uff0c\u6211\u5199\u7684\u662f i <= (r) \u800c\u4e0d\u662f i <= r\uff0c\u539f\u56e0\u975e\u5e38\u7b80\u5355\uff0c\u5982\u679c\u4f60\u8981\u4f7f\u7528 rep(i, 1, a ^ b) \u540e\u8005\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f60\u65e0\u5c3d\u7684\u5faa\u73af\uff08\u56e0\u4e3a\u662f i <= a ^ b\uff0c\u5c0f\u4e8e\u7b49\u4e8e\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u5f02\u6216\uff0c\u6240\u4ee5\u5b83\u7684\u503c\u662f (i <= a) ^ b \uff09\u3002\u8fd9\u79cd\u4f8b\u5b50\u76f8\u5f53\u4e4b\u591a\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u5217\u4e3e\u3002\u56e0\u6b64\uff0c\u4f46\u51e1\u4f7f\u7528\u5b8f\uff0c\u5c31\u4e00\u5b9a\u8981\u6ce8\u610f\u591a\u6253\u51e0\u4e2a\u62ec\u53f7\u3002<br/>\u53e6\u5916\u4e00\u4e2a\u7ecf\u5178\u7684\u9519\u8bef\uff0c\u6765\u81ea\u4e8e\u4e00\u4e2a\u7b80\u5355\u7684 max \u5b8f\u51fd\u6570\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14#define max(a, b) ((a) > (b) ? a : b)<br/><br/>int query(Node *x, int l, int r) {<br/>    if (l <= x->left && x->right <= r)<br/>        return x->value;<br/><br/>    int mid = (x->left + x->right) >> 1, ans = INT_MIN;<br/>    if (l <= mid)<br/>        ans = max(ans, query(x->lch, l, r));<br/>    if (r > mid)<br/>        ans = max(ans, query(x->rch, l, r));<br/><br/>    return ans;<br/>}<br/><br/><br/>\u4e4d\u4e00\u770b\u597d\u50cf\u6ca1\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u5b9e\u9645\u4e0a\u4f60\u7684\u7ebf\u6bb5\u6811\u65e9\u5df2\u80cc\u53db\u4e86\u4f60\uff0c\u5b83\u5c06\u7ed9\u4e88\u4f60\u65e0\u5c3d\u7684 Time Limit Exceeded\u3002\u539f\u56e0\u5728\u4e8e\uff0c\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u4e24\u4e2a\u53d6 max \u7684\u5730\u65b9\uff0c\u5982\u679c\u513f\u5b50\u7ed9\u51fa\u7684\u7b54\u6848\u66f4\u5927\uff0c\u90a3\u4e48\u90a3\u4e2a query \u5c06\u4f1a\u88ab\u8c03\u7528\u7b2c\u4e8c\u6b21\uff0c\u5bfc\u81f4\u7ebf\u6bb5\u6811\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u9000\u5316\u3002\u56e0\u6b64\u5728\u8fd9\u91cc\u6211\u8fd8\u662f\u63a8\u8350\u4f7f\u7528\u5185\u8054\u51fd\u6570\u800c\u4e0d\u662f\u5b8f\u6765\u5b9e\u73b0\u8fd9\u4e9b\u7b80\u5355\u7684\u51fd\u6570\u3002<br/>\u5e38\u7528\u51fd\u6570\u548c STL<br/>\u867d\u7136\u50cf max\u3001min \u4e4b\u7c7b\u7684\u51fd\u6570\u5728 algorithm \u5934\u6587\u4ef6\u5df2\u6709\u5b9a\u4e49\uff0c\u4f46\u662f\u4e00\u4e9b\u7279\u522b\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4f7f\u7528\u66f4\u7b80\u5355\u7684\u51fd\u6570\u6765\u51cf\u5c0f\u5e38\u6570\u3002\u4f8b\u5982\u7528\u4e8e\u66f4\u65b0\u6700\u503c\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9template <typename T><br/>inline void chkmax(T &a, const T &b) {<br/>    if (b > a) a = b;<br/>}<br/><br/>template <typename T><br/>inline void chkmin(T &a, const T &b) {<br/>    if (b < a) a = b;<br/>}<br/><br/><br/>\u76f8\u6bd4\u4e8e a = max(a, b) \u800c\u8a00\uff0c\u53ef\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u8d4b\u503c\uff0c\u4ece\u800c\u51cf\u5c0f\u4e86\u5e38\u6570\u3002\u53e6\u5916\u4e00\u4e2a\u540c\u7c7b\u578b\u7684\u5c31\u662f\u53d6\u6a21\u52a0\u6cd5\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7template <typename T><br/>inline void add(T &a, const T &b) {<br/>    a += b;<br/><br/>    if (a >= MOD) a -= MOD;<br/>    if (a < 0) a += MOD;<br/>}<br/><br/><br/>\u56e0\u4e3a\u53ea\u662f\u52a0\u51cf\u6cd5\uff0c\u6240\u4ee5\u4f7f\u7528 (a + b) %  MOD \u5b9e\u9645\u4e0a\u4f1a\u6d6a\u8d39\u4e00\u6b21\u53d6\u6a21\u64cd\u4f5c\u3002\u987a\u5e26\u4e00\u63d0\uff0c\u4e00\u822c\u7684\u8ba1\u7b97\u673a\u4e0a\u52a0\u51cf\u4e58\u7684\u901f\u5ea6\u5dee\u4e0d\u591a\uff0c\u53d6\u6a21\u548c\u9664\u6cd5\u901f\u5ea6\u4e0e\u5b83\u4eec\u76f8\u6bd4\u6162\u5f88\u591a\uff0c\u6240\u4ee5\u7ecf\u5e38\u4f1a\u5c1d\u8bd5\u51cf\u5c11\u9664\u6cd5\u548c\u53d6\u6a21\u7684\u6b21\u6570\u6765\u51cf\u5c0f\u5e38\u6570\u3002\u5728\u6d6e\u70b9\u6570\u4e2d\uff0c\u51cf\u6cd5\u548c\u9664\u6cd5\u9020\u6210\u7684\u7cbe\u5ea6\u8bef\u5dee\u6bd4\u8f83\u5927\u3002<br/>algorithm \u5934\u6587\u4ef6\u4e2d\u6709\u5f88\u591a OI \u5e38\u7528\u7684\u51fd\u6570\uff0c\u4e0b\u9762\u5c06\u5217\u4e3e\u6211\u7ecf\u5e38\u7528\u7684\u51e0\u4e2a\u3002<br/>\u4f7f\u7528 reverse \u53ef\u4ee5\u5c06\u6570\u7ec4\u7ffb\u8f6c\uff1a<br/>1<br/>2int a[] = {1, 2, 3, 4, 5};<br/>reverse(a, a + 5);  // a = {5 4, 3, 2, 1}<br/><br/><br/>\u4f17\u6240\u5468\u77e5 sort \u4e3b\u8981\u4f7f\u7528\u7684\u662f\u5feb\u901f\u6392\u5e8f\u7b97\u6cd5\uff0c\u540c\u65f6\u4e5f\u6709\u4e00\u4e2a stable_sort\uff0c\u4f7f\u7528\u7684\u662f\u5f52\u5e76\u6392\u5e8f\u3002\u7edd\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u5927\u5bb6\u90fd\u4f1a\u4f7f\u7528 sort\uff0c\u5c11\u6570\u4ea4\u4e92\u9898\u53ef\u80fd\u4f1a\u5361\u5feb\u901f\u6392\u5e8f\u7684\u6bd4\u8f83\u6b21\u6570\uff0c\u8fd9\u65f6\u624d\u4f1a\u4f7f\u7528 stable_sort \u6765\u907f\u514d\u3002<br/>unique \u7684\u4f5c\u7528\u662f\u5c06\u591a\u4e2a\u8fde\u7eed\u76f8\u540c\u7684\u5143\u7d20\u53d8\u4e3a\u4e00\u4e2a\uff0c\u901a\u5e38\u548c sort \u4e00\u8d77\u4f7f\u7528\u6765\u53bb\u91cd\uff1a<br/>1<br/>2<br/>3<br/>4int a[] = {1, 3, 2, 1, 2, 1, 4};<br/>sort(a, a + 7);<br/>int cnt = unique(a, a + 7) - a;<br/>// a = {1, 2, 3, 4, ...}, cnt = 4<br/><br/><br/>lower_bound \u548c upper_bound \u5219\u662f\u5e38\u7528\u7684\u4e8c\u5206\u51fd\u6570\u3002\u5b83\u4eec\u53ea\u80fd\u7528\u4e8e\u6709\u5e8f\u7684\u5e8f\u5217\u4e0a\u3002lower_bound \u4f1a\u5e2e\u4f60\u627e\u51fa\u67d0\u4e2a\u5143\u7d20\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u800c upper_bound \u4f1a\u5e2e\u4f60\u627e\u51fa\u67d0\u4e2a\u5143\u7d20\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5982\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5int a[] = {1, 2, 2, 2, 2, 3, 7};<br/>//            ^           ^<br/>//            lower       upper<br/>lower = lower_bound(a, a + 7, 2);<br/>upper = upper_bound(a, a + 7, 2);<br/><br/><br/>inplace_merge \u662f\u7528\u4e8e\u5408\u5e76\u4e24\u4e2a\u6709\u5e8f\u5e8f\u5217\u7684\uff0c\u7528\u4e8e\u5b9e\u73b0\u5f52\u5e76\u6392\u5e8f\u3002\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u7528\u5230\u3002<br/>1<br/>2int a[] = {1, 3, 5, 2, 4, 6};<br/>inplace_merge(a, a + 3, a + 6);  // a = {1, 2, 3, 4, 5, 6}<br/><br/><br/>STL \u4e2d\u7684\u5bb9\u5668\u4e5f\u5e38\u5e38\u88ab\u4f7f\u7528\uff0c\u7528\u4e8e\u51cf\u5c11\u4ee3\u7801\u91cf\u3002\u4e00\u822c\u5e38\u7528\u7684\u6709\u8fd9\u4e48\u4e00\u4e9b\uff1a<br/><br/>vector \u52a8\u6001\u6570\u7ec4\uff0c\u8fd9\u4e2a\u5176\u5b9e\u770b\u4e2a\u4eba\u559c\u597d\uff0c\u5b83\u53ef\u4ee5\u652f\u6301\u4e0b\u6807\u8bbf\u95ee\uff0c\u5e76\u4e14\u53ef\u4ee5\u5feb\u901f\u5728\u672b\u5c3e\u589e\u52a0\u3001\u5220\u9664\u5143\u7d20\u3002<br/>deque \u53cc\u7aef\u961f\u5217\uff0c\u53ef\u4ee5\u4e0b\u6807\u8bbf\u95ee\uff0c\u4f46\u5e38\u6570\u6bd4\u6570\u7ec4\u7565\u9ad8\uff0c\u53ef\u4ee5\u5728\u4e24\u5934\u5feb\u901f\u63d2\u5165\u3001\u5220\u9664\u3002<br/>queue \u961f\u5217\uff0c\u63a5\u53e3\u6bd4\u8f83\u7b80\u5355\uff0c\u7528 front \u67e5\u770b\u961f\u9996\uff0cpop \u5f39\u51fa\u961f\u9996\uff0cpush \u52a0\u5165\u961f\u5c3e\u3002<br/>stack \u6808\uff0c\u7c7b\u4f3c\u4e8e queue\uff0c\u53ea\u4e0d\u8fc7\u662f\u7528 top \u67e5\u770b\u6808\u9876\u3002<br/>set \u548c map\uff0c\u8fd9\u662f STL \u826f\u5fc3\u4e3a\u5927\u5bb6\u63d0\u4f9b\u7684\u7ea2\u9ed1\u6811\uff0c\u53ef\u4ee5\u5feb\u901f\u67e5\u627e\u548c\u4f7f\u7528\u4e0e algorithm \u4e2d\u7c7b\u4f3c\u7684 lower_bound \u4ee5\u53ca upper_bound\u3002<br/>priority_queue \u4f18\u5148\u961f\u5217\uff0c\u4e5f\u5c31\u662f\u5927\u6839\u5806\uff0c\u63a5\u53e3\u548c stack \u5dee\u4e0d\u591a\u3002<br/>bitset \u5361\u5e38\u795e\u5668\uff0c\u7528\u4e8e\u5b58\u50a8\u4e8c\u8fdb\u5236\u5e8f\u5217\uff0c\u53ef\u4ee5\u8fdb\u884c\u4f4d\u8fd0\u7b97\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u57fa\u672c\u90fd\u662f $O(n / w)$\u3002<br/>string \u5b57\u7b26\u4e32\uff0c\u5176\u5b9e\u5c31\u662f vector<char>\uff0c\u4e00\u822c\u4e0d\u600e\u4e48\u7528\u3002<br/>* unordered_set \u548c unordered_map\uff0c\u529f\u80fd\u4e0e set \u548c map \u5bf9\u5e94\uff0c\u4f46\u662f\u662f\u54c8\u5e0c\u8868\u5b9e\u73b0\u7684\uff0c\u590d\u6742\u5ea6\u66f4\u4f18\u79c0\uff0c\u4f46\u4e0d\u652f\u6301\u4e8c\u5206\u67e5\u627e\u3002\u53ef\u4ee5\u5728\u5934\u6587\u4ef6 tr1/unordered_set \u548c tr1/unordered_map \u4e2d\u627e\u5230\u3002<br/><br/>\u8fd9\u4e9b\u4e1c\u897f\u4e3b\u8981\u8fd8\u662f\u63a8\u8350\u5927\u5bb6\u81ea\u5df1\u53bb cppreference \u4e0a\u53bb\u67e5\u7136\u540e\u8bd5\u7740\u7528\u4e00\u4e0b\uff0c\u76f8\u4fe1\u4f60\u4eec\u7684\u82f1\u6587\u6c34\u5e73\u8db3\u591f\u4e86\u3002<br/>\u7b2c\u4e8c\u90e8\u5206\uff1aLinux \u4e0b\u7f16\u7a0b\u73af\u5883<br/>\u7f16\u8f91\u5668<br/>\u5199\u7a0b\u5e8f\u7b2c\u4e00\u6b65\u662f\u4ec0\u4e48\uff1f\u5f53\u7136\u662f\u5199\u4ee3\u7801\u3002\u5728\u5199\u4ee3\u7801\u4e4b\u524d\uff0c\u4f60\u9700\u8981\u786e\u5b9a\u4f60\u5728\u5c06\u6765\u5728\u8003\u573a\u4e0a\u8981\u4f7f\u7528\u4ec0\u4e48\u7f16\u8f91\u5668\u3002NOI Linux \u76ee\u524d\u63d0\u4f9b\u7684\u7f16\u8f91\u5668\u6709\u8fd9\u4e9b\uff1a<br/><br/>gedit<br/>VIM<br/>Emacs<br/>GUIDE\u3001Anjuta\u3001Lazarus \u4e4b\u6d41<br/><br/>\u5728\u8fd9\u91cc\u6211\u4e5f\u4e0d\u505a\u4ec0\u4e48\u63a8\u8350\uff0c\u5927\u5bb6\u627e\u81ea\u5df1\u559c\u6b22\u7684\u5c31\u597d\u3002\u6211\u53ea\u77e5\u9053\u6b63\u5f0f\u8003\u573a\u4e0a\u666e\u901a\u73a9\u5bb6\u90fd\u662f\u4f7f\u7528\u4e0e \u201cUOJ \u81ea\u5b9a\u4e49\u6d4b\u8bd5\u201d \u5dee\u4e0d\u591a\u7684 gedit\uff0c\u4e2d\u9ad8\u7aef\u73a9\u5bb6\u666e\u904d\u9009\u62e9 Emacs \u6216 VIM\u3002<br/>\u7f16\u8bd1\u5668<br/>NOI Linux \u4e0b\u53ea\u63d0\u4f9b\u4e86 g++ \u6765\u7ed9\u6211\u4eec\u7f16\u8bd1\u7a0b\u5e8f\u3002\u5982\u679c\u4f60\u7684\u6e90\u4ee3\u7801\u53eb\u505a a.cpp\uff0c\u90a3\u4e48\u4f7f\u7528\uff1a<br/>1g++ a.cpp<br/><br/><br/>\u5c06\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u4ea7\u751f\u4e00\u4e2a a.out \u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f7f\u7528 ./a.out \u5c31\u53ef\u4ee5\u8fd0\u884c\u5b83\u3002\u5982\u679c\u4f60\u89c9\u5f97 a.out \u8fd9\u4e2a\u540d\u5b57\u592a na\u00efve\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a<br/>1g++ a.cpp -o exec<br/><br/><br/>\u5c06\u4f1a\u5f97\u5230 exec \u8fd9\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u3002\u5bf9\u4e8e\u4ea4\u4e92\u5f0f\u7684\u9898\u76ee\uff0c\u4e00\u822c\u4f1a\u63d0\u4f9b\u4e00\u4e2a\u53eb\u505a grader.cpp \u7684\u6587\u4ef6\uff0c\u6b64\u65f6\u4f60\u6309\u7167\u8981\u6c42\u5199\u597d\u7a0b\u5e8f\u540e\uff0c\u5e94\u8be5\u8fd9\u6837\u7f16\u8bd1\uff1a<br/>1g++ grader.cpp a.cpp<br/><br/><br/>\u5982\u679c\u9700\u8981\u6253\u5f00\u4f18\u5316\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a<br/>1g++ a.cpp -O2  // \u6216\u8005 -O3<br/><br/><br/>\u4e00\u5957\u9898\u76ee\u7684\u7b2c\u4e00\u9875\u901a\u5e38\u4f1a\u6709\u6ce8\u660e\u8868\u793a\u67d0\u4e9b\u9898\u76ee\u662f\u5426\u5f00\u4f18\u5316\u3002\u8fd9\u662f\u6bd4\u8f83\u91cd\u8981\u7684\u4fe1\u606f\uff0c\u901a\u5e38\u4f1a\u51b3\u5b9a\u4f60\u662f\u5426\u9700\u8981\u82b1\u65f6\u95f4\u6765\u5361\u5e38\u6570\u3002<br/>\u4e00\u822c\u4e3a\u4e86\u5145\u5206\u53d1\u6325\u7f16\u8bd1\u5668\u7684\u4f5c\u7528\uff0c\u6211\u4f1a\u6253\u5f00\u7f16\u8bd1\u5668\u7684\u7edd\u5927\u90e8\u5206\u8b66\u544a\uff1a<br/>1g++ a.cpp -Wall -Wextra<br/><br/><br/>\u6253\u5f00\u4e4b\u540e\uff0c\u4e00\u4e9b\u5e38\u89c1\u7684\u5374\u4e0d\u662f\u8bed\u6cd5\u9519\u8bef\u7684\u5c0f\u95ee\u9898\u90fd\u4f1a\u88ab\u7f16\u8bd1\u5668\u62a5\u544a\u3002\u5982 if (a = b) \u8fd9\u79cd\u76f8\u7b49\u7b26\u53f7\u5c11\u5199\u4e00\u4e2a\u7b49\u53f7\u7684\u9519\u8bef\uff0c\u7f16\u8bd1\u5668\u90fd\u4f1a\u63d0\u793a\u4f60\u3002<br/>\u8c03\u8bd5\u5668<br/>gdb \u662f\u6700\u5e38\u7528\u4e8e\u8c03\u8bd5\u7a0b\u5e8f\u7684\u5de5\u5177\u3002\u5c3d\u7ba1\u591a\u6570\u60c5\u51b5\u4e0b\u8f93\u51fa\u8c03\u8bd5\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\uff0c\u4f46\u662f gdb \u53ef\u4ee5\u5e2e\u4f60\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u8282\u7ea6\u65f6\u95f4\u3002gdb \u7684\u4e3b\u8981\u4f18\u52bf\u5728\u4e8e\u53ef\u4ee5\u7075\u6d3b\u7684\u8ddf\u8e2a\u7a0b\u5e8f\u8fd0\u884c\u7684\u72b6\u51b5\uff0c\u65b9\u4fbf\u6211\u4eec\u627e\u51fa BUG \u7684\u6839\u6e90\u3002<br/>\u5982\u679c\u4e00\u4e2a\u7a0b\u5e8f\u60f3\u8981\u4f7f\u7528 gdb \u8c03\u8bd5\uff0c\u90a3\u4e48\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u9700\u8981\u52a0\u4e0a -g \u9009\u9879\uff1a<br/>1g++ a.cpp -g<br/><br/><br/>\u7136\u540e\u6267\u884c gdb a.out \u5373\u53ef\u8fdb\u5165\u8c03\u8bd5\u3002\u4e00\u822c\u4f60\u4f1a\u770b\u5230\u4e0b\u9762\u8fd9\u4e9b\u4e1c\u897f\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1<br/>Copyright (C) 2016 Free Software Foundation, Inc.<br/>License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html><br/>This is free software: you are free to change and redistribute it.<br/>There is NO WARRANTY, to the extent permitted by law.  Type \\ show copying\\ <br/>and \\ show warranty\\  for details.<br/>This GDB was configured as \\ x86_64-linux-gnu\\ .<br/>Type \\ show configuration\\  for configuration details.<br/>For bug reporting instructions, please see:<br/><http://www.gnu.org/software/gdb/bugs/>.<br/>Find the GDB manual and other documentation resources online at:<br/><http://www.gnu.org/software/gdb/documentation/>.<br/>For help, type \\ help\\ .<br/>Type \\ apropos word\\  to search for commands related to \\ word\\ ...<br/>Reading symbols from a.out...done.<br/>(gdb)<br/><br/><br/>\u5176\u5b9e\u53ea\u6709\u6700\u540e\u4e00\u53e5 \u201cReading symbols from a.out...done.\u201d \u6709\u7528\uff0c\u5b83\u544a\u8bc9\u6211\u4eec a.out \u88ab\u6210\u529f\u8bfb\u53d6\u3002\u5982\u679c\u4f60\u4e0d\u60f3\u770b\u5230\u4e0a\u9762\u4e00\u5927\u5806\u8bdd\uff0c\u90a3\u4e48\u5728\u547d\u4ee4\u672b\u5c3e\u52a0\u4e2a -q \u5373\u53ef\u3002<br/>\u73b0\u5728\u6765\u4e3e\u4e2a\u4f8b\u5b50\u3002\u5c31\u4ee5\u4e0b\u9762\u7684\u7a0b\u5e8f\u5f00\u5200\uff0c\u6765\u4f53\u4f1a\u4e00\u4e0b\u4f7f\u7528 gdb \u7684\u57fa\u672c\u6d41\u7a0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17#include <cstdio><br/><br/>int fac(int n) {<br/>    return fac(n - 1) * n;<br/>}<br/><br/>int main() {<br/>    int n;<br/>    scanf(\\ % d\\ , &n);<br/>    n = fac(n);<br/><br/>    for (unsigned i = n; i >= 0; i--) {<br/>        puts(\\ Aha!\\ );<br/>    }<br/><br/>    return 0;<br/>}<br/><br/><br/>\u7f16\u8bd1\u540e\u8fdb\u5165 gdb\uff0c\u8f93\u5165 l \u5e76\u56de\u8f66\uff0c\u53ef\u4ee5\u770b\u5230\u7a0b\u5e8f\u7684\u524d\u9762\u51e0\u884c\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11(gdb) l<br/>1   #include <cstdio><br/>2<br/>3   int fac(int n) {<br/>4       return fac(n - 1) * n;<br/>5   }<br/>6<br/>7   int main() {<br/>8       int n;<br/>9       scanf(\\ % d\\ , &n);<br/>10      n = fac(n);<br/><br/><br/>\u8fd9\u65f6\u6309\u4e0b\u56de\u8f66\uff0c\u53ef\u4ee5\u770b\u5230\u7d27\u63a5\u7740\u7684\u540e\u9762\u51e0\u884c\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8(gdb)<br/>11<br/>12      for (unsigned i = n; i >= 0; i--) {<br/>13          puts(\\ Aha!\\ );<br/>14      }<br/>15<br/>16      return 0;<br/>17  }<br/><br/><br/>\u8fd9\u4e0d\u662f\u56e0\u4e3a\u56de\u8f66\u5c31\u662f\u770b\u4ee3\u7801\u7684\u529f\u80fd\uff0c\u800c\u662f\u5728 gdb \u4e2d\u4ec0\u4e48\u4e5f\u4e0d\u8f93\u5165\u5c31\u76f4\u63a5\u56de\u8f66\u8868\u793a\u6267\u884c\u4e0a\u4e00\u4e2a\u4f60\u4f7f\u7528\u7684\u547d\u4ee4\u3002\u6240\u4ee5\u8fd9\u91cc\u5b9e\u9645\u4e0a\u662f\u53c8\u6267\u884c\u4e86\u4e00\u904d l \u547d\u4ee4\u3002\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0a\u4e0b\u65b9\u5411\u952e\u6765\u7ffb\u9605\u4f60\u4e4b\u524d\u4f7f\u7528\u7684\u547d\u4ee4\u3002\u4f7f\u7528 l [\u884c\u53f7] \u5c06\u4f1a\u628a\u4f60\u6240\u6307\u5b9a\u7684\u884c\u53f7\u9644\u8fd1\u7684\u4ee3\u7801\u5c55\u793a\u7ed9\u4f60\u3002\u800c l [\u51fd\u6570\u540d] \u5219\u4f1a\u628a\u5bf9\u5e94\u51fd\u6570\u5c55\u793a\u3002<br/>\u5f53\u7136\u6211\u4eec\u4e0d\u662f\u62ff gdb \u6765\u770b\u4ee3\u7801\u7684......\u5982\u679c\u4f60\u73b0\u5728\u4f7f\u7528 r \u547d\u4ee4\uff0cgdb \u5c06\u4f1a\u6b63\u5e38\u542f\u52a8\u8fd9\u4e2a\u7a0b\u5e8f\u3002\u4f60\u4f1a\u53d1\u73b0\u8fd9\u5728\u548c gdb \u5916\u9762\u8fd0\u884c\u7a0b\u5e8f\u6ca1\u4ec0\u4e48\u533a\u522b\uff0c\u8f93\u5165\u4e86\u4e00\u4e2a\u6570\u5b57\u4e4b\u540e\u7a0b\u5e8f\u5c31\u4f1a\u6bb5\u9519\u8bef\u3002\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u8fd8\u6ca1\u6709\u8bbe\u7f6e\u65ad\u70b9\uff0cgdb \u4e0d\u4f1a\u65e0\u7f18\u65e0\u6545\u4f7f\u7a0b\u5e8f\u6682\u505c\u3002<br/>\u4f7f\u7528 b [\u51fd\u6570\u540d / \u884c\u53f7] \u53ef\u4ee5\u5728\u7279\u5b9a\u7684\u51fd\u6570\u5165\u53e3\u6216\u8005\u67d0\u4e00\u884c\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5f53\u7a0b\u5e8f\u8fd0\u884c\u5230\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u6682\u505c\u4e0b\u6765\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7(gdb) b main<br/>Breakpoint 1 at 0x40058c: file a.cpp, line 7.<br/>(gdb) r<br/>Starting program: /home/owen/aknoi/a.out<br/><br/>Breakpoint 1, main () at a.cpp:7<br/>7   int main() {<br/><br/><br/>\u4f7f\u7528 n \u53ef\u4ee5\u6267\u884c\u5f53\u524d\u8fd9\u4e00\u884c\u4ee3\u7801\uff1a<br/>1<br/>2(gdb) n<br/>9       scanf(\\ % d\\ , &n);<br/><br/><br/>\u8fd9\u91cc\u518d\u56de\u8f66\u4e00\u4e0b\u5c31\u4f1a\u6267\u884c scanf \u4e86\uff0c\u4e5f\u5c31\u4f1a\u8981\u4f60\u8f93\u5165\u4e00\u4e2a\u6570\u5b57\u4e86\uff1a<br/>1<br/>2<br/>3(gdb) n<br/>1<br/>10      n = fac(n);<br/><br/><br/>\u6ce8\u610f\uff0c\u5230\u4e86\u7b2c $10$ \u5982\u679c\u7ee7\u7eed\u4f7f\u7528 n\uff0c\u5c06\u4e0d\u4f1a\u8fdb\u5165 fac \u51fd\u6570\u3002\u5982\u679c\u60f3\u8fdb\u5165 fac \u51fd\u6570\u4e00\u63a2\u7a76\u7adf\uff0c\u5c31\u9700\u8981\u4f7f\u7528 s\uff1a<br/>1<br/>2<br/>3(gdb) s<br/>fac (n=1) at a.cpp:4<br/>4       return fac(n - 1) * n;<br/><br/><br/>\u4f7f\u7528 p \u53ef\u4ee5\u8ba1\u7b97\u4e00\u4e9b\u8868\u8fbe\u5f0f\uff0c\u5982\uff1a<br/>1<br/>2(gdb) p n * 123<br/>$1 = 123<br/><br/><br/>p \u662f gdb \u7684\u65b9\u4fbf\u6240\u5728\uff0c\u5b83\u53ef\u4ee5\u67e5\u770b\u7a0b\u5e8f\u4e2d\u7684\u53d8\u91cf\u4ece\u800c\u77e5\u9053\u7a0b\u5e8f\u5f53\u524d\u7684\u72b6\u51b5\u3002\u5f53\u7136\uff0c\u603b\u662f\u624b\u52a8\u4f7f\u7528 p \u975e\u5e38\u9ebb\u70e6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 disp \u6765\u5c06\u67d0\u4e2a\u8868\u8fbe\u5f0f\u6302\u5728\u65c1\u8fb9\u968f\u65f6\u67e5\u770b\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6(gdb) disp n<br/>1: n = 1<br/>(gdb) s<br/>fac (n=0) at a.cpp:4<br/>4       return fac(n - 1) * n;<br/>1: n = 0<br/><br/><br/>\u6ca1\u9519\uff0c\u4f60\u4f1a\u53d1\u73b0 n \u7684\u503c\u4f1a\u5728\u6bcf\u4e00\u6b65\u6307\u4ee4\u7ed3\u675f\u540e\u5c55\u793a\u7ed9\u4f60\u3002\u6ce8\u610f\u5230\u5de6\u8fb9\u7684\u90a3\u4e2a\u6807\u53f7 1\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 undisp 1 \u6765\u53d6\u6d88\u8fd9\u4e2a\u663e\u793a\u3002<br/>\u5f53\u7136\u4f60\u4e0d\u4f1a\u4e00\u76f4\u4f7f\u7528 n \u548c s \u8ba9\u7a0b\u5e8f\u8dd1\u4e0b\u53bb\uff0c\u6709\u65f6\u5019\u662f\u5e0c\u671b\u8ba9\u7a0b\u5e8f\u5148\u81ea\u7531\u7684\u8dd1\u4e00\u8dd1\u3002\u8fd9\u91cc\u6211\u4eec\u5148\u7ed9\u7b2c $4$ \u884c\u52a0\u4e2a\u65ad\u70b9\uff0c\u5e76\u4f7f\u7528 c \u547d\u4ee4\u7ee7\u7eed\u8fd0\u884c\u7a0b\u5e8f\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7(gdb) b 4<br/>Breakpoint 2 at 0x400571: file a.cpp, line 4.<br/>(gdb) c<br/>Continuing.<br/><br/>Breakpoint 2, fac (n=-1) at a.cpp:4<br/>4       return fac(n - 1) * n;<br/><br/><br/>\u7531\u4e8e\u5728\u7ee7\u7eed\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u9047\u4e0a\u4e86\u65ad\u70b9 $2$\uff0c\u6240\u4ee5\u7a0b\u5e8f\u53c8\u4e00\u6b21\u6682\u505c\u3002\u73b0\u5728\u53ef\u4ee5\u6765\u770b\u770b\u51fd\u6570\u7684\u8c03\u7528\u6808\u4e86\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5(gdb) bt<br/>#0  fac (n=-1) at a.cpp:4<br/>#1  0x000000000040057e in fac (n=0) at a.cpp:4<br/>#2  0x000000000040057e in fac (n=1) at a.cpp:4<br/>#3  0x00000000004005bb in main () at a.cpp:10<br/><br/><br/>\u53ef\u4ee5\u770b\u5230 fac \u8c03\u7528\u4e86\u4e09\u5c42\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 d \u547d\u4ee4\u6765\u5220\u9664\u4e00\u4e2a\u65ad\u70b9\uff0c\u5e76\u4e14\u5c1d\u8bd5\u7ee7\u7eed\u6267\u884c\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7(gdb) d 2<br/>(gdb) c<br/>Continuing.<br/><br/>Program received signal SIGSEGV, Segmentation fault.<br/>0x000000000040056e in fac (n=<error reading variable: Cannot access memory at address 0x7fffff7feffc>) at a.cpp:3<br/>3   int fac(int n) {<br/><br/><br/>\u6ca1\u6709\u4e86\u65ad\u70b9\u7684\u963b\u6320\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u76f4\u63a5\u6bb5\u9519\u8bef\u3002\u8f93\u5165 bt \u5c31\u53ef\u4ee5\u770b\u5230 fac \u9012\u5f52\u4e86\u76f8\u5f53\u591a\u5c42\uff0c\u5bfc\u81f4\u8d85\u51fa\u6808\u7a7a\u95f4\u3002\u627e\u5230\u4e86\u9519\u8bef\u539f\u56e0\uff0c\u5c31\u53ef\u4f7f\u7528 q \u547d\u4ee4\u9000\u51fa gdb \u4e86\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6(gdb) q<br/>A debugging session is active.<br/><br/>    Inferior 1 [process 23333] will be killed.<br/><br/>Quit anyway? (y or n) y<br/><br/><br/>\u7531\u4e8e fac \u51fd\u6570\u7f3a\u5c11\u8fb9\u754c\u6761\u4ef6\u5bfc\u81f4\u7206\u6808\uff0c\u6240\u4ee5\u4fee\u6539\u4e4b\u540e\u7684\u7a0b\u5e8f\u662f\u8fd9\u6837\u7684\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19#include <cstdio><br/><br/>int fac(int n) {<br/>    if (n == 0)<br/>        return 1;<br/>    return fac(n - 1) * n;<br/>}<br/><br/>int main() {<br/>    int n;<br/>    scanf(\\ % d\\ , &n);<br/>    n = fac(n);<br/><br/>    for (unsigned i = n; i >= 0; i--) {<br/>        puts(\\ Aha!\\ );<br/>    }<br/><br/>    return 0;<br/>}<br/><br/><br/>\u73b0\u5728\u7f16\u8bd1\u5e76\u8fd0\u884c\u7a0b\u5e8f\u5c06\u4f1a\u65e0\u9650\u8f93\u51fa \u201cAha!\u201d\u3002\u518d\u6b21\u4f7f\u7528 gdb \u6765\u8c03\u8bd5\uff0c\u8fd9\u6b21\u76f4\u63a5\u5f00\u59cb\u8fd0\u884c\u7a0b\u5e8f\uff0c\u5e76\u4e14\u5728\u4e00\u5806 \u201cAha!\u201d \u9762\u524d\u6c89\u7740\u5730\u6309\u4e0b \u201cCtrl + C\u201d\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10Aha!<br/>Aha!<br/>Aha!<br/>Aha!<br/>Aha!<br/>^C<br/>Program received signal SIGINT, Interrupt.<br/>0x00007ffff7856290 in __write_nocancel () at ../sysdeps/unix/syscall-template.S:84<br/>84  ../sysdeps/unix/syscall-template.S: No such file or directory.<br/>(gdb)<br/><br/><br/>\u7136\u540e\u8fd9\u4e2a\u7a0b\u5e8f\u5c31\u6682\u505c\u4e86\u3002gdb \u544a\u8bc9\u4f60\u73b0\u5728\u5728\u4e00\u4e2a\u5947\u602a\u7684\u6587\u4ef6\u91cc\u9762\uff0c\u5176\u5b9e\u662f\u56e0\u4e3a\u5728\u6267\u884c puts \u65f6\u6682\u505c\u4e86\u3002\u73b0\u5728\u6211\u4eec\u60f3\u56de\u5230 a.cpp \u51fd\u6570\u7684\u7b2c $15$ \u884c\uff0c\u56e0\u6b64\u53ef\u4ee5\u8bbe\u4e00\u4e2a\u65ad\u70b9\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10(gdb) b a.cpp:15<br/>Breakpoint 2 at 0x4005d1: file a.cpp, line 15.<br/>(gdb) c<br/>Continuing.<br/><br/><br/>Breakpoint 2, main () at a.cpp:15<br/>15          puts(\\ Aha!\\ );<br/>(gdb) p i<br/>$1 = 4294925190<br/><br/><br/>\u6253\u5370\u51fa i \u7684\u503c\uff0c\u53d1\u73b0\u53d8\u5f97\u975e\u5e38\u5927\u3002\u8fd9\u662f\u56e0\u4e3a i \u662f\u65e0\u7b26\u53f7\u6574\u578b\uff0c\u5f53 i = 0 \u65f6\u518d\u51cf\u4e00\uff0c\u5c31\u4f1a\u53d8\u6210 UINT_MAX\uff0c\u56e0\u800c\u5bfc\u81f4\u6b7b\u5faa\u73af\u3002\u81f3\u6b64\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u5f02\u5e38\u5c31\u5168\u90e8\u67e5\u6e05\u4e86\u3002\u4ee5\u4e0a\u4e5f\u5dee\u4e0d\u591a\u5c31\u662f OI \u4e2d\u5e38\u7528\u7684\u547d\u4ee4\uff0c\u5982\u679c\u60f3\u8981 gdb \u4e3a\u4f60\u53d1\u6325\u66f4\u5927\u7684\u4f5c\u7528\uff0c\u5c31\u9700\u8981\u5e73\u5e38\u591a\u7ec3\u4e60\u4f7f\u7528\uff0c\u7136\u540e\u624d\u80fd\u5728\u6b63\u5f0f\u8003\u573a\u4e0a\u719f\u7ec3\u8fd0\u7528\u8fd9\u4e9b\u5de5\u5177\u3002<br/>\u6027\u80fd\u5256\u6790\u5de5\u5177<br/>NOI Linux \u4e0a\u552f\u4e00\u63d0\u4f9b\u7684\u6027\u80fd\u5256\u6790\u5de5\u5177\u5c31\u662f gprof \u4e86\u3002\u5b83\u7684\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u751f\u6210\u4e00\u4efd\u7a0b\u5e8f\u7684\u8fd0\u884c\u62a5\u544a\uff0c\u4e3b\u8981\u5305\u62ec\u7a0b\u5e8f\u4e2d\u6bcf\u4e2a\u51fd\u6570\u7684\u76f8\u5173\u6570\u636e\u3002\u4f7f\u7528\u65b9\u6cd5\u5e76\u4e0d\u590d\u6742\uff0c\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b\uff1a<br/>\u9996\u5148\uff0c\u7f16\u8bd1\u7a0b\u5e8f\u7684\u65f6\u5019\u5e26\u4e0a -pg \u9009\u9879\uff1a<br/>1g++ a.cpp -pg<br/><br/><br/>\u7136\u540e\u8fd0\u884c\u4e00\u4e0b\u8fd9\u4e2a\u7a0b\u5e8f\uff0cOI \u4e2d\u901a\u5e38\u4f1a\u62ff\u4e2a\u5927\u6570\u636e\u6765\u8dd1\u4e00\u4e0b\u3002\u6ce8\u610f\uff0c\u5e26\u4e0a\u8fd9\u4e2a\u9009\u9879\u540e\u7a0b\u5e8f\u8fd0\u884c\u901f\u5ea6\u53ef\u80fd\u53d8\u6162\u4e86\u5f88\u591a\uff0c\u8fd9\u662f\u56e0\u4e3a\u6b64\u65f6\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4f1a\u6536\u96c6\u4e00\u4e9b\u4fe1\u606f\uff0c\u53d8\u6162\u662f\u6b63\u5e38\u7684\u3002\u7a0b\u5e8f\u8fd0\u884c\u5b8c\u6bd5\u540e\uff0c\u4f7f\u7528 gprof \u751f\u6210\u62a5\u544a\uff1a<br/>1gprof a.out > result.out<br/><br/><br/>result.out \u5c31\u662f\u62a5\u544a\u4e86\uff0c\u4f7f\u7528\u4efb\u610f\u7f16\u8f91\u5668\u53ef\u4ee5\u6253\u5f00\u3002\u4e0b\u9762\u653e\u4e00\u4e2a\u6211\u6700\u8fd1\u5199\u7684\u7a0b\u5e8f\u751f\u6210\u7684\u62a5\u544a\u7684\u524d\u51e0\u884c\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17Flat profile:<br/><br/>Each sample counts as 0.01 seconds.<br/>  %    cumulative   self              self     total<br/> time   seconds   seconds    calls  ms/call  ms/call  name<br/> 17.29      0.52     0.52 99401724     0.00     0.00  pushdown(int)<br/> 10.97      0.85     0.33 25936095     0.00     0.00  rotate(int, int)<br/>  6.32      1.36     0.19  6808190     0.00     0.00  upans(int, int)<br/>  6.15      1.54     0.19 38677554     0.00     0.00  update(int)<br/>  5.32      1.70     0.16 36189660     0.00     0.00  clear(int)<br/>  5.15      1.86     0.16 40849140     0.00     0.00  splay(int)<br/>  4.99      2.16     0.15       43     3.49    60.87  dfs(int, int)<br/>  4.82      2.30     0.15 13616380     0.00     0.00  query(int, long long)<br/>  4.82      2.45     0.15 83375581     0.00     0.00  rminb(int)<br/>  3.66      2.56     0.11                             main<br/>  2.66      2.64     0.08 83375581     0.00     0.00  rmina(int)<br/>  2.33      2.71     0.07        1    70.06   130.11  initialize()<br/><br/><br/>\u4e0a\u9762\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u88ab\u8c03\u67e5\u5230\u7684\u51fd\u6570\u6240\u5360\u7528\u7684\u65f6\u95f4\u767e\u5206\u6bd4\uff0c\u79d2\u6570\u548c\u8c03\u7528\u6b21\u6570\u3002\u6392\u540d\u8d8a\u9760\u524d\u7684\u8868\u660e\u5360\u7528\u65f6\u95f4\u8d8a\u591a\u3002\u4ece\u4e0a\u9762\u53ef\u4ee5\u770b\u51fa\uff0cpushdown \u548c rotate \u5360\u7528\u4e86\u7edd\u5927\u90e8\u5206\u65f6\u95f4\uff0c\u56e0\u6b64\u5982\u679c\u60f3\u5361\u5e38\u6570\uff0c\u9996\u5148\u5e94\u8003\u8651\u5b83\u4eec\uff0c\u8fd9\u6837\u6548\u679c\u624d\u6700\u660e\u663e\u3002\u6709\u65f6\u5019\u8fd9\u4efd\u62a5\u544a\u91cc\u9762\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u4e9b\u540d\u5b57\u5f88\u957f\u5f88\u5947\u602a\u7684\u51fd\u6570\uff0c\u4e0d\u8981\u89c9\u5f97\u662f\u51fa\u4e86\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u80fd\u662f STL \u91cc\u9762\u7684\u51fd\u6570\uff0c\u6240\u4ee5\u540d\u5b57\u624d\u4f1a\u5f88\u5947\u602a\u3002<br/>gprof \u4e00\u822c\u662f\u7528\u5728\u4f60\u8003\u8bd5\u65f6\u95f4\u6bd4\u8f83\u5145\u88d5\u7684\u60c5\u51b5\u4e0b\uff0c\u7ed9\u5927\u6570\u636e\u7ed3\u6784\u548c\u4e00\u4e9b\u6570\u8bba\u7b5b\u9898\u6765\u5206\u6790\u7a0b\u5e8f\u6027\u80fd\u74f6\u9888\u7528\u7684\u3002\u5982\u679c\u4f60\u60f3\u5361\u5e38\u6570\u4e86\uff0c\u53ef\u4ee5\u5229\u7528\u8fd9\u4efd\u62a5\u544a\u505a\u4e00\u4e2a\u53c2\u8003\u3002<br/>\u540e\u8bb0<br/>\u81f3\u6b64\uff0c\u8fd9\u7bc7\u5e9f\u8bdd\u8fde\u7bc7\u7684\u7b80\u5355\u7684\u6307\u5357\u5c31\u7ed3\u675f\u4e86~~~<br/>\uff08\u6211\u81ea\u5df1\u4e5f\u6ca1\u60f3\u5230\u5199\u4e86\u8fd9\u4e48\u957f......\uff09<br/>\u6700\u540e\u795d\u5927\u5bb6 OI \u987a\u5229\uff0c\u6700\u540e\u90fd\u5b9e\u73b0\u81ea\u5df1\u5fc3\u4e2d\u7684\u7406\u60f3\uff01<br/>23-24 Sept 2017, by riteme",
"url": "blog/2017-10-28/oi-coding-guidelines.html"
},
"POJ2135 Farm Tour": {
"tags": "POJ \u7f51\u7edc\u6d41 \u6700\u5c0f\u8d39\u7528\u6d41 \u56fe\u8bba \u9898\u89e3",
"text": "[POJ2135] Farm Tour<br/>\u539f\u9898\u9898\u610f<br/>FJ\u8001\u7237\u7237\u5e26\u7740\u4ed6\u7684\u670b\u53cb\u5230\u4ed6\u7684\u5f00\u5fc3\u519c\u573a\u88c5B\u3002FJ\u7684\u519c\u573a\u662f\u4e00\u5f20\u6709$n(n\\\\le1000)$\u4e2a\u70b9\uff0c$m(m\\\\le10000)$\u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u6bcf\u4e2a\u70b9\u4ece$1$\u5f00\u59cb\u7f16\u53f7\uff0c\u6bcf\u6761\u8fb9\u6709\u4e00\u4e2a\u8fb9\u6743\u3002\u73b0\u5728\u4ed6\u60f3\u4ece$1$\u8d70\u5230$n$\uff0c\u7136\u540e\u53c8\u4ece$n$\u8d70\u5230$1$\uff0c\u4ed6\u5e0c\u671b\u8d70\u7684\u8def\u6700\u77ed\u4e14\u6bcf\u6761\u8def\u4e0d\u8d70\u4e24\u904d\u3002<br/>\u505a\u6cd5<br/>\u770b\u5230\u8981\u4f7f\u8d70\u7684\u8def\u6700\u77ed\uff0c\u5c31\u80af\u5b9a\u8981\u52a8\u7528\u6700\u77ed\u8def\u4e86\u3002\u7136\u800c\u4ed6\u8fd8\u9700\u8981\u4e24\u6761\uff0c\u4e14\u8fd9\u4e24\u6761\u8def\u5f84\u7684\u6bcf\u4e00\u6761\u8fb9\u90fd\u4e0d\u540c\uff0c\u7528\u5355\u7eaf\u7684\u6700\u77ed\u8def\u96be\u4ee5\u529e\u5230\u3002<br/>\u4e0d\u59a8\u8fd0\u7528\u6700\u5927\u6d41\u7684\u601d\u60f3\uff0c\u5c06\u6bcf\u6761\u8fb9\u62c6\u6210\u4e24\u4e2a\u6709\u5411\u7ba1\u9053\uff0c\u4e14\u5bb9\u91cf\u4e3a1\u3002\u90a3\u4e48\uff0c\u5728\u589e\u5e7f\u65f6\uff0c\u53ea\u8981\u662f\u8d70\u8fc7\u7684\u8fb9\u5c31\u4f1a\u6ca1\u6709\u6d41\u91cf\u4e86\uff0c\u4fdd\u8bc1\u53ea\u6709\u4e00\u6761\u8def\u5f84\u7ecf\u8fc7\u3002<br/>\u5c06\u6700\u77ed\u8def\u548c\u6700\u5927\u6d41\u7ed3\u5408\u8d77\u6765\uff0c\u5c31\u662f\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u6d41\u7f51\u7edc\u7684\u6bcf\u6761\u5f27\u589e\u52a0\u4e00\u4e2a\u5c5e\u6027cost\u8868\u793a\u8d39\u7528\uff08\u6ce8\u610f\u4e0d\u662f\u5355\u4f4d\u8d39\u7528\uff09\uff0c\u5bf9\u5e94\u7684\u5c31\u662f\u539f\u56fe\u4e2d\u7684\u8fb9\u6743\u3002\u6bcf\u6b21\u589e\u5e7f\u65f6\u9009\u53d6\u8d39\u7528\u6700\u5c0f\u7684\u6765\u8fdb\u884c\u589e\u5e7f\uff0c\u5c31\u80fd\u786e\u4fdd\u627e\u5230\u7684\u589e\u5e7f\u8def\u662f\u539f\u56fe\u4e2d\u7684\u6700\u77ed\u8def\u3002<br/>\u6700\u540e\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u8981\u627e\u4e24\u6761\uff0c\u8fd9\u4e2a\u5176\u5b9e\u5f88\u597d\u529e\u3002\u6211\u4eec\u5229\u7528\u6e90\u70b9\u548c\u6c47\u70b9\u6765\u63a7\u5236\u3002\u9996\u5148\u5efa\u7acb\u4e00\u4e2a\u6e90\u70b9\uff0c\u4e0e$1$\u76f8\u8fde\uff0c\u5bb9\u91cf\u4e3a2,\u5f53\u7136\u8d39\u7528\u4e3a0\uff0c\u8fd9\u6837\u4e0d\u4f1a\u6700\u77ed\u8def\u7684\u7ed3\u679c\u3002\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u5c06\u6c47\u70b9\u4e0e$n$\u8fde\u63a5\u3002\u8fd9\u6837\uff0c\u6bcf\u6b21\u53ea\u80fd\u589e\u5e7f1\u7684\u6d41\uff0c\u5c31\u80fd\u786e\u4fdd\u6700\u591a\u53ea\u67092\u6761\u589e\u5e7f\u8def\u3002<br/>\u9700\u6ce8\u610f\u7684\u662f\uff0c\u5728\u6b8b\u7559\u7f51\u7edc\u4e2d\uff0c\u65b9\u5411\u8fb9\u7684\u8fb9\u6743\u8981\u4e3a-cost\uff0c\u8fd9\u6837\u624d\u80fd\u8ba9\u589e\u5e7f\u6b63\u5e38\u8fdb\u884c\u3002\u56e0\u6b64\uff0cDijkstra\u7b97\u6cd5\u5e76\u4e0d\u9002\u5408\u3002",
"url": "blog/2016-2-1/farm-tour.html"
},
"RSRL\u5f00\u53d1\u8bb0\u5f55\uff08\u4e00\uff09": {
"tags": "RSRL",
"text": "RSRL\u5f00\u53d1\u8bb0\u5f55\uff08\u4e00\uff09<br/>\u6df1\u89c9\u81ea\u5df1\u59ff\u52bf\u6c34\u5e73\u8fd8\u662f\u592a\u4f4e\uff0c\u8bb8\u591a\u4e1c\u897f\u5e76\u6ca1\u6709\u5b66\u5230\u5bb6\u5c31\u51c6\u5907\u641e\u4e1c\u897f\uff0cne2d\u5c31\u662f\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\u5427\u3002\u867d\u7136\u4ee5\u540e\u53ef\u80fd\u8fd8\u4f1a\u7ee7\u7eed\uff0c\u4f46\u662f\u73b0\u5728\u5148\u5199\u4e2a\u8f6f\u6e32\u67d3\u5668\u6765\u719f\u6089\u4e00\u4e9b\u57fa\u7840\u77e5\u8bc6\u3002<br/>\u9879\u76ee\u5f00\u5728\u4e86GitHub\u548cGit@OSC\u4e0a\uff0c\u6b22\u8fce\u56f4\u89c2\uff1a<br/>GitHub: https://github.com/riteme/RSRL<br/>Git@OSC: https://git.oschina.net/riteme/RSRL<br/>\u6240\u8c13\u4e4e\u5f00\u53d1\u8bb0\u5f55\uff0c\u5c31\u662f\u8bb0\u5f55\u4e00\u70b9\u6709\u70b9\u4ef7\u503c\u7684\u4e1c\u897f\uff0c\u5404\u4f4d\u968f\u610f\u770b\u770b\u3002<br/>\u989c\u8272\u8fd0\u7b97<br/>Color.h & Color.cpp<br/>\u5e38\u89c1\u7684\u5c4f\u5e55\u989c\u8272\u6709\u56db\u4e2a\u5206\u91cf\uff1a\u7ea2($\\\\mathrm{R}$)\u3001\u7eff($\\\\mathrm{G}$)\u3001\u84dd($\\\\mathrm{B}$)\u548c\u900f\u660e\u5ea6($\\\\mathrm{A}$)\u3002\u901a\u5e38\u8fd9\u56db\u4e2a\u5206\u91cf\u7528uint8_t\u6765\u8bb0\u5f55\uff0c\u8303\u56f4\u5c31\u662f$0$\u81f3$255$\u3002\u5728\u8ba1\u7b97\u673a\u56fe\u5f62\u5b66\u4e2d\u4e3a\u4e86\u65b9\u4fbf\u63d2\u503c\uff0c\u901a\u5e38\u90fd\u662f\u7528\u6d6e\u70b9\u6570\u6765\u5b58\u50a8\u7684\uff0c\u8303\u56f4\u4e3a$0.0$\u81f3$1.0$\u3002<br/>\u8ba1\u7b97\u4e00\u4e2a\u989c\u8272\u7684\u53cd\u8272\u53ef\u4ee5\u7528\u4ee5\u4e0b\u516c\u5f0f\uff1a<br/>$$<br/>\\\\mathrm{R}^\\\\prime = 1 - \\\\mathrm{R} \\\\\\\\<br/>\\\\mathrm{G}^\\\\prime = 1 - \\\\mathrm{G} \\\\\\\\<br/>\\\\mathrm{B}^\\\\prime = 1 - \\\\mathrm{B}<br/>$$<br/>\u8fd9\u91cc\u6211\u4eec\u4e0d\u8003\u8651\u900f\u660e\u5ea6\u3002<br/>\u53e6\u4e00\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u5c31\u662fAlpha\u6df7\u5408\uff0c\u5c31\u662f\u5c06\u4e24\u4e2a\u989c\u8272\u6309\u7167\u900f\u660e\u5ea6\u6df7\u5408\uff0c\u901a\u5e38\u662f\u8fd9\u6837\u8ba1\u7b97\u7684\uff1a<br/>$$<br/>\\\\mathrm{R}^\\\\prime = \\\\mathrm{R}_1 \\\\cdot \\\\mathrm{A}_1 + \\\\mathrm{R}_2 \\\\cdot \\\\mathrm{A}_2 \\\\cdot (1 - \\\\mathrm{A}_1) \\\\\\\\<br/>\\\\mathrm{G}^\\\\prime = \\\\mathrm{G}_1 \\\\cdot \\\\mathrm{A}_1 + \\\\mathrm{G}_2 \\\\cdot \\\\mathrm{A}_2 \\\\cdot (1 - \\\\mathrm{A}_1) \\\\\\\\<br/>\\\\mathrm{B}^\\\\prime = \\\\mathrm{B}_1 \\\\cdot \\\\mathrm{A}_1 + \\\\mathrm{B}_2 \\\\cdot \\\\mathrm{A}_2 \\\\cdot (1 - \\\\mathrm{A}_1) \\\\\\\\<br/>\\\\mathrm{A}^\\\\prime = 1 - (1 - \\\\mathrm{A}_1) \\\\cdot (1 - \\\\mathrm{A}_2)<br/>$$<br/>\u5176\u4e2d$\\\\{\\\\mathrm{R}_1,\\\\;\\\\mathrm{G}_1,\\\\;\\\\mathrm{B}_1,\\\\;\\\\mathrm{A}_1\\\\}$\u662f\u524d\u666f\u8272\uff0c$\\\\{\\\\mathrm{R}_1,\\\\;\\\\mathrm{G}_1,\\\\;\\\\mathrm{B}_1,\\\\;\\\\mathrm{A}_1\\\\}$\u662f\u540e\u666f\u8272\u3002<br/>\u540c\u65f6\uff0c\u8fd9\u4e2a\u516c\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u989c\u8272\u7684\u53e0\u52a0\u987a\u5e8f\u4e0d\u540c\uff0c\u6700\u7ec8\u7684\u7ed3\u679c\u4e5f\u4f1a\u6709\u6240\u4e0d\u540c\u3002<br/>\u5411\u91cf\u4e0e\u77e9\u9635<br/>Math.h & Math.cpp<br/>\u8fd9\u91cc\u4e0d\u5728\u4ecb\u7ecd\u4ec0\u4e48\u662f\u5411\u91cf\u548c\u77e9\u9635\u4e86\uff0c\u8fd9\u91cc\u81f3\u4ecb\u7ecd\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u77e9\u9635\u3002<br/>\u9996\u5148\u6211\u4eec\u7684\u53ef\u80fd\u9700\u8981\u7f29\u653e\u4e00\u4e2a\u5411\u91cf\uff0c\u8fd9\u53ef\u4ee5\u4f7f\u7528\u77e9\u9635\u6765\u8868\u793a\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>S_X & 0 & 0 \\\\\\\\<br/>0 & S_Y & 0 \\\\\\\\<br/>0 & 0 & S_Z<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\cdot<br/>\\\\left(<br/>\\\\begin{matrix}<br/>X \\\\\\\\<br/>Y \\\\\\\\<br/>Z<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u5982\u679c\u662f\u65cb\u8f6c\uff0c\u90a3\u4e48\u8fd9\u6837\u4e5f\u53ef\u4ee5\uff08\u4e0b\u9762\u793a\u4f8b\u7684\u662f\u7ed5Z\u8f74\u65cb\u8f6c\uff09\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>\\\\cos\\\\alpha & -\\\\sin\\\\alpha & 0 \\\\\\\\<br/>\\\\sin\\\\alpha & \\\\cos\\\\alpha & 0 \\\\\\\\<br/>0 & 0 & 1<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\cdot<br/>\\\\left(<br/>\\\\begin{matrix}<br/>X \\\\\\\\<br/>Y \\\\\\\\<br/>Z<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u5bf9\u4e8e\u7ed5X\u8f74\u548c\u7ed5Y\u8f74\u7684\u65cb\u8f6c\u53ef\u4ee5\u7c7b\u4f3c\u7684\u6784\u9020\u3002<br/>\u5f88\u591a\u5176\u5b83\u7684\u7ebf\u6027\u53d8\u6362\u90fd\u53ef\u4ee5\u7528\u77e9\u9635\u6765\u8868\u793a\u3002\u5f53\u6211\u4eec\u60f3\u8fdb\u884c\u591a\u4e2a\u53d8\u6362\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u77e9\u9635\u4e58\u6cd5\u6765\u53d8\u4e3a\u4e00\u4e2a\u77e9\u9635\uff0c\u8fd9\u6837\u5c31\u52a0\u901f\u4e86\u590d\u6742\u7684\u53d8\u6362\u3002<br/>\u4f46\u662f\u5e73\u79fb\u5411\u91cf\u51fa\u4e86\u4e00\u70b9\u610f\u5916\uff0c\u56e0\u4e3a3\u7ef4\u7684\u77e9\u9635\u65e0\u6cd5\u8868\u793a\u5e73\u79fb\u53d8\u5316\u3002<br/>\u4e3a\u4e86\u7edf\u4e00\u5b83\u4eec\uff0c\u5e73\u79fb\u53d8\u5316\u88ab\u52a0\u4e0a\u4e86\u4e00\u7ef4\uff0c\u4f7f\u7528\u56db\u7ef4\u77e9\u9635\u6765\u8868\u793a\u4e4b\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 0 & 0 & D_X \\\\\\\\<br/>0 & 1 & 0 & D_Y \\\\\\\\<br/>0 & 0 & 1 & D_Z \\\\\\\\<br/>0 & 0 & 0 & 1<br/>\\\\end{matrix}<br/>\\\\right] \\\\cdot<br/>\\\\left(<br/>\\\\begin{matrix}<br/>X \\\\\\\\<br/>Y \\\\\\\\<br/>Z \\\\\\\\<br/>1<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u662f\u4e0d\u662f\u975e\u5e38\u5de7\u5999\uff1f\u867d\u7136\u5411\u91cf\u548c\u77e9\u9635\u90fd\u53d8\u6210\u4e86\u56db\u7ef4\uff0c\u4f46\u662f\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u6240\u6709\u7684\u7ebf\u6027\u53d8\u6362\u90fd\u7528\u77e9\u9635\u8868\u793a\uff0c\u5e76\u4e14\u53ef\u4ee5\u5229\u7528\u77e9\u9635\u4e58\u6cd5\u6765\u52a0\u901f\u53d8\u6362\u3002\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u77e9\u9635\u5728\u8ba1\u7b97\u673a\u56fe\u5f62\u5b66\u4e2d\u5341\u5206\u91cd\u8981\u7684\u539f\u56e0\u4e4b\u4e00\u4e86\u3002",
"url": "blog/2016-11-6/rsrl-1.html"
},
"ZY\u7684\u6838\u7535\u7ad9": {
"tags": "Problems ZY",
"text": "ZY\u7684\u6838\u7535\u7ad9 (nuclear.in/out/cpp)<br/>\u65f6\u95f4\u9650\u5236: 5 s / \u5185\u5b58\u9650\u5236: 256 MB / \u6253\u5f00O2\u4f18\u5316<br/>\u9898\u76ee\u63cf\u8ff0<br/><br/>\u201cZY\u559c\u6b22\u73a9\u6838\u7535\u7ad9\u3002\u201d<br/><br/>ZY\u7684\u6838\u7535\u7ad9\u975e\u5e38\u7279\u6b8a\u3002\u65e9\u57282038\u5e74\uff0cZY\u5c31\u53d1\u73b0\u4e86\u9ad8\u5206\u5b50\u6709\u673a\u7269\u7684\u5b8c\u5168\u88c2\u89e3\u53ef\u4ee5\u91ca\u653e\u5927\u91cf\u7684\u6838\u80fd\u7684\u539f\u7406\uff08\u8fd9\u53e5\u8bdd\u7eaf\u5c5eFP\uff09\u3002\u56e0\u6b64ZY\u7684\u6838\u7535\u7ad9\u53cd\u5e94\u5806\u91cc\u9762\u5168\u662f\u9ad8\u5206\u5b50\u6709\u673a\u7269\uff0c\u53ef\u60dc\u53ea\u6709\u4e00\u4e2a\u3002<br/>\u4e3a\u4e86\u4f7f\u53d1\u7535\u91cf\u5c3d\u53ef\u80fd\u5927\uff0cZY\u627e\u5230\u4e86\u4e00\u79cd\u80fd\u4f7f\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u7684\u65b9\u5f0f\uff0c\u4f7f\u91ca\u653e\u51fa\u6765\u7684\u80fd\u91cf\u6700\u5927\u3002\u7531\u4e8e\u8fd9\u662fZY\u7684\u6709\u673a\u7269\uff0c\u56e0\u6b64\u88c2\u89e3\u65b9\u5f0f\u4e5f\u975e\u5e38\u5947\u8469\u3002\u4e0b\u9762\u662fZY\u57282039\u5e74\u7684\u8bba\u6587\u300a\u8bbaZY\u5bf9MC1\u6838\u7535\u7ad9\u7684\u5de8\u5927\u8d21\u732e\u300b\u4e2d\u7684\u8282\u9009\u7247\u6bb5\uff1a<br/><br/>......<br/>\u6211\u4eec\u7684\u6709\u673a\u7269\u662f\u7531$n$\u4e2a\u5404\u79cd\u539f\u5b50\u6784\u6210\u7684\uff0c\u539f\u5b50\u4e4b\u95f4\u901a\u8fc7\u4e0d\u540c\u7684\u5171\u4ef7\u952e\u76f8\u8fde\u3002<br/><br/>($\\\\text{H}$\u592a\u591a\u4e86\uff0c\u5230\u65f6\u5019\u8fd9\u4e9b\u6ca1\u7528\u7684\u6c22\u539f\u5b50\u90fd\u4f1a\u88abZY\u4e22\u6389)<br/>......<br/>\u4e3a\u4e86\u65b9\u4fbf\u8fdb\u884c\u88c2\u89e3\uff0c\u8fd9\u4e2a\u6709\u673a\u7269\u662f\u6ca1\u6709\u73af\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8282\u7ea6\u6210\u672c\u6765\u4e70**V*P***......<br/>......<br/>\u6bcf\u6b21\u88c2\u89e3\u90fd\u4f1a\u65ad\u5f00\u4e00\u4e2a\u5171\u4ef7\u952e\uff0c\u6b64\u65f6\u8fd9\u4e2a\u6709\u673a\u7269\u4f1a\u5206\u4e3a\u4e24\u90e8\u5206\u3002\u5e76\u4e14\u91ca\u653e\u5927\u91cf\u7684\u80fd\u91cf......<br/>\u8bbe\u653e\u51fa\u7684\u80fd\u91cf\u4e3a$E$\uff0c\u6709\u673a\u7269\u88c2\u89e3\u540e\u7684\u4e24\u90e8\u5206\u7684\u5171\u4ef7\u952e\u7684\u96c6\u5408\u5206\u522b\u4e3a$A$\u548c$B$\uff0c\u5219\uff1a\u3001<br/>$$ E = \\\\sum_{a\\\\in A} a.\\\\text{energy} \\\\cdot \\\\sum_{b\\\\in B} b.\\\\text{energy} \\\\tag{ZY's energy theorem}$$<br/>\u5176\u4e2d$\\\\text{energy}$\u8868\u793a\u5171\u4ef7\u952e\u7684\u80fd\u91cf\u3002<br/>......<br/>\u4e3a\u4e86\u5145\u5206\u5229\u7528\u6709\u673a\u7269\u4e2d\u7684\u80fd\u91cf\uff0c\u6bcf\u88c2\u89e3\u4e00\u4e2a\u5171\u4ef7\u952e\u540e\uff0c\u6211\u4eec\u6709\u529e\u6cd5\u65e0\u635f\u8017\u65e0\u6210\u672c\u7684\u5c06\u5176\u8fd8\u539f\uff0c\u5373\u6709\u673a\u7269\u4f1a\u53d8\u5f97\u548c\u88c2\u89e3\u524d\u4e00\u6837\u3002\u4f46\u662f\u51fa\u4e8e\u79cd\u79cd\u539f\u56e0\uff0c\u8fd9\u4e2a\u5171\u4ef7\u952e\u5c31\u4e0d\u80fd\u518d\u6b21\u8fdb\u884c\u88c2\u89e3\u4e86\u3002\u9664\u975eZY\u53d1\u51faSB\u4e4b\u795e\u529b\u6765\u4f7f\u6240\u6709\u7684\u5171\u4ef7\u952e\u590d\u6d3b......<br/>......<br/>\u90a3\u4e48\uff0c\u4e00\u4e2a\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u6240\u80fd\u653e\u51fa\u7684\u80fd\u91cf\u4e3a\u6240\u6709\u5171\u4ef7\u952e\u88c2\u89e3\u4e00\u6b21\u540e\u6240\u653e\u51fa\u7684\u80fd\u91cf\u4e4b\u548c\u3002<br/>......<br/><br/>(\u5b9e\u9645\u4e0a\uff0cZY\u7684\u8fd9\u7bc7\u8bba\u6587\u957f\u8fbe$2147483647$\u5b57)<br/>\u5f53\u7136\uff0cZY\u7684\u667a\u5546\u7406\u8bba\u4e0a\u4e3a$-\\\\infty$\u3002\u56e0\u6b64\u5b83\u7684\u6838\u7535\u7ad9\u5176\u5b9e\u975e\u5e38\u8fa3\u9e21\u3002\u53cd\u5e94\u5806\u4e2d\u7684\u6709\u673a\u7269\u4e0d\u4e00\u5b9a\u662f\u7a33\u5b9a\u7684\uff0c\u4f46\u662fZY\u5229\u7528LCT\u7b97\u6cd5\u4ee5$O(\\\\infty!)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6210\u529f\u5730\u4fdd\u8bc1\u4e86\u6709\u673a\u7269\u7684\u7ed3\u6784\uff0c\u8fd9\u6837\u5c31\u65b9\u4fbfZY\u53d1\u51faSB\u4e4b\u795e\u529b\u3002\u4f46\u662f\u4ee4ZY\u60f3\u8df3\u697c\u7684\u662f\uff0c\u603b\u6709\u4e00\u4e2a\u5171\u4ef7\u952e\u7684\u80fd\u91cf\u5728\u7ef4\u62a4\u6709\u673a\u7269\u7ed3\u6784\u65f6\u4f1a\u53d8\u52a8\u3002\u7136\u800c\u201d\u673a\u667a\u201d\u7684ZY\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e9b\u53d8\u5316\u3002<br/>ZY\u53ea\u5e0c\u671b\u80fd\u591f\u5feb\u901f\u7b97\u51fa\u5f53\u524d\u7684\u6709\u673a\u7269\u901a\u8fc7\u5b8c\u5168\u88c2\u89e3\u7a76\u7adf\u80fd\u653e\u51fa\u591a\u5c11\u80fd\u91cf\u3002\u7531\u4e8eZY\u7684\u6570\u5b66\u53ea\u6709\u5b66\u524d\u73ed\u6c34\u5e73\uff0c\u6240\u4ee5\u6bcf\u5f53\u5979\u7b97\u5230\u4e00\u534a\u65f6\uff0c\u8fd9\u4e2a\u6709\u673a\u7269\u53c8\u5f00\u59cb\u4e71\u641e\u4e86\uff0cZY\u5c31\u53ea\u80fd\u7528LCT\u6765\u91cd\u65b0\u7ef4\u62a4\u5b83\u3002<br/>\u4e00\u5e74\u4e4b\u5185\uff0cZY\u7684\u6838\u7535\u7ad9\u4ec0\u4e48\u7535\u90fd\u6ca1\u6709\u53d1\u3002\u4e3a\u4e86\u5feb\u901f\u8ba1\u7b97\uff0cZY\u627e\u5230\u4e86\u4f60\u8fd9\u4e2a**\u3002<br/>ZY\u5e0c\u671b\u4f60\u80fd\u7ed9\u51fa\u4e00\u4e2a\u597d\u65b9\u6cd5\u6765\u5e2e\u52a9\u5979\u8ba1\u7b97\u5f53\u524d\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u80fd\u653e\u51fa\u7684\u80fd\u91cf\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c$1$\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570$n$\uff0c$m$\u3002$n$\u8868\u793a\u6709\u673a\u7269\u4e2d\u539f\u5b50\u7684\u6570\u91cf\uff0c$m$\u8868\u793aZY\u7ef4\u62a4\u6709\u673a\u7269\u7ed3\u6784\u7684\u6b21\u6570\u3002<br/>\u63a5\u4e0b\u6765$n - 1$\u884c\u63cf\u8ff0\u4e00\u4e2a\u6709\u673a\u7269\u3002\u5bf9\u4e8e\u6bcf\u4e00\u884c\u8f93\u5165\u4e09\u4e2a\u6574\u6570$u$\uff0c$v$\u548c$e$\uff0c\u8868\u793a\u7b2c$u$\u53f7\u539f\u5b50\u548c\u7b2c$v$\u53f7\u539f\u5b50\u4e4b\u95f4\u4ee5\u80fd\u91cf\u4e3a$e$\u7684\u5171\u4ef7\u952e\u76f8\u8fde\u3002<br/>\u63a5\u4e0b\u6765$m$\u884c\uff0c\u6bcf\u4e00\u884c\u63cf\u8ff0\u4e00\u4e2a\u5171\u4ef7\u952e\u7684\u952e\u80fd\u53d8\u5316\u3002\u6bcf\u884c\u8f93\u5165\u4e09\u4e2a\u6574\u6570$u$\uff0c$v$\u548c$e$\uff0c\u8868\u793a\u7b2c$u$\u53f7\u539f\u5b50\u548c\u7b2c$v$\u53f7\u539f\u5b50\u4e4b\u95f4\u7684\u5171\u4ef7\u952e\u7684\u80fd\u91cf\u53d8\u4e3a$e$\u3002\u4fdd\u8bc1\u7b2c$u$\u53f7\u539f\u5b50\u548c\u7b2c$v$\u53f7\u539f\u5b50\u4e4b\u95f4\u5b58\u5728\u5171\u4ef7\u952e\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u6b21\u5171\u4ef7\u952e\u80fd\u91cf\u7684\u53d8\u52a8\uff0c\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u952e\u80fd\u6539\u53d8\u540e\u7684\u6709\u673a\u7269\u5b8c\u5168\u88c2\u89e3\u80fd\u653e\u51fa\u7684\u80fd\u91cf\u3002<br/>\u8f93\u5165\u6837\u4f8b<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>127 4<br/>1 2 2<br/>1 7 1<br/>2 3 2<br/>2 6 1<br/>3 4 1<br/>3 5 1<br/><br/>1 2 2<br/>1 2 3<br/>2 3 3<br/>1 2 0<br/><br/><br/>\u8f93\u51fa\u6837\u4f8b<br/>1<br/>2<br/>3<br/>413<br/>15<br/>16<br/>10<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8be2\u95ee:<br/>\u88c2\u89e3$1$\u548c$2$\u4e4b\u95f4\u7684\u5171\u4ef7\u952e: $1 \\\\times (2 + 1 + 1 + 1) = 5$<br/>\u88c2\u89e3$2$\u548c$3$\u4e4b\u95f4\u7684\u5171\u4ef7\u952e: $(2 + 1 + 1) \\\\times (1 + 1) = 8$<br/>\u5176\u4f59\u7684\u5171\u4ef7\u952e\u88c2\u89e3\u5f97\u5230\u7684\u80fd\u91cf\u5747\u4e3a$0$\u3002<br/>\u56e0\u6b64\u7b54\u6848\u4e3a$13$\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 1,000, \\\\; m \\\\le 5,000$<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 10,000, \\\\; m \\\\le 500,000$<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 100,000, \\\\; m \\\\le 100$<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e: $n \\\\le 10,000, \\\\; m \\\\le 1,000,000$<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e: \u6709\u673a\u7269\u6ca1\u6709\u652f\u94fe\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e: $n \\\\le 200,000, \\\\; m \\\\le 1,000,000, \\\\; e \\\\le 10 $<br/><br/><br/><br/><br/>ZY\u4ece\u4e0d\u6253\u6446\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-5-26/riteme.html"
},
"x^n-1\u95ee\u9898": {
"tags": "\u6570\u5b66 \u591a\u9879\u5f0f",
"text": "$x^n-1$\u95ee\u9898<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u8bf7\u5bf9\u4e0b\u9762\u7684\u591a\u9879\u5f0f$ A_n(x) $\u8fdb\u884c\u56e0\u5f0f\u5206\u89e3\uff1a<br/>$$ A_n(x) = x^n - 1 \\\\tag{1}$$<br/>\u5176\u4e2d\uff0c$ n \\\\in \\\\text{N}^* $\u3002<br/>\u5206\u6790<br/>\u5bf9\u4e8e$ n = 1$\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u65e0\u9700\u5206\u89e3\u3002\u5bf9\u4e8e$n = 2 $\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u89e3\u4e3a$ (x - 1)(x + 1) $\u3002<br/>\u5982\u679c\u6b21\u6570\u66f4\u9ad8\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c31\u6bd4\u8f83\u68d8\u624b\u3002<br/>\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u7684\u5b9a\u7406\uff1a<br/>$$ m \\\\mid n \\\\Longrightarrow (x^m - 1) \\\\mid (x^n - 1) \\\\tag{2}$$<br/>\u8fd9\u4e2a\u5b9a\u7406\u53ef\u4ee5\u7528\u591a\u9879\u5f0f\u9664\u6cd5\u6765\u9a8c\u8bc1\u3002<br/>\u56e0\u6b64\uff0c\u6211\u4eec\u4e3a\u4e86\u5206\u89e3$(1)$\u5f0f\uff0c\u9996\u5148\u7528$\\\\Theta(\\\\sqrt{n})$\u7684\u65f6\u95f4\u5bf9$n$\u8fdb\u884c\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u4ece\u800c\u80fd\u627e\u5230$(1)$\u7684\u51e0\u4e2a\u56e0\u5f0f\uff0c\u7136\u540e\u539f\u59cb\u5c31\u53ef\u4ee5\u8868\u793a\u6210\u51e0\u4e2a\u5f62\u5982$(x^a - 1)(x^b - 1) \\\\cdots (x^z - 1)$\u7684\u5f62\u5f0f\uff0c\u4ece\u800c\u80fd\u591f\u9012\u5f52\u7684\u7ee7\u7eed\u5206\u89e3\u3002<br/>\u7136\u800c\u6211\u4eec\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff1a\u4ee5$n=6$\u4e3a\u4f8b\uff0c$6$\u7684\u56e0\u5b50\u6709$1$\u3001$2$\u3001$3$\u548c$6$\u3002\u6211\u4eec\u53d1\u73b0\u9009\u62e9\u4e86$(x^6 - 1)$\u4f5c\u4e3a\u56e0\u5f0f\u8ddf\u6ca1\u9009\u4e00\u6837\u3002\u7136\u800c\u9009\u62e9\u5176\u5b83\u7684\u56e0\u5b50\u65f6\u53d1\u73b0\u66f4\u4e25\u91cd\u7684\u95ee\u9898\uff1a<br/>$$ (x - 1) \\\\mid (x^3 - 1) \\\\Longrightarrow (x - 1) \\\\nmid {x^6 - 1 \\\\over x^3 - 1} $$<br/>\u8fd9\u6837\u5bfc\u81f4\u51e0\u4e2a\u56e0\u5b50\u95f4\u4f1a\u6709\u51b2\u7a81\uff0c\u56e0\u6b64\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u9009\u62e9\u56e0\u5f0f\u3002<br/>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u7cfb\u5217\u7684\u591a\u9879\u5f0f$ p_n(x) $\uff1a<br/>$$ p_n(x) = { x^n - 1 \\\\over \\\\prod_{i \\\\mid n}p_i(x)} \\\\; (i \\\\neq n) \\\\tag{3}$$<br/>\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e9b\u591a\u9879\u5f0f\u53ea\u662f\u5c06\u539f\u672c$ x^n - 1 $\u4e2d\u7684\u975e\u672c\u8eab\u56e0\u5f0f\u53bb\u6389\u4e86\uff0c\u8fd9\u6837\u4f7f\u5f97\uff1a<br/>$$ (x - 1) \\\\mid {x^6 - 1 \\\\over p_3(x) } $$<br/>\u56e0\u4e3a<br/>$$<br/>{x^6 - 1 \\\\over p_3(x) } = {x^6 - 1 \\\\over {(x^3 - 1) / (x - 1)}} = (x - 1) \\\\cdot {x^6 - 1 \\\\over x^3 - 1}<br/>$$<br/>\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4efb\u610f\u7684$ A_n(x) $\u8868\u793a\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff1a<br/>$$ A_n(x) = \\\\prod_{i \\\\mid n} p_i(x) \\\\tag{4}$$<br/>\u6839\u636e$(3)$\u5f0f\u548c$(4)$\u5f0f\uff0c\u9012\u63a8\u5b8c$ p_n(x) $\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06$ A_n(x) $\u4e2d\u7684\u6bcf\u4e00\u9879\u90fd\u6c42\u89e3\u51fa\u6765\u3002\u5982\u679c\u591a\u9879\u5f0f\u9664\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$ \\\\Theta(g(n)) $\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728$ \\\\Theta(n\\\\sqrt{n} \\\\cdot g(n)) + \\\\Theta(\\\\sqrt{n}) = \\\\Theta(n\\\\sqrt{n} \\\\cdot g(n))$\u7684\u65f6\u95f4\u5185\u5bf9$ A_n(x) $\u8fdb\u884c\u56e0\u5f0f\u5206\u89e3\u3002",
"url": "blog/2016-3-21/x-2-1.html"
},
"\u3010NOI2016\u3011\u201c\u5faa\u73af\u4e4b\u7f8e\u201d \u65e0\u8111\u89e3\u6cd5": {
"tags": "NOI \u6570\u8bba \u9898\u89e3",
"text": "\u3010NOI2016\u3011\u201c\u5faa\u73af\u4e4b\u7f8e\u201d \u65e0\u8111\u89e3\u6cd5<br/>\u9898\u610f<br/>\u7ed9\u5b9a$n, m, k$\uff0c\u6c42\u51fa\u6240\u6709\u6ee1\u8db3$1 \\\\leqslant x \\\\leqslant n,\\\\; 1 \\\\leqslant y \\\\leqslant m$\u7684\u6b63\u6574\u6570\u4e2d\uff0c$x / y$\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u7684\u4e2a\u6570\u3002\u6570\u503c\u76f8\u540c\u7684\u53ea\u7b97\u4e00\u6b21\u3002<br/>$n,\\\\;m$\u5747\u4e0d\u8d85\u8fc7$10^9$\uff0c$k$\u4e0d\u8d85\u8fc7$2000$\u3002<br/>\u9898\u89e3<br/>\u7f51\u4e0a\u4e00\u822c\u7684\u89e3\u6cd5\u90fd\u662f\u63a8\u4e00\u5927\u5806\u5f0f\u5b50\uff0c\u7136\u540e\u7ecf\u8fc7\u4e00\u4e9b\u8ba8\u8bba\u6700\u540e\u5f97\u51fa\u4f7f\u7528\u675c\u6559\u7b5b\u7684\u505a\u6cd5\u3002<br/>\u63a5\u4e0b\u6765\u8981\u7ed9\u7684\u662f\u4e00\u4e2axjb\u7b97\u6cd5\uff0c\u5404\u4f4d\u542c\u542c\u5c31\u597d\u3002<br/>\u521d\u6b65\u8f6c\u5316<br/>\u9996\u5148\uff0c\u5982\u679c$x / y$\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u90a3\u4e48$1 / y$\u4e5f\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u3002<br/>\u8003\u8651\u5c0f\u6570\u5faa\u73af\u8282\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u5b9e\u9645\u4e0a\u548c$k^x \\\\pmod{y}$\u7684\u5faa\u73af\u8282\u662f\u4e00\u6837\u7684\u3002\u7531\u4e8e\u6211\u4eec\u77e5\u9053$k^0 \\\\equiv 1 \\\\pmod{y}$\uff0c\u6240\u4ee5\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a$L > 0$\u6ee1\u8db3$k^L \\\\equiv 1 \\\\pmod{y}$\u3002\u8fd9\u6837\u5c31\u53ef\u5f97\u77e5$k \\\\cdot k^{L - 1} = 1 + cy$\u3002\u5229\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5f53$k$\u548c$y$\u4e0d\u4e92\u8d28\u65f6\uff0c\u662f\u4e0d\u4f1a\u6709\u89e3\u7684\u3002<br/>\u7efc\u4e0a\uff0c\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\uff1a<br/>$$<br/>\\\\sum_{i = 1}^n \\\\sum_{j = 1}^m [\\\\gcd(i, j) = 1][\\\\gcd(j, k) = 1]<br/>$$<br/>\u5177\u4f53\u5206\u6790<br/>\u770b\u5230\u4e4b\u540e\uff0c\u6211\u53d1\u73b0\u5982\u679c\u6ca1\u6709\u540e\u9762\u90a3\u4e2a$j$\u548c$k$\u7684\u4e92\u8d28\u6761\u4ef6\uff0c\u5219\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u524d\u7f00\u548c\u7684\u8ba1\u7b97\uff0c\u53ef\u4ee5\u4f7f\u7528\u675c\u6559\u7b5b\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bb2\u3002\u73b0\u5728\u8003\u8651$j$\u8981\u548c$k$\u4e92\u8d28\uff0c\u770b\u5230\u8ba1\u6570\u60f3\u5bb9\u65a5\uff0c\u6211\u4eec\u81ea\u7136\u53bb\u627e\u4e0d\u4e0e$k$\u4e92\u8d28\u7684$j$\uff0c\u90a3\u4e48\u8bbe$\\\\gcd(j, k) = d$\u3002\u9996\u5148$d > 2$\uff0c\u5176\u6b21$d$\u662f$j$\u548c$k$\u7684\u4e00\u4e2a\u516c\u56e0\u5b50\uff0c\u6240\u4ee5\u6211\u4eec\u679a\u4e3e$d$\u7684\u500d\u6570\u5373\u53ef\u3002\u540c\u65f6\u6ce8\u610f\u4e00\u4e2a$j$\u53ef\u80fd\u88ab\u591a\u4e2a\u56e0\u5b50\u6240\u51cf\u53bb\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u4f5c\u4e3a\u5bb9\u65a5\u7cfb\u6570\u3002\u56e0\u6b64\u9700\u8981\u51cf\u53bb\u7684\u90e8\u5206\u4e3a\uff1a<br/>$$<br/>\\\\sum_{d \\\\mid k} \\\\mu(d) \\\\sum_{j = 1}^{\\\\lfloor m / d \\\\rfloor} \\\\sum_{i = 1}^n [\\\\gcd(dj, i) = 1]<br/>$$<br/>\u7531\u4e8e$\\\\gcd(dj, i) = 1$\u7b49\u4ef7\u4e8e$\\\\gcd(j, i) = 1$\u5e76\u4e14$\\\\gcd(d, i) = 1$\uff0c\u6240\u4ee5\u4e0a\u5f0f\u53d8\u4e3a\uff1a<br/>$$<br/>\\\\sum_{d \\\\mid k, d > 1} \\\\mu(d) \\\\sum_{j = 1}^{\\\\lfloor m / d \\\\rfloor} \\\\sum_{i = 1}^n [\\\\gcd(j, i) = 1][\\\\gcd(i, d) = 1]<br/>$$<br/>\u6211\u4eec\u673a\u667a\u7684\u53d1\u73b0\u540e\u9762\u90a3\u4e24\u4e2a\u6c42\u548c\u5c31\u662f\u539f\u95ee\u9898\u7684\u201c\u6570\u636e\u89c4\u6a21\u51cf\u5c0f\u7248\u201d......<br/>\u6240\u4ee5\u8bbe$f(n, m, k)$\u8868\u793a\u6211\u4eec\u7684\u7b54\u6848\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230DP\u8f6c\u79fb\u5f0f\uff1a<br/>$$<br/>f(n, m, k) = \\\\sum_{i = 1}^n\\\\sum_{j = 1}^m [\\\\gcd(i, j) = 1] - \\\\sum_{d \\\\mid k, d > 1} \\\\mu(d) f\\\\left(\\\\left\\\\lfloor \\\\frac{m}d \\\\right\\\\rfloor, n, d\\\\right)<br/>$$<br/>\u5f88\u50cf\u675c\u6559\u7b5b\uff1f\u6211\u76f4\u63a5\u62ff\u53bb\u7528\u4e2a\u54c8\u5e0c\u8868\u6765\u8bb0\u5fc6\u5316\u641c\u4e00\u4e0b\uff0c\u597d\u50cf\u6700\u574f\u7684\u6570\u636e\u4e5f\u53ea\u8bbf\u95ee\u4e86$30000$\u5de6\u53f3\u4e2a\u72b6\u6001......\u8fd9\u4e48\u4f18\u7f8e\u7684\u4e00\u9053\u9898\u5c31\u8fd9\u6837\u8fc7\u4e86......<br/>\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97......<br/>\u5177\u4f53\u5b9e\u73b0<br/>UOJ Submission #159233<br/>  1<br/>  2<br/>  3<br/>  4<br/>  5<br/>  6<br/>  7<br/>  8<br/>  9<br/> 10<br/> 11<br/> 12<br/> 13<br/> 14<br/> 15<br/> 16<br/> 17<br/> 18<br/> 19<br/> 20<br/> 21<br/> 22<br/> 23<br/> 24<br/> 25<br/> 26<br/> 27<br/> 28<br/> 29<br/> 30<br/> 31<br/> 32<br/> 33<br/> 34<br/> 35<br/> 36<br/> 37<br/> 38<br/> 39<br/> 40<br/> 41<br/> 42<br/> 43<br/> 44<br/> 45<br/> 46<br/> 47<br/> 48<br/> 49<br/> 50<br/> 51<br/> 52<br/> 53<br/> 54<br/> 55<br/> 56<br/> 57<br/> 58<br/> 59<br/> 60<br/> 61<br/> 62<br/> 63<br/> 64<br/> 65<br/> 66<br/> 67<br/> 68<br/> 69<br/> 70<br/> 71<br/> 72<br/> 73<br/> 74<br/> 75<br/> 76<br/> 77<br/> 78<br/> 79<br/> 80<br/> 81<br/> 82<br/> 83<br/> 84<br/> 85<br/> 86<br/> 87<br/> 88<br/> 89<br/> 90<br/> 91<br/> 92<br/> 93<br/> 94<br/> 95<br/> 96<br/> 97<br/> 98<br/> 99<br/>100<br/>101<br/>102<br/>103<br/>104<br/>105<br/>106<br/>107<br/>108<br/>109<br/>110<br/>111<br/>112<br/>113<br/>114<br/>115<br/>116<br/>117<br/>118<br/>119<br/>120<br/>121<br/>122<br/>123<br/>124<br/>125<br/>126<br/>127<br/>128<br/>129<br/>130<br/>131<br/>132<br/>133<br/>134<br/>135<br/>136<br/>137<br/>138<br/>139<br/>140<br/>141<br/>142<br/>143<br/>144<br/>145<br/>146<br/>147<br/>148<br/>149<br/>150<br/>151<br/>152<br/>153<br/>154<br/>155<br/>156<br/>157<br/>158<br/>159<br/>160<br/>161<br/>162<br/>163<br/>164// #define NDEBUG<br/><br/>#include <cassert><br/>#include <cstdio><br/>#include <cstring><br/>#include <climits><br/><br/>#include <vector><br/>#include <algorithm><br/><br/>using namespace std;<br/><br/>#define KMAX 2000<br/>#define S 5000000<br/>#define MOD 116099<br/><br/>typedef long long i64;<br/><br/>template <typename TPolicy><br/>struct HashTable {<br/>    typedef typename TPolicy::TKey TKey;<br/>    typedef typename TPolicy::TVal TVal;<br/>    typedef pair<TKey, TVal> Data;<br/><br/>    vector<Data> bucket[MOD];<br/><br/>    int get_pos(int key) {<br/>        int pos = key %  MOD;<br/>        return pos < 0 ? pos + MOD : pos;<br/>    }<br/><br/>    void insert(TKey key, TVal val) {<br/>        bucket[get_pos(TPolicy::hash(key))].push_back(Data(key, val));<br/>    }<br/><br/>    bool query(TKey key, TVal &val) {<br/>        int pos = get_pos(TPolicy::hash(key));<br/><br/>        for (auto e : bucket[pos]) {<br/>            if (e.first == key) {<br/>                val = e.second;<br/>                return true;<br/>            }<br/>        }<br/><br/>        return false;<br/>    }<br/>};<br/><br/>struct PrePolicy {<br/>    typedef int TKey;<br/>    typedef int TVal;<br/><br/>    static int hash(int x) {<br/>        return x;<br/>    }<br/>};<br/><br/>static int c[S + 10];<br/>static int p[S + 10];<br/>static HashTable<PrePolicy> mu;<br/><br/>int pre(int n) {<br/>    if (n <= S)<br/>        return p[n];<br/><br/>    int ret = 1;<br/>    if (mu.query(n, ret))<br/>        return ret;<br/><br/>    for (int i = 2, last = 2; i <= n; i = last + 1) {<br/>        last = n / (n / i);<br/>        ret -= (last - i + 1) * pre(n / i);<br/>    }<br/><br/>    mu.insert(n, ret);<br/>    return ret;<br/>}<br/><br/>struct Key {<br/>    int n, m, k;<br/><br/>    bool operator==(const Key &b) const {<br/>        return n == b.n && m == b.m && k == b.k;<br/>    }<br/>};<br/><br/>struct DpPolicy {<br/>    typedef Key TKey;<br/>    typedef i64 TVal;<br/><br/>    static int hash(const TKey &x) {<br/>        return (x.n ^ x.m) * x.k;<br/>    }<br/>};<br/><br/>static vector<int> d[KMAX + 10];<br/>static HashTable<DpPolicy> mem;<br/><br/>i64 dp(int n, int m, int k) {<br/>    if (n == 0 || m == 0)<br/>        return 0;<br/><br/>    Key key = {n, m, k};<br/>    i64 ret = 0;<br/>    if (mem.query(key, ret))<br/>        return ret;<br/><br/>    for (int i = 1, last = 1; i <= n && i <= m; i = last + 1) {<br/>        last = min(n / (n / i), m / (m / i));<br/>        i64 sum = pre(last) - pre(i - 1); <br/>        ret += sum * (n / i) * (m / i);<br/>    }<br/><br/>    for (int i : d[k]) {<br/>        ret += c[i] * dp(m / i, n, i);<br/>    }<br/><br/>    mem.insert(key, ret);<br/>    return ret;<br/>}<br/><br/>static int n, m, k;<br/>static bool marked[S + 10];<br/>static int prime[S + 10], cnt;<br/><br/>void initialize() {<br/>    scanf(\\ % d% d% d\\ , &n, &m, &k);<br/><br/>    c[1] = p[1] = 1;<br/>    for (int i = 2; i <= S; i++) {<br/>        if (!marked[i]) {<br/>            c[i] = -1;<br/>            prime[++cnt] = i;<br/>        }<br/><br/>        p[i] = p[i - 1] + c[i];<br/>        for (int j = 1; i * prime[j] <= S; j++) {<br/>            int p = prime[j];<br/>            marked[i * p] = true;<br/><br/>            if (i %  p == 0) {<br/>                c[i * p] = 0;<br/>                break;<br/>            } else<br/>                c[i * p] = -c[i];<br/>        }<br/>    }<br/><br/>    for (int i = 2; i <= k; i++) {<br/>        for (int j = 2; j <= i; j++) {<br/>            if (c[j] && i %  j == 0)<br/>                d[i].push_back(j);<br/>        }<br/>    }<br/>}<br/><br/>int main() {<br/>    // freopen(\\ cyclic.in\\ , \\ r\\ , stdin);<br/>    initialize();<br/>    printf(\\ % lld\\\\n\\ , dp(n, m, k));<br/><br/>    return 0;<br/>}<br/><br/>",
"url": "blog/2017-5-18/cyclic.html"
},
"\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 (CRT)": {
"tags": "\u6570\u5b66 \u6570\u8bba \u4e2d\u56fd\u5269\u4f59\u5b9a\u7406",
"text": "\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 (CRT)<br/>\u73a9\u4e00\u73a9<br/>\u627e\u51fa\u6240\u6709$a$\uff0c\u4f7f\u5f97\u6ee1\u8db3\u4e0b\u5217\u5173\u7cfb\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>a & \\\\equiv 3\\\\;(\\\\text{mod}\\\\;5) \\\\\\\\<br/>a & \\\\equiv 2\\\\;(\\\\text{mod}\\\\;7)<br/>\\\\end{aligned}<br/>$$<br/>\u901a\u8fc7\u66b4\u529b\u679a\u4e3e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u7b54\u6848\uff1a<br/>$$<br/>a = 23 + 35k\\\\;(k \\\\in Z)<br/>$$<br/>\u7b80\u5355\u5f62\u5f0f<br/>\u73b0\u5728\u6765\u8003\u8651\u4e00\u4e2a\u95ee\u9898\uff1a<br/><br/>\u8bc1\u660e\uff1a\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a$a$\uff0c\u6ee1\u8db3<br/>$$a \\\\equiv a_1\\\\;(\\\\text{mod}\\\\;m) \\\\\\\\a \\\\equiv a_2\\\\;(\\\\text{mod}\\\\;n)$$<br/>\u5176\u4e2d$m \\\\bot n$<br/><br/>\u6211\u4eec\u4f7f\u7528\u9e3d\u5de2\u539f\u7406\u6765\u8bc1\u660e\u3002<br/>\u8bbe\u6709$n$\u4e2a\u6570\u6a21$m$\u7b49\u4e8e$a_1$\uff0c\u8fd9$n$\u4e2a\u6570\u662f\uff1a<br/>$$<br/>a_1,\\\\;m + a_1,\\\\;2m + a_1,\\\\;\\\\dots,\\\\;(n - 1)m + a_1<br/>$$<br/>\u5373\u8bbe\u5176\u4e2d\u6709\u4e24\u4e2a\u6570\u6a21$n$\u610f\u4e49\u4e0b\u540c\u4f59\uff0c\u8bbe\u5b83\u4eec\u4e3a$im + a_1$\u548c$jm + a_1$ ($i < j$)\u3002<br/>\u90a3\u4e48\u610f\u5473\u7740\uff1a<br/>$$<br/>jm + a_1 = pn + r \\\\\\\\<br/>im + a_1 = qn + r<br/>$$<br/>\u4e24\u5f0f\u76f8\u51cf\u53ef\u5f97\uff1a<br/>$$<br/>(j - i)m = (p - q)n<br/>$$<br/>\u56e0\u4e3a$p - q \\\\in Z$\uff0c\u6240\u4ee5$n \\\\mid (j - i)m$\u3002<br/>\u4f46\u662f$m \\\\bot n$\uff0c\u4e14$0 \\\\lt j - i \\\\le n - 1$\uff0c\u6240\u4ee5$n \\\\not\\\\mid (j - i)m$\uff0c\u4e0e\u4e4b\u524d\u7684\u5047\u8bbe\u76f8\u77db\u76fe\u3002<br/>\u6545\u4e4b\u524d\u9009\u51fa\u7684$n$\u4e2a\u6570\u91cc\u9762\u6ca1\u6709\u4e24\u4e2a\u6570\u5728\u6a21$n$\u610f\u4e49\u4e0b\u540c\u4f59\u3002<br/>\u90a3\u4e48\u8fd9\u91cc\u9762\u5fc5\u5b9a\u5b58\u5728\u4e00\u4e2a\u6570\u6a21$n$\u4f59$a_2$\u3002<br/>\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406<br/><br/>\u8bc1\u660e\uff1a\u5b58\u5728\u4e00\u4e2a\u6570$x$\uff0c\u6ee1\u8db3<br/>$$x \\\\equiv a_1 \\\\; (\\\\text{mod}\\\\;m_1) \\\\\\\\x \\\\equiv a_2 \\\\; (\\\\text{mod}\\\\;m_2) \\\\\\\\\\\\dots \\\\\\\\x \\\\equiv a_k \\\\; (\\\\text{mod}\\\\;m_k)$$<br/>\u5176\u4e2d$m_1,\\\\;m_2,\\\\;\\\\dots,\\\\;m_k$\u4e24\u4e24\u4e92\u8d28<br/><br/>\u5f53\u7136\u53ef\u4ee5\u8003\u8651\u4e24\u4e24\u5408\u5e76\u7684\u65b9\u5f0f\uff0c\u5e76\u4f7f\u7528\u4e4b\u524d\u9e3d\u5de2\u539f\u7406\u7684\u8bc1\u6cd5\u6765\u8bc1\u660e\u3002<br/>\u5f53\u7136\u6211\u4eec\u8003\u8651\u4e00\u79cd\u66f4\u5177\u6709\u4ef7\u503c\u7684\u8bc1\u6cd5\u3002<br/>\u65e2\u7136\u8981\u8bc1\u660e\u5176\u5b58\u5728\uff0c\u4e0d\u5982\u76f4\u63a5\u6784\u9020\u4e00\u4e2a\u7b54\u6848\uff1a<br/>\u9996\u5148\u8bbe\uff1a<br/>$$<br/>M = \\\\prod_{j=1}^k m_j \\\\tag{2.1}<br/>$$<br/>\u662f\u6240\u6709\u6a21\u6570\u4e4b\u79ef\u3002<br/>$$<br/>M_i = {M \\\\over m_i} \\\\tag{2.2}<br/>$$<br/>\u662f\u5254\u9664\u6389\u67d0\u4e00\u4e2a\u6a21\u6570\u7684\u79ef\u3002<br/>$$<br/>C_i = M_i(M_i^{-1}\\\\;\\\\text{mod}\\\\;m_i) \\\\tag{2.3}<br/>$$<br/>\u5219\u662f\u4e00\u4e2a\u795e\u5947\u7684\u6570\u5b57\u3002<br/>\u7531\u4e8e$M_i$\u80af\u5b9a\u4e0e$m_i$\u4e92\u8d28\uff0c\u6240\u4ee5\u8fd9\u4e2a\u9006\u5143\u662f\u80af\u5b9a\u80fd\u6c42\u51fa\u6765\u7684\u3002<br/>\u90a3\u4e48\uff1a<br/>$$<br/>x \\\\equiv \\\\sum_{i=1}^k a_iC_i \\\\; (\\\\text{mod}\\\\;M)<br/>$$<br/>\u63a5\u4e0b\u6765\u5c31\u662f\u8981\u8bc1\u660e\u8fd9\u4e2a\u6570\u540c\u65f6\u6ee1\u8db3\u4e0a\u9762\u7684\u65b9\u7a0b\u3002<br/>\u9996\u5148\u6ce8\u610f\u5230\uff1a<br/>$$<br/>m_i \\\\mid C_j \\\\Longrightarrow C_i \\\\equiv 0 \\\\; (\\\\text{mod}\\\\;m_i) \\\\;\\\\;\\\\; (i \\\\neq j)<br/>$$<br/>\u540c\u65f6\uff1a<br/>$$<br/>C_i \\\\equiv M_i\\\\cdot M_i^{-1} \\\\equiv 1 \\\\; (\\\\text{mod}\\\\;m_i)<br/>$$<br/>\u4e8e\u662f\uff1a<br/>$$<br/>x \\\\equiv a_i \\\\; (\\\\text{mod} \\\\; m_i)<br/>$$<br/>\u56e0\u6b64\u8fd9\u4e2a\u6570\u662f\u6ee1\u8db3\u8981\u6c42\u7684\u3002<br/>\u540c\u65f6\u6211\u4eec\u83b7\u5f97\u4e86\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 (CRT) \u7684\u516c\u5f0f\uff1a<br/>$$<br/>x = \\\\sum_{i=1}^k a_i M_i(M_i^{-1}\\\\;\\\\text{mod}\\\\;m_i) \\\\tag{2.4}<br/>$$<br/>\u501f\u52a9\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5\uff0c\u53ef\u4ee5\u5728$O(n\\\\log n)$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u7b54\u6848\u3002<br/>\u5e94\u7528<br/>\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u4e00\u4e2a\u6700\u5927\u7684\u5e94\u7528\u5c31\u662f\u8ba1\u7b97\u4e00\u4e9b\u6570\u5728\u6a21\u4e00\u4e2a\u5408\u6570\u4e0b\u7684\u53d6\u503c\u3002<br/>\u4f8b\u5982\uff0c\u6c42\u5927\u7ec4\u5408\u6570\u53d6\u6a21\uff1a<br/>$$<br/>{n \\\\choose m} \\\\;\\\\text{mod}\\\\; p<br/>$$<br/>\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u5982\u679c$p$\u662f\u8d28\u6570\u4e14\u6bd4\u8f83\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528Lucas\u5b9a\u7406\u6c42\u89e3\u3002<br/>\u7136\u800c\u73b0\u5728\u662f\u5408\u6570\u3002<br/>\u6211\u4eec\u8003\u8651\u4e00\u79cd\u65b9\u6848\uff0c\u5c06\u5408\u6570$p$\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5206\u89e3\u6210\u591a\u4e2a\u8d28\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8d28\u6570\uff0c\u6211\u4eec\u90fd\u6709\u65b9\u6cd5\u6c42\u89e3\u7b54\u6848\u3002\u8fd9\u6837\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8d28\u6570\u8ba1\u7b97\u7b54\u6848\u4e4b\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u6a21\u7ebf\u6027\u65b9\u7a0b\u7ec4\u3002<br/>\u8fd9\u6837\u5c31\u53d8\u6210\u4e86\u6211\u4eec\u4e4b\u524d\u6240\u8ba8\u8bba\u7684\u95ee\u9898\u3002\u5bf9\u4e8e\u6b64\uff0c\u4f7f\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff0c\u5c31\u53ef\u4ee5\u5408\u5e76\u7b54\u6848\u3002",
"url": "blog/2016-8-17/crt.html"
},
"\u4e8c\u8fdb\u5236GCD": {
"tags": "\u6570\u5b66 GCD",
"text": "\u4e8c\u8fdb\u5236GCD<br/>\u5728\u7b97\u5bfc\u4e0a\u53d1\u73b0\u4e86\u4e00\u4e2a\u6709\u8da3\u7684\u7b97\u6cd5\uff0c\u6709\u6c27\u73af\u5883\u4e0b\u53ef\u4ee5\u62ff\u6765\u5361\u5361\u5e38.....<br/>\u7b97\u6cd5\u539f\u7406<br/>\u4e0b\u9762\u5c06\u8003\u8651\u8ba1\u7b97$\\\\gcd(a,\\\\;b)$\uff0c\u5047\u5b9a$a \\\\ge b$\uff1a<br/><br/>\u5982\u679c$a$\u3001$b$\u90fd\u662f\u5076\u6570\uff0c\u90a3\u4e48\u6613\u77e5\uff1a<br/>$$<br/>\\\\gcd(a,\\\\;b) = 2\\\\gcd(a / 2,\\\\;b / 2)<br/>$$<br/>\u5982\u679c$a$\u662f\u5076\u6570\uff0c$b$\u662f\u5947\u6570\uff0c\u90a3\u4e48\u6709\uff1a<br/>$$<br/>\\\\gcd(a,\\\\;b) = \\\\gcd(a / 2, b)<br/>$$<br/>\u5982\u679c$a$\u662f\u5947\u6570\uff0c$b$\u662f\u5076\u6570\uff0c\u90a3\u4e48\u6709\uff1a<br/>$$<br/>\\\\gcd(a,\\\\;b) = \\\\gcd(a,\\\\;b / 2)<br/>$$<br/>\u5982\u679c$a$\u3001$b$\u90fd\u662f\u5947\u6570\uff0c\u90a3\u4e48\u6709\uff1a<br/>$$<br/>\\\\gcd(a,\\\\;b) = \\\\gcd((a - b) / 2, b)<br/>$$<br/><br/>\u8fd9\u4e9b\u7ed3\u8bba\u90fd\u662f\u6bd4\u8f83\u5bb9\u6613\u8bc1\u660e\u7684\uff0c\u8fd9\u91cc\u5c31\u7565\u53bb\u4e86\u3002<br/>\u7531\u4e8e\u51cf\u6cd5\u7684\u901f\u5ea6\u6bd4\u53d6\u6a21\u5feb (\u51cf\u6cd5\u901f\u5ea6\u57fa\u672c\u4e0e\u52a0\u6cd5\u4e00\u81f4)\uff0c\u540c\u65f6\u9664\u4ee5$2$\u548c\u4e58\u4ee5$2$\u53ef\u4ee5\u4f7f\u7528\u4f4d\u8fd0\u7b97\u6765\u4ee3\u66ff\uff0c\u5e76\u4e14\u6bcf\u6b21\u6298\u534a\u53ef\u4ee5\u4fdd\u8bc1\u590d\u6742\u5ea6\uff0c\u6240\u4ee5\u7406\u8bba\u4e0a\u8fd9\u4e2a\u7b97\u6cd5\u662f\u975e\u5e38\u5feb\u7684\u3002<br/>\u4f46\u662f\u9700\u8981\u6ce8\u610f\uff0c\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5\u662f\u4e0a\u754c$O(\\\\log(\\\\min\\\\{a,\\\\;b\\\\}))$\uff0c\u800c\u6b64\u7b97\u6cd5\u7c7b\u4f3c\u4e8e\u5feb\u901f\u5e42\uff0c\u662f\u4e0a\u4e0b\u754c$\\\\Theta(\\\\log(\\\\min\\\\{a,\\\\;b\\\\}))$\u3002<br/>\u4f46\u8fd9\u5e76\u4e0d\u5f71\u54cd\u5b83\u7684\u6548\u7387\u3002\u5728\u6211\u7684\u673a\u5b50\u4e0a (\u4f7f\u7528Clang 3.6.0) \u5b9e\u6d4b\uff0c\u5728\u7f16\u8bd1\u5668\u6253\u5f00-O2\u4f18\u5316\u4e0b\u6bd4\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5\u5feb\u3002<br/>\u4f46\u662f\u5728\u6ca1\u6709\u5f00-O2\u4f18\u5316\u65f6\uff0c\u56e0\u4e3a\u5e38\u6570\u95ee\u9898\u901f\u5ea6\u53d8\u6162\u8bb8\u591a\u3002<br/>\u7b97\u6cd5\u5b9e\u73b0<br/>\u4e0b\u9762\u5c55\u793a\u4e00\u4e2a\u57fa\u672c\u5b9e\u73b0\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15function BINARY-GCD(a, b):<br/>    if a < b:  # \u8981\u4fdd\u8bc1 a >= b<br/>        SWAP(a, b)<br/>    if b == 0:<br/>        return a<br/>    if a & 1:<br/>        if b & 1:<br/>            return BINARY-GCD((a - b) >> 1, b)<br/>        else:<br/>            return BINARY-GCD(a, b >> 1)<br/>    else:<br/>        if b & 1:<br/>            return BINARY-GCD(a >> 1, b)<br/>        else:<br/>            return BINARY-GCD(a >> 1, b >> 1) << 1<br/><br/><br/>\u6ce8\u610f\u5230\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5\u91cc\u9762\u662f\u5c3e\u9012\u5f52\uff0c\u7f16\u8bd1\u5668\u53ef\u4ee5\u4f9d\u6b64\u505a\u4f18\u5316\u3002<br/>\u800c\u4e0a\u9762\u7ed9\u51fa\u7684\u4ee3\u7801\u91cc\u9762\u5e76\u4e0d\u662f\u8fd9\u79cd\u5f62\u5f0f\u3002<br/>\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5c06\u5176\u6539\u4e3a\u5c3e\u9012\u5f52\u5f62\u5f0f\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15function TAIL-BINARY-GCD(a, b, shift = 0):  # \u8bb0\u5f55\u4e00\u4e2ashift\u8868\u793a\u7b54\u6848\u4e58\u4e86\u51e0\u4e2a2<br/>    if a < b:<br/>        SWAP(a, b)<br/>    if b == 0:<br/>        return a << shift  # \u5c06shift\u7684\u8bb0\u5f55\u76842\u7b97\u5165\u7b54\u6848<br/>    if a & 1:<br/>        if b & 1:<br/>            return TAIL-BINARY-GCD((a - b) >> 1, b, shift)<br/>        else:<br/>            return TAIL-BINARY-GCD(a, b >> 1, shift)<br/>    else:<br/>        if b & 1:<br/>            return TAIL-BINARY-GCD(a >> 1, b, shift)<br/>        else:<br/>            return TAIL-BINARY-GCD(a >> 1, b >> 1, shift + 1)  # \u8ba1\u6570\u5668\u52a01<br/><br/><br/>\u5728\u7f16\u8bd1\u5668\u4f18\u5316\u7684\u5e2e\u52a9\u4e0b\uff0c\u8fd9\u4efd\u4ee3\u7801\u8dd1\u5f97\u66f4\u5feb\u3002<br/>\u6b64\u5916\uff0c\u4e8c\u8fdb\u5236GCD\u53e6\u4e00\u4e2a\u5de8\u5927\u7684\u4f18\u52bf\u5c31\u662f\u5728\u9700\u8981\u9ad8\u7cbe\u5ea6\u7684\u573a\u5408\u4e0b\uff0c\u4e0d\u4f46\u964d\u4f4e\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u51cf\u4f4e\u4e86\u7f16\u7a0b\u96be\u5ea6 (\u6bd5\u7adf\u4e0d\u9700\u8981\u9ad8\u7cbe\u5ea6\u53d6\u6a21)\uff0c\u6240\u4ee5\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u7b97\u6cd5\u3002",
"url": "blog/2016-8-19/binary-gcd.html"
},
"\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ca\u5176\u5b83": {
"tags": "\u6570\u5b66 \u7ec4\u5408\u6570\u5b66 \u4e8c\u9879\u5f0f\u5b9a\u7406 \u591a\u9879\u5f0f\u5b9a\u7406 \u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406",
"text": "\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ca\u5176\u5b83<br/>\u4e8c\u9879\u5f0f\u5b9a\u7406<br/>\u57fa\u672c\u5b9a\u7406<br/>\u4e8c\u9879\u5f0f\u5b9a\u7406\u662f\u7528\u4e8e\u5c55\u5f00\u4e24\u6570\u76f8\u52a0\u7684\u5e42\u6b21\u7684\u516c\u5f0f\uff1a<br/>$$<br/>(x + y)^n = \\\\sum_{k=0}^n {n \\\\choose k} x^k y^{n-k} \\\\tag{1.1}<br/>$$<br/>\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u7ec4\u5408\u8bc1\u660e\u3002\u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u4ece$n$\u4e2a\u62ec\u53f7\u4e2d\u4efb\u610f\u9009\u53d6$k$\u4e2a\u6765\u7ec4\u6210$x^k$\u7684\u9879\uff0c\u8fd9\u4e2a\u65b9\u6848\u6570\u6070\u597d\u662f${n \\\\choose k}$\uff0c\u5269\u4e0b\u7684$y$\u4e5f\u662f\u540c\u7406\u3002\u56e0\u6b64\u5bf9\u5e94\u7684\u9879\u7684\u7cfb\u6570\u5c31\u662f${n \\\\choose k}$\u6216${n \\\\choose n - k}$\u3002<br/>\u4e0b\u9762\u4f7f\u7528\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff1a<br/>\u5f53$n = 1$\u7684\u65f6\u5019\uff1a<br/>$$<br/>(x + y)^1 = x + y = \\\\sum_{k=0}^1 {1 \\\\choose k} x^ky^{1-k}<br/>$$<br/>\u7ed3\u8bba\u663e\u7136\u6210\u7acb\u3002<br/>\u5047\u8bbe\u5bf9$n$\u6210\u7acb\uff0c\u6c42\u8bc1\u5bf9$n + 1$\u6210\u7acb\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>(x + y)^{n+1} & = (x + y)(x + y)^n \\\\\\\\<br/>& = (x + y)\\\\sum_{k=0}^n {n \\\\choose k} x^ky^{n-k} \\\\\\\\<br/>& = \\\\sum_{k=0}^n {n \\\\choose k} x^{k+1}y^{n-k} + \\\\sum_{k=0}^n {n \\\\choose k} x^ky^{n-k+1} \\\\\\\\<br/>& = x^{n+1} + y^{n+1} + \\\\sum_{k=0}^{n-1} {n \\\\choose k} x^{k+1}y^{n-k} + \\\\sum_{k=1}^n {n \\\\choose k} x^ky^{n-k+1} \\\\\\\\<br/>& = x^{n+1} + y^{n+1} + \\\\sum_{k=1}^{n} {n \\\\choose k - 1} x^{k}y^{n-k+1} + \\\\sum_{k=1}^n {n \\\\choose k} x^ky^{n-k+1} \\\\\\\\<br/>& = x^{n+1} + y^{n+1} + \\\\sum_{k=1}^n \\\\left[{n \\\\choose k - 1}+{n \\\\choose k}\\\\right] x^ky^{n-k+1} \\\\\\\\<br/>& = x^{n+1} + y^{n+1} + \\\\sum_{k=1}^n {n+1 \\\\choose k} x^ky^{n-k+1} \\\\\\\\<br/>& = \\\\sum_{k=0}^{n+1} {n+1 \\\\choose k} x^ky^{n-k+1} \\\\\\\\<br/>\\\\end{aligned}<br/>$$<br/>\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u6211\u4eec\u7684\u8bc1\u660e\u3002<br/>\u7b80\u5355\u8fd0\u7528<br/>\u7ec4\u5408\u6052\u7b49\u5f0f<br/>\u5c06$y = 1$\uff0c\u6211\u4eec\u5c06\u5f97\u5230\u4e00\u4e2a\u5f88\u5e38\u7528\u7684\u5f0f\u5b50\uff1a<br/>$$<br/>(1 + x)^n = \\\\sum_{k=0}^n {n \\\\choose k} x^k \\\\tag{1.2}<br/>$$<br/>\u4ee4$x = 1$:<br/>$$<br/>\\\\sum_{k=0}^n {n \\\\choose k} = (1 + 1)^n = 2^n \\\\tag{1.3}<br/>$$<br/>\u5f97\u5230\u4e86\u7ec4\u5408\u6570\u4e4b\u548c\uff0c<br/>\u4ee4$x = -1$:<br/>$$<br/>\\\\sum_{k=0}^n (-1)^k {n \\\\choose k} = 0 \\\\tag{1.4}<br/>$$<br/>\u5f97\u5230\u4e86\u7ec4\u5408\u6570\u7684\u4ea4\u9519\u548c\u3002<br/>\u901a\u8fc7\u79fb\u9879\u53ef\u4ee5\u5f97\u5230\u66f4\u8fdb\u4e00\u6b65\u7684\u7ed3\u8bba\uff1a:<br/>$$<br/>{n \\\\choose 0} + {n \\\\choose 2} + \\\\dots = {n \\\\choose 1} + {n \\\\choose 3} + \\\\dots \\\\tag{1.5}<br/>$$<br/>\u7ed3\u5408$(1.3)$\u53ef\u77e5\uff1a<br/>$$<br/>{n \\\\choose 0} + {n \\\\choose 2} + \\\\dots = {n \\\\choose 1} + {n \\\\choose 3} + \\\\dots = 2^{n-1} \\\\tag{1.6}<br/>$$<br/>\u5bfc\u6570<br/>\u73b0\u5728\u6211\u4eec\u91cd\u65b0\u8003\u8651\u8fd9\u4e2a\u5f0f\u5b50\uff1a<br/>$$<br/>(1 + x)^n = \\\\sum_{k=0}^n {n \\\\choose k} x^k \\\\tag{1.2}<br/>$$<br/>\u4e24\u8fb9\u540c\u65f6\u5173\u4e8e$x$\u6c42\u5bfc\uff1a<br/>$$<br/>n(1 + x)^{n-1} = \\\\sum_{k=0}^n {n \\\\choose k} \\\\cdot kx^{k-1} \\\\tag{1.7}<br/>$$<br/>\u4ee4$x = 1$\uff1a<br/>$$<br/>n2^{n-1} = \\\\sum_{k=0}^n k{n \\\\choose k} \\\\tag{1.8}<br/>$$<br/>\u8fd9\u6837\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u975e\u5e38\u6709\u610f\u601d\u7684\u5f0f\u5b50\u3002<br/>\u8fd0\u7528\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u7b97\u51fa\uff1a<br/>$$<br/>\\\\sum_{k=0}^n (2k+1){n \\\\choose k} = (n+1)2^n<br/>$$<br/>\u4e8b\u5b9e\u4e0a\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5bf9$(1.8)$\u8fdb\u4e00\u6b65\u6c42\u5bfc\uff0c\u4ece\u800c\u5f97\u5230$k^2$\u7684\u516c\u5f0f\u3002<br/>\u7ec4\u5408\u6570\u7684\u5e73\u65b9\u548c<br/>$$<br/>\\\\sum_{k=0}^n {n \\\\choose k}^2 = {2n \\\\choose n} \\\\tag{1.9}<br/>$$<br/>\u5bf9\u4e8e\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u8003\u8651\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a<br/>$$<br/>(1 + x)^n(1+x)^n = (1+x)^{2n}<br/>$$<br/>\u8fd0\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u53ef\u5f97\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{i=0}^n {n\\\\choose i} x^i \\\\cdot \\\\sum_{j=0}^n {n\\\\choose j} x^j & = \\\\sum_{i=0}^n\\\\sum_{j=0}^n {n \\\\choose i}{n \\\\choose j} x^ix^j \\\\\\\\<br/>& = \\\\sum_{k=0}^{2n} {2n \\\\choose k} x^k<br/>\\\\end{aligned}<br/>$$<br/>\u8003\u8651\u7b49\u53f7\u4e24\u8fb9\u7cfb\u6570\u540c\u4e3a$k$\u7684\u9879\uff0c\u4e00\u5b9a\u6ee1\u8db3\u4e0b\u9762\u7684\u7b49\u5f0f\uff1a<br/>$$<br/>\\\\sum_{i=0}^n {n \\\\choose i}{n \\\\choose k - i} = {2n \\\\choose k} \\\\tag{1.10}<br/>$$<br/>\u5f53$k = n$\u65f6\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{i=0}^n {n \\\\choose i}{n \\\\choose n - i} & = \\\\sum_{i=0}^n {n \\\\choose i}{n \\\\choose i} \\\\\\\\<br/>& = \\\\sum_{i=0}^n {n \\\\choose i}^2 \\\\\\\\<br/>& = {2n \\\\choose n}<br/>\\\\end{aligned}<br/>$$<br/>\u8fd9\u6837\u5c31\u8bc1\u660e\u4e86\u7ec4\u5408\u6570\u7684\u5e73\u65b9\u548c\u7684\u7ed3\u8bba\u3002<br/>\u4e8c\u9879\u5f0f\u5b9a\u7406\u4e0e$\\\\text{e}$<br/>\u6839\u636e\u6cf0\u52d2\u5c55\u5f00\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>\\\\text{e}^x = \\\\sum_{n=0}^\\\\infty \\\\frac{x^n}{n!} \\\\tag{1.11}<br/>$$<br/>\u4ee4$x = 1$\u5c31\u53ef\u4ee5\u5f97\u5230$\\\\text{e}$\u7684\u65e0\u7a77\u5c55\u5f00\u5f62\u5f0f\uff1a<br/>$$<br/>\\\\text{e} = \\\\sum_{k=0}^\\\\infty \\\\frac1{k!} \\\\tag{1.12}<br/>$$<br/>\u800c\u6211\u4eec\u5e73\u5e38\u6240\u719f\u77e5\u7684$\\\\text{e}$\u7684\u5b9a\u4e49\u662f\u8fd9\u6837\u7684\uff1a<br/>$$<br/>\\\\text{e} = \\\\lim_{n \\\\rightarrow \\\\infty} \\\\left(1 + \\\\frac1n\\\\right)^n \\\\tag{1.13}<br/>$$<br/>\u8fd0\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ef\u4ee5\u8bc1\u660e\u6cf0\u52d2\u5c55\u5f00\u7684\u7ed3\u679c\u4e0e\u4e0a\u9762\u7684\u5b9a\u4e49\u7b49\u4ef7\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\text{e} & = \\\\lim_{n\\\\rightarrow\\\\infty} \\\\left(1 + \\\\frac1n\\\\right)^n \\\\\\\\<br/>& = \\\\lim_{n\\\\rightarrow\\\\infty} \\\\sum_{k=0}^n {n \\\\choose k} \\\\frac1{n^k} \\\\\\\\<br/>& = \\\\lim_{n\\\\rightarrow\\\\infty} \\\\sum_{k=0}^n \\\\frac1{k!} \\\\frac{\\\\prod_{i=n-k+1}^n i}{n^k}<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u4e8e\uff1a<br/>$$<br/>\\\\lim_{n \\\\rightarrow \\\\infty} \\\\frac{\\\\prod_{i=n-k+1}^n i}{n^k} = 1<br/>$$<br/>\u6240\u4ee5\u8fd9\u4e00\u9879\u53ef\u4ee5\u53bb\u6389\u3002\u4e8e\u662f\u5c31\u5f97\u5230\u4e86\u6cf0\u52d2\u5c55\u5f00\u7684\u7ed3\u679c\u3002<br/>\u591a\u9879\u5f0f\u5b9a\u7406<br/>\u4e0e\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u8fd9\u4e2a\u5b9a\u7406\u5e76\u4e0d\u600e\u4e48\u5e38\u7528\u3002<br/>\u53ef\u80fd\u662f\u5f62\u5f0f\u6bd4\u8f83\u590d\u6742\uff0c\u4e0d\u4fbf\u4e8e\u7406\u8bba\u5206\u6790\u3002<br/>\u591a\u9879\u5f0f\u5b9a\u7406\u662f\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u6269\u5c55\uff1a<br/>$$<br/>(x_1 + x_2 + \\\\dots + x_m)^n = \\\\sum_{k_1 + k_2 + \\\\dots + k_m = n} {n \\\\choose k_1\\\\;k_2\\\\;\\\\dots\\\\;k_m} x_1^{k_1}x_2^{k_2}\\\\cdots x_m^{k_m} \\\\tag{2.1}<br/>$$<br/>\u5176\u4e2d\uff1a<br/>$$<br/>{n \\\\choose k_1\\\\;k_2\\\\;\\\\dots\\\\;k_m} = {n! \\\\over k_1!k_2!\\\\cdots k_m!}<br/>$$<br/>\u662f\u591a\u9879\u5f0f\u7cfb\u6570\uff0c\u540c\u65f6\u4e5f\u662f\u591a\u91cd\u96c6\u5408\u7684\u5168\u6392\u5217\u6570\u91cf\u3002<br/>\u7ec4\u5408\u8bc1\u660e\u65b9\u6cd5\u4e0e\u4e8c\u9879\u5f0f\u5b9a\u7406\u7c7b\u4f3c\u3002\u540c\u65f6\u4e5f\u53ef\u4ee5\u4ece\u4e8c\u9879\u5f0f\u5b9a\u7406\u5f52\u7eb3\u6cd5\u800c\u6765\u3002<br/>\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406<br/>\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\u53c8\u79f0\u4e3a\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\uff1a<br/>$$<br/>(x + y)^\\\\alpha = \\\\sum_{k=0}^\\\\infty {\\\\alpha \\\\choose k} x^ky^{\\\\alpha - k} \\\\;\\\\;\\\\; (\\\\alpha \\\\in R,\\\\;\\\\color{red}{0 \\\\le \\\\;\\\\mid x\\\\mid\\\\; \\\\lt \\\\;\\\\mid y\\\\mid}) \\\\tag{3.1}<br/>$$<br/>\u6ce8\u610f\u7ea2\u8272\u7684\u5b57\uff0c\u8fd9\u662f\u975e\u5e38\u91cd\u8981\u7684\u9650\u5236\u3002<br/>\u5176\u4e2d\uff1a<br/>$$<br/>{\\\\alpha \\\\choose k} = {\\\\prod_{i=\\\\alpha - k +1}^\\\\alpha i \\\\over k!}<br/>$$<br/>\u662f\u5728\u5b9e\u6570\u57df\u7684\u4e8c\u9879\u5f0f\u7cfb\u6570\u3002<br/>\u4e0d\u4f1a\u90a3\u4e48\u9ad8\u6df1\u7684\u9ad8\u6570\u77e5\u8bc6\uff0c\u4e0d\u4f1a\u8bc1......<br/>\u57fa\u672c\u7528\u9014<br/>\u8fd9\u79cd\u5f62\u5f0f\u5e76\u4e0d\u5e38\u7528\uff0c\u800c\u53e6\u5916\u4e00\u79cd\u5f62\u5f0f\u5f88\u5e38\u7528\uff1a<br/>\u4ee4$z = x/y$\uff0c\u90a3\u4e48$\\\\color{red}{\\\\mid z\\\\mid \\\\;\\\\lt 1}$\uff1a<br/>$$<br/>(x + y)^\\\\alpha = y^\\\\alpha(z + 1)^\\\\alpha<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>(z + 1)^\\\\alpha & = \\\\sum_{k=0}^\\\\alpha {\\\\alpha \\\\choose k} {x^ky^{\\\\alpha-k} \\\\over y^\\\\alpha} \\\\\\\\<br/>& = \\\\sum_{k=0}^\\\\alpha {\\\\alpha \\\\choose k} {x^k \\\\over y^k}\\\\cdot{y^{\\\\alpha-k} \\\\over y^{\\\\alpha-k}} \\\\\\\\<br/>& = \\\\sum_{k=0}^\\\\alpha {\\\\alpha \\\\choose k} z^k \\\\\\\\<br/>& = (1 + z)^\\\\alpha<br/>\\\\end{aligned}<br/>\\\\tag{3.2}<br/>$$<br/>\u51e0\u4f55\u7ea7\u6570<br/>\u4ee4$\\\\alpha = -n \\\\; (n \\\\in Z)$\uff1a<br/>$$<br/>{\\\\alpha \\\\choose k} = {-n \\\\choose k} = (-1)^k{n + k - 1 \\\\choose k}<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$<br/>\\\\frac1{(1+z)^n} = \\\\sum_{k=0}^\\\\infty (-1)^k{n + k - 1 \\\\choose k} z^k<br/>$$<br/>\u4ee4$z = -z$\uff1a<br/>$$<br/>\\\\frac1{(1-z)^n} = \\\\sum_{k=0}^\\\\infty {n+k-1 \\\\choose k}z^k<br/>$$<br/>\u5999\u554a\uff01\u8ba8\u538c\u7684$-1$\u4e0d\u89c1\u4e86\uff01<br/>\u4ee4$n=1$\uff1a<br/>$$<br/>\\\\frac1{1-z} = \\\\sum_{k=0}^\\\\infty z^k<br/>$$<br/>\u6b63\u662f\u6536\u655b\u51e0\u4f55\u7ea7\u6570\u3002<br/>\u8fd9\u4e1c\u897f\u5728\u751f\u6210\u51fd\u6570\u91cc\u9762\u5f88\u5e38\u89c1\u3002<br/>\u770b\u751f\u6210\u51fd\u6570\u4e4b\u524d\u4e00\u5b9a\u8981\u5b66\u597d\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\u548c\u6cf0\u52d2\u5c55\u5f00QAQ\u3002<br/>\u73b0\u5728\u6211\u4eec\u6765\u6c42\u4e00\u4e0b\u6709\u9650\u51e0\u4f55\u7ea7\u6570\u7684\u516c\u5f0f\u3002<br/>\u6ce8\u610f$\\\\mid z \\\\mid \\\\;\\\\lt 1$\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{k=0}^n z^k & = \\\\sum_{k=0}^\\\\infty z^k - \\\\sum_{k=n+1}^\\\\infty z^k \\\\\\\\<br/>& = \\\\sum_{k=0}^\\\\infty z^k - z^{n+1}\\\\sum_{k=0}^\\\\infty z^k \\\\\\\\<br/>& = (1 - z^{n+1}) \\\\sum_{k=0}^\\\\infty z^k \\\\\\\\<br/>& = {1 - z^{n+1} \\\\over 1-z}<br/>\\\\end{aligned}<br/>\\\\tag{3.3}<br/>$$<br/>\u5f00\u6839\u8fd0\u7b97<br/>\u4e4b\u524d\u53d6$\\\\alpha = -n$\uff0c\u4ece\u800c\u89e3\u51b3\u4e86\u51e0\u4f55\u7ea7\u6570\u7684\u95ee\u9898\u3002<br/>\u73b0\u5728\u53d6$\\\\alpha = 1/2$\uff0c\u5c31\u53ef\u4ee5\u5c06\u6c42\u5e73\u65b9\u6839\u53d8\u6210\u4e00\u4e2a\u8fed\u4ee3\u7684\u5f62\u5f0f\u3002<br/>\u5e76\u4e14\u53ef\u4ee5\u6c42\u4efb\u610f\u5e42\u6b21\u3001\u4efb\u610f\u7cbe\u5ea6\u7684\u7ed3\u679c\u3002<br/>\u7531\u4e8e$z$\u6709\u9650\u5236\uff0c\u56e0\u6b64\u9700\u8981\u63d0\u9879\uff0c\u5982\uff1a<br/>$$<br/>\\\\sqrt{20} = \\\\sqrt{16+4} = 4\\\\sqrt{1 + 0.25}<br/>$$<br/>\u8fd9\u6837\u6211\u4eec\u5c31\u83b7\u5f97\u4e86\u4e00\u4e2a\u6c42\u6839\u53f7\u7684\u597d\u65b9\u6cd5\u3002",
"url": "blog/2016-8-18/binomial.html"
},
"\u4f2a\u4ee3\u7801\u89c4\u5b9a": {
"tags": "\u4f2a\u4ee3\u7801",
"text": "\u4f2a\u4ee3\u7801\u89c4\u5b9a<br/>\u6700\u8fd1\u535a\u5ba2\u4e0a\u7684\u4f2a\u4ee3\u7801\u8d8a\u5199\u8d8a\u4e71\u4e86\uff0c\u662f\u65f6\u5019\u597d\u597d\u5b9a\u4e00\u4e0b\u4e86\u3002<br/>\u53c2\u8003\u4e86\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b\u7684\u4f2a\u4ee3\u7801\u98ce\u683c\uff0c\u6742\u63c9\u4e00\u4e9bPython\u7684\u5199\u6cd5\u3002<br/>\u6ce8\u91ca<br/>//\u540e\u7684\u6240\u6709\u5185\u5bb9\u90fd\u662f\u6ce8\u91ca\u3002<br/>1// \u8fd9\u662f\u6ce8\u91ca<br/><br/><br/>\u53d8\u91cf<br/>\u4ee5\u5355\u4e2a\u5b57\u7b26\u4e3a\u4e3b\uff0c\u5c0f\u5199\u5b57\u6bcd\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u5927\u5199\u5b57\u6bcd\u6700\u597d\u53ea\u67091\u4e2a\u3002<br/>\u53d8\u91cf\u7684\u5c5e\u6027\u7528.\u64cd\u4f5c\u7b26\u6765\u8bbf\u95ee\u3002<br/>\u8fd9\u91cc\u7684\u53d8\u91cf\u5b9e\u9645\u4e0a\u90fd\u662f\u5bf9\u5b9e\u4f53\u7684\u4e00\u4e2a\u5f15\u7528\uff0c\u7c7b\u4f3c\u4e8eC++\u4e2d\u7684\u6307\u9488\u3002<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7a = 1  // \u7b2c\u4e00\u6b21\u58f0\u660ea<br/>b = 2  // \u7b2c\u4e00\u6b21\u58f0\u660eb<br/>a = b  // a\u7ed1\u5b9a\u5230b\u4e0a\uff0c\u5373a\u548cb\u6307\u5411\u540c\u4e00\u5b9e\u4f53<br/>a = COPY(b)  // \u5c06b\u7684\u503c\u590d\u5236\u5230a<br/>a = DEEPCOPY(b)  // \u6df1\u5ea6\u590d\u5236\uff0c\u5c06b\u4e2d\u6240\u6709\u7684\u5f15\u7528\u5168\u90e8\u590d\u5236\u3002<br/>a.name = \\ 233\\   // \u5c5e\u6027\u7684\u8bbe\u5b9a<br/>b.name = a.name  // \u5c5e\u6027\u7684\u8bbf\u95ee\u4e0e\u8bbe\u5b9a<br/><br/><br/>\u51fd\u6570<br/>\u51fd\u6570\u7684\u58f0\u660e\u4ee5function\u5f00\u59cb\u3002<br/>\u51fd\u6570\u540d\u79f0\u6700\u597d\u5168\u90e8\u5927\u5199\uff0c\u5982\u679c\u6709\u591a\u4e2a\u8bcd\u8bed\u7528-\u5206\u5f00\u3002<br/>\u51fd\u6570\u540d\u540e\u9762\u5e26\u4e00\u4e2a\u5143\u7ec4\uff0c\u8868\u793a\u53c2\u6570\u3002<br/>return\u8bed\u53e5\u7528\u6765\u8fd4\u56de\u51fd\u6570\u503c\u3002\u5982\u679c\u6ca1\u6709return\uff0c\u90a3\u4e48\u5b9e\u9645\u8fd4\u56denil\u3002<br/>1<br/>2<br/>3<br/>4function ADD-TWO-NUMBERS(a, b):<br/>    return a + b<br/><br/>c = ADD-TWO-NUMBERS(1, 2)  // c = 3<br/><br/><br/>\u64cd\u4f5c\u7b26<br/>=: \u8d4b\u503c\uff0c\u5728if\u4e2d\u8868\u793a\u5224\u65ad\u662f\u5426\u76f8\u7b49<br/><: \u5c0f\u4e8e<br/>>: \u5927\u4e8e<br/><=: \u4e0d\u5927\u4e8e<br/>>=: \u4e0d\u5c0f\u4e8e<br/>+: \u52a0\u53f7<br/>-: \u51cf\u53f7<br/>*: \u4e58\u53f7<br/>**: \u5e42\u8fd0\u7b97<br/>/: \u9664\u53f7<br/>mod: \u53d6\u6a21<br/>~: \u6309\u4f4d\u53d6\u53cd<br/>&: \u6309\u4f4d\u4e0e<br/>|: \u6309\u4f4d\u6216<br/>^: \u6309\u4f4d\u5f02\u6216<br/><<: \u6309\u4f4d\u5de6\u79fb<br/>>>: \u6309\u4f4d\u53f3\u79fb<br/>not: \u903b\u8f91\u53cd<br/>and: \u903b\u8f91\u4e14<br/>or: \u903b\u8f91\u6216<br/>xor: \u903b\u8f91\u5f02\u6216<br/>\u6761\u4ef6\u63a7\u5236\u8bed\u53e5<br/>if<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8if statement:<br/>    // \u5982\u679c\u4e3a\u771f<br/>else if statement2:<br/>    // ...<br/>else if statement3:<br/>    // ...<br/>else:<br/>    // ...<br/><br/><br/>while<br/>1<br/>2while condition:<br/>    // ...<br/><br/><br/>for<br/>for\u7684\u5f62\u5f0f\u53ef\u4ee5\u591a\u6837\u3002\u6761\u4ef6\u53ef\u4ee5\u7528\u9648\u8ff0\u53e5\u3002<br/>1<br/>2for i = 0 to 100 step 2:  // i\u4ece0\u5230100\uff0c\u6bcf\u6b21\u52a02\u3002<br/>    // ...<br/><br/><br/>foreach\u53ef\u4ee5\u4ee5\u4e0d\u5b9a\u7684\u987a\u5e8f\u904d\u5386\u96c6\u5408\u5185\u7684\u6240\u6709\u5143\u7d20\u3002<br/>1<br/>2foreach a in A:<br/>    // ...<br/><br/><br/>\u5bf9\u4e8e\u8bf8\u59821\u5230100\u7684\u904d\u5386\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b9a\u4e49\u57df\u3002<br/>1<br/>2foreach i in [1, 100]:<br/>    // ...<br/><br/><br/>\u5185\u7f6e\u7c7b\u578b<br/>nil: \u8868\u793a\u4e0d\u5b58\u5728\u7684\u503c<br/>Number: \u8868\u793a\u5b9e\u6570<br/>String: \u8868\u793a\u5b57\u7b26\u4e32\uff0c\u7528\\ \\ \u8868\u793a<br/>Boolean: \u8868\u793a\u5e03\u5c14\u503c\uff0c\u53ea\u6709true\u548cfalse<br/>Byte: \u8868\u793a\u4e00\u4e2a\u5b57\u8282(\u901a\u5e38\u4e3a8bit)\uff0c\u5141\u8bb8\u4f7f\u752816\u8fdb\u5236\u548c2\u8fdb\u5236\uff0c16\u8fdb\u5236\u4ee5#\u5f00\u59cb\u3002<br/>Set: \u8868\u793a\u96c6\u5408\uff0c\u7528{}\u8868\u793a\u3002<br/>\u6240\u6709\u7684\u7c7b\u578b\u540e\u52a0\u4e0a[]\u8868\u793a\u8be5\u7c7b\u578b\u7684\u6570\u7ec4\u7c7b\u578b\u3002<br/>\u5bf9\u4e8e\u5143\u7ec4\uff0c\u4f7f\u7528()\u6765\u8868\u793a\u3002<br/>\u5185\u7f6e\u51fd\u6570\u6216\u8bed\u53e5<br/>ASSERT statement: \u65ad\u8a00\uff0c\u5982\u679c\u4e0d\u4e3a\u771f\u5219\u62a5\u9519\u3002<br/>SWAP(a, b): \u4ea4\u6362\u4e24\u8005\u7684\u5f15\u7528\u3002<br/>delete a: \u5220\u9664a\u8fd9\u4e00\u5f15\u7528<br/>\u4ee5\u53ca\u5404\u79cd\u6570\u5b66\u51fd\u6570<br/>\u5143\u7ec4<br/>\u4f7f\u7528\u5c0f\u62ec\u53f7\u6765\u58f0\u660e\u5143\u7ec4\u3002<br/>1<br/>2(a, )  // \u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u5219\u9700\u8981\u5e26\u4e0a\u4e00\u4e2a\u989d\u5916\u7684\u9017\u53f7\u3002<br/>(a, b, c)  // \u4e09\u5143\u7ec4<br/><br/><br/>\u5143\u7ec4\u53ef\u4ee5\u88c2\u89e3\u3002<br/>1a, b = (1, 2)  // a = 1, b = 2<br/><br/><br/>\u6784\u6210\u5143\u7ec4\u7684\u65b9\u5f0f\u4e5f\u53ef\u4ee5\u968f\u610f\u3002<br/>1a, b = b, a  // \u6b64\u4e43SWAP\u7684\u5b9e\u73b0<br/><br/><br/>\u5982\u679c\u9047\u5230\u6781\u7aef\u60c5\u51b5\u2026<br/>\u5982\u679c\u4e0a\u9762\u7684\u89c4\u5b9a\u4e0d\u80fd\u6ee1\u8db3\u8868\u8fbe\u7b97\u6cd5\u7684\u9700\u8981\uff0c\u90a3\u4e48\u6709\u4e24\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1a<br/><br/>\u4ece\u5176\u5b83\u7684\u8bed\u8a00\u501f\u70b9\u8bed\u6cd5\u8fc7\u6765\uff0c\u522b\u4eba\u770b\u5f97\u61c2\u5c31\u884c\u3002<br/>\u4f7f\u7528\u9648\u8ff0\u53e5\u3002<br/><br/>\u8bb0\u4f4f\uff0c\u5982\u679c\u89e3\u51b3\u4e0d\u4e86\u65f6\uff0c\u5c31\u7528\u9648\u8ff0\u53e5\u3002",
"url": "blog/2016-4-23/fake-code.html"
},
"\u4f4d\u8fd0\u7b97\u5377\u79ef\u4e0eFWT": {
"tags": "\u4f4d\u8fd0\u7b97\u5377\u79ef FWT",
"text": "\u4f4d\u8fd0\u7b97\u5377\u79ef\u4e0e FWT<br/>\u51e0\u884c\u4ee3\u7801\u91cc\u9690\u85cf\u6570\u5b66\u771f\u662f\u9ad8\u6df1\u83ab\u6d4b\uff0c\u53ea\u6709\u52c7\u8005\u624d\u80fd\u591f\u53d1\u73b0\u8fd9\u7edd\u5999\u7684\u89c4\u5f8b\u3002<br/>\u4f4d\u8fd0\u7b97\u5377\u79ef<br/>\u666e\u901a\u7684\u5377\u79ef (\u5373\u591a\u9879\u5f0f\u4e58\u6cd5) \u662f\u8fd9\u4e2a\u6837\u5b50\uff1a<br/>$$<br/>C_i = \\\\sum_{j + k = i} A_j \\\\cdot B_k \\\\;\\\\;\\\\;\\\\;\\\\forall \\\\; j, k \\\\in [0, n)<br/>\\\\tag{1.1}<br/>$$<br/>\u800c\u4f4d\u8fd0\u7b97\u5377\u79ef\u5c31\u662f\u5c06\u52a0\u53f7\u53d8\u4e3a\u4e86\u4e8c\u5143\u4f4d\u8fd0\u7b97\uff0c\u5c31\u662f\u8fd9\u6837\uff1a<br/>$$<br/>C_i = \\\\sum_{j \\\\oplus k = i} A_j \\\\cdot B_k \\\\;\\\\;\\\\;\\\\;\\\\forall \\\\; j, k \\\\in [0, n)<br/>\\\\tag{1.2}<br/>$$<br/>\u5176\u4e2d $\\\\oplus$ \u6307\u4ee3\u4efb\u610f\u4e8c\u5143\u4f4d\u8fd0\u7b97\u7b26\u53f7\uff0c\u5982\u5f02\u6216 (\u5c31\u662f\u8bb0\u505a $\\\\oplus$)\u3001\u4e0e\u8fd0\u7b97 ($\\\\land$) \u548c\u6216\u8fd0\u7b97 ($\\\\lor$) \u7b49\u7b49\u3002<br/>\u6ce8\u610f\u5230\uff0c\u5728\u591a\u9879\u5f0f\u4e58\u6cd5\u4e2d\uff0c\u5982\u679c\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u754c\u4e3a $A$ \u548c $B$\uff0c\u90a3\u4e48\u7b54\u6848\u7684\u754c\u5c31\u662f $A + B - 1$\u3002\u800c\u5728\u4f4d\u8fd0\u7b97\u5377\u79ef\u4e2d\uff0c\u5374\u662f $2^{\\\\left\\\\lceil\\\\log_2\\\\max\\\\{A,B\\\\}\\\\right\\\\rceil}$\u3002\u800c\u4e14\u5bf9\u4e8e\u4e24\u4e2a\u8f93\u5165\u5411\u91cf\u800c\u8a00\uff0c\u672b\u5c3e\u6dfb\u52a0\u51e0\u4e2a $0$ \u662f\u4e0d\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u5f71\u54cd\u76841\u3002\u56e0\u6b64\uff0c\u50cf\u5728\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u4e2d\u4e00\u6837\uff0c\u5047\u5b9a\u8f93\u5165\u7684\u5411\u91cf\u5927\u5c0f\u4e00\u81f4\u4e14\u5747\u4e3a $2$ \u7684\u5e42\uff0c\u8bbe\u8fd9\u4e2a\u5927\u5c0f\u4e3a $n$\u3002<br/>\u5728\u4e0b\u6587\u4e2d\uff0c\u5411\u91cf $A = (a_0, a_1, ..., a_k)$ \u7684\u5012\u7f6e $A^T$ \u4e3a\uff1a<br/>$$<br/>A^T = \\\\left[\\\\begin{matrix}<br/>a_0 \\\\\\\\<br/>a_1 \\\\\\\\<br/>\\\\vdots \\\\\\\\<br/>a_k<br/>\\\\end{matrix}\\\\right] \\\\tag{1.3}<br/>$$<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u77e9\u9635 $M$ \u4e0e\u5411\u91cf $A = (a_0, a_1, ..., a_k)$ \u76f8\u4e58\u8868\u793a\u7ebf\u6027\u53d8\u6362\u65f6\uff0c\u7b80\u5199\u4e3a $MA$\uff0c\u4ee3\u8868 $(MA^T)^T$\u3002<br/>\u7279\u6b8a\u60c5\u51b5<br/>\u4e3a\u4e86\u63a2\u5bfb\u89c4\u5f8b\uff0c\u6211\u4eec\u4ee5\u5f02\u6216\u4e3a\u4f8b\uff0c\u624b\u52a8\u8ba1\u7b97\u4e00\u4e0b $n$ \u5f88\u5c0f\u65f6\u7684\u60c5\u51b5\u3002<br/>$n = 2^0$<br/>\u5f53\u8f93\u5165\u4e24\u4e2a\u6570\u65f6\uff0c\u7ed3\u679c\u4f1a\u662f\u4e00\u4e2a\u6570\u3002\u7531\u4e8e $0 \\\\oplus 0 = 0$\uff0c\u6240\u4ee5\uff1a<br/>$$<br/>C_0 = A_0 \\\\cdot B_0<br/>\\\\tag{2.1}<br/>$$<br/>So easy, \u4e5f\u6ca1\u4ec0\u4e48\u610f\u601d\u3002<br/>$n = 2^1$<br/>\u8f93\u5165\u4e24\u4e2a\u5411\u91cf $A = (a_0, a_1)$ \u548c $B = (b_0, b_1)$\u3002\u5f97\u5230\u7684\u7ed3\u679c $C$ \u662f\uff1a<br/>$$<br/>C = (a_0 b_0 + a_1 b_1, a_0 b_1 + a_1 b_0)<br/>\\\\tag{2.2}<br/>$$<br/>\u4e0d\u5982\u5927\u80c6\u7684\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u80fd\u5426\u901a\u8fc7\u67d0\u79cd\u53d8\u6362\uff0c\u4ece\u800c\u80fd\u591f\u4f7f\u7528\u66f4\u7b80\u5355\u7684\u70b9\u79ef\u6765\u8ba1\u7b97\u5462\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a<br/>$$<br/>TA \\\\cdot TB = TC<br/>\\\\tag{2.3}<br/>$$<br/>\u8fd9\u91cc $T$ \u8868\u793a\u53d8\u6362\uff0c\u540c\u65f6\u4ed6\u8fd8\u9700\u8981\u4e00\u4e2a\u9006\u53d8\u6362\u4ece\u800c\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u5f97\u5230 $C$\u3002\u6211\u4eec\u53ef\u4ee5\u4ece\u7ebf\u6027\u4ee3\u6570\u7684\u89d2\u5ea6\u6765\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\uff0c\u90a3\u4e48\u6211\u4eec\u5e0c\u671b $T$ \u80fd\u591f\u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u77e9\u9635\u6765\u8868\u793a\u4e4b\u3002<br/>\u90a3\u4e48\u610f\u5473\u7740\u6211\u4eec\u8981\u627e\u5230\u4e00\u4e2a\u77e9\u9635 $T$\uff0c\u6ee1\u8db3\uff1a<br/>$$<br/>T<br/>\\\\left[<br/>\\\\begin{matrix}<br/>a_0 \\\\\\\\<br/>a_1<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\cdot<br/>T<br/>\\\\left[<br/>\\\\begin{matrix}<br/>b_0 \\\\\\\\<br/>b_1<br/>\\\\end{matrix}<br/>\\\\right]<br/>=<br/>T<br/>\\\\left[<br/>\\\\begin{matrix}<br/>a_0 b_0 + a_1 b_1 \\\\\\\\<br/>a_0 b_1 + a_1 b_0<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{2.4}<br/>$$<br/>\u9996\u5148\u8fd9\u4e2a\u7ebf\u6027\u53d8\u6362\u53ea\u5728\u4e8c\u7ef4\u5411\u91cf\u7a7a\u95f4\u4e0a\u8fdb\u884c\u7684\uff0c\u6240\u4ee5 $T$ \u5e94\u8be5\u662f\u4e00\u4e2a $2 \\\\times 2$ \u7684\u77e9\u9635\uff0c\u4e8e\u662f\u8bbe\uff1a<br/>$$<br/>T =<br/>\\\\left[<br/>\\\\begin{matrix}<br/>m & n \\\\\\\\<br/>p & q<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{2.5}<br/>$$<br/>\u90a3\u4e48\u4e4b\u524d\u662f\u4e00\u4e2a\u4e24\u4e2a\u5411\u91cf\u7684\u70b9\u79ef\u5f0f\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u4e24\u4e2a\u65b9\u7a0b\u6765\u8868\u793a\uff1a<br/>$$<br/>\\\\begin{cases}<br/>\\\\begin{aligned}<br/>(ma_0 + na_1)(mb_0 + nb_1) & = m(a_0 b_0 + a_1 b_1) + n(a_0 b_1 + a_1 b_0) \\\\\\\\<br/>(pa_0 + qa_1)(pb_0 + qb_1) & = p(a_0 b_0 + a_1 b_1) + q(a_0 b_1 + a_1 b_0)<br/>\\\\end{aligned}<br/>\\\\end{cases}<br/>\\\\tag{2.6}<br/>$$<br/>\u4e8e\u662f\u4f60\u53d1\u73b0\u7b2c\u4e00\u4e2a\u65b9\u7a0b\u548c\u7b2c\u4e8c\u65b9\u7a0b\u6ca1\u6709\u533a\u522b......\u597d\u5427\uff0c\u90a3\u5c31\u53ea\u7814\u7a76\u7b2c\u4e00\u4e2a\u65b9\u7a0b\uff0c\u5c06\u5176\u66b4\u529b\u62c6\u5f00\u662f\u8fd9\u6837\u7684\uff1a<br/>$$<br/>m^2a_0 b_0 + mna_0 b_1 + mna_1 b_0 + n^2a_1 b_1 = ma_0 b_0 + na_0 b_1 + na_1 b_0 + ma_1 b_1<br/>\\\\tag{2.7}<br/>$$<br/>\u4e00\u4e2a\u4e8c\u5143\u4e8c\u6b21\u65b9\u7a0b\uff0c\u6709\u5f88\u591a\u89e3\u4e86\u5566\uff0c\u4f46\u662f\u6211\u4eec\u53ea\u9700\u8981\u4e00\u4e2a\u3002\u6700\u7b80\u5355\u7684\u89e3\u6cd52\u5c31\u662f\u5bf9\u5e94\u7684\u9879\u7684\u7cfb\u6570\u76f8\u540c\u3002<br/>\u4e5f\u5c31\u662f\u8bf4\uff1a<br/>$$<br/>m^2 = m \\\\Longrightarrow m = 1<br/>\\\\tag{2.8}<br/>$$<br/>\u7136\u540e\u5c31\u662f\uff1a<br/>$$<br/>n^2 = 1 \\\\Longrightarrow n = \\\\pm 1<br/>\\\\tag{2.9}<br/>$$<br/>\u7136\u540e\u53d1\u73b0 $n$ \u7684\u8fd9\u4e24\u4e2a\u53d6\u503c\u90fd\u53ef\u4ee5\u6ee1\u8db3 $mn = n$\u3002\u90a3\u4e48\u5bf9\u4e8e $p$ \u548c $q$ \u662f\u540c\u7406\u7684\uff0c\u56e0\u6b64 $T$ \u7684\u4e00\u79cd\u5f62\u5f0f\u662f\u8fd9\u6837\u7684\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & \\\\pm 1 \\\\\\\\<br/>1 & \\\\pm 1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{2.10}<br/>$$<br/>\u4e0d\u8fc7\u6211\u4eec\u4e0d\u80fd\u591f\u5168\u90e8\u586b $1$\uff0c\u56e0\u4e3a\u6211\u4eec\u5728\u4e00\u5f00\u59cb\u7684\u8981\u6c42\u662f $T$ \u8981\u6709\u9006\u53d8\u6362\uff0c\u4f46\u662f\u5168\u662f $n = q$ \u7684\u77e9\u9635\u4e0d\u6ee1\u79e9\uff0c\u6240\u4ee5\u6ca1\u6709\u9006\u77e9\u9635\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u6709\u4e24\u79cd\u9009\u62e9\u3002<br/>\u5bf9\u4e8e\u5176\u9006\u77e9\u9635\uff0c\u6211\u5728\u8fd9\u91cc\u5e2e\u4f60\u4eec\u7b97\u51fa\u6765\u4e86\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & -1 \\\\\\\\<br/>1 & 1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]^{-1}<br/>=<br/>\\\\left[<br/>\\\\begin{matrix}<br/>0.5 & 0.5 \\\\\\\\<br/>-0.5 & 0.5 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right] \\\\\\\\<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 1 \\\\\\\\<br/>1 & -1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]^{-1}<br/>=<br/>\\\\left[<br/>\\\\begin{matrix}<br/>0.5 & 0.5 \\\\\\\\<br/>0.5 & -0.5 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{2.11}<br/>$$<br/>\u5b9e\u5728\u8bb0\u4e0d\u4f4f\u5c31\u7206\u679a\u4e00\u4e0b\u77e9\u9635\u5427\uff0c\u8fd9\u6837\u7684 $\\\\pm 1$ \u77e9\u9635\u6ca1\u51e0\u4e2a\uff0c\u8bd5\u4e00\u8bd5\u5c31\u597d......<br/>$n = 2^m \\\\;\\\\; (m \\\\geqslant 2)$<br/>\u73b0\u5728\u6765\u8003\u8651\u66f4\u590d\u6742\u7684\u60c5\u51b5\u3002<br/>\u8ddf\u524d\u9762\u4e00\u6837\u7684\u601d\u60f3\uff0c\u6211\u4eec\u4f01\u56fe\u627e\u5230 $T_m$\uff0c\u6ee1\u8db3\uff1a<br/>$$<br/>T_mA \\\\cdot T_mB = T_mC<br/>\\\\tag{2.12}<br/>$$<br/>\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 $T_0 = 1$ \u5e76\u4e14\u6c42\u51fa\u4e86 $T_1$\u3002<br/>\u57fa\u4e8e\u8fd9\u6837\u4e00\u4e2a\u4e8b\u5b9e\uff1a<br/>$$<br/>a \\\\oplus b = c \\\\Longrightarrow<br/>a[i] \\\\oplus b[i] = c[i]<br/>\\\\tag{2.13}<br/>$$<br/>\u8fd9\u91cc $a[i]$ \u8868\u793a $a$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u7684\u7b2c $i$ \u4f4d\u3002\u8fd9\u8bf4\u660e\u4e8c\u8fdb\u5236\u8fd0\u7b97\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u6027\u8d28\u5c31\u662f\u5176\u6bcf\u4e00\u4f4d\u53ef\u4ee5\u5206\u5f00\u8fd0\u7b97\u3002<br/>\u8fd9\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\u6211\u4eec\u5148\u8003\u8651\u6700\u9ad8\u4f4d\uff0c\u8fd9\u6837\u5c06\u8f93\u5165\u5411\u91cf\u5206\u4e3a\u4e24\u90e8\u5206\uff1a<br/>$$<br/>A = (A_0, A_1) \\\\\\\\<br/>B = (B_0, B_1)<br/>\\\\tag{2.14}<br/>$$<br/>\u4e0b\u6807\u4e3a $0$ \u7684\u8868\u793a\u6700\u9ad8\u4f4d\u4e3a $0$\uff0c\u4e0b\u6807\u4e3a $1$ \u7684\u8868\u793a\u6700\u9ad8\u4f4d\u4e3a $1$\u3002\u5b9e\u9645\u4e0a\uff0c\u5c31\u662f\u5c06\u5411\u91cf\u5207\u6210\u4e86\u4e24\u534a\u3002<br/>\u5bf9\u4e8e\u7ed3\u679c $C = (C_0, C_1)$ \u800c\u8a00\uff0c\u5728\u4e0d\u8003\u8651\u6700\u9ad8\u4f4d\u7684\u60c5\u51b5\u4e0b\uff0c$A_0$\u3001$A_1$\u3001$B_0$ \u548c $B_1$ \u4efb\u610f\u6c42\u5377\u79ef\u90fd\u662f\u53ef\u4ee5\u5bf9 $C_0$ \u548c $C_1$ \u6709\u8d21\u732e\u7684 (\u5377\u79ef\u540e\u4e00\u4e2a\u5411\u91cf\u52a0\u6cd5\u7d2f\u8ba1\u8d21\u732e)\u3002\u4f46\u662f\u6b64\u5904\u6211\u4eec\u9700\u8981\u8003\u8651\u6700\u9ad8\u4f4d\uff0c\u90a3\u4e48\u5c31\u4f1a\u6709\u4e00\u5b9a\u7684\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u4e0b\u6807\u7684\u8fd0\u7b97\u7ed3\u679c\u7684\u9650\u5236\u3002<br/>\u4e0d\u96be\u53d1\u73b0\uff0c\u8fd9\u5b9e\u9645\u4e0a\u9000\u5316\u4e3a\u4e86 $n = 2$ \u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u7528\u4e4b\u524d\u7684\u65b9\u6cd5\u6765\u8868\u793a\uff1a<br/>$$<br/>T_1<br/>\\\\left[<br/>\\\\begin{matrix}<br/>T_{m-1} A_0 \\\\\\\\<br/>T_{m-1} A_1<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\cdot<br/>T_1<br/>\\\\left[<br/>\\\\begin{matrix}<br/>T_{m-1}B_0 \\\\\\\\<br/>T_{m-1}B_1<br/>\\\\end{matrix}<br/>\\\\right]<br/>=<br/>T_1<br/>\\\\left[<br/>\\\\begin{matrix}<br/>T_{m-1}C_0 \\\\\\\\<br/>T_{m-1}C_1<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{2.15}<br/>$$<br/>\u5bf9\u4e8e\u9006\u53d8\u6362\u4e5f\u662f\u4e00\u6837\u3002<br/>\u4e8e\u662f\u53ef\u4ee5\u5f97\u77e5\uff1a<br/>$$<br/>T_m = T_1<br/>\\\\left[<br/>\\\\begin{matrix}<br/>T_{m-1} \\\\\\\\<br/>T_{m-1}<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{2.16}<br/>$$<br/>\u4f46\u5b9e\u9645\u4e0a\u5df2\u7ecf\u6ca1\u6709\u610f\u4e49\u5566\uff01\u56e0\u4e3a $(2.15)$ \u5c31\u662f\u4e00\u4e2a\u5206\u6cbb\u8ba1\u7b97\u7684\u8fc7\u7a0b\uff0c\u5e76\u4e14\u5b83\u7684\u590d\u6742\u5ea6\u662f\uff1a<br/>$$<br/>T(n) = 2T(n / 2) + \\\\Theta(n) = \\\\Theta(n\\\\log n)<br/>\\\\tag{2.17}<br/>$$<br/>\u4e8e\u662f\u6211\u4eec\u83b7\u5f97\u4e86 FWT \u7b97\u6cd53\uff01<br/>FWT \u7b97\u6cd5<br/>\u524d\u9762 BB \u4e86\u4e00\u5927\u6bb5\uff0c\u73b0\u5728\u6765\u68b3\u7406\u4e00\u4e0b\uff1a<br/><br/>\u6211\u4eec\u8ba1\u7b97 $TA$ \u548c $TB$\u3002<br/>\u7136\u540e\u7b54\u6848\u5c31\u662f $T^{-1}(TA \\\\cdot TB)$\u3002<br/><br/>\u5982\u4f55\u8ba1\u7b97 $TA$ \u548c $T^{-1}A$\uff1f\u6839\u636e $(2.15)$ \u5f0f\uff0c\u6211\u4eec\u5148\u8981\u6309\u6700\u9ad8\u4f4d\u5206\u6210\u4e24\u4e2a\u5411\u91cf\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b50\u5411\u91cf\uff0c\u9012\u5f52\u8ba1\u7b97\u5176\u7ecf\u8fc7\u53d8\u6362\u540e\u7684\u7ed3\u679c\u3002\u7136\u540e\u6839\u636e $T_1$ \u6765\u5408\u5e76\u7ed3\u679c\u3002<br/>\u4ee5\u5f02\u6216\u8fd0\u7b97\u4e3a\u4f8b\uff0c\u5047\u8bbe\u6211\u4eec\u94a6\u5b9a\u4e86\u4f7f\u7528\u8fd9\u4e2a\u77e9\u9635\u4f5c\u4e3a\u6211\u4eec\u7684\u53d8\u6362\uff1a<br/>$$<br/>T =<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 1 \\\\\\\\<br/>1 & -1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{3.1}<br/>$$<br/>\u90a3\u4e48\u5408\u5e76\u7684\u8fc7\u7a0b\u5c31\u662f\u8fd9\u68374\uff1a<br/>$$<br/>TA = (TA_0 + TA_1, TA_0 - TA_1)<br/>\\\\tag{3.2}<br/>$$<br/>\u4f60\u53ea\u7528\u6309\u7167\u77e9\u9635\u7684\u5f62\u5f0f\u6765\u8ba1\u7b97\u5c31\u53ef\u4ee5\u4e86\u3002<br/>\u5bf9\u4e8e\u9006\u53d8\u6362\uff0c\u5c31\u662f\u8fd9\u6837\u5408\u5e76\uff1a<br/>$$<br/>T^{-1} A = \\\\left({T^{-1}A_0 + T^{-1}A_1 \\\\over 2}, {T^{-1}A_0 - T^{-1}A_1 \\\\over 2}\\\\right)<br/>\\\\tag{3.3}<br/>$$<br/>\u5177\u4f53\u5b9e\u73b0<br/>\u4e3a\u4e86\u65b9\u4fbf\u7406\u89e3\uff0c\u5728\u8fd9\u91cc\u7ed9\u51fa\u7528 Python \u7f16\u5199\u7684 FWT \u7b97\u6cd5\uff0c\u4f9d\u7136\u662f\u5f02\u6216\u7684\u4f8b\u5b50\u3002<br/>\u9012\u5f52\u5f62\u5f0f<br/>\u9012\u5f52\u5f62\u5f0f\u7b80\u5355\u7c97\u66b4\uff0c\u5bb9\u6613\u7f16\u5199\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43import numpy<br/><br/>def fwt(X):<br/>    \\ \\ \\ \u6b63\u53d8\u6362\uff0c\u8fd4\u56deTX<br/>    X: \u8f93\u5165\u5411\u91cf<br/>    \\ \\ \\ <br/><br/>    if len(X) == 1:<br/>        return X<br/><br/>    m = len(X) // 2<br/>    A0 = fwt(X[:m])<br/>    A1 = fwt(X[m:])<br/>    return numpy.array(*(A0 + A1), *(A0 - A1))<br/><br/>def rfwt(X):<br/>    \\ \\ \\ \u9006\u53d8\u6362\uff0c\u8fd4\u56deT^{-1}X<br/>    X: \u8f93\u5165\u5411\u91cf<br/>    \\ \\ \\ <br/><br/>    if len(X) == 1:<br/>        return X<br/><br/>    m = len(X) // 2<br/>    A0 = rfwt(X[:m])<br/>    A1 = rfwt(X[m:])<br/>    return numpy.array(*((A0 + A1) / 2), *((A0 - A1) / 2))<br/><br/>def product(A, B):<br/>    \\ \\ \\ \u8ba1\u7b97\u5377\u79ef<br/>    A, B: \u8f93\u5165\u5411\u91cf<br/>    \\ \\ \\ <br/><br/>    TA = fwt(A)<br/>    TB = fwt(B)<br/>    TC = TA * TB<br/>    return rfwt(TC)<br/><br/># \u8c03\u7528<br/>print(product(<br/>    numpy.array([1, 2, 3, 4]),<br/>    numpy.array([2, 3, 3, 3])<br/>))  # [29, 28, 27, 26]<br/><br/><br/>\u8fed\u4ee3\u5f62\u5f0f<br/>\u4e0e\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7c7b\u4f3c\uff0cFWT \u4e5f\u53ef\u4ee5\u6539\u5199\u4e3a\u8fed\u4ee3\u7684\u7248\u672c\uff0c\u5177\u4f53\u7684\u539f\u7406\u53ef\u4ee5\u53c2\u89c1\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7684\u5b9e\u73b0\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28import copy<br/>import numpy<br/><br/>def iterative_fwt(X):<br/>    A = copy.deepcopy(X)<br/>    s = 2<br/>    while s <= len(X):<br/>        for i in range(0, len(X), s):<br/>            for j in range(0, s // 2):<br/>                tmp = A[i + j]<br/>                A[i + j] += A[i + j + s // 2]<br/>                A[i + j + s // 2] = tmp - A[i + j + s // 2]<br/>        s *= 2<br/><br/>    return A<br/><br/>def iterative_rfwt(X):<br/>    A = copy.deepcopy(X)<br/>    s = 2<br/>    while s <= len(X):<br/>        for i in range(0, len(X), s):<br/>            for j in range(0, s // 2):<br/>                tmp = A[i + j]<br/>                A[i + j] = (A[i + j] + A[i + j + s // 2]) / 2<br/>                A[i + j + s // 2] = (tmp - A[i + j + s // 2]) / 2<br/>        s *= 2<br/><br/>    return A<br/><br/><br/>\u5f53\u7136\u8fd9\u91cc\u7ed9\u51fa\u7248\u672c\u4e0d\u662f\u5e38\u6570\u4e0a\u6548\u7387\u6700\u9ad8\u7684\uff0c\u5927\u5bb6\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6539\u5199\u4ee3\u7801\u3002<br/>\u5176\u4ed6\u7684\u4f4d\u8fd0\u7b97<br/>\u4e4b\u524d\u4e00\u76f4\u5728\u8ba8\u8bba\u5f02\u6216\uff0c\u6ca1\u6709\u5173\u6ce8\u4e0e\u8fd0\u7b97\u548c\u6216\u8fd0\u7b97\u3002\u56e0\u4e3a\u5b83\u4eec\u7684\u63a8\u5bfc\u8fc7\u7a0b\u662f\u4e00\u6837\u7684\u3002\u8fd9\u91cc\u5c31\u4e0d\u91cd\u590d\u5176\u8fc7\u7a0b\u4e86\u3002<br/>\u5bf9\u4e8e\u4e0e\u8fd0\u7b97\u800c\u8a00\uff1a<br/>$$<br/>T =<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 1 \\\\\\\\<br/>0 & 1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right] \\\\\\\\<br/>T^{-1} =<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & -1 \\\\\\\\<br/>0 & 1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{5.1}<br/>$$<br/>\u5bf9\u4e8e\u6216\u8fd0\u7b97\u800c\u8a00\uff1a<br/>$$<br/>T =<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 0 \\\\\\\\<br/>1 & 1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right] \\\\\\\\<br/>T^{-1} =<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 0 \\\\\\\\<br/>-1 & 1 \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\tag{5.2}<br/>$$<br/>\u5b9e\u73b0\u5b83\u4eec\u7684\u4f4d\u8fd0\u7b97\u5377\u79ef\u5c31\u53ea\u7528\u4fee\u6539\u5408\u5e76\u7684\u8fc7\u7a0b\u5373\u53ef\u3002<br/>\u5176\u4ed6\u8fd0\u7528<br/>\u5b50\u96c6\u548c<br/>\u73b0\u5728\u662f\u65f6\u5019\u6765\u770b\u4e00\u4e0b\u6216\u5377\u79ef\u4e86\uff0c\u6309\u7167\u4e4b\u524d\u65b9\u6cd5\uff0c\u6c42\u51fa\u6216\u5377\u79ef\u53d8\u6362\u7684\u4e00\u79cd\u5f62\u5f0f\u3002\u8fd9\u91cc\u6211\u4eec\u5173\u6ce8\u7684\u662f $(5.2)$ \u4e2d\u7684\u53d8\u6362\u3002FWT \u7b97\u6cd5\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u662f\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u7684\u987a\u5e8f\u8fdb\u884c\u5408\u5e76\u7684\u3002\u6211\u4eec\u8fd8\u662f\u6309\u7167\u67d0\u4e00\u4f4d\u6765\u5212\u5206\u5e8f\u5217 $A = (A_0, A_1)$\uff0c\u90a3\u4e48 $TA$ \u5c31\u662f $(A_0, A_0 + A_1)$\uff0c\u4e0d\u96be\u53d1\u73b0\uff0c\u539f\u6765\u7684 $A_1$ \u90e8\u5206\u52a0\u4e0a\u4e86 $A_0$\uff0c\u4e5f\u5c31\u662f\u76f8\u5f53\u4e8e\u4e00\u4e2a\u96c6\u5408\u91cc\u9762\u5c11\u4e86\u4e00\u4e2a\u5143\u7d20\u7684\u96c6\u5408\u7684\u503c\u88ab\u52a0\u4e86\u8fc7\u6765\uff0c\u8fd9\u4e9b\u96c6\u5408\u90fd\u662f\u81ea\u5df1\u7684\u5b50\u96c6\u3002\u56e0\u6b64\uff0c\u8fd9\u6837\u7684 FWT \u7b97\u6cd5\u5b9e\u9645\u4e0a\u8ba1\u7b97\u7684\u662f\u4e0b\u9762\u8fd9\u4e2a\u4e1c\u897f\uff1a<br/>$$<br/>H(S) = \\\\sum_{T \\\\subseteq S} A(T) \\\\tag{6.1}<br/>$$<br/>\u8fd9\u5c31\u662f\u5b50\u96c6\u548c\u53d8\u6362\u3002\u540c\u65f6\u5229\u7528 $T^{-1}$\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e $H$ \u6765\u7b97\u51fa $A$\u3002\u5173\u7cfb\u8fd0\u7b97\u7b26 \u201c$\\\\subseteq$\u201d \u662f\u504f\u5e8f\uff0c\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f145\uff0c\u6211\u4eec\u5f97\u77e5\u9006 FWT \u7b97\u7684\u662f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>A(S) & = \\\\sum_{T \\\\subseteq S} \\\\mu(T)H(S - T) \\\\\\\\<br/>& = \\\\sum_{T \\\\subseteq S} (-1)^{|T|}H(S - T)<br/>\\\\end{aligned} \\\\tag{6.2}<br/>$$<br/>\u5373\u9006\u5b50\u96c6\u548c\u53d8\u6362\u3002\u8ba1\u7b97\u5b83\u4eec\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f $\\\\Theta(n \\\\log n)$\u3002<br/>\u5b50\u96c6\u5377\u79ef<br/>\u5229\u7528\u6216\u5377\u79ef\uff0c\u6211\u4eec\u53ef\u4ee5\u5e72\u4e9b\u66f4\u6709\u8da3\u7684\u4e8b\u60c5\uff0c\u90a3\u5c31\u662f\u5b50\u96c6\u5377\u79ef\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u5411\u91cf $F= (f_0, f_1, ..., f_{n-1})$ \u548c $G = (g_0, g_1, ..., g_{n-1})$\uff0c\u5b83\u4eec\u7684\u5b50\u96c6\u5377\u79ef $H = F \\\\times G$ \u4e3a\uff1a<br/>$$<br/>H(S) = \\\\sum_{T \\\\subseteq S} F(T)G(S - T) \\\\tag{7.1}<br/>$$<br/>\u8bb0 $k = \\\\Theta(\\\\log n)$\uff0c\u5982\u679c\u76f4\u63a5\u4e24\u8fb9\u540c\u65f6\u679a\u4e3e\u8ba1\u7b97\uff0c\u5176\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n^2)$\u3002\u5982\u679c\u5148\u679a\u4e3e $S$\uff0c\u518d\u679a\u4e3e $S$ \u7684\u5b50\u96c6 $T$\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u6211\u4eec\u53ea\u679a\u4e3e\u4e86 $\\\\sum_{j = 0}^k \\\\binom{k}j 2^j = (1 + 2)^k = 3^k$ \u6b21\u3002\u4e3a\u4e86\u80fd\u591f\u964d\u4f4e\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528 FWT \u7b97\u6cd5\u3002\u5bb9\u6613\u770b\u51fa\uff0c\u6216\u5377\u79ef\u4e0e\u5b50\u96c6\u5377\u79ef\u6700\u4e3a\u76f8\u4f3c\u3002\u6211\u4eec\u53ef\u4ee5\u628a\u5b50\u96c6\u5377\u79ef\u7b49\u4ef7\u5730\u5199\u6210\u4e0b\u9762\u7684\u5f62\u5f0f\uff1a<br/>$$<br/>H(S) = \\\\sum_{X \\\\subseteq S} \\\\sum_{Y \\\\subseteq S} [X \\\\cup Y = S][X \\\\cap Y = \\\\varnothing] F(X)G(Y) \\\\tag{7.2}<br/>$$<br/>\u800c\u6216\u5377\u79ef\u53ef\u4ee5\u7b49\u4ef7\u5730\u5199\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\uff1a<br/>$$<br/>H(S) = \\\\sum_{X \\\\subseteq S} \\\\sum_{Y \\\\subseteq S} [X \\\\cup Y = S] F(X)G(Y) \\\\tag{7.3}<br/>$$<br/>\u4e0e\u5b50\u96c6\u5377\u79ef\u76f8\u6bd4\uff0c\u53ea\u662f\u5c11\u4e86\u4e00\u4e2a\u4ea4\u96c6\u4e3a\u7a7a\u7684\u6761\u4ef6\u3002\u4e3a\u4e86\u80fd\u591f\u89e3\u51b3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u96c6\u5408\u7684\u5927\u5c0f\u4e0b\u624b\u3002\u4e3b\u8981\u539f\u56e0\u662f\u5927\u5c0f\u53ea\u6709 $\\\\Theta(\\\\log n)$ \u79cd\uff0c\u5e76\u4e14 $|A \\\\cup B| \\\\leqslant |A| + |B|$\uff08\u5f53\u4e14\u4ec5\u5f53 $A$ \u4e0e $B$ \u65e0\u4ea4\u96c6\u65f6\u53d6\u7b49\uff09\uff0c\u8fd9\u6837\u4e00\u6765\u5c31\u53ef\u4ee5\u6309\u7167\u5927\u5c0f\u5206\u7c7b\u8fdb\u884c FWT\u3002<br/>\u5177\u4f53\u7684\u505a\u6cd5\u5982\u4e0b\uff0c\u9996\u5148\u4ee4\uff1a<br/>$$<br/>F_k(S) = \\\\begin{cases}<br/>F(S) & (|S| = k) \\\\\\\\<br/>0 & (\\\\text{otherwise})<br/>\\\\end{cases} \\\\tag{7.4}<br/>$$<br/>\u7c7b\u4f3c\u7684\u65b9\u6cd5\u5b9a\u4e49 $G_k$\u3001$H_k$\u3002\u4ee4\u5143\u7d20\u4e2a\u6570\u4e3a $k = \\\\Theta(\\\\log n)$\uff0c\u679a\u4e3e $i$ \u548c $j$ \u6ee1\u8db3 $i + j = l$\uff0c\u5c06 $F_i$ \u548c $G_j$ \u8fdb\u884c\u6216\u5377\u79ef\u540e\u8d21\u732e\u7ed9 $H_l$\uff0c\u6700\u540e\u5c06 $H_0$ \u5230 $H_k$ \u5168\u90e8\u52a0\u8d77\u6765\u5c31\u662f\u5b50\u96c6\u5377\u79ef\u540e\u7684 $H$\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c$F_i$ \u548c $G_j$ \u7684\u5377\u79ef\u4e0d\u5fc5\u6bcf\u6b21\u90fd\u505a FWT \u548c\u9006 FWT \u53d8\u6362\uff0c\u5c31\u50cf\u591a\u9879\u5f0f\u4e58\u6cd5\u4e00\u6837\uff0c\u7ecf\u8fc7 FWT \u4e4b\u540e\u7684\u5e8f\u5217\u4e4b\u95f4\u7684\u70b9\u79ef\u5c31\u662f\u539f\u5e8f\u5217\u7684\u5377\u79ef\uff0c\u5e8f\u5217\u4e4b\u95f4\u7684\u52a0\u6cd5\u8fd8\u662f\u539f\u5e8f\u5217\u7684\u52a0\u6cd5\u3002\u56e0\u6b64\u6700\u7ec8\u7684\u590d\u6742\u5ea6\u662f $\\\\Theta(2^k k^2) = \\\\Theta(n \\\\log^2 n)$\u3002<br/>\u4e0b\u9762\u662f\u6211\u7684 Python 2 \u5b9e\u73b0\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48<br/>49<br/>50<br/>51<br/>52<br/>53<br/>54<br/>55<br/>56<br/>57<br/>58<br/>59<br/>60<br/>61<br/>62<br/>63<br/>64<br/>65<br/>66<br/>67<br/>68<br/>69<br/>70<br/>71<br/>72<br/>73<br/>74n = int(raw_input())<br/>assert n & (n - 1) == 0, 'Argument \\ n\\  must be a power of 2.'<br/><br/>f = map(int, raw_input().split())<br/>g = map(int, raw_input().split())<br/><br/>def fwt(X):<br/>    if len(X) == 1:<br/>        return X<br/><br/>    m = len(X) >> 1<br/>    A, B = fwt(X[:m]), fwt(X[m:])<br/>    for i in xrange(m):<br/>        A.append(A[i] + B[i])<br/>    return A<br/><br/>def rfwt(X):<br/>    if len(X) == 1:<br/>        return X<br/><br/>    m = len(X) >> 1<br/>    A, B = rfwt(X[:m]), rfwt(X[m:])<br/>    for i in xrange(m):<br/>        A.append(B[i] - A[i])<br/>    return A<br/><br/>def cnt(x):<br/>    r = 0<br/>    while x:<br/>        x ^= x & (-x)<br/>        r += 1<br/>    return r<br/><br/>def add(A, B):<br/>    return [A[x] + B[x] for x in xrange(len(A))]<br/><br/>def mul(A, B):<br/>    return [A[x] * B[x] for x in xrange(len(A))]<br/><br/>def show(X):<br/>    print ' '.join(map(str, X))<br/><br/>k = cnt(n - 1) + 1<br/>F = [[0] * n for i in xrange(k)]<br/>G = [[0] * n for i in xrange(k)]<br/>H = [[0] * n for i in xrange(k)]<br/><br/># \u6309\u7167\u5927\u5c0f\u5206\u7ec4<br/>for i in xrange(n):<br/>    c = cnt(i)<br/>    F[c][i] = f[i]<br/>    G[c][i] = g[i]<br/><br/># \u63d0\u524d\u8fdb\u884c FWT<br/>for i in xrange(k):<br/>    F[i] = fwt(F[i])<br/>    G[i] = fwt(G[i])<br/><br/># \u5377\u79ef\u90e8\u5206<br/>for i in xrange(k):<br/>    for j in xrange(k - i):<br/>        print i, j<br/>        H[i + j] = add(H[i + j], mul(F[i], G[j]))<br/><br/>for i in xrange(k):<br/>    H[i] = rfwt(H[i])<br/><br/># \u8ba1\u7b97\u7ed3\u679c<br/>R = [0] * n<br/>for i in xrange(n):<br/>    c = cnt(i)<br/>    R[i] = H[c][i]<br/><br/>show(R)<br/><br/><br/><br/><br/><br/><br/>\u5f53\u7136\u9700\u8981\u4fdd\u8bc1\u6dfb\u52a0\u5b8c $0$ \u540e\u7ed3\u679c\u7684\u754c\u4e0d\u53d8\u3002\u6570\u503c\u4e0a\u4e0d\u4f1a\u6709\u5f71\u54cd\u3002\u00a0\u21a9<br/><br/><br/>\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u5c06$m$\u548c$n$\u8bbe\u4e3a$0$\uff1f\u56e0\u4e3a\u90a3\u6837\u592ana\u00efve\u4e86\uff0c\u4f60\u5f97\u5230\u7684$T$\u662f\u96f6\u77e9\u9635\u3002\u00a0\u21a9<br/><br/><br/>\u6709\u65f6\u4e5f\u79f0 FWHT\u3002\u00a0\u21a9<br/><br/><br/>\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u77e9\u9635\uff0c\u6240\u4ee5\u8fd9\u4e2a\u53d8\u6362\u662f\u7ebf\u6027\u53d8\u6362\uff0c\u4f60\u53ef\u4ee5\u6709\u5176\u5b83\u7684\u5199\u6cd5\u3002\u00a0\u21a9<br/><br/><br/>\u53ef\u4ee5\u53c2\u89c1\u6211\u7684\u535a\u5ba2\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-11-25/fwt.html"
},
"\u516c\u5e73\u7ec4\u5408\u6e38\u620f": {
"tags": "\u516c\u5e73\u7ec4\u5408\u6e38\u620f Sprague-Grundy\u5b9a\u7406 SG\u51fd\u6570 \u535a\u5f08\u8bba",
"text": "\u516c\u5e73\u7ec4\u5408\u6e38\u620f<br/>\u5e94\u8be5\u662f2016\u5e74\u7684\u6700\u540e\u4e00\u7bc7\u535a\u5ba2\u4e86\uff0cGoodbye 2016\uff01<br/>\u5b9a\u4e49<br/>\u516c\u5e73\u7ec4\u5408\u6e38\u620f\u4e0e\u5e73\u5e38\u7684\u6e38\u620f\u7c7b\u4f3c\uff0c\u4f46\u662f\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u8981\u6c42\uff1a<br/><br/>\u6709\u4e24\u4e2a\u73a9\u5bb6\u8f6e\u6d41\u884c\u52a8\u3002<br/>\u53cc\u65b9\u7684\u6e38\u620f\u65b9\u5f0f\u4e00\u81f4\u3002<br/>\u53cc\u65b9\u5747\u77e5\u9053\u6e38\u620f\u7684\u5b8c\u6574\u4fe1\u606f\u3002<br/>\u4ee5\u73a9\u5bb6\u65e0\u6cd5\u884c\u52a8\u4e3a\u6e38\u620f\u7ed3\u675f\u3002<br/>\u6e38\u620f\u5728\u6709\u9650\u6b65\u6570\u5185\u7ed3\u675f\uff0c\u5e76\u4e14\u4e00\u5b9a\u80fd\u5206\u51fa\u80dc\u8d1f\u3002<br/><br/>\u7ecf\u5178\u7684Nim\u6e38\u620f\u5c31\u662f\u516c\u5e73\u7ec4\u5408\u6e38\u620f\u7684\u4ee3\u8868\uff0c\u4f46\u662f\u56f4\u68cb\u3001\u8c61\u68cb\u4ee5\u53ca\u4e95\u5b57\u68cb\u8fd9\u4e9b\u4e0d\u5c5e\u4e8e\uff0c\u56e0\u4e3a\u8fd9\u4e09\u79cd\u53cc\u65b9\u7684\u884c\u52a8\u4e0d\u540c\u3002\u800c\u4e14\u50cf\u4e95\u5b57\u68cb\uff0c\u53ef\u80fd\u5b58\u5728\u5e73\u5c40\u3002<br/>\u7b80\u5355Nim\u6e38\u620f<br/>\u73b0\u5728\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684Nim\u6e38\u620f\u6765\u4ecb\u7ecd\u4e00\u4e9b\u6982\u5ff5\u3002\u8fd9\u4e2aNim\u6e38\u620f\u89c4\u5b9a\u5982\u4e0b\uff1a<br/><br/>\u4e00\u5f00\u59cb\u6709$n$\u4e2a\u77f3\u5b50\u3002<br/>\u53cc\u65b9\u8f6e\u6d41\u53d6\u77f3\u5b50\uff0c\u5fc5\u987b\u53d6\u4e00\u9897\u6216\u4e24\u9897\u3002<br/>\u65e0\u6cd5\u53d6\u77f3\u5b50\u8005\u5931\u8d25\u3002<br/><br/>\u5bf9\u4e8e\u8fd9\u4e2a\u6e38\u620f\uff0c\u6211\u4eec\u60f3\u77e5\u9053\uff0c\u5728\u53cc\u65b9\u90fd\u5341\u5206\u806a\u660e\u7684\u60c5\u51b5\u4e0b\uff0c\u5148\u624b/\u540e\u624b\u662f\u5426\u5fc5\u80dc\u3002\u6216\u8005\u7ed9\u51fa\u4e00\u4e2a\u5fc5\u80dc\u7684\u7b56\u7565\u3002<br/>\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5206\u6790\u4e00\u4e0b\u3002\u4ee5\u5148\u624b\u4e3a\u4f8b\uff0c\u5982\u679c\u6ca1\u6709\u77f3\u5b50\uff0c\u90a3\u4e48\u4e00\u5f00\u573a\u5c31\u7b97\u8f93\u3002\u5982\u679c\u53ea\u6709\u4e00\u9897\u6216\u4e24\u9897\u77f3\u5b50\uff0c\u90a3\u4e48\u5148\u624b\u53ef\u4ee5\u9a6c\u4e0a\u53d6\u8d70\u5e76\u83b7\u5f97\u80dc\u5229\u3002\u7136\u800c\uff0c\u5f53\u6709$3$\u9897\u77f3\u5b50\u65f6\uff0c\u4f60\u4f1a\u53d1\u73b0\u65e0\u8bba\u600e\u4e48\u53d6\uff0c\u5148\u624b\u90fd\u4f1a\u8f93\u6389\u6bd4\u8d5b\uff0c\u56e0\u4e3a\u65e0\u6cd5\u4e00\u6b21\u53d6\u8d70\u6240\u6709\u7684\u77f3\u5b50\uff0c\u800c\u540e\u624b\u5728\u4f60\u53d6\u5b8c\u4e00\u6b21\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u53d8\u6210\u4e86\u77f3\u5b50\u6570\u4e3a$1$\u6216$2$\u7684\u5148\u624b\uff0c\u90a3\u4e48\u540e\u624b\u5fc5\u8d62\u3002<br/>\u5b9e\u9645\u4e0a\uff0c\u5f53$n \\\\;\\\\mathrm{mod}\\\\; 3 = 0$\u7684\u65f6\u5019\uff0c\u5148\u624b\u4f1a\u5fc5\u8f93\uff0c\u5426\u5219\u540e\u624b\u5fc5\u8f93\uff0c\u6b64\u65f6\u5148\u624b\u53ea\u7528\u4fdd\u8bc1\u6bcf\u6b21\u81ea\u5df1\u53d6\u5b8c\u4e4b\u540e\u77f3\u5b50\u7684\u6570\u91cf\u90fd\u662f$3$\u7684\u500d\u6570\u5373\u53ef\u3002<br/>\u5fc5\u80dc\u4e0e\u5fc5\u8d25<br/>\u6211\u4eec\u89c4\u5b9a\u4e00\u4e2a\u4f4d\u7f6e (\u4f8b\u5982\u4e0a\u9762\u7684Nim\u6e38\u620f\u4e2d\u77f3\u5b50\u7684\u4e2a\u6570) \u662f$\\\\mathrm{N}$\u70b9\u662f\u5f53\u6b64\u65f6\u5148\u624b\u7684\u4eba\u5fc5\u80dc\u7684\u4f4d\u7f6e\uff0c\u800c$\\\\mathrm{P}$\u70b9\u5219\u662f\u6b64\u65f6\u5148\u624b\u7684\u4eba\u5fc5\u8f93\u7684\u4f4d\u7f6e1\u3002\u4f8b\u5982\uff0c\u5f53$n = 0$\u65f6 (\u4e0b\u9762\u7b80\u5199\u4e3a$0$)\uff0c\u5148\u624b\u662f\u5fc5\u8f93\u7684\u3002\u56e0\u6b64$0$\u662f$\\\\mathrm{P}$\u70b9\u3002\u800c\u5728$1$\u548c$2$\u65f6\uff0c\u5148\u624b\u4f1a\u5fc5\u80dc\uff0c\u6240\u4ee5\u5b83\u4eec\u662f$\\\\mathrm{N}$\u70b9\u3002<br/>\u7b80\u5355\u5206\u6790\u53ef\u77e5\uff1a<br/><br/>\u7ec8\u6b62\u4f4d\u7f6e\u662f$\\\\mathrm{P}$\u70b9\u3002<br/>\u6240\u80fd\u5230\u8fbe\u7684\u4f4d\u7f6e\u90fd\u662f$\\\\mathrm{N}$\u70b9\u7684\u4f4d\u7f6e\u662f$\\\\mathrm{P}$\u70b9\u3002<br/>\u80fd\u591f\u5230\u8fbe$\\\\mathrm{P}$\u70b9\u7684\u4f4d\u7f6e\u662f$\\\\mathrm{N}$\u70b9\u3002<br/><br/>\u4f8b\u5982\uff0c\u5728$3$\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u53d6\u8d70\u4e00\u4e2a\u77f3\u5b50\u4f1a\u5230\u8fbe$2$\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u53d6\u8d70\u4e24\u4e2a\u77f3\u5b50\u4f1a\u5230\u8fbe$1$\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u800c\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\u90fd\u662f$\\\\mathrm{N}$\u70b9\uff0c\u6240\u4ee5$3$\u662f$\\\\mathrm{P}$\u70b9\u3002\u56e0\u6b64$3$\u4e2a\u77f3\u5b50\u65f6\u5148\u624b\u5fc5\u8d25\u3002<br/>\u56fe\u7684\u8868\u793a<br/>\u5982\u679c\u5c06\u6bcf\u4e2a\u4f4d\u7f6e\u7528\u70b9\u8868\u793a\uff0c\u800c\u4f4d\u7f6e\u4e4b\u95f4\u7684\u8f6c\u79fb\u7528\u6709\u5411\u8fb9\u8868\u793a\uff0c\u90a3\u4e48$0$\u5230$3$\u4e4b\u95f4\u7684\u5173\u7cfb\u53ef\u4ee5\u7531\u4e0b\u56fe\u8868\u793a\uff1a<br/><br/>\u7531\u4e8e\u6e38\u620f\u662f\u6709\u9650\u6b65\u6570\u7684\uff0c\u6240\u4ee5\u8fd9\u5f20\u56fe\u5fc5\u987b\u662f\u62d3\u6251\u56fe\u3002\u5728\u8fd9\u56fe\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u6ca1\u6709\u51fa\u8fb9\u7684\u70b9\u6807\u8bb0\u4e3a$\\\\mathrm{P}$\u70b9\uff0c\u7136\u540e\u6839\u636e\u4e0a\u9762\u7684\u89c4\u5219\u5c31\u53ef\u4ee5\u8fa8\u8bc6\u6240\u6709\u7684\u4f4d\u7f6e\u662f$\\\\mathrm{N}$\u70b9\u8fd8\u662f$\\\\mathrm{P}$\u70b9\u3002\u7531\u6b64\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c\u4e00\u4e2a\u516c\u5e73\u7ec4\u5408\u6e38\u620f\u5fc5\u5b9a\u80fd\u5206\u51fa\u80dc\u8d1f\u3002<br/>Sprague-Grundy\u5b9a\u7406<br/>\u73b0\u5728\u6211\u4eec\u5c06\u4f4d\u7f6e\u7528\u56fe$G(V, E)$\u4e0a\u7684\u70b9\u8868\u793a\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9$u$\uff0c\u90a3\u4e48\u5b9a\u4e49\u5b83\u7684SG\u51fd\u6570$g$\u4e3a\uff1a<br/>$$<br/>g(u) = \\\\mathrm{mex}(\\\\{g(v) : \\\\forall (u, v) \\\\in E\\\\})<br/>$$<br/>$\\\\mathrm{mex}$\u662f\u5b9a\u4e49\u57df\u5728\u96c6\u5408\u4e0a\u7684\u51fd\u6570\uff0c\u8fd4\u56de\u8fd9\u4e2a\u96c6\u5408\u4e2d\u6700\u5c0f\u7684\u6ca1\u51fa\u73b0\u8fc7\u7684\u975e\u8d1f\u6574\u6570\u3002<br/>\u4f8b\u5982\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>& \\\\mathrm{mex}(\\\\varnothing) & = 0 \\\\\\\\<br/>& \\\\mathrm{mex}(\\\\{0\\\\}) & = 1 \\\\\\\\<br/>& \\\\mathrm{mex}(\\\\{0, 1, 2, 4, 5\\\\}) & = 3<br/>\\\\end{aligned}<br/>$$<br/>\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6ca1\u6709\u51fa\u8fb9\u7684\u70b9\uff0c\u5176$g$\u503c\u4e3a$0$\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8fd9\u4e9b\u70b9\u90fd\u662f$\\\\mathrm{P}$\u70b9\u3002\u5982\u679c\u6211\u4eec\u8ba1\u7b97\u4e4b\u524d\u51fa\u73b0\u7684\u56fe\u4e2d\u7684$g$\u503c\uff1a<br/><br/>\u4e0a\u56fe\u4e2d$0$\u548c$3$\u90fd\u662f$0$\uff0c$1$\u548c$2$\u90fd\u4e0d\u662f$0$\u3002\u5341\u5206\u5de7\u5408\u7684\u662f\uff0c$0$\u548c$3$\u662f$\\\\mathrm{P}$\u70b9\uff0c$1$\u548c$2$\u662f$\\\\mathrm{N}$\u70b9\u3002<br/>\u5bf9\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\u4e0b\u9762\u4e00\u70b9\uff1a<br/><br/>\u4f4d\u7f6e$p$\u662f$\\\\mathrm{P}$\u70b9\u5f53\u4e14\u4ec5\u5f53$g(p) = 0$\u3002<br/><br/>\u8bc1\u660e\uff1a\u9996\u5148\u5bf9\u4e8e\u6ca1\u6709\u51fa\u8fb9\u7684\u70b9\uff0c\u5b83\u4eec\u662f$\\\\mathrm{P}$\u70b9\uff0c\u5e76\u4e14\u5176$g$\u503c\u4e3a$0$\u3002\u540c\u65f6\uff0c\u6240\u6709\u80fd\u5230\u8fbe\u7684\u8fd9\u4e9b\u70b9\u7684\u70b9\uff0c\u5176$g$\u503c$\\\\gt 0$\uff0c\u5e76\u4e14\u4e3a$\\\\mathrm{N}$\u70b9\u3002<br/>\u5bf9\u4e8e\u5176\u4ed6\u7684\u70b9\uff0c\u5982\u679c\u662f$\\\\mathrm{N}$\u70b9\uff0c\u90a3\u4e48\u5b83\u4e00\u5b9a\u80fd\u5230\u8fbe\u4e00\u4e2a$\\\\mathrm{P}$\u70b9\uff0c\u6240\u4ee5\u5176$g$\u503c\u4e0d\u80fd\u4e3a$0$\u3002\u5982\u679c\u662f$\\\\mathrm{P}$\u70b9\uff0c\u90a3\u4e48\u5b83\u6240\u80fd\u5230\u8fbe\u7684\u70b9\u90fd\u662f$\\\\mathrm{N}$\u70b9\uff0c\u8fd9\u4e9b\u70b9\u4e2d\u6ca1\u6709\u8c01\u7684$g$\u503c\u662f$0$\uff0c\u6240\u4ee5\u5176$g$\u503c\u4e3a$0$\u3002<br/>\u8fd9\u6837\u6211\u4eec\u62e5\u6709\u4e86\u4e00\u4e2a\u91cf\u5316\u80dc\u8d1f\u7684\u51fd\u6570\u3002\u4f46\u662f\u5bf9\u4e8e\u4e0a\u9762\u8fd9\u4e2a\u7b80\u5355Nim\u6e38\u620f\u5e76\u6ca1\u6709\u4ec0\u4e48\u597d\u5904\uff0c\u56e0\u4e3a\u4e0a\u9762\u7684\u8ba1\u7b97\u5b8c\u5168\u53ef\u4ee5\u5229\u7528\u903b\u8f91\u8fd0\u7b97\u800c\u4e0d\u9700\u8981\u8ba1\u7b97\u4ec0\u4e48$\\\\mathrm{mex}$\u3002<br/>\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4f60\u6240\u89c1\u5230\u7684\u6240\u8c13Nim\u6e38\u620f\u5e76\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\uff1a\u5b83\u901a\u5e38\u6709\u8bb8\u591a\u5806\u77f3\u5b50\uff0c\u5141\u8bb8\u4efb\u610f\u53d6\u8d70 (\u6216\u662f\u53d6\u8d70\u6307\u5b9a\u6570\u91cf\u7684\u77f3\u5b50)\uff0c\u6b64\u65f6\u518d\u53bb\u95ee\u4f60\u5148\u624b\u662f\u5fc5\u80dc\u8fd8\u662f\u5fc5\u8d25\u3002<br/>\u8fd9\u5e76\u6ca1\u6709\u4ec0\u4e48\u96be\u7684\uff0c\u6211\u4eec\u4f9d\u7136\u53ef\u4ee5\u5c06\u8bb8\u591a\u5806\u77f3\u5b50\u653e\u5165\u591a\u5143\u7ec4\u6765\u6784\u6210\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u4f9d\u7136\u53ef\u4ee5\u8ba1\u7b97\u8fd9\u4e2a\u4f4d\u7f6e\u662f$\\\\mathrm{N}$\u70b9\u8fd8\u662f$\\\\mathrm{P}$\u70b9\u3002\u4f46\u662f\uff0c\u5f53\u77f3\u5b50\u6570\u91cf\u6bd4\u8f83\u591a\u65f6\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u589e\u957f\u51e0\u4e4e\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u5373\u4f7f\u662f\u591a\u5806\u77f3\u5b50\uff0c\u5b83\u4f9d\u7136\u53ef\u4ee5\u5206\u89e3\u4e3a\u591a\u4e2a\u4e00\u5806\u7684Nim\u6e38\u620f\uff0c\u6bcf\u6b21\u884c\u52a8\u65f6\uff0c\u73a9\u5bb6\u53ef\u4ee5\u4efb\u610f\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u6e38\u620f\u6765\u884c\u52a8\u3002\u4e0d\u59a8\u7528$G_1(V_1, E_1)$\u548c$G_2(V_2, E_2)$\u4e24\u5f20\u56fe\u6765\u8868\u793a\u4e24\u4e2a\u516c\u5e73\u7ec4\u5408\u6e38\u620f\uff0c\u90a3\u4e48\u5b9a\u4e49$G(V, E) = G_1 + G_2$\u4e3a\u6e38\u620f\u7684\u7ec4\u5408\uff0c\u5373\u65b0\u6e38\u620f$G$\u53ef\u4ee5\u6bcf\u4e00\u6b65\u5728$G_1$\u4e2d\u884c\u52a8\uff0c\u6216\u662f\u5728$G_2$\u4e2d\u884c\u52a8\u3002\u6211\u4eec\u9700\u8981\u5c06\u4e24\u5f20\u56fe\u52a0\u5408\u4e3a\u4e00\u5f20\u56fe\uff0c\u6240\u4ee5\u5bf9\u4e8e$u \\\\in V_1$\u548c$v \\\\in V_2$\u7684\u4e24\u4e2a\u70b9\uff0c\u5728$G$\u4e2d\u5c06\u53d8\u4e3a\u4e00\u4e2a\u70b9$(u, v)$\u3002\u540c\u65f6\u548c$u$\u3001$v$\u76f8\u5173\u7684\u8fb9\u90fd\u8fde\u5411\u8fd9\u4e2a\u70b9\u3002<br/>\u53ef\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4e0d\u4f1a\u5173\u5fc3\u8fd9\u4e2a\u56fe\u662f\u4ec0\u4e48\u6837\u7684\uff0c\u56e0\u4e3a\u5b83\u5b9e\u5728\u662f\u592a\u590d\u6742\u4e86\u3002\u4f46\u662f\u5374\u6709\u4e00\u4e2a\u5f88\u597d\u7684\u6027\u8d28\uff1a<br/><br/>(Sprague-Grundy\u5b9a\u7406)<br/>\u4ee4$G = G_1 + G_2 + \\\\cdots + G_n$\uff0c\u8bbe$G_i$\u7684SG\u51fd\u6570\u4e3a$g_i$\uff0c$G$\u7684SG\u51fd\u6570\u4e3a$g$\uff0c\u90a3\u4e48\u6709\uff1a<br/>$$ g(X) = g((x_1, x_2, \\\\dots, x_n)) = g_1(x_1) \\\\oplus g_2(x_2) \\\\oplus \\\\cdots \\\\oplus g_n(x_n) $$<br/>\u5176\u4e2d$X \\\\in V, x_i \\\\in V_i$\uff0c$\\\\oplus$\u662f\u5f02\u6216\u8fd0\u7b97\u3002<br/><br/>\u8bc1\u660e\uff1a\u5728\u8fd9\u91cc\u4e0d\u518d\u4ecb\u7ecd\u5f02\u6216\u4e86\uff0c\u5982\u679c\u4e0d\u4e86\u89e3\u7684\u53ef\u4ee5\u5148\u53bb\u770b\u4e00\u4e0b\u3002<br/>\u6839\u636eSG\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u53ea\u7528\u8bc1\u660e\u4ee5\u4e0b\u4e24\u70b9\u5c31\u53ef\u4ee5\u5b8c\u6210\u6574\u4e2a\u5b9a\u7406\u7684\u8bc1\u660e\uff1a<br/>\u8bbe$b = g_1(x_1) \\\\oplus g_2(x_2) \\\\oplus \\\\cdots \\\\oplus g_n(x_n)$\u3002<br/><br/>\u5bf9\u4e8e\u6240\u6709\u7684$0 \\\\leqslant a \\\\lt b$\uff0c$X$\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u53ef\u4ee5\u5230\u8fbe\u7684\u4f4d\u7f6e\uff0c\u6ee1\u8db3\u5176$g$\u503c\u4e3a$a$\u3002<br/>\u5bf9\u4e8e\u6240\u6709$X$\u6240\u53ef\u4ee5\u5230\u8fbe\u7684\u4f4d\u7f6e\uff0c\u6ca1\u6709$g$\u503c\u4e3a$b$\u3002<br/><br/>\u8bc1\u660e$(1)$\uff1a\u8bbe$d = a \\\\oplus b$\u3002\u8bbe$d$\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u7684\u6700\u9ad8\u4f4d\u7684\u4f4d\u7f6e\u4e3a$k$\u3002\u7531\u4e8e$a \\\\lt b$\uff0c\u6240\u4ee5\u4e00\u5b9a\u6709$a$\u7684\u7b2c$k$\u4f4d\u4e3a$0$\uff0c\u5e76\u4e14$b$\u7684\u7b2c$k$\u4f4d\u4e3a$1$\u3002\u7531\u4e8e$b = g_1(x_1) \\\\oplus g_2(x_2) \\\\oplus \\\\cdots \\\\oplus g_n(x_n)$\uff0c\u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a$g_i(x_i)$\u7684\u7b2c$k$\u4f4d\u4e3a$1$\u3002\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u8bbe$i = 1$\uff0c\u90a3\u4e48\u53ef\u4ee5\u77e5\u9053$d \\\\oplus g_1(x_1) \\\\lt g_1(x_1)$\uff0c\u6240\u4ee5\u5b58\u5728\u4e00\u4e2a\u4f4d\u7f6e$x^\\\\prime_1$\u80fd\u591f\u4ece$x_1$\u8f6c\u79fb\u8fc7\u6765\uff0c\u5e76\u4e14\u6ee1\u8db3$g_1(x^\\\\prime_1) = d \\\\oplus g_1(x_1)$\u3002\u8fd9\u76f8\u5f53\u4e8e\u5728$G_1$\u4e2d\u884c\u52a8\u4e00\u6b65\uff0c\u6240\u4ee5$(x_1, x_2, \\\\dots, x_n)$\u4e5f\u5b58\u5728\u4e00\u4e2a\u8f6c\u79fb\u5230$(x^\\\\prime_1, x_2, \\\\dots, x_n)$\u7684\u884c\u52a8\uff0c\u800c\u6b64\u65f6\u6709\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>a & = g_1(x^\\\\prime_1) \\\\oplus g_2(x_2) \\\\oplus \\\\cdots \\\\oplus g_n(x_n) \\\\\\\\<br/>& = d \\\\oplus g_1(x_1) \\\\oplus g_2(x_2) \\\\oplus \\\\cdots \\\\oplus g_n(x_n) \\\\\\\\<br/>& = d \\\\oplus b<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5$(1)$\u6210\u7acb\u3002<br/>\u8bc1\u660e$(2)$\uff1a\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u5047\u8bbe\u6211\u4eec\u5728$G_1$\u4e2d\u4ece$x_1$\u884c\u52a8\u5230$x^\\\\prime_1$\uff0c\u90a3\u4e48\u6839\u636eSG\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u6709$g_1(x_1) \\\\neq g_1(x^\\\\prime_1)$\uff0c\u6240\u4ee5$b \\\\oplus g_1(x_1) \\\\oplus g_1(x^\\\\prime_1) \\\\neq b$\uff0c\u6240\u4ee5$(2)$\u6210\u7acb\u3002<br/>\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u7ecf\u6210\u529f\u8bc1\u660e\u4e86Sprague-Grundy\u5b9a\u7406\u3002\u73b0\u5728\u6211\u4eec\u5c1d\u8bd5\u5c06\u5176\u8fd0\u7528\u5230Nim\u6e38\u620f\u4e0a\uff1a<br/>\u9996\u5148\u5bf9\u4e8e\u4e00\u5806\u77f3\u5b50\u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u53d6\u8d70\u4efb\u610f\u6570\u91cf\u4e0d\u4e3a$0$\u7684\u77f3\u5b50\uff0c\u6240\u4ee5\u53ea\u8981\u4e0d\u662f\u6ca1\u6709\u77f3\u5b50\uff0c\u5148\u624b\u53ef\u4ee5\u4e00\u6b21\u53d6\u5b8c\u3002\u7b80\u5355\u63a8\u7406\u53ef\u4ee5\u77e5\u9053$g(n) = n$\u3002\u5373\u53ea\u8981\u6709\u77f3\u5b50\u5c31\u5148\u624b\u5fc5\u80dc\u3002<br/>\u73b0\u5728\u6211\u4eec\u6709\u8bb8\u591a\u5806\u77f3\u5b50\uff0c\u6bcf\u4e00\u5806\u77f3\u5b50\u90fd\u53ef\u4ee5\u89c6\u4e3a\u4e00\u4e2aNim\u6e38\u620f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6e38\u620f\u5c31\u662f\u8bb8\u591aNim\u6e38\u620f\u52a0\u5408\u3002\u6839\u636eSprague-Grundy\u5b9a\u7406\uff0c\u5982\u679c\u6bcf\u4e00\u5806\u77f3\u5b50\u7684\u4e2a\u6570\u4e3a$x_i$\uff0c\u90a3\u4e48SG\u51fd\u6570\u5c31\u662f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>g((x_1, x_2, \\\\dots, x_n)) & = g(x_1) \\\\oplus g(x_2) \\\\oplus \\\\cdots \\\\oplus g(x_n)  \\\\\\\\<br/>& = x_1 \\\\oplus x_2 \\\\oplus \\\\cdots \\\\oplus x_n<br/>\\\\end{aligned}<br/>$$<br/>\u6362\u8a00\u4e4b\uff0c\u5982\u679c\u6bcf\u5806\u77f3\u5b50\u6570\u5f02\u6216\u8d77\u6765\u5982\u679c\u4e0d\u4e3a$0$\uff0c\u90a3\u4e48\u5148\u624b\u5c31\u5fc5\u80dc\uff0c\u5426\u5219\u5c06\u4f1a\u5fc5\u8d25\u3002\u8fd9\u786e\u5b9e\u662f\u4e00\u4e2a\u975e\u5e38\u795e\u5947\u7684\u7ed3\u8bba\u3002\u540c\u65f6\uff0c\u7ed3\u5408\u4e4b\u524d\u5173\u4e8e$\\\\mathrm{N}$\u70b9\u548c$\\\\mathrm{P}$\u7684\u4e00\u4e9b\u8ba8\u8bba\uff0c\u6211\u4eec\u77e5\u9053\u53ea\u8981\u80fd\u4f7f\u5f02\u6216\u548c\u53d8\u4e3a$0$\u7684\u64cd\u4f5c\u5c31\u662f\u6211\u4eec\u7684\u5148\u624b\u5fc5\u80dc\u7b56\u7565\u3002<br/><br/><br/><br/><br/>N\u610f\u4e3a\u201dNext\u201d\uff0c\u5373\u6267\u884c\u8fd9\u4e00\u6b65\u7684\u4eba\u4f1a\u8d62\u3002P\u610f\u4e3a\u201dPrevious\u201d\uff0c\u5373\u6267\u884c\u4e0a\u4e00\u6b65\u7684\u4eba\u4f1a\u8d62\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-12-30/sg.html"
},
"\u5173\u4e8e": {
"tags": "About",
"text": "\u5173\u4e8e<br/>riteme \u6765\u81ea HNSDFZ / FDU\u3002<br/>sitegen.py<br/>\u4f7f\u7528 Python 3 \u7f16\u5199\u7684\u4e0d\u6e05\u771f\u7ad9\u70b9\u751f\u6210\u5668\u3002<br/>\u53c2\u89c1\u5de6\u4fa7\u680f \u201cGitHub \u9879\u76ee\u201d\u3002<br/>\u9700\u8981\u7684\u4f9d\u8d56\uff1a<br/><br/>Python 3 (>= 3.4)<br/>Python Markdown<br/>Pygments (\u7528\u4e8e\u63d0\u4f9b\u4ee3\u7801\u9ad8\u4eae)<br/>Beautiful Soup 4<br/><br/>\u72ec\u7acb\u6a21\u5757\u529f\u80fd\uff1a<br/><br/>info: \u63d0\u53d6\u6587\u6863\u57fa\u672c\u4fe1\u606f (\u53f3\u4e0a\u89d2)\u3002<br/>navigater: \u8f85\u52a9\u6587\u4ef6\u5939\u5bfc\u822a\u3002<br/>parser: Markdown \u9636\u6bb5\u9884\u5904\u7406\u7279\u6b8a\u8bed\u6cd5\u3002<br/>tag: \u6807\u7b7e\u751f\u6210\u3002<br/>tipuesearch: \u751f\u6210 Tipuesearch \u7684\u641c\u7d22\u6570\u636e\u3002<br/>tocer: \u63d0\u53d6\u5e76\u751f\u6210\u76ee\u5f55\u3002<br/><br/>\u53ef\u6267\u884c\u5de5\u5177\uff1a<br/><br/>pagegen.py: \u7528\u4e8e\u751f\u6210\u5355\u4e2a\u9875\u9762\u3002<br/>sitegen.py: \u7528\u4e8e\u751f\u6210\u6574\u4e2a\u7f51\u7ad9\u3002<br/>setup.py: \u7b80\u5355\u7f51\u7ad9\u67b6\u8bbe\u5de5\u5177\u3002<br/><br/>Material Design<br/>\u4f7f\u7528\u7684\u662f\u529f\u80fd\u6bd4\u8f83\u7b80\u5355\u7684 Material Design Lite\uff0c\u800c\u4e14\u7248\u672c\u5df2\u7ecf\u6bd4\u8f83\u8001\u4e86QAQ\u3002<br/>\u4e3b\u9898\u98ce\u683c\u90fd\u662f\u6211\u81ea\u5df1 xjb \u8c03\u7684\u3002<br/>\u76ee\u524d\u9875\u9762\u4e0a\u8fd8\u662f\u6709\u4e00\u4e9b\u5df2\u77e5\u7684\u5c0f\u95ee\u9898\uff0c\u6709\u4e9b\u662f\u8001\u7248\u672c MDL \u7684\u9505\uff0c\u5b9e\u5728\u662f\u6ca1\u7cbe\u529b\u6362\u6846\u67b6\u4e86 TAT\u3002<br/>\u6570\u5b66\u516c\u5f0f<br/>\u4f7f\u7528 MathJax \u548c KaTeX\u3002<br/>\u4ee5\u540e\u8ba1\u5212\u629b\u5f03\u7b28\u91cd\u7684 MathJax\uff0c\u6362\u7528\u6e05\u771f\u7684 KaTeX\u3002<br/>\u6b63\u5728\u5c1d\u8bd5 KaTeX......\u4f46\u73b0\u5b9e\u5f88\u6b8b\u9177\uff0cKaTeX \u5bb9\u9519\u6027\u5b9e\u5728\u4e0d\u884c\uff0c\u56e0\u6b64\u53d8\u6210\u4e86\u6d4f\u89c8\u8005\u53ef\u5728 MathJax \u548c KaTeX \u4e4b\u95f4\u4e8c\u9009\u4e00\u3002<br/>\u5b9e\u9645\u4e0a KaTeX \u80fd\u591f\u65e0\u9519\u6e32\u67d3\u7684\u6587\u7ae0\u771f\u7684\u4e0d\u591a...... KaTeX 0.10.0 \u7248\u672c\u5927\u8d5e\uff01<br/>\u7ad9\u5185\u641c\u7d22<br/>\u4f7f\u7528 Tipuesearch\u3002<br/>Tipuesearch \u6709\u4e2a\u7f3a\u70b9\u5c31\u662f\u9700\u8981\u6d4f\u89c8\u5668\u5c06\u641c\u7d22\u6570\u636e\u4e0b\u8f7d\u4e0b\u6765\u3002\u800c\u8fd9\u4e2a\u6587\u4ef6\u901a\u5e38\u5f88\u5927\u3002\u4ee5\u540e\u53ef\u80fd\u4f1a\u8003\u8651\u6362\u6210\u5176\u5b83\u7684\u4e1c\u897f\u3002<br/>\u8bc4\u8bba<br/>\u4f7f\u7528 Gitment\u3002<br/>\u81ea\u884c\u9b54\u6539\u4e86\u4e0b JS \u6587\u4ef6\u7ed9\u6c49\u5316\u4e86\u3002\u4e0d\u77e5\u9053\u73b0\u5728 Gitment \u81ea\u5df1\u6709\u6ca1\u6709\u63d0\u4f9b\u591a\u8bed\u8a00\u652f\u6301\u3002<br/>\u53cb\u94fe<br/>\u6b22\u8fce\u4e92\u6362\u53cb\u94fe ~ ~ ~<br/>\u60f3\u6362\u53cb\u94fe\u7684\u53ef\u4ee5\u76f4\u63a5\u5728\u8bc4\u8bba\u91cc\u7559\u8a00 ~ ~ ~<br/>\u8054\u7cfb\u6211<br/>\u6211\u7684\u90ae\u7bb1\uff1ariteme@qq.com<br/>\u6211\u7684 GitHub\uff1ahttps://github.com/riteme<br/>\u6211\u7684\u77e5\u4e4e\uff1ahttps://www.zhihu.com/people/riteme",
"url": "about.html"
},
"\u51f8\u5305\u76f8\u5173": {
"tags": "\u51f8\u5305 \u8ba1\u7b97\u51e0\u4f55 \u6570\u636e\u7ed3\u6784 \u659c\u7387\u4f18\u5316 \u65cb\u8f6c\u5361\u58f3",
"text": "\u51f8\u5305\u76f8\u5173<br/>\u5b9a\u4e49<br/>\u901a\u5e38\u8bf4\u7684\u51f8\u5305\u662f\u6307\u4e00\u4e2a\u70b9\u96c6\u7684\u51f8\u5305\uff0c\u5e76\u4e14\u662f\u6307\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a1\u3002\u8fd9\u79cd\u51f8\u5305\u672c\u8eab\u662f\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62\uff0c\u7531\u70b9\u96c6\u4e2d\u7684\u70b9\u6784\u6210\uff0c\u5e76\u4e14\u8981\u6c42\u51f8\u5305\u4e0a\u7684\u70b9\u5c3d\u53ef\u80fd\u5c11\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u51f8\u5305\u7684\u793a\u4f8b\uff1a<br/><br/>\u5bf9\u4e8e\u5176\u5b83\u7684\u56fe\u5f62\uff0c\u4e5f\u53ef\u4ee5\u6709\u51f8\u5305\uff0c\u5982\u7ebf\u6bb5\u7684\u51f8\u5305\uff1a<br/><br/>\u5b9e\u9645\u4e0a\u7ebf\u6bb5\u7684\u51f8\u5305\u5c31\u662f\u6240\u6709\u7ebf\u6bb5\u7684\u7aef\u70b9\u7684\u51f8\u5305\u3002\u66f4\u4e00\u822c\u7684\uff0c\u591a\u8fb9\u5f62\u7684\u51f8\u5305\u5c31\u662f\u6240\u6709\u591a\u8fb9\u5f62\u7684\u9876\u70b9\u7684\u51f8\u5305\u3002<br/>\u800c\u66f2\u7ebf\u56fe\u5f62\u7684\u51f8\u5305\u5219\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\uff0c\u4ece\u5706\u7684\u51f8\u5305\u5c31\u53ef\u89c1\u4e00\u7aa5\uff1a<br/><br/>\u4e0b\u9762\u7684\u6587\u7ae0\u5c06\u4e0d\u8ba8\u8bba\u4e0e\u66f2\u7ebf\u76f8\u5173\u7684\u51f8\u5305\u3002<br/>\u7279\u522b\u7684\uff0c\u5f53\u70b9\u96c6\u91cc\u53ea\u6709\u4e24\u4e2a\u70b9\u65f6\uff0c\u51f8\u5305\u9000\u5316\u4e3a\u4e00\u6761\u7ebf\u6bb5\u3002\u53ea\u6709\u4e00\u4e2a\u70b9\u65f6\uff0c\u9000\u5316\u4e3a\u4e00\u4e2a\u70b9\u3002<br/>\u540c\u65f6\u9700\u8981\u6ce8\u610f\u591a\u70b9\u5171\u7ebf\u548c\u591a\u70b9\u91cd\u5408\u800c\u5bfc\u81f4\u7684\u51f8\u5305\u9000\u5316\u73b0\u8c61\u3002<br/>\u6784\u9020\u7b97\u6cd5<br/>\u5728\u8ba1\u7b97\u51e0\u4f55\u91cc\u9762\uff0c\u8ba1\u7b97\u51f8\u5305\u5c31\u8ddf\u6392\u5e8f\u4e00\u6837\u5341\u5206\u7ecf\u5178\uff0c\u81f3\u4eca\u5df2\u7ecf\u7814\u7a76\u51fa\u4e86\u8bb8\u591a\u7b97\u6cd5\u3002\u5b83\u4eec\u4e2d\u7684\u7edd\u5927\u90e8\u5206\u53ef\u4ee5\u5728\u7ef4\u57fa\u767e\u79d1\u4e0a\u770b\u5230\uff0c\u8fd9\u91cc\u53ea\u4ecb\u7ecdJavis\u6b65\u8fdb\u6cd5\u3001\u6c34\u5e73\u626b\u63cf\u7ebf\u6cd5\u548cGraham\u626b\u63cf\u6cd5\u3002<br/>Jarvis\u6b65\u8fdb\u6cd5 (Gift Wrapping)<br/>Jarvis\u6b65\u8fdb\u6cd5\u53ef\u4ee5\u770b\u4f5c\u662f\u7ed9\u70b9\u96c6\u5305\u4e0a\u5305\u88c5\u7eb8\uff0c\u6700\u540e\u7b97\u51fa\u51f8\u5305\u7684\u3002\u7b97\u6cd5\u8fc7\u7a0b\u975e\u5e38\u7b80\u5355\uff1a<br/><br/>\u627e\u51fa\u6700\u5de6\u4e0b\u548c\u6700\u53f3\u4e0a\u7684\u4e24\u4e2a\u70b9\uff0c\u8bb0\u4e3a$p_1$\u3001$p_2$\uff0c\u5b83\u4eec\u4e00\u5b9a\u662f\u51f8\u5305\u4e0a\u7684\u70b9\u3002<br/>\u8bbe$p_1$\u4e3a\u5f53\u524d\u70b9\uff0c\u6bcf\u6b21\u4ece\u5269\u4e0b\u7684\u70b9\u4e2d\u627e\u51fa\u4ee5\u5f53\u524d\u70b9\u4e3a\u539f\u70b9\u6781\u89d2\u6700\u5c0f\u7684\u70b9\uff0c\u5c06\u5176\u52a0\u5165\u51f8\u5305\uff0c\u5e76\u8bbe\u4e3a\u5f53\u524d\u70b9\u3002\u91cd\u590d\u8fd9\u4e00\u6b65\u9aa4\uff0c\u76f4\u5230\u9047\u5230$p_2$\u3002\u8fd9\u6837\u5b8c\u6210\u4e86\u51f8\u5305\u53f3\u8fb9\u7684\u6784\u9020\u3002<br/>\u4e0e\u7b2c\u4e8c\u6b65\u76f8\u4f3c\uff0c\u6784\u9020\u51f8\u5305\u7684\u5de6\u8fb9\uff08\u6bcf\u4e00\u6b65\u5bfb\u627e\u6781\u89d2\u6700\u5927\u7684\u70b9\uff09\u3002<br/><br/>\u4ee5\u4e0b\u9762\u7684\u70b9\u96c6\u4e3a\u4f8b\uff1a<br/><br/>\u9996\u5148\u627e\u5230\u5de6\u4e0b\u548c\u53f3\u4e0a\u4e24\u4e2a\u70b9\uff1a<br/><br/>\u6784\u5efa\u53f3\u51f8\u5305\uff1a<br/><br/><br/>\u6784\u5efa\u5de6\u51f8\u5305\uff1a<br/><br/><br/><br/>\u81f3\u6b64\uff0c\u51f8\u5305\u6784\u5efa\u5b8c\u6bd5\u3002<br/>\u7531\u4e8eJarvis\u6b65\u8fdb\u6cd5\u4e2d\u51f8\u5305\u6bcf\u4e00\u4e2a\u70b9\u90fd\u9700\u8981\u5bf9\u5269\u4e0b\u7684\u70b9\u8fdb\u884c\u5904\u7406\uff0c\u6240\u4ee5\u8be5\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(nh)$\uff0c\u5176\u4e2d$h$\u662f\u51f8\u5305\u7684\u89c4\u6a21\u3002\u6700\u574f\u60c5\u51b5\u4e0b\u4e3a$\\\\Theta(n^2)$\u3002\u7531\u4e8e\u5f53\u70b9\u5728\u4e00\u4e2a\u6709\u9650\u77e9\u5f62\u5185\u968f\u673a\u5206\u5e03\u65f6\u51f8\u5305\u7684\u671f\u671b\u89c4\u6a21\u4e3a$O(\\\\log n)$\uff0c\u6240\u4ee5\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8be5\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n\\\\log n)$\u3002<br/>\u4e0b\u9762\u662f\u5176\u4f2a\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48function JARVIS(Q):  # Q\u662f\u70b9\u96c6<br/>    if |Q| <= 3:  # \u70b9\u6570\u4e0d\u5927\u4e8e3<br/>        return Q<br/><br/>    p1, p2 = nil<br/>    for p in Q:<br/>        if p1 == nil or ( p.y < p1.y or p.y == p1.y and p.x < p1.x ):<br/>            p1 = p<br/>        if p2 == nil or ( p.y > p2.y or p.y == p2.y and p.x < p2.x ):<br/>            p2 = p<br/><br/>    # \u4f7f\u7528\u53c9\u79ef\u6765\u6bd4\u8f83\u6781\u89d2\u5927\u5c0f<br/>    CH = [p1, p2]  # \u51f8\u5305<br/>    Q.pop(p1, p2)  # \u5220\u9664p1, p2<br/><br/>    # \u53f3\u51f8\u5305<br/>    x = p1<br/>    while true:<br/>        y = Q[0]<br/>        for p in Q[1:]:<br/>            if cross(y - x, p - x) < 0 or<br/>               cross(y - x, p - x) == 0 and |y - x| < |p - x|:  # \u5171\u7ebf<br/>                y = p<br/><br/>        if y == p2:<br/>            break<br/><br/>        CH.append(y)<br/>        Q.pop(y)<br/>        x = y<br/><br/>    # \u5de6\u51f8\u5305<br/>    x = p1<br/>    while true:<br/>        y = Q[0]<br/>        for p in Q[1:]:<br/>            if cross(y - x, p - x) > 0 or<br/>               cross(y - x, p - x) == 0 and |y - x| < |p - x|:  # \u5171\u7ebf<br/>                y = p<br/><br/>        if y == p2:<br/>            break<br/><br/>        CH.append(y)<br/>        Q.pop(y)<br/>        x = y<br/><br/>    return CH<br/><br/><br/>\u6c34\u5e73\u626b\u63cf\u7ebf\u6cd5<br/>\u8ba1\u7b97\u51e0\u4f55\u4e2d\uff0c\u626b\u63cf\u7ebf\u662f\u4e00\u79cd\u5e38\u7528\u7684\u65b9\u6cd5\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u626b\u63cf\u7ebf\u6765\u8ba1\u7b97\u51f8\u5305\u3002<br/>\u6211\u4eec\u53ef\u4ee5\u4ece\u5de6\u81f3\u53f3\u626b\u63cf\u6bcf\u4e00\u4e2a\u70b9\u6765\u66f4\u65b0\u51f8\u5305\u3002\u53ef\u4ee5\u786e\u5b9a\uff0c\u6700\u5de6\u8fb9\u548c\u6700\u53f3\u8fb9\u7684\u70b9\u90fd\u662f\u51f8\u5305\u4e0a\u7684\u70b9\u3002\u56e0\u6b64\u5229\u7528\u626b\u63cf\u7ebf\u6765\u5206\u522b\u8ba1\u7b97\u4e0a\u4e0b\u51f8\u5305\u3002<br/>\u7b97\u6cd5\u6b65\u9aa4\u5982\u4e0b\uff1a<br/><br/>\u5c06\u6240\u6709\u70b9\u6309\u7167$x$\u6392\u5e8f\u3002<br/>\u5bf9\u4e8e\u6bcf\u4e00\u7ec4$x$\u76f8\u540c\u7684\u70b9\uff0c\u4ec5\u4fdd\u7559$y$\u503c\u6700\u5927\u548c\u6700\u5c0f\u7684\u70b9\u3002<br/>\u53d6\u51fa\u6700\u5de6\u548c\u6700\u53f3\u4f5c\u4e3a\u57fa\u70b9\uff0c\u7528\u4e8e\u5224\u65ad\u5176\u5b83\u7684\u70b9\u662f\u5728\u4e0a\u51f8\u5305\u8fd8\u662f\u4e0b\u51f8\u5305\u3002<br/>\u4ece\u5de6\u81f3\u53f3\u626b\u63cf\u6bcf\u4e00\u4e2a\u70b9\uff0c\u6839\u636e\u57fa\u70b9\u5229\u7528\u53c9\u79ef\u8ba1\u7b97\u8be5\u70b9\u662f\u5e94\u63d2\u5165\u4e0a\u51f8\u5305\u8fd8\u4e0b\u51f8\u5305\uff0c\u5c06\u5176\u63d2\u5165\u5bf9\u5e94\u7684\u51f8\u5305\u4e2d\u3002\u7136\u540e\u4ece\u8fd9\u4e2a\u70b9\u5f00\u59cb\u5411\u524d\u8bbf\u95ee\uff0c\u5982\u679c\u548c\u4e4b\u524d\u7684\u70b9\u5f62\u6210\u5185\u51f9\u7684\u5f62\u72b6\uff08\u53ef\u4ee5\u5229\u7528\u53c9\u79ef\u5224\u65ad\uff09\uff0c\u5c31\u5c06\u4e4b\u524d\u7684\u70b9\u5220\u9664\u3002\u76f4\u5230\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u5f62\u72b6\u4e3a\u6b62\u3002<br/><br/>\u4e0b\u9762\u5c55\u793a\u4e86\u4e00\u4e2a\u6c34\u5e73\u626b\u63cf\u7ebf\u7684\u793a\u4f8b\uff1a<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>\u5f00\u59cb\u4ece\u4e0a\u51f8\u5305\u4e2d\u5220\u9664\u70b9\uff1a<br/><br/><br/><br/><br/><br/>\u7531\u4e8e\u6bcf\u4e2a\u70b9\u53ea\u4f1a\u88ab\u8bbf\u95ee1\u6b21\uff0c\u70b9\u5728\u6808\u4e2d\u53ea\u4f1a\u88ab\u5f39\u51fa\u4e00\u6b21\uff0c\u6240\u4ee5\u626b\u63cf\u7ebf\u7684\u90e8\u5206\u662f$\\\\Theta(n)$\u7684\u3002\u4f46\u6392\u5e8f\u9700\u8981$O(n\\\\log n)$\u7684\u65f6\u95f4\uff0c\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u662f$O(n\\\\log n)$\u7684\u3002\u662f\u4e00\u4e2a\u975e\u5e38\u4e0d\u9519\u7684\u7b97\u6cd5\u3002<br/>\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28function SCANLINE(Q):<br/>    if |Q| <= 3:<br/>        return Q<br/><br/>    sort Q by order of x<br/>    foreach x keeps the highest and lowest points<br/><br/>    p1, p2 = Q[0], Q[-1]<br/>    CH1 = []<br/>    CH2 = []<br/>    for p in Q:<br/>        if p == p1:  # \u8d77\u70b9<br/>            CH1.append(p)<br/>            CH2.append(p)<br/>            continue<br/>        if p == p2 or  # \u7ec8\u70b9<br/>           cross(p2 - p1, p - p1) >= 0:  # \u5728\u4e0a\u51f8\u5305<br/>            while |CH1| > 1 and cross(CH1[-1] - CH1[-2], p - CH1[-2]) >= 0:<br/>                CH1.pop()<br/>            CH1.append(p)<br/>        if p == p2 or<br/>           cross(p2 - p1, p - p1) < 0:  # \u5728\u4e0b\u51f8\u5305<br/>            while |CH2| > 1 and cross(CH2[-1] - CH2[-1], p - CH2[-2]) <= 0:<br/>                CH2.pop()<br/>            CH2.append(p)<br/><br/>    merge CH1, CH2 into CH<br/>    return CH<br/><br/><br/>Graham\u626b\u63cf\u6cd5<br/>\u8ba1\u7b97\u51f8\u5305\u7684\u53e6\u5916\u4e00\u79cd\u7b97\u6cd5\u5c31\u662fGraham\u626b\u63cf\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u89c6\u4e3a\u662f\u65cb\u8f6c\u626b\u63cf\u7ebf\u7684\u8fd0\u7528\u3002\u7c7b\u4f3c\u4e8eJarvis\u6b65\u8fdb\u6cd5\u8fd9\u79cd\u4e0d\u65ad\u5305\u88f9\u5f62\u6210\u51f8\u5305\u7684\u65b9\u6cd5\uff0cGraham\u626b\u63cf\u6cd5\u9996\u5148\u9009\u51fa\u4e00\u4e2a\u80af\u5b9a\u5728\u51f8\u5305\u4e0a\u7684\u70b9\u4f5c\u4e3a\u57fa\u70b9\uff0c\u7136\u540e\u5c06\u5176\u5b83\u70b9\u8fdb\u884c\u6781\u89d2\u6392\u5e8f\uff0c\u6309\u7167\u6781\u89d2\u5e8f\u7684\u987a\u5e8f\u6765\u626b\u63cf\u3002\u5e76\u4e14\u6309\u7167\u6c34\u5e73\u626b\u63cf\u7ebf\u7b97\u6cd5\u4e2d\u5220\u9664\u5148\u524d\u7684\u70b9\u7684\u65b9\u6cd5\u6765\u4e0d\u65ad\u66f4\u65b0\u51f8\u5305\u3002<br/>Graham\u7b97\u6cd5\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u5c31\u662f\u6700\u7ec8\u5f97\u5230\u7684\u51f8\u5305\u8fd8\u662f\u6309\u7167\u6781\u89d2\u5e8f\u6392\u5217\u7684\uff0c\u4e0d\u9700\u8981\u518d\u6b21\u6392\u5e8f\uff0c\u65b9\u4fbf\u540e\u7eed\u7684\u5904\u7406\u3002<br/>\u7b97\u6cd5\u6b65\u9aa4\u5982\u4e0b\uff1a<br/><br/>\u9009\u51fa\u6700\u5de6\u4e0b\u7684\u70b9\u4f5c\u4e3a\u57fa\u70b9<br/>\u4ee5\u57fa\u70b9\u4e3a\u539f\u70b9\uff0c\u5176\u5b83\u70b9\u6309\u7167\u6781\u89d2\u9006\u65f6\u9488\u6392\u5e8f\u3002\u5bf9\u4e8e\u6781\u89d2\u76f8\u540c\u7684\u70b9\uff0c\u4fdd\u7559\u4e0e\u57fa\u70b9\u8ddd\u79bb\u6700\u8fdc\u7684\u70b9\u3002<br/>\u7ef4\u62a4\u4e00\u4e2a\u6808\uff0c\u4f9d\u6b21\u8bbf\u95ee\u6bcf\u4e00\u4e2a\u70b9\uff0c\u68c0\u67e5\u4e4b\u524d\u7684\u70b9\u662f\u5426\u4e0e\u5176\u5f62\u6210\u4e86\u51f9\u9677\u7684\u5f62\u72b6\uff08\u5229\u7528\u53c9\u79ef\u5224\u65ad\uff09\uff0c\u5982\u679c\u6709\u5c31\u4ece\u6808\u4e2d\u9000\u6389\u4e00\u4e2a\u70b9\u3002\u5426\u5219\u5c06\u8be5\u70b9\u538b\u5165\u6808\u4e2d\u3002<br/>\u6700\u540e\u6808\u4e2d\u5143\u7d20\u5c31\u662f\u51f8\u5305<br/><br/>\u4e0b\u9762\u7ed9\u51fa\u4e86\u4e00\u4e2a\u793a\u4f8b\uff1a<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>\u56fe\u4e0a\u4f9d\u6b21\u8fde\u63a5\u7684\u7ebf\u8868\u793a\u6808\u4e2d\u7684\u5143\u7d20\u3002<br/>\u5bf9\u4e8eGraham\u626b\u63cf\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4e0e\u6c34\u5e73\u626b\u63cf\u7ebf\u7684\u5206\u6790\u4e00\u81f4\uff0c\u5173\u952e\u5728\u4e8e\u6392\u5e8f\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002<br/>\u8be5\u7b97\u6cd5\u603b\u4f53\u590d\u6742\u5ea6\u4e3a$O(n\\\\log n)$\u3002<br/>\u4e0b\u9762\u662f\u8be5\u7b97\u6cd5\u7684\u4f2a\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17function GRAHAM-SCAN(Q):<br/>    if |Q| <= 3:<br/>        return Q<br/><br/>    select the base point p1<br/><br/>    sort Q by polar angle order, when meets the same polar angle,<br/>    keep the furthest one.<br/><br/>    CH = []<br/>    for p in Q[1:]:<br/>        while |Q| > 1 and<br/>              cross(Q[-1] - Q[-2], p - Q[-2]) <= 0:<br/>            CH.pop()<br/>        CH.append(p)<br/><br/>    return CH<br/><br/><br/>\u5c0f\u7ed3<br/>\u4e0a\u9762\u4ecb\u7ecd\u4e86\u4e09\u79cd\u51f8\u5305\u6784\u9020\u7b97\u6cd5\uff0c\u5176\u4e2d\u6c34\u5e73\u626b\u63cf\u7ebf\u6cd5\u548cGraham\u626b\u63cf\u6cd5\u662f\u6700\u4e3a\u5e38\u7528\u548c\u9ad8\u6548\u7684\u7b97\u6cd5\u3002<br/>\u8fd9\u4e24\u79cd\u7b97\u6cd5\u4e2d\u7684\u626b\u63cf\u7ebf\u65b9\u6cd5\u53ef\u4ee5\u88ab\u5355\u72ec\u62ff\u51fa\u6765\u4f7f\u7528\uff0c\u56e0\u800c\u53ef\u4ee5\u505a\u8fdb\u4e00\u6b65\u6269\u5c55\uff08\u5982\u4e0b\u9762\u5c06\u63d0\u5230\u7684\u52a8\u6001\u51f8\u5305\u95ee\u9898\uff09<br/>\u6269\u5c55\u4e0e\u5e94\u7528<br/>\u52a8\u6001\u51f8\u5305<br/>\u52a8\u6001\u51f8\u5305\u662f\u6307\u8981\u6c42\u5b9e\u73b0\u52a8\u6001\u63d2\u5165\u70b9\u5e76\u7ef4\u62a4\u70b9\u96c6\u51f8\u5305\u7684\u95ee\u9898\uff0c\u76ee\u524d\u597d\u50cf\u8fd8\u6ca1\u6709\u652f\u6301\u5728\u7ebf2\u5220\u9664\u70b9\u7684\u9ad8\u6548\u7b97\u6cd5\u3002<br/>\u76ee\u524d\u6d41\u884c\u7684\u4e24\u79cd\u52a8\u6001\u51f8\u5305\u7b97\u6cd5\u6765\u6e90\u4e8e\u4e4b\u524d\u7684\u4e24\u79cd\u51f8\u5305\u7b97\u6cd5\uff1a\u6c34\u5e73\u626b\u63cf\u7ebf\u6cd5\u548cGraham\u626b\u63cf\u6cd5\u3002<br/>\u6c34\u5e73\u5e8f<br/>\u7b2c\u4e00\u79cd\u662f\u6765\u6e90\u4e8e\u6c34\u5e73\u626b\u63cf\u7ebf\u7684\u7b97\u6cd5\u3002\u6211\u4eec\u7528\u4e24\u68f5\u5e73\u8861\u6811\u6765\u7ef4\u62a4\u4e0a\u4e0b\u4e24\u4e2a\u51f8\u5305\uff0c\u5747\u6309\u7167$x$\u6392\u5e8f\u3002<br/>\u6bcf\u6b21\u63d2\u5165\u70b9\u4e4b\u524d\uff0c\u5148\u8981\u5224\u65ad\u70b9\u662f\u5426\u5728\u51f8\u5305\u5185\u90e8\u3002\u9996\u5148\u4e8c\u5206\u51fa\u8be5\u70b9\u6240\u5728\u7684\u4e0a\u51f8\u5305\u6216\u4e0b\u51f8\u5305\u7684\u5de6\u53f3\u4e24\u4e2a\u70b9\uff0c\u7136\u540e\u5229\u7528\u53c9\u79ef\u6765\u5224\u65ad\u662f\u5426\u5728\u51f8\u5305\u5916\u3002\u6ce8\u610f\u8fd9\u91cc\u6709\u51e0\u4e2a\u8fb9\u754c\u60c5\u51b5\uff1a<br/><br/>\u70b9\u8d85\u51fa\u4e86\u51f8\u5305\u7684\u6700\u5de6\u8fb9\u548c\u6700\u53f3\u8fb9\u65f6\u8981\u5355\u72ec\u5904\u7406\u3002<br/>\u70b9\u7684$x$\u4e0e\u6700\u5de6\u8fb9\u6216\u6700\u53f3\u8fb9\u76f8\u540c\u65f6\u9700\u8981\u8003\u8651\u4e00\u4e0b\u3002<br/><br/>\u5982\u679c\u70b9\u5728\u51f8\u5305\u5185\uff0c\u90a3\u4e48\u51f8\u5305\u5c06\u4e0d\u4f1a\u88ab\u66f4\u65b0\u3002\u5426\u5219\u5c31\u8981\u8003\u8651\u66f4\u65b0\u51f8\u5305\u3002<br/>\u6309\u7167\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u5728\u5e73\u8861\u6811\u4e0a\u67e5\u627e\u51fa\u8be5\u70b9\u5728\u51f8\u5305\u4e0a\u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u70b9\uff0c\u7136\u540e\u5411\u5de6\u5411\u53f3\u68c0\u67e5\u662f\u5426\u6709\u8fdd\u53cd\u51f8\u5305\u6027\u8d28\u7684\u51f9\u9677\u5f62\u72b6\uff0c\u5982\u679c\u6709\uff0c\u5219\u5220\u9664\u5bf9\u5e94\u7684\u70b9\u3002\u76f4\u5230\u51f8\u5305\u6027\u8d28\u5f97\u5230\u7ef4\u62a4\u3002\u7136\u540e\u5c06\u8be5\u70b9\u63d2\u5165\u5373\u53ef\u3002<br/>\u7c7b\u4f3c\u7684\uff0c\u5bf9\u4e8e\u4e4b\u524d\u5224\u65ad\u70b9\u662f\u5426\u5728\u51f8\u5305\u5185\u7684\u8fb9\u754c\u60c5\u51b5\uff0c\u5728\u8fd9\u91cc\u5c31\u9700\u8981\u66f4\u52a0\u6ce8\u610f\u3002<br/>\u7531\u4e8e\u6709\u4e0a\u4e0b\u4e24\u4e2a\u51f8\u5305\uff0c\u6240\u4ee5\u76f8\u4f3c\u7684\u4ee3\u7801\u9700\u8981\u5199\u4e24\u904d......<br/>\u6781\u89d2\u5e8f<br/>\u7b2c\u4e8c\u79cd\u662f\u6765\u6e90\u4e8eGraham\u626b\u63cf\u6cd5\u7684\u7b97\u6cd5\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u4e0e\u6c34\u5e73\u5e8f\u76f8\u6bd4\u8fb9\u754c\u66f4\u7b80\u5355\uff0c\u4ee3\u7801\u4e5f\u66f4\u77ed\u3002<br/>\u8be5\u7b97\u6cd5\u8981\u6c42\u5f97\u5230\u4e00\u4e2a\u521d\u59cb\u7684\u51f8\u5305\uff08\u81f3\u5c11\u4e24\u4e2a\u70b9\uff09\uff0c\u5e76\u4ee5\u8fd9\u4e9b\u70b9\u7684\u4e2d\u5fc3\u4f5c\u4e3a\u539f\u70b9\uff0c\u6309\u7167\u6781\u89d2\u5e8f3\u63d2\u5165\u5230\u5e73\u8861\u6811\u4e2d\u3002<br/>\u4e0e\u6c34\u5e73\u5e8f\u7c7b\u4f3c\uff0c\u9996\u5148\u8981\u67e5\u8be2\u70b9\u662f\u5426\u5728\u51f8\u5305\u5185\u90e8\u3002\u540c\u6837\uff0c\u6211\u4eec\u5728\u5e73\u8861\u6811\u4e2d\u67e5\u627e\u6781\u89d2\u5de6\u53f3\u7684\u70b9\uff0c\u5e76\u5229\u7528\u53c9\u79ef\u5224\u65ad\u662f\u5426\u5728\u51f8\u5305\u5185\u3002\u6ce8\u610f\u6211\u4eec\u671f\u671b\u8fd9\u4e9b\u70b9\u4f1a\u6309\u7167\u4e00\u4e2a\u73af\u7684\u65b9\u5f0f\u5b58\u5165\uff0c\u7136\u800c\u5e73\u8861\u6811\u662f\u94fe\u72b6\u6570\u636e\u7ed3\u6784\u3002\u56e0\u6b64\u5728\u8fb9\u754c\u5904\u9700\u8981\u5230\u53e6\u5916\u4e00\u8fb9\u5bfb\u627e\u7b54\u6848\u3002<br/>\u5982\u679c\u67e5\u8be2\u7684\u70b9\u4e0e\u539f\u70b9\u4e00\u6837\uff0c\u5c31\u6ca1\u6709\u6781\u89d2\u53ef\u8a00\u4e86\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5224\u65ad\u8be5\u70b9\u662f\u5426\u4e0e\u539f\u70b9\u4e00\u6837\u3002\u7531\u4e8e\u6211\u4eec\u7684\u539f\u70b9\u5fc5\u5b9a\u5728\u51f8\u5305\u5185\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5224\u5b9a\u3002<br/>\u4e4b\u540e\u7684\u63d2\u5165\u4e0e\u6c34\u5e73\u5e8f\u4e00\u81f4\uff0c\u4e8c\u5206\u51fa\u5de6\u53f3\u70b9\uff0c\u5e76\u7ef4\u62a4\u51f8\u5305\u6027\u8d28\u5373\u53ef\u3002<br/>\u6ce8\u610f\u8fd9\u91cc\u6ca1\u6709\u8d85\u51fa\u5de6\u53f3\u8fb9\u754c\u7684\u60c5\u51b5\uff0c\u8fd9\u5c31\u662f\u6781\u89d2\u5e8f\u7684\u4e00\u5927\u4f18\u52bf\u3002\u540c\u65f6\uff0c\u6781\u89d2\u5e8f\u4e5f\u53ea\u7528\u7ef4\u62a4\u4e00\u68f5\u5e73\u8861\u6811\u3002<br/>\u5177\u4f53\u5b9e\u73b0<br/>[Codeforces 70D] Professor\u2019s task<br/>\u8fd9\u9053\u9898\u662f\u975e\u5e38\u826f\u5fc3\u7684\u6a21\u677f\u9898\uff0c\u5982\u679c\u60f3\u5b9e\u73b0\u52a8\u6001\u51f8\u5305\uff0c\u53ef\u4ee5\u5230\u8fd9\u91cc\u6765\u6d4b\u8bd5\u3002<br/>\u672c\u4eba\u7684\u4ee3\u7801\u7531\u4e8e\u662f\u624b\u5199\u7684\u5411\u91cf\u548c\u5e73\u8861\u6811\uff0c\u6240\u4ee5\u4ee3\u7801\u76f8\u5f53\u957f\uff0c\u5c31\u4e0d\u5728\u6b64\u4ee5\u4ee3\u7801\u6846\u7684\u5f62\u5f0f\u653e\u51fa\u3002\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u70b9\u5f00\u4e0b\u9762\u7684\u94fe\u63a5\u6765\u770b\uff1a<br/>\u6c34\u5e73\u5e8f<br/>\u6781\u89d2\u5e8f<br/>\u65cb\u8f6c\u5361\u58f3<br/>\u65cb\u8f6c\u5361\u58f3\u662f\u4e00\u7c7b\u5e94\u7528\u4e8e\u51f8\u591a\u8fb9\u5f62\u4e0a\u7684\u7b97\u6cd5\u3002\u7531\u4e8e\u51f8\u5305\u4e5f\u662f\u51f8\u591a\u8fb9\u5f62\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u7528\u5728\u51f8\u5305\u4e0a\u3002<br/>\u4e3a\u4e86\u89e3\u91ca\u4ec0\u4e48\u662f\u65cb\u8f6c\u5361\u58f3\uff0c\u9996\u5148\u6765\u770b\u4e00\u4e2a\u7ecf\u5178\u7684\u95ee\u9898\uff1a<br/><br/>\u7ed9\u4f60\u4e00\u4e2a\u70b9\u96c6$Q$\uff0c\u6c42\u8fd9\u4e2a\u70b9\u96c6\u4e2d\u6700\u8fdc4\u7684\u4e24\u4e2a\u70b9\u7684\u8ddd\u79bb\u3002<br/><br/>\u8be5\u95ee\u9898\u6700\u4e3a\u76f4\u63a5\u7684\u65b9\u6cd5\u662f\u679a\u4e3e\u8fd9\u4e24\u4e2a\u70b9\u5bf9\uff0c\u7136\u540e\u8ba1\u7b97\u8ddd\u79bb\u3002\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(n^2)$\u3002<br/>\u6709\u6ca1\u6709\u4e00\u79cd\u66f4\u5feb\u7684\u7b97\u6cd5\u5462\uff1f\u9996\u5148\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u6700\u8fdc\u7684\u4e24\u4e2a\u70b9\u4e00\u5b9a\u5728\u51f8\u5305\u4e0a\uff0c\u56e0\u4e3a\u5982\u679c\u5b83\u4eec\u4e0d\u5728\u51f8\u5305\u4e0a\uff0c\u90a3\u4e48\u51f8\u5305\u5b9e\u9645\u4e0a\u53ef\u4ee5\u88ab\u6269\u5927\u3002<br/>\u8fd9\u6837\u6211\u4eec\u5c31\u53ea\u7528\u8003\u8651\u51f8\u5305\u4e0a\u7684\u70b9\u4e86\u3002\u5bf9\u4e8e\u51f8\u5305\u4e0a\u7684\u4e00\u4e2a\u70b9\uff0c\u5f88\u76f4\u89c2\u7684\u60f3\u6cd5\u5c31\u662f\u627e\u5230\u51f8\u5305\u53e6\u4e00\u8fb9\u6700\u8fdc\u7684\u70b9\u3002<br/>\u8fd9\u662f\u5c31\u8981\u7528\u5230\u65cb\u8f6c\u5361\u58f3\uff0c\u6211\u4eec\u7528\u4e00\u5bf9\u5e73\u884c\u7ebf\u201d\u5939\u7d27\u201d\u8fd9\u4e2a\u51f8\u5305\uff0c\u8fd9\u6837\u88ab\u4e24\u6761\u76f4\u7ebf\u6240\u538b\u4f4f\u7684\u70b9\u4e4b\u95f4\u5c31\u53ef\u80fd\u6709\u6700\u8fdc\u70b9\u5bf9\u3002<br/><br/>\u7531\u4e8e\u5f53\u524d\u6240\u5361\u4e2d\u7684\u4e0d\u4e00\u5b9a\u5c31\u662f\u6700\u8fdc\u70b9\u5bf9\uff0c\u6240\u4ee5\u8fd8\u9700\u8981\u7ee7\u7eed\u5bfb\u627e\u3002<br/>\u800c\u5bf9\u6bcf\u4e00\u6761\u51f8\u5305\u4e0a\u7684\u8fb9\u800c\u8a00\uff0c\u90fd\u53ea\u6709\u6700\u8fdc\u7684\u70b9\u5bf9\u5176\u6709\u6548\u3002<br/>\u6240\u4ee5\u53ef\u4ee5\u60f3\u8c61\u5176\u4e2d\u4e00\u6761\u76f4\u7ebf\u4e0d\u65ad\u7684\u6cbf\u7740\u51f8\u5305\u4e0a\u7684\u8fb9\u8fdb\u884c\u65cb\u8f6c\uff0c\u800c\u53e6\u4e00\u6761\u76f4\u7ebf\u5219\u4e0d\u65ad\u66f4\u65b0\u4e0e\u4e4b\u6700\u8fdc\u7684\u70b9\u3002<br/><br/>\u7b2c\u4e00\u6761\u76f4\u7ebf\u7684\u4e8b\u60c5\u597d\u529e\uff0c\u5173\u952e\u5728\u4e8e\u7b2c\u4e8c\u6761\u3002\u7531\u4e8e\u51f8\u5305\u4e0a\u7684\u70b9\u5230\u7b2c\u4e00\u6761\u76f4\u7ebf\u7684\u8ddd\u79bb\u5177\u6709\u5355\u8c03\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6761\u76f4\u7ebf\u53ef\u4ee5\u6cbf\u7740\u4e00\u4e2a\u65b9\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u5230\u8fbe\u5408\u9002\u7684\u4f4d\u7f6e\u3002<br/>\u5f53\u7136\u9700\u8981\u6ce8\u610f\u4e00\u79cd\u8fb9\u754c\u60c5\u51b5\uff1a\u5982\u679c\u6709\u4e24\u6761\u5e73\u884c\u7684\u8fb9\uff0c\u90a3\u4e48\u7b2c\u4e8c\u6761\u76f4\u7ebf\u53ef\u80fd\u5361\u4e2d\u4e24\u4e2a\u70b95\uff0c\u8fd9\u6837\u5c31\u9700\u8981\u591a\u679a\u4e3e\u4e00\u4e9b\u60c5\u51b5\u3002<br/>\u6309\u7167\u8fd9\u6837\u7684\u65b9\u6cd5\u65cb\u8f6c\u4e00\u5468\uff0c\u5c31\u53ef\u4ee5\u5bf9\u6240\u6709\u53ef\u80fd\u7684\u70b9\u5bf9\u5b8c\u6210\u679a\u4e3e\uff0c\u6781\u5927\u5730\u51cf\u5c11\u4e86\u679a\u4e3e\u91cf\u3002<br/>\u5bf9\u4e8e\u51f8\u591a\u8fb9\u5f62\u7684\u6bcf\u4e00\u6761\u8fb9\u6211\u4eec\u90fd\u8981\u8ba1\u7b97\u4e00\u6b21\u7b54\u6848\u3002\u5982\u679c\u8ba1\u7b97\u7b54\u6848\u7684\u590d\u6742\u5ea6\u4e3a$O(g(n))$\uff0c\u90a3\u4e48\u65cb\u8f6c\u5361\u58f3\u7684\u590d\u6742\u5ea6\u5c31\u662f$O(ng(n))$\u3002\u5bf9\u4e8e\u6700\u8fdc\u70b9\u5bf9\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u5728$\\\\Theta(n)$\u7684\u65f6\u95f4\u5185\u89e3\u51b3\u3002<br/>\u65cb\u8f6c\u5361\u58f3\u8fd8\u6709\u8bb8\u591a\u6709\u8da3\u7684\u5e94\u7528\uff0c\u5f88\u591a\u60c5\u51b5\u4e0b\u662f\u7528\u4e8e\u89e3\u51b3\u70b9\u96c6\u548c\u51f8\u591a\u8fb9\u5f62\u4e0a\u7684\u95ee\u9898\u3002<br/>\u659c\u7387\u4f18\u5316<br/>\u659c\u7387\u4f18\u5316\u662f\u4e00\u7c7b\u5e94\u7528\u5728\u9012\u63a8\u4f18\u5316\u4e0a\u7684\u7b97\u6cd5\uff0c\u5b83\u5de7\u5999\u5728\u4e8e\u5c06\u770b\u4f3c\u6ca1\u6709\u89c4\u5f8b\u7684\u9012\u63a8\u5173\u7cfb\u8f6c\u4e3a\u4e86\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u7ebf\u6027\u89c4\u5212\u95ee\u9898\u3002\u4e0b\u9762\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a<br/><br/>\u7ed9\u4f60\u4e00\u4e2a\u6570\u7ec4$A[1\\\\dots n]$\u548c$B[1\\\\dots n]$\u3000$(A[i],\\\\;B[i] > 0,\\\\;i\\\\in[1.\\\\;n])$\uff0c\u5e76\u7ed9\u51fa$f(1)$\u548c$f(2)$\uff0c\u5df2\u77e5$f$\u5177\u6709\u4ee5\u4e0b\u9012\u63a8\u5173\u7cfb\uff1a<br/>$$ f(x) = \\\\max\\\\{A[x]f(i) + B[x]f(i - 1) \\\\mid i \\\\in [2,\\\\;x)\\\\} $$<br/>\u6c42$\\\\sum_{i=1}^nf(i)$\u3002<br/><br/>\u9996\u5148\uff0c\u76f4\u63a5\u679a\u4e3e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(n^2)$\uff0c\u5e76\u4e0d\u662f\u5f88\u4f18\u3002<br/>\u5982\u679c\u5355\u7eaf\u662f\u53d6\u6700\u5927\u503c\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c31\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u6765\u89e3\u51b3\u3002\u7136\u800c$\\\\max$\u4e2d\u7684\u4e1c\u897f\u7b80\u76f4\u83ab\u540d\u5176\u5999\uff0c\u4ee4\u4eba\u6478\u4e0d\u7740\u5934\u8111\u3002<br/>\u4e0d\u59a8\u4ece\u53e6\u5916\u4e00\u4e2a\u89d2\u5ea6\u6765\u8003\u8651\u95ee\u9898\u3002\u5bf9\u4e8e\u5f53\u524d\u7684$x$\u800c\u8a00\uff0c\u8003\u8651\u4e4b\u524d\u7684\u4e24\u4e2a\u4f4d\u7f6e$j,\\\\;k \\\\in [2,\\\\;x)$ (\u5047\u5b9a$j \\\\lt k$)\uff0c\u4ec0\u4e48\u65f6\u5019$j$\u4f1a\u6bd4$k$\u66f4\u4f18\uff08\u5373\u53ef\u80fd\u53d6\u5230\u6700\u5927\u503c\uff09\u3002<br/>\u6211\u4eec\u53d1\u73b0\u3002\u53ea\u6709\u4e0b\u9762\u7684\u4e0d\u7b49\u5f0f\u6210\u7acb\u65f6\uff0c$j$\u4f1a\u6bd4$k$\u66f4\u4f18\uff1a<br/>$$ A[x]f(j) + B[x]f(j - 1) \\\\gt A[x]f(k) + B[x]f(k - 1) $$<br/>\u7531\u4e8e$f(x)$\u662f\u9012\u589e\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5bf9\u4e0a\u5f0f\u8fdb\u884c\u4e00\u4e9b\u7b49\u4ef7\u53d8\u5f62\uff1a<br/>$$ A[x](f(j) - f(k)) \\\\gt B[x](f(k - 1) - f(j - 1)) $$<br/>$$ {f(j) - f(k) \\\\over f(k-1) - f(j-1)} \\\\gt {B[x] \\\\over A[x]} \\\\tag{1} $$<br/>$$ {f(j) - f(k) \\\\over f(j-1) - f(k-1)} \\\\lt -{B[x] \\\\over A[x]} \\\\tag{2} $$<br/>\u56de\u60f3\u4e00\u4e0b\u76f4\u7ebf\u659c\u7387\u7684\u8ba1\u7b97\u516c\u5f0f\uff0c\u4e0d\u96be\u53d1\u73b0$(2)$\u5f0f\u5de6\u8fb9\u662f\u4e00\u4e2a\u8ba1\u7b97\u659c\u7387\u7684\u5f62\u5f0f\uff0c\u800c\u53f3\u8fb9\u662f\u4e00\u4e2a\u5e38\u91cf\uff08\u5bf9\u7279\u5b9a\u7684$x$\u800c\u8a00\uff09\u3002<br/>\u56e0\u6b64$(2)$\u5f0f\u5de6\u8fb9\u53ef\u4ee5\u89c6\u4e3a\u662f\u4e24\u4e2a\u70b9$(f(j-1),\\\\;f(j))$\u548c$(f(k-1),\\\\;f(k))$\u7684\u76f4\u7ebf\u7684\u659c\u7387\u4e0e$-B[x] / A[x]$\u7684\u5173\u7cfb\u3002<br/><br/>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u8fd9\u4e2a\u65f6\u5019\uff1a<br/>$$ {f(j) - f(k) \\\\over f(j-1) - f(k-1)} \\\\gt -{B[x] \\\\over A[x]} $$<br/>\u6545\u6b64\u65f6$j$\u4e0d\u6bd4$k$\u66f4\u4f18\u3002<br/>\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u67e5\u8be2\u7684\u659c\u7387\u90fd\u662f\u8d1f\u6570\uff0c\u6240\u4ee5\u53ea\u8981\u4e24\u70b9\u95f4\u7684\u659c\u7387\u5927\u4e8e$0$\uff0c\u5c31\u53ef\u4ee5\u6709\u66f4\u4f18\u7684\u8c03\u6574\u3002<br/>\u56e0\u6b64\u6240\u6709\u975e\u4e0a\u51f8\u5305\u7684\u70b9\u90fd\u4e0d\u6bd4\u4e0a\u51f8\u5305\u7684\u70b9\u66f4\u4f18\u3002<br/>\u4e8e\u662f\u6211\u4eec\u5c31\u53ea\u7528\u8003\u8651\u4e0a\u51f8\u5305\u7684\u70b9\u4e86\u3002<br/>\u7531\u4e8e\u4e0a\u51f8\u5305\u7684\u76f8\u90bb\u4e24\u70b9\u95f4\u659c\u7387\u662f\u9012\u51cf\u7684\uff0c\u800c\u6211\u4eec\u7684\u76ee\u6807\u662f\u67e5\u627e\u5230\u7b2c\u4e00\u4e2a\u5c0f\u4e8e$-B[x] / A[x]$\u7684\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4e8c\u5206\u7684\u65b9\u6cd5\uff01<br/>\u5230\u6b64\u6574\u4e2a\u7b97\u6cd5\u5df2\u7ecf\u5f88\u5999\u4e86\uff0c\u53ea\u5269\u4e0b\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u8fd9\u4e9b\u70b9\u5e76\u4e0d\u662f\u4e00\u5f00\u59cb\u5c31\u77e5\u9053\u7684\u3002<br/>\u6240\u4ee5\u6211\u4eec\u9700\u8981\u52a8\u6001\u63d2\u5165\u70b9\u5e76\u7ef4\u62a4\u51f8\u5305\uff0c\u8fd9\u5c31\u9700\u8981\u4e4b\u524d\u6240\u63d0\u53ca\u7684\u52a8\u6001\u51f8\u5305\u3002<br/>\u7531\u4e8e\u53ea\u9700\u8981\u4e0a\u51f8\u5305\uff0c\u6240\u4ee5\u8fd9\u91cc\u6700\u597d\u9009\u7528\u6c34\u5e73\u5e8f\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u7ef4\u62a4\u4e00\u68f5\u5e73\u8861\u6811\u3002<br/>\u8fd9\u6837\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u5c31\u505a\u5230\u7684$O(n\\\\log n)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u673a\u667a\u7684\u4eba\u53ef\u80fd\u53d1\u73b0\u8fd9\u4e2a\u95ee\u9898\u5e76\u4e0d\u9700\u8981\u8fd9\u79cd\u9ad8\u7ea7\u7684\u65b9\u6cd5\uff0c\u7136\u800c\u8fd9\u91cc\u53ea\u662f\u4e3a\u4e86\u89e3\u91ca\u4ec0\u4e48\u662f\u659c\u7387\u4f18\u5316\u3002\u5728\u771f\u6b63\u590d\u6742\u7684\u5730\u65b9\uff0c\u659c\u7387\u4f18\u5316\u8fd8\u662f\u6709\u5f88\u5927\u7528\u5904\uff0c\u5e76\u4e14\u5f62\u5f0f\u4e5f\u591a\u53d8\u3002<br/><br/><br/><br/><br/>\u51f8\u5305\u7684\u5b9a\u4e49\u53ef\u4ee5\u6269\u5c55\u81f3\u9ad8\u7ef4\u3002\u00a0\u21a9<br/><br/><br/>\u5982\u679c\u53ea\u9700\u8981\u5220\u9664\u4e14\u5141\u8bb8\u79bb\u7ebf\uff0c\u5219\u53ef\u4ee5\u8fdb\u884c\u201d\u65f6\u5149\u5012\u6d41\u201d\uff0c\u4ece\u540e\u5f80\u524d\u5904\u7406\uff0c\u8fd9\u6837\u5c31\u53d8\u6210\u4e86\u63d2\u5165\u3002\u00a0\u21a9<br/><br/><br/>\u6700\u597d\u91c7\u7528\u5148\u8c61\u9650\u540e\u6781\u89d2\u7684\u65b9\u6cd5\uff0c\u907f\u514d\u4e00\u4e9b\u8fb9\u754c\u60c5\u51b5\u3002\u00a0\u21a9<br/><br/><br/>\u6700\u8fd1\u70b9\u5bf9\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u4e0e\u4e4b\u5b8c\u5168\u4e0d\u540c\uff0c\u901a\u5e38\u662f\u91c7\u7528\u5206\u6cbb\u6cd5\u3002\u00a0\u21a9<br/><br/><br/>\u7531\u4e8e\u51f8\u5305\u4e0a\u4e0d\u5141\u8bb8\u51fa\u73b0\u540c\u4e00\u6761\u76f4\u7ebf\u4e0a\u51fa\u73b0\u591a\u4e8e\u4e24\u4e2a\u70b9\uff08\u56e0\u4e3a\u8981\u4f7f\u51f8\u5305\u4e0a\u7684\u70b9\u5c3d\u53ef\u80fd\u5c11\uff09\uff0c\u6240\u4ee5\u4e0d\u4f1a\u540c\u65f6\u5361\u4e2d\u4e09\u4e2a\u4ee5\u4e0a\u7684\u70b9\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-8-11/convex-hull.html"
},
"\u533a\u95f4\u52a0\u591a\u9879\u5f0f\u95ee\u9898\u7684\u7814\u7a76": {
"tags": "\u6570\u636e\u7ed3\u6784 \u591a\u9879\u5f0f FFT \u4f2f\u52aa\u5229\u6570",
"text": "\u533a\u95f4\u52a0\u591a\u9879\u5f0f\u95ee\u9898\u7684\u7814\u7a76<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$\uff0c\u521d\u59cb\u503c\u5168\u4e3a $0$ \u7684\u5e8f\u5217 $A[1..n]$\uff0c\u8981\u6c42\u652f\u6301\u4ee5\u4e0b\u4e24\u79cd\u64cd\u4f5c\uff1a<br/><br/>\u4fee\u6539\u64cd\u4f5c\uff1a\u6bcf\u6b21\u7ed9\u5b9a\u4e00\u4e2a\u533a\u95f4 $[l, r]$ \u4ee5\u53ca\u4e00\u4e2a $K$ \u6b21\u591a\u9879\u5f0f $P(x)$\uff0c\u8981\u6c42\u5c06 $[l, r]$ \u7684\u7b2c $k$ \u9879\u52a0\u4e0a $P(k)$\u3002\u4e5f\u5c31\u662f $A[l + k - 1]$ \u52a0\u4e0a $P(k)$\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $1 \\\\leqslant k \\\\leqslant r - l + 1$\u3002<br/>\u67e5\u8be2\u64cd\u4f5c\uff1a\u67e5\u8be2\u64cd\u4f5c\u5206\u4e3a\u4e24\u79cd (i) \u7ed9\u5b9a\u4f4d\u7f6e $k$\uff0c\u8981\u6c42\u8f93\u51fa $A[k]$ \u7684\u503c \uff08\u5355\u70b9\u67e5\u8be2\uff09; (ii) \u7ed9\u5b9a\u533a\u95f4 $[l, r]$\uff0c\u8981\u6c42\u8f93\u51fa\u533a\u95f4 $[l, r]$ \u5185\u6240\u6709\u6570\u4e4b\u548c\uff0c\u5373 $\\\\sum_{k = l}^r A[k]$\uff08\u533a\u95f4\u67e5\u8be2\uff09\u3002<br/><br/>\u8bb0\u64cd\u4f5c\u603b\u6570\u4e3a $q$\uff0c\u4fee\u6539\u64cd\u4f5c\u4e2d\u591a\u9879\u5f0f\u7684\u6700\u9ad8\u6b21\u6570\u4e3a $K$\uff0c\u5e76\u4e14 $K$ \u4e0e $n$ \u548c $q$ \u76f8\u6bd4\u8f83\u5c0f\u3002\u672c\u6587\u7684\u76ee\u7684\u662f\u9488\u5bf9\u4fee\u6539\u64cd\u4f5c\u548c\u533a\u95f4\u67e5\u8be2\u7ed9\u51fa\u4e00\u4e2a $O((n + q)K \\\\log n)$ \u7684\u5728\u7ebf\u7b97\u6cd5\u4ee5\u53ca\u4e00\u4e2a $O(qK \\\\log q)$ \u7684\u79bb\u7ebf\u7b97\u6cd5\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u5728\u7ebf\u7b97\u6cd5<br/>\u6211\u4eec\u53ef\u4ee5\u9996\u5148\u8003\u8651\u4e00\u4e2a\u7b80\u5316\u7684\u4fee\u6539\u64cd\u4f5c\uff1a\u6bcf\u6b21\u6307\u5b9a\u533a\u95f4\u4e3a $[1..n]$\uff0c\u4e5f\u5c31\u662f\u6574\u4e2a\u5e8f\u5217\u3002\u5b9e\u9645\u4e0a\u6211\u4eec\u53ea\u7528\u4fdd\u5b58\u4e00\u4e2a\u591a\u9879\u5f0f $Q(x)$\uff0c\u6bcf\u6b21\u4fee\u6539\u64cd\u4f5c\u5c31\u5c06 $P(x)$ \u52a0\u5230 $Q(x)$ \u4e0a\uff0c\u4fee\u6539\u540e\u7684\u5e8f\u5217\u4e2d $A[k]$ \u5b9e\u9645\u4e0a\u5c31\u662f $Q(k)$\u3002\u5982\u679c\u6211\u4eec\u82b1\u8d39 $\\\\Theta(nK)$ \u7684\u65f6\u95f4\u6765\u8ba1\u7b97\u4e00\u4e2a\u8868 $F(n, k) = \\\\sum_{x = 1}^n x^k$\uff0c\u5373 $x^k$ \u7684\u524d\u7f00\u548c\uff0c\u5c31\u53ef\u4ee5\u5728\u5355\u6b21 $\\\\Theta(K)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa $A$ \u7684\u533a\u95f4\u548c\u3002<br/>\u56de\u5230\u539f\u5148\u7684\u95ee\u9898\uff0c\u53d1\u73b0 $P(x)$ \u4e0d\u4ec5\u5728\u5e8f\u5217\u4e2d\u7684\u8d77\u59cb\u4f4d\u7f6e\u53d8\u4e86\uff0c\u800c\u4e14\u7ba1\u8f96\u8303\u56f4\u4e5f\u7f29\u51cf\u5230 $[l, r]$\u3002\u4e3a\u4e86\u5c3d\u53ef\u80fd\u7b80\u5316\u95ee\u9898\uff0c\u6211\u4eec\u5c1d\u8bd5\u5bf9\u591a\u9879\u5f0f\u8fdb\u884c\u5904\u7406\u3002\u6211\u4eec\u5e0c\u671b $P(k)  = A[k]$ \u800c\u4e0d\u662f $P(k) = A[l + k - 1]$\uff0c\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u6240\u9700\u8981\u505a\u7684\uff0c\u5c31\u662f\u51fd\u6570\u7684\u5e73\u79fb\uff1a$P'(x) = P(x - l + 1)$\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u5728\u4e8e\uff0c\u4fee\u6539\u64cd\u4f5c\u53d8\u4e3a\u4e86\u5bf9\u6574\u4e2a\u5e8f\u5217\u7684\u4fee\u6539\uff0c\u4f46\u662f\u53ea\u5728\u6307\u5b9a\u7684\u533a\u95f4\u6709\u4f5c\u7528\u3002\u7ecf\u8fc7\u5e73\u79fb\u4e4b\u540e\uff0c\u4e0d\u540c\u7684\u591a\u9879\u5f0f\u53ef\u4ee5\u6309\u7167\u4e4b\u524d\u7684\u65b9\u5f0f\u7d2f\u52a0\u5e76\u4e14\u6b63\u786e\u5730\u8ba1\u7b97\u7ed3\u679c\uff0c\u56e0\u6b64\uff0c\u53ea\u8981\u914d\u5408\u5e73\u8861\u6811\u6216\u7ebf\u6bb5\u6811\u4e4b\u7c7b\u7684\u6570\u636e\u7ed3\u6784\u5373\u53ef\u5feb\u901f\u89e3\u51b3\u533a\u95f4\u95ee\u9898\u3002\u5177\u4f53\u800c\u8a00\uff0c\u5c31\u662f\u5bf9\u5e8f\u5217\u7684\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7ef4\u62a4\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u4fee\u6539\u65f6\uff0c\u5c06\u5e73\u79fb\u540e\u7684\u591a\u9879\u5f0f $P'(x)$ \u52a0\u5230\u533a\u95f4 $[l, r]$ \u4e0a\u7684\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5e76\u5229\u7528\u7ebf\u6bb5\u6811\u4e0a\u7684\u8282\u70b9\u6765\u5b58\u50a8\u5fc5\u8981\u7684\u4fe1\u606f\u7528\u4e8e\u8ba1\u7b97\u533a\u95f4\u548c\u3002\u8fd9\u4e00\u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(qK \\\\log n)$\uff0c\u81f3\u4e8e\u4f7f\u7528\u6570\u636e\u7ed3\u6784\u5904\u7406\u533a\u95f4\u52a0\u7684\u8fc7\u7a0b\u8fd9\u91cc\u5c31\u4e0d\u8be6\u7ec6\u8ba8\u8bba\u4e86\u3002<br/>\u73b0\u5728\u7684\u95ee\u9898\u662f\u6211\u4eec\u9700\u8981\u5f97\u5230 $P'(x)$ \u7684\u7cfb\u6570\u8868\u8fbe\u5f62\u5f0f\u624d\u80fd\u65b9\u4fbf\u5730\u52a0\u51cf\u3002\u8bbe $P(x) = \\\\sum_{k = 0}^K a_k x^k$\uff0c\u4ee5\u53ca\u5e73\u79fb\u91cf $c$\uff0c\u90a3\u4e48 $P'(x) = P(x + c) = \\\\sum_{k = 0}^K a_k (x + c)^k$\u3002\u8fd9\u663e\u7136\u53ef\u4ee5\u76f4\u63a5\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5728 $\\\\Theta(K^2)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5c55\u5f00\u3002\u4f46\u662f\u8fd9\u79cd\u5f62\u5f0f\u7684\u5f0f\u5b50\u666e\u904d\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5377\u79ef1\uff0c\u4ece\u800c\u80fd\u591f\u5229\u7528 FFT \u7b97\u6cd5\u6765\u52a0\u901f\u3002\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e00\u70b9\uff0c\u8003\u8651\u5229\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u5e76\u8fdb\u884c\u6574\u7406\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{k = 0}^K a_k(x + c) ^k & = \\\\sum_{k = 0}^K a_k \\\\sum_{j = 0}^k \\\\binom{k}{j} x^j c^{k - j} = \\\\sum_{j = 0}^K x^j \\\\sum_{k = j}^K \\\\binom{k}{j}a_k c^{k - j} \\\\\\\\<br/>& = \\\\sum_{j = 0}^K {x^j \\\\over j!} \\\\sum_{k = j}^K k!\\\\  a_k \\\\cdot {c^{k - j} \\\\over (k - j)!} \\\\\\\\<br/>& = \\\\sum_{j = 0}^K {x^j \\\\over j!} \\\\sum_{t = 0}^{K - j} (j + t)!\\\\  a_{j + t} \\\\cdot {c^t \\\\over t!} ~~~~ (t = k - j)\\\\\\\\<br/>\\\\end{aligned}<br/>$$<br/>\u6b64\u65f6\u53f3\u8fb9\u7684\u5f0f\u5b50\u5df2\u7ecf\u53d8\u6210\u4e86\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u3002\u4ee4 $B_k = (K - k)! \\\\ a_{K - k}$\u3001$C_k = c^k / k!$\uff0c\u90a3\u4e48\uff1a<br/>$$<br/>P'(x) = \\\\sum_{j = 0}^K {x^j \\\\over j!} \\\\sum_{t = 0}^{K - j}B_{K - j - t} \\\\cdot C_t<br/>$$<br/>\u4ee4 $F(n) = \\\\sum_{k = 0}^n B_k \\\\cdot C_{n - k}$\uff0c$F(n)$ \u53ef\u4ee5\u7528 FFT \u7b97\u6cd5\u5728 $\\\\Theta(K \\\\log K)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa\u6765\uff0c\u6b64\u65f6\uff1a<br/>$$<br/>P'(x) = \\\\sum_{j = 0}^K {F(K - j) \\\\over j!} x^j<br/>$$<br/>\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 $\\\\Theta(K \\\\log K)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u591a\u9879\u5f0f\u5e73\u79fb\u3002\u7ed3\u5408\u6570\u636e\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 $O(nK + qK(\\\\log n + \\\\log K)) = O((n + q)K \\\\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u89e3\u51b3\u533a\u95f4\u52a0\u591a\u9879\u5f0f\u95ee\u9898\u3002<br/>\u79bb\u7ebf\u7b97\u6cd5<br/>\u63a5\u4e0b\u6765\u7684\u76ee\u6807\u662f\u8ba9\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u5f97\u4e0e\u5e8f\u5217\u957f\u5ea6 $n$ \u65e0\u5173\u3002\u8003\u8651\u6c42\u533a\u95f4\u548c\u7684\u4e00\u79cd\u79bb\u7ebf\u7b97\u6cd5\uff1a\u626b\u63cf\u7ebf\u7b97\u6cd5\u3002<br/><br/>(Fig.1. \u626b\u63cf\u7ebf\u7b97\u6cd5\u7684\u4e00\u4e2a\u793a\u4f8b\u3002$6$ \u4e2a\u65b9\u683c\u4ee3\u8868\u5e8f\u5217 $X[1..6]$\u3002\u4e0a\u9762\u7684\u64cd\u4f5c\u662f\u5c06\u533a\u95f4 $[2, 4]$ \u90fd\u52a0\u4e0a $3$\uff1b\u4e0b\u9762\u7684\u662f\u626b\u63cf\u7ebf\u7684\u8fc7\u7a0b\uff0c\u9996\u5148\u5c06\u539f\u5e8f\u5217\u89c6\u4e3a\u5dee\u5206\u5e8f\u5217\uff0c\u5728\u4f4d\u7f6e $2$ \u52a0\u4e0a $3$\uff0c\u4f4d\u7f6e $4$ \u51cf\u53bb $3$\uff0c\u6a21\u62df\u4e00\u6839\u626b\u63cf\u7ebf\u4ece $1$ \u4e00\u76f4\u626b\u63cf\u5230 $6$\uff0c\u5176\u4e2d\u9047\u5230\u6b63\u6570\u5c31\u7ed9 $A$ \u52a0\u4e0a\uff0c\u9047\u5230\u8d1f\u6570\u5219\u76f8\u5e94\u5730\u51cf\u53bb\uff0c\u8fd9\u6837\u626b\u63cf\u7ebf\u626b\u5230\u54ea\u91cc\uff0c$A$ \u7684\u503c\u5c31\u662f\u90a3\u4e2a\u4f4d\u7f6e\u7684\u503c)<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5148\u53ea\u8003\u8651\u5355\u70b9\u67e5\u8be2\u3002\u7531\u4e8e\u9700\u8981\u652f\u6301\u4fee\u6539\u8fc7\u7a0b\u4e2d\u7684\u67e5\u8be2\uff0c\u6240\u4ee5\u5bf9\u6bcf\u4e2a\u64cd\u4f5c\u8bb0\u5f55\u4e00\u4e2a\u65f6\u95f4\u6233 $t$\uff0c\u7279\u522b\u7684\uff0c\u7b2c\u4e00\u4e2a\u64cd\u4f5c\u7684\u65f6\u95f4\u6233\u662f $1$\u3002\u5982\u679c\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u5219\u5f53\u524d\u65f6\u95f4\u52a0 $1$\uff0c\u800c\u67e5\u8be2\u64cd\u4f5c\u4e0d\u5fc5\u589e\u52a0\u65f6\u95f4\u3002\u8fd9\u6837\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5355\u70b9\u67e5\u8be2\u4ee5\u53ca\u5b83\u7684\u65f6\u95f4\u6233 $t$\uff0c\u53ea\u9700\u8981\u5c06\u6240\u6709\u65f6\u95f4\u6233\u4e0d\u5927\u4e8e $t$ \u7684\u533a\u95f4\u8986\u76d6\u4e86\u5f53\u524d\u4f4d\u7f6e\u7684\u4fee\u6539\u64cd\u4f5c\u7684\u591a\u9879\u5f0f\u52a0\u8d77\u6765\uff0c\u5c31\u53ef\u5f97\u5230\u5f53\u524d\u4f4d\u7f6e\u7684\u591a\u9879\u5f0f\uff0c\u4ece\u800c\u53ef\u4ee5\u8ba1\u7b97\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u503c\u3002\u56e0\u6b64\u6211\u4eec\u5728\u626b\u63cf\u7ebf\u7684\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08\u5e73\u8861\u6811/\u7ebf\u6bb5\u6811\uff09\uff0c\u6309\u7167\u65f6\u95f4\u6233\u7684\u987a\u5e8f\u6765\u7ef4\u62a4\u6240\u6709\u7684\u4fee\u6539\u64cd\u4f5c\u7684\u591a\u9879\u5f0f\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u4fee\u6539\u64cd\u4f5c\uff0c\u5728\u533a\u95f4\u5f00\u59cb\u7684\u4f4d\u7f6e\u52a0\u4e00\u4e2a\u201c\u6dfb\u52a0\u201d\u4e8b\u4ef6\uff0c\u533a\u95f4\u672b\u5c3e\u52a0\u4e00\u4e2a\u201c\u5220\u9664\u201d\u4e8b\u4ef6\uff0c\u6267\u884c\u76f8\u5e94\u7684\u4e8b\u4ef6\u65f6\u5c31\u5c06\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u5bf9\u5e94\u591a\u9879\u5f0f\u63d2\u5165\u6216\u5220\u9664\uff1b\u800c\u5bf9\u4e8e\u67e5\u8be2\u64cd\u4f5c\uff0c\u5c31\u53ea\u9700\u67e5\u8be2\u524d\u7f00\u548c\u5373\u53ef\u3002\u5b9e\u9645\u4e0a\uff0c\u5982\u679c\u67d0\u4e2a\u4f4d\u7f6e\u6ca1\u6709\u4efb\u4f55\u4e8b\u4ef6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\uff0c\u56e0\u4e3a\u5b83\u4e0d\u4f1a\u5bf9\u6211\u4eec\u7684\u6570\u636e\u7ed3\u6784\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\uff0c\u4ece\u800c\u53ef\u4ee5\u5728 $O(qK \\\\log q)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u5b8c\u6210\u533a\u95f4\u4fee\u6539/\u5355\u70b9\u67e5\u8be2\u95ee\u9898\u3002<br/>\u73b0\u5728\u6765\u8003\u8651\u533a\u95f4\u67e5\u8be2\u3002\u6211\u4eec\u77e5\u9053\uff0c\u5229\u7528\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u5c06\u533a\u95f4\u548c\u53d8\u4e3a\u4e24\u4e2a\u5355\u70b9\u503c\u4e4b\u5dee\u3002\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u4e0d\u96be\u60f3\u5230\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u591a\u9879\u5f0f $P(x)$ \u53d8\u6210\u81ea\u5df1\u7684\u524d\u7f00\u548c\u591a\u9879\u5f0f\uff0c\u5373 $P'(x) = \\\\sum_{k = 1}^x P(k)$\uff0c\u8fd9\u6837\u6211\u4eec\u7ef4\u62a4\u7684\u5b9e\u9645\u4e0a\u5c31\u662f\u539f\u5e8f\u5217\u7684\u524d\u7f00\u548c\u5e8f\u5217\uff0c\u6210\u529f\u5730\u5c06\u533a\u95f4\u67e5\u8be2\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u5355\u70b9\u67e5\u8be2\u95ee\u9898\u3002\u6211\u4eec\u77e5\u9053\uff0c$K$ \u6b21\u591a\u9879\u5f0f\u7684\u524d\u7f00\u548c\u662f $K + 1$ \u6b21\u591a\u9879\u5f0f\uff0c\u800c\u8ba1\u7b97\u591a\u9879\u5f0f\u524d\u7f00\u548c\u6709\u5f88\u591a\u516c\u5f0f\u6216\u65b9\u6cd5\uff1a\u4f2f\u52aa\u5229\u516c\u5f0f\uff08\u53c8\u79f0 Faulhaber\u2019s formula\uff09\u3001\u79bb\u6563\u5fae\u79ef\u5206\u3001\u5b50\u96c6\u53cd\u6f14\u6216\u8005\u591a\u9879\u5f0f\u63d2\u503c\u3002\u4f46\u5b83\u4eec\u90fd\u662f\u9488\u5bf9 $k$ \u6b21\u5355\u9879\u5f0f\uff08\u5373 $x^k$\uff09\u7684\u516c\u5f0f\uff0c\u5e76\u4e14\u8ba1\u7b97\u590d\u6742\u5ea6\u90fd\u662f $\\\\Theta(k)$\uff0c\u5982\u679c\u8fd0\u7528\u5230\u4efb\u610f $K$ \u6b21\u591a\u9879\u5f0f\uff0c\u5c31\u53c8\u9700\u8981 $\\\\Theta(K^2)$ \u7684\u65f6\u95f4\u3002<br/>\u5230\u4e86\u8fd9\u79cd\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u53c8\u4f1a\u60f3\u8981 FFT \u51fa\u573a\u4e86\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u9009\u62e9\u4e00\u4e2a\u4fbf\u4e8e\u53d8\u5f62\u7684\u516c\u5f0f\u3002\u6211\u7ecf\u8fc7\u4e00\u756a\u6311\u9009\uff0c\u53d1\u73b0\u8fd8\u662f\u4f2f\u52aa\u5229\u516c\u5f0f\u5f62\u5f0f\u6700\u4f18\u79c0\uff1a<br/>$$<br/>\\\\sum_{k = 1}^x k^n = 1^n + 2^n + \\\\cdots + x^n = \\\\frac1{n+1}\\\\sum_{k = 0}^n \\\\binom{n + 1}{k} B_k x^{n + 1 - k}<br/>\\\\tag{Bernoulli's Formula}<br/>$$<br/>\u5176\u4e2d $B_k$ \u8868\u793a\u4f2f\u52aa\u5229\u6570\uff0c\u5e76\u4e14 $B_1 = +1/2$2\u3002\u4f2f\u52aa\u5229\u6570\u53ef\u4ee5\u901a\u8fc7\u591a\u9879\u5f0f\u9006\u5143\u5feb\u901f\u8ba1\u7b97\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u8fd9\u91cc\u3002\u6216\u8005\u5f53 $K$ \u8db3\u591f\u5c0f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u9700\u8981\u7684\u4f2f\u52aa\u5229\u6570\u5b58\u5165\u7a0b\u5e8f\u3002<br/>\u63a5\u4e0b\u6765\u53c8\u8981\u7ecf\u8fc7\u4e00\u756a\u5957\u8def\u53d8\u5f62\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{k = 1}^x P(k) & = \\\\sum_{k = 1}^x \\\\sum_{j = 0}^K a_j k^j = \\\\sum_{j = 0}^K a_j \\\\sum_{k = 1}^x k^j \\\\\\\\<br/>& = \\\\sum_{j = 0}^K {a_j \\\\over j + 1} \\\\sum_{k = 0}^j \\\\binom{j + 1}{k} B_k x^{j + 1 - k} \\\\\\\\<br/>&  = \\\\sum_{j = 0}^K {a_j \\\\over j + 1} \\\\sum_{t = 0}^j \\\\binom{j + 1}{j - t} B_{j - t} x^{t + 1} ~~~~ (t = j - k) \\\\\\\\<br/>&  = \\\\sum_{t = 0}^K x^{t  + 1} \\\\sum_{j  = t}^K {a_j \\\\over j + 1} \\\\binom{j + 1}{j - t} B_{j - t} \\\\\\\\<br/>& = \\\\sum_{t = 0}^K {x^{t + 1} \\\\over (t + 1)!} \\\\sum_{j = t}^K j!\\\\ a_j \\\\cdot {B_{j - t} \\\\over (j - t)!} \\\\\\\\<br/>& = \\\\sum_{t = 0}^K {x^{t + 1} \\\\over (t + 1)!} \\\\sum_{j = 0}^{K - t} (j + t)!\\\\ a_{j + t} \\\\cdot {B_j \\\\over j!}<br/>\\\\end{aligned}<br/>$$<br/>Alright\uff013\u53c8\u662f\u719f\u6089\u7684\u9762\u5b54\u3002\u6545\u6280\u91cd\u65bd\uff0c\u4ee4 $C_k = (K - k)!\\\\ a_{K - k}$\u3001$D_k = B_k / k!$\uff0c\u53f3\u8fb9\u5c31\u53d8\u6210\u4e86\u5377\u79ef\u7684\u5f62\u5f0f\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728 $\\\\Theta(K \\\\log K)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u8ba1\u7b97\u591a\u9879\u5f0f\u524d\u7f00\u548c\u7684\u8868\u8fbe\u5f0f\u3002\u7ed3\u5408\u4e4b\u524d\u5355\u70b9\u67e5\u8be2\u7684\u7b97\u6cd5\uff0c\u5982\u679c\u5141\u8bb8\u79bb\u7ebf\u64cd\u4f5c\uff0c\u533a\u95f4\u52a0\u591a\u9879\u5f0f\u95ee\u9898\u53ef\u4ee5\u5728 $O(qK \\\\log q)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u3002\u53e6\u5916\uff0c\u5c06\u533a\u95f4\u548c\u8f6c\u5316\u4e3a\u5355\u70b9\u5dee\u4e4b\u540e\uff0c\u5b9e\u9645\u4e0a\u8fd8\u53ef\u4ee5\u4f7f\u7528\u52a8\u6001\u5f00\u70b9\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b9e\u73b0\u5728\u7ebf\u7b97\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(qK \\\\log n)$ \u7684\u3002<br/>\u6700\u540e\uff0c\u6211\u81ea\u5df1\u4f7f\u7528 C++ \u5b9e\u73b0\u4e86\u79bb\u7ebf\u7b97\u6cd5\uff0c\u5982\u679c\u60f3\u8981\u67e5\u770b\u53ef\u4ee5\u524d\u5f80 \u6211\u7684 GitHub\u3002<br/><br/><br/><br/><br/>\u5377\u79ef\u662f\u9488\u5bf9\u4e24\u4e2a\u5e8f\u5217 $A[0..n]$ \u548c $B[0..n]$ \u800c\u8a00\u7684\u3002\u5b9a\u4e49\u5377\u79ef $C = A \\\\times B$\uff0c\u5219 $C(n) = \\\\sum_{k = 0}^n A(k) \\\\cdot B(n - k)$\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u53ef\u4ee5\u89c6\u4e3a\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u6545\u53ef\u4ee5\u4f7f\u7528 FFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff09\u6765\u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n \\\\log n)$\u3002\u00a0\u21a9<br/><br/><br/>\u6709\u4e00\u4e9b\u5730\u65b9\u7684\u4f1a\u4f7f\u7528 $B_1 = -1/2$ \u7684\u4f2f\u52aa\u5229\u6570\u3002\u00a0\u21a9<br/><br/><br/>\u201cBut your spelling is alwrong.\u201d \u2014\u2014 Concrete Mathematics\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2018-1-28/interval-polynomial.html"
},
"\u53cb\u94fe": {
"tags": "Friend Links",
"text": "\u53cb\u60c5\u94fe\u63a5<br/>\u6b22\u8fce\u5404\u4f4d\u5927\u795e\u6765\u4e92\u6362\u53cb\u94fe~~~<br/><br/><br/><br/>Nickname<br/>Address<br/><br/><br/><br/><br/>ruanxingzhi<br/>ruanx.pw<br/><br/><br/>Haogram<br/>haogram.hol.es<br/><br/><br/>HJWJBSR<br/>hjwjbsr.is-programmer.com<br/><br/><br/>Mr.Rabbit<br/>www.ianime.co<br/><br/><br/>Linyxus<br/>blog.linyxus.xyz<br/><br/><br/>memset0<br/>memset0.cf<br/><br/><br/>MicDZ<br/>www.micdz.cn<br/><br/><br/><br/>\u53e6\u5916\u8fd9\u91cc\u662f\u51e0\u4e2a\u672c\u6821\u795e\u7287\uff1a<br/><br/><br/><br/>Nickname<br/>Address<br/><br/><br/><br/><br/>remoon<br/>CSDN/remoon<br/><br/><br/>Creeper_LKF<br/>CSDN/Creeper_LKF<br/><br/><br/>Twilight_<br/>CSDN/Twilight_Sx<br/><br/><br/>",
"url": "links.html"
},
"\u53cc\u91cd\u8ba1\u6570\u7684\u7b80\u5355\u5e94\u7528": {
"tags": "\u56fe\u8ba1\u6570 \u7ec4\u5408\u6570\u5b66",
"text": "\u53cc\u91cd\u8ba1\u6570\u7684\u7b80\u5355\u5e94\u7528<br/>\u4ec0\u4e48\u662f\u53cc\u91cd\u8ba1\u6570<br/>\u53cc\u91cd\u8ba1\u6570\u5c31\u662f\u5c31\u662f\u8ba1\u6570\u540c\u4e00\u4e2a\u4e8b\u7269\u8003\u8651\u4e24\u79cd\u8ba1\u7b97\u65b9\u5f0f\uff0c\u5f97\u5230\u4e24\u4e2a\u770b\u4e0a\u53bb\u6ca1\u6709\u8054\u7cfb\u7684\u8868\u8fbe\u5f0f\u76f8\u7b49\uff0c\u4ece\u800c\u5f97\u5230\u4f18\u7f8e\u7684\u516c\u5f0f\u7684\u4e00\u79cd\u65b9\u6cd5\u3002\u901a\u5e38\u4e5f\u88ab\u79f0\u4f5c\u201c\u591a\u91cd\u8ba1\u6570\u201d\u6216\u8005\u201c\u53cc\u8ba1\u6570\u201d\u3002<br/>\u5e94\u7528<br/>\u7ec4\u5408\u6052\u7b49\u5f0f<br/>\u5927\u5c0f\u4e3a $n$ \u7684\u96c6\u5408\u7684\u6240\u6709\u5b50\u96c6\u6570\u662f $2^n$ \u7684\uff0c\u56e0\u4e3a\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u53ef\u4ee5\u9009\u62e9\u9009\u6216\u8005\u4e0d\u9009\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5b83\u7684\u5b50\u96c6\u6570\u76ee\u540c\u65f6\u4e5f\u662f $\\\\sum_{k=0}^n {n \\\\choose k}$\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u7ecf\u5178\u7684\u7ec4\u5408\u6052\u7b49\u5f0f\uff1a<br/>$$<br/>\\\\sum_{k=0}^n {n \\\\choose k} = 2^n \\\\tag{2.1}<br/>$$<br/>\u8fd9\u5e94\u8be5\u662f\u53cc\u8ba1\u6570\u6700\u57fa\u7840\u7684\u8fd0\u7528\u4e86\u5427\u3002<br/>\u6211\u4eec\u9012\u63a8\u7ec4\u5408\u6570\u65f6\u7ecf\u5e38\u4f1a\u7528\u5230\u8fd9\u6837\u7684\u516c\u5f0f\uff1a<br/>$$<br/>k{n \\\\choose k} = n{n - 1 \\\\choose k - 1} \\\\tag{2.2}<br/>$$<br/>\u8bc1\u660e\u5b83\u5341\u5206\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5c06\u7ec4\u5408\u6570\u516c\u5f0f\u5c55\u5f00\u7ea6\u5206\u5373\u53ef\u3002\u4f46\u662f\u5f62\u8c61\u7684\u7ec4\u5408\u8bc1\u660e\u4e5f\u8bb8\u66f4\u597d\uff0c\u56e0\u6b64\u6211\u4eec\u6765\u8003\u8651\u4e8c\u5143\u7ec4 $(A,\\\\;x)$ \u7684\u6570\u91cf\uff0c\u5176\u4e2d\u8981\u6c42\u6ee1\u8db3 $x \\\\in A$\u3002\u6211\u4eec\u4ece\u4e24\u4e2a\u65b9\u9762\u6765\u8003\u8651\uff1a<br/><br/>\u5982\u679c\u5148\u8ba1\u6570\u96c6\u5408 $A$\uff0c\u518d\u8ba1\u6570 $x$\uff1a\u96c6\u5408 $A$ \u7684\u6570\u91cf\u4e3a ${n \\\\choose k}$\uff0c\u4ece\u4e2d\u9009\u51fa\u4e00\u4e2a\u5143\u7d20\u7684\u65b9\u6848\u6570\u4e3a $k$\uff0c\u6240\u4ee5\u603b\u65b9\u6848\u6570\u4e3a $k{n \\\\choose k}$\u3002<br/>\u5982\u679c\u5148\u8ba1\u6570 $x$\uff0c\u518d\u8ba1\u6570 $A$\uff1a\u9996\u5148 $x$ \u6709 $n$ \u79cd\u9009\u6cd5\uff0c\u7136\u540e\u8003\u8651\u4ece\u5269\u4e0b\u7684 $n - 1$ \u4e2a\u5143\u7d20\u91cc\u9762\u6765\u9009\u51fa $k - 1$ \u4e2a\u5143\u7d20\uff0c\u5373\u53ef\u5f97\u5230\u4e00\u4e2a\u5927\u5c0f\u4e3a $k$ \u7684\u5b50\u96c6 $A$\u3002\u56e0\u6b64\u603b\u65b9\u6848\u6570\u4e3a $n{n - 1 \\\\choose k - 1}$\u3002<br/><br/>\u7531\u4e8e\u6211\u4eec\u8ba1\u6570\u7684\u662f\u540c\u4e00\u4e2a\u4e1c\u897f\uff0c\u6240\u4ee5 $(2.2)$ \u5f0f\u6210\u7acb\u3002<br/>Burnside \u5b9a\u7406<br/>Burnside \u5b9a\u7406\u7684\u8bc1\u660e\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u5de7\u5999\u7684\u53cc\u8ba1\u6570\uff0c\u5177\u4f53\u7684\u8bc1\u660e\u8fc7\u7a0b\u5c31\u4e0d\u5728\u8fd9\u91cc\u5c55\u51fa\uff0c\u5404\u4f4d\u53ef\u4ee5\u53c2\u8003\u7f51\u4e0a\u7684\u76f8\u5173\u8d44\u6599\u6216\u8005\u8fd9\u7bc7\u535a\u5ba2\u3002<br/>\u65e0\u6807\u53f7\u7684\u6709\u6839\u6811\u8ba1\u6570<br/>\u65e0\u6807\u53f7\u7684\u6709\u6839\u6811\u8868\u793a\u6211\u4eec\u6240\u8ba1\u6570\u7684\u6811\u662f\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u6839\u8282\u70b9\uff0c\u4f46\u662f\u540c\u6784\u7684\u6811\u53ea\u80fd\u7b97\u4e00\u4e2a\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u4ee4 $n$ \u4e2a\u65e0\u6807\u53f7\u8282\u70b9\u7684\u6709\u6839\u6811\u7684\u6570\u91cf\u4e3a $t(n)$\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4e09\u68f5\u6811\u4e2d\uff1a<br/><br/>\u84dd\u8272\u7684\u8282\u70b9\u662f\u6839\u8282\u70b9\uff0c\u7b2c\u4e00\u68f5\u6811\u548c\u7b2c\u4e8c\u68f5\u6811\u867d\u7136\u672c\u8d28\u4e0a\u4e00\u6a21\u4e00\u6837\uff0c\u4f46\u662f\u7531\u4e8e\u6811\u6839\u7684\u4e0d\u540c\uff0c\u6240\u4ee5\u7b97\u4f5c\u4e0d\u540c\u7684\u6811\u3002\u800c\u7b2c\u4e09\u68f5\u6811\u548c\u7b2c\u4e00\u68f5\u6570\u4ec5\u4ec5\u53ea\u662f\u5b50\u6811\u987a\u5e8f\u7684\u8c03\u52a8\uff0c\u7531\u4e8e\u8282\u70b9\u6ca1\u6709\u7f16\u53f7\uff0c\u6240\u4ee5\u8ba4\u4e3a\u4e0e\u7b2c\u4e00\u68f5\u6811\u662f\u540c\u6784\u7684\u3002<br/>\u5982\u4f55\u8ba1\u6570\u8fd9\u6837\u7684\u4e1c\u897f\uff1f\u9996\u5148\u6709\u4e00\u4e2a\u660e\u663e\u7684\u7279\u5f81\u5c31\u662f\u6811\u6839\u662f\u56fa\u5b9a\u7684\uff0c\u800c\u6bcf\u4e00\u68f5\u5b50\u6811\u53c8\u662f\u4e00\u68f5\u6709\u6839\u6811\uff0c\u6240\u4ee5\u6211\u4eec\u6765\u8003\u8651\u9012\u63a8\uff1a\u8bbe $f(n, \\\\;m)$ \u8868\u793a $n$ \u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u6700\u5927\u7684\u5b50\u6811\u5927\u5c0f\u4e3a $m$ \u7684\u65b9\u6848\u6570\uff0c\u901a\u8fc7\u679a\u4e3e\u5927\u5c0f\u4e3a $m$ \u7684\u5b50\u6811\u7684\u4e2a\u6570 $k$ \u53ef\u4ee5\u505a\u5982\u4e0b\u9012\u63a8\uff1a<br/>$$<br/>f(n,\\\\;m) = \\\\sum_{1 \\\\leqslant mk < n} {k + t(m) - 1 \\\\choose k} \\\\sum_{i = 1}^{m - 1} f(n - mk, \\\\;i)\u3000\\\\tag{2.3}<br/>$$<br/>\u800c $t(n) = \\\\sum_{k = 1}^{n - 1} f(n,\\\\;k)$\uff0c\u6240\u4ee5\u5229\u7528\u4e00\u4e9b\u9012\u63a8\u6280\u5de7\uff0c\u4e0d\u8003\u8651\u7b97\u672f\u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 $O(n^2\\\\ln n)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa $t(n)$\u3002<br/>\u73b0\u5728\u6211\u4eec\u6765\u8003\u8651\u4f7f\u7528\u53cc\u8ba1\u6570\u7684\u6280\u5de7\uff0c\u5c1d\u8bd5\u8ba1\u6570\u4e8c\u5143\u7ec4 $(T, \\\\;x)$ \u7684\u65b9\u6848\u6570\uff0c\u5176\u4e2d $T$ \u662f\u4e00\u68f5\u6709\u6839\u6811\uff0c\u800c $x$ \u662f\u5c06 $T$ \u6309\u7167\u6700\u5c0f\u8868\u793a\u6cd51\u6807\u53f7\u4e4b\u540e\u4e00\u4e2a\u975e\u6811\u6839\u7684\u8282\u70b9\u7f16\u53f7\uff0c\u73b0\u5728\u6765\u8003\u8651\u4e24\u4e2a\u65b9\u9762\uff1a<br/><br/>\u8003\u8651\u5148\u8ba1\u6570 $T$\uff0c\u540e\u8ba1\u6570 $x$\uff1a\u603b\u5171\u7684 $T$ \u5171\u6709 $t(n)$ \u4e2a\uff0c\u5176\u4e2d\u975e\u6839\u8282\u70b9\u6570\u91cf\u4e3a $n - 1$ \u4e2a\uff0c\u6545\u603b\u65b9\u6848\u6570\u4e3a $(n - 1)t(n)$\u3002<br/>\u8003\u8651\u5148\u8ba1\u6570 $x$\uff0c\u540e\u8ba1\u6570 $T$\uff1a\u9996\u5148\u5047\u5b9a $x$ \u5728\u4e00\u4e2a\u5927\u5c0f\u4e3a $m$ \u7684\u67d0\u4e2a\u5b50\u6811\u4e2d\uff0c\u8fd9\u6837\u7684\u5b50\u6811\u4e00\u5171\u6709 $t(m)$ \u79cd\uff0c\u800c\u5b50\u6811\u4e0a\u7684 $x$ \u6709 $m$ \u79cd\uff0c\u6240\u4ee5\u4e00\u5171\u6709 $mt(m)$ \u79cd\u3002\u7136\u540e\u6ce8\u610f\u5230\u8ddf\u5b83\u76f8\u540c\u7684\u5b50\u6811\u53ef\u80fd\u4e0d\u6b62\u4e00\u4e2a\uff0c\u800c\u6211\u4eec\u7684 $x$ \u90fd\u8981\u679a\u4e3e\u5230\u3002\u5f53 $x$ \u5728\u7b2c\u4e00\u68f5\u4e0a\u8fd9\u6837\u7684\u5b50\u6811\u65f6\uff0c\u65b9\u6848\u6570\u4e3a $t(n - m)$\uff0c\u5728\u7b2c\u4e8c\u68f5\u65f6\uff0c\u65b9\u6848\u6570\u4e3a $t(n - 2m)$......\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u65b9\u6848\u6570\u4e3a $\\\\sum_{1 \\\\leqslant km < n} t(n - km)$\u3002\u7531\u4e8e $x$ \u5728\u4e0d\u540c\u7684\u5927\u5c0f\u7684\u5b50\u6811\u4e2d\uff0c\u6240\u4ee5\u603b\u65b9\u6848\u6570\u4e3a $\\\\sum_{m = 1}^{n - 1}mt(m)\\\\sum_{1\\\\leqslant km<n}t(n-km)$<br/><br/>\u8054\u7acb\u4e24\u5f0f\u76f8\u7b49\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\uff1a<br/>$$<br/>t(n) = \\\\frac1{n-1}\\\\sum_{m = 1}^{n - 1}mt(m)\\\\sum_{1\\\\leqslant km<n}t(n-km) \\\\tag{2.4}<br/>$$<br/>\u901a\u8fc7\u679a\u4e3e $T = mk$\uff0c\u9012\u63a8\u5f0f\u53ef\u4ee5\u53d8\u4e3a\uff1a<br/>$$<br/>t(n) = \\\\frac1{n-1}\\\\sum_{T = 1}^{n - 1} t(n - T) \\\\sum_{m \\\\mid T} mt(m) \\\\tag{2.5}<br/>$$<br/>\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u5728 $O(n^2)$ \u65f6\u95f4\u9012\u63a8\u8ba1\u7b97 $t(n)$ \u4e86\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fdb\u4e00\u6b65\u7684\u53d8\u5f62\u4ece\u800c\u5229\u7528FFT\u7b97\u6cd5\u6765\u52a0\u901f\u8ba1\u7b97\u3002\u5f53\u7136\u6709\u5173\u5229\u7528\u751f\u6210\u51fd\u6570\u6765\u8ba1\u7b97\u7c7b\u4f3c\u95ee\u9898\u7684\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\u3002<br/>\u65e0\u6807\u53f7\u7684\u65e0\u5411\u8fde\u901a\u7b80\u5355\u56fe\u8ba1\u6570<br/>\u4e0a\u8ff0\u65b9\u6cd5\u53ef\u4ee5\u7ee7\u7eed\u5957\u7528\u5230\u65e0\u5411\u56fe\u4e0a\u6765\uff0c\u9996\u5148\u6211\u4eec\u8bbe $n$ \u4e2a\u6ca1\u6709\u6807\u53f7\u7684\u65e0\u5411\u7b80\u5355\u56fe\u6570\u91cf\u4e3a $h(n)$\uff0c\u8fde\u901a\u56fe\u6570\u91cf\u4e3a $f(n)$\uff0c\u4ee5\u53ca\u975e\u8fde\u901a\u56fe\u6570\u91cf\u4e3a $g(n)$\u3002$n = 0..5$ \u7684\u51e0\u4e2a\u6570\u503c\u5982\u4e0b2\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f: &1, 1, 1, 2, 6, 21, ... \\\\\\\\<br/>g: &0, 0, 1, 2, 5, 13, ... \\\\\\\\<br/>h: &1, 1, 2, 4, 11, 34, ...<br/>\\\\end{aligned}<br/>$$<br/>\u5173\u4e8e $h$ \u7684\u8ba1\u7b97\uff0c\u53ef\u4ee5\u4f7f\u7528 Polya \u8ba1\u6570\u6cd5\u6765\u5f97\u51fa\uff08\u53ea\u53ef\u60dc\u8fd9\u79cd\u65b9\u6cd5\u5e76\u4e0d\u9ad8\u6548\uff09\uff0c\u5177\u4f53\u7684\u65b9\u6cd5\u53ef\u4ee5\u53c2\u89c1\u8fd9\u91cc\u3002\u7531\u4e8e\u975e\u8fde\u901a\u56fe\u662f\u7531\u4e00\u4e9b\u8fde\u901a\u5757\u6784\u6210\u7684\uff0c\u5f88\u50cf\u6211\u4eec\u5728\u65e0\u6807\u53f7\u6709\u6839\u6811\u4e2d\u7684\u5b50\u6811\uff0c\u6240\u4ee5\u6211\u4eec\u63a5\u4e0b\u6765\u8003\u8651\u8ba1\u7b97\u5173\u4e8e $g$ \u7684\u9012\u63a8\u5173\u7cfb\u3002<br/>\u9996\u5148\uff0c\u6211\u4eec\u8003\u8651\u8ba1\u6570\u4e8c\u5143\u7ec4 $(G, \\\\;x)$ \u7684\u6570\u91cf\uff0c\u7c7b\u4f3c\u7684\uff0c$G$ \u662f\u4e00\u5f20\u975e\u8fde\u901a\u56fe\uff0c\u800c $x$ \u662f\u5c06 $G$ \u7f16\u53f7\u540e\u7684\u4e00\u4e2a\u8282\u70b9 $x$\u3002\u540c\u6837\uff0c\u6211\u4eec\u8003\u8651\u4e24\u4e2a\u65b9\u9762\uff1a<br/><br/>\u5148\u8ba1\u6570 $G$ \u540e\u8ba1\u6570 $x$\uff1a\u663e\u7136\u65b9\u6848\u6570\u4e3a $ng(n)$\u3002<br/>\u5148\u8ba1\u6570 $x$ \u540e\u8ba1\u6570 $G$\uff1a\u8003\u8651 $x$ \u5728\u4e00\u4e2a\u5927\u5c0f\u4e3a $t$ \u7684\u8fde\u901a\u5757\u4e2d\uff0c\u6309\u7167\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u8fd9\u6837\u7684 $x$ \u6709 $tf(t)$ \u79cd\u3002\u53e6\u5916\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u679a\u4e3e\u5b83\u662f $G$ \u4e2d\u7b2c\u51e0\u4e2a\u8fd9\u6837\u7684\u8fde\u901a\u5757\uff0c\u8fd9\u6837\u7684\u65b9\u6848\u6570\u662f $\\\\sum_{1 \\\\leqslant kt \\\\leqslant n} h(n - kt)$ \u79cd\u3002<br/><br/>\u6240\u4ee5\uff0c\u6211\u4eec\u5f97\u5230\uff1a<br/>$$<br/>g(n) = \\\\frac1n\\\\sum_{t = 1}^{n - 1} tf(t) \\\\sum_{1\\\\leqslant kt \\\\leqslant n} h(n - kt) \\\\tag{2.6}<br/>$$<br/>\u56e0\u6b64\u77e5\u9053\u4e86 $h(n)$ \u7684\u503c\uff0c\u540c\u65f6\u5c31\u53ef\u4ee5\u5c06 $f(n)$ \u548c $g(n)$ \u90fd\u8ba1\u7b97\u51fa\u6765\u3002<br/>\u7136\u800c\uff0c\u6211\u5e76\u6ca1\u6709\u627e\u5230\u66f4\u597d\u7684\u8ba1\u7b97 $h(n)$ \u7684\u529e\u6cd5\uff0c\u5e0c\u671b\u5982\u679c\u6709\u5927\u795e\u77e5\u9053\u80fd\u591f\u544a\u8bc9\u6211\u4e00\u58f0\uff01<br/><br/><br/><br/><br/>\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bd4\u8f83\u5c0f\u7684\uff08\u4f8b\u5982\u5927\u5c0f\u4e3a $1$\uff09\u5927\u5c0f\u76f8\u540c\u7684\u4e0d\u540c\u7684\u6709\u6839\u6811\u90fd\u7ed9\u4e2a\u7f16\u53f7\uff0c\u7136\u540e\u66f4\u5927\u7684\u6709\u6839\u6811\u53ef\u4ee5\u6309\u7167\u5148\u5b50\u6811\u5927\u5c0f\u540e\u5b50\u6811\u7f16\u53f7\u6765\u5bf9\u5b83\u6811\u6839\u7684\u5b50\u6811\u6392\u5e8f\uff0c\u56e0\u6b64\u5c31\u53ef\u4ee5\u7ee7\u7eed\u7ed9\u66f4\u5927\u7684\u5b50\u6811\u7f16\u53f7\u3002\u00a0\u21a9<br/><br/><br/>\u6211\u4eec\u8ba4\u4e3a\u5927\u5c0f\u4e3a $0$ \u7684\u56fe\u662f\u5b58\u5728\u7684\uff0c\u5e76\u4e14\u5b83\u662f\u8fde\u901a\u7684\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-6-19/double-count.html"
},
"\u5bc6\u7801\u9501": {
"tags": "Problems",
"text": "\u5bc6\u7801\u9501 (expression.cpp/in/out)<br/>\u65f6\u95f4\u9650\u5236: 1 s / \u5185\u5b58\u9650\u5236: 512 MB / \u6253\u5f00O2\u4f18\u5316<br/>\u9898\u76ee\u63cf\u8ff0<br/>dyx\u5728\u5bb6\u91cc\u73a9\u800d\u65f6\u53d1\u73b0\u4e86\u4e00\u4e2a\u795e\u5947\u7684\u5bc6\u7801\u9501\u3002\u7136\u800c\u4ed6\u65e9\u5df2\u5fd8\u8bb0\u4e86\u8fd9\u4e2a\u9501\u7684\u5bc6\u7801\uff0c\u4e8e\u662f\u4ed6\u968f\u4fbf\u5c1d\u8bd5\u4e86\u4e00\u4e0b\uff0c\u7ed3\u679c\u9501\u5c31\u6253\u5f00\u4e86......<br/>\u9501\u7684\u5185\u90e8\u6709\u4e00\u4e2a\u5f88\u957f\u7684\u5b57\u7b26\u4e32\uff0c\u673a\u667a\u7684dyx\u9a6c\u4e0a\u5c31\u53d1\u73b0\u8fd9\u5c31\u662f\u5bc6\u7801\u9501\u7684\u6838\u5fc3\u3002\u4e8e\u662f\u4ed6\u7814\u7a76\u4e86\u4e00\u4e0b\u5348\uff0c\u63a2\u5bfb\u8fd9\u628a\u9501\u7684\u5965\u79d8\u3002<br/>\u4ed6\u53d1\u73b0\u8fd9\u4e2a\u5b57\u7b26\u4e32\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u5f62\u5f0f\uff0c\u50cf\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a<br/>1a|b&(!c^d)<br/><br/><br/>\u5176\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u7531\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u7684\u5355\u8bcd\u662f\u4e00\u4e2a\u53d8\u91cf\uff0c\u5bf9\u5e94\u7740\u5bc6\u7801\u9501\u4e0a\u7684\u4e00\u4e2a\u6309\u94ae\u3002\u7531\u4e8e\u6309\u94ae\u53ea\u80fd\u6309\u4e0b\u6216\u4e0d\u6309\u4e0b\uff0c\u4e8e\u662f\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u6bcf\u4e2a\u53d8\u91cf\u662f\u4e00\u4e2a\u5e03\u5c14\u7c7b\u578b\u7684\uff08\u5373\u53ea\u6709$\\\\text{true}$\u548c$\\\\text{false}$\u4e4b\u5206\uff09<br/>\u5176\u4f59\u7684\u5b57\u7b26\u5c31\u53ea\u6709&\u3001|\u3001^\u3001!\u548c\u5de6\u53f3\u5c0f\u62ec\u53f7\u3002dyx\u53d1\u73b0\u62ec\u53f7\u662f\u7528\u6765\u4f18\u5148\u8fd0\u7b97\u7684\uff0c\u610f\u601d\u662f\u8fd9\u662f\u4e00\u4e2a\u4f1a\u5c06\u6240\u6709\u53d8\u91cf\u8fdb\u884c\u8ba1\u7b97\u7684\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e14\u4f18\u5148\u8ba1\u7b97\u62ec\u53f7\u4e2d\u7684\u5b50\u8868\u8fbe\u5f0f\u3002\u540c\u65f6\uff0c&\u3001|\u3001^\u3001!\u90fd\u662f\u8fd0\u7b97\u7b26\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u7684\u662f\u903b\u8f91\u4e0e\u3001\u903b\u8f91\u6216\u3001\u903b\u8f91\u5f02\u6216\u548c\u903b\u8f91\u975e\u3002\u5176\u4e2d\u524d\u4e09\u8005\u8fd0\u7b97\u4f18\u5148\u7ea7\u4e00\u81f4\uff0c\u5f53\u5b83\u4eec\u5728\u540c\u4e00\u7ea7\u51fa\u73b0\u65f6\u4f1a\u4ece\u5de6\u81f3\u53f3\u8fd0\u7b97\uff0c\u903b\u8f91\u975e\u7684\u4f18\u5148\u7ea7\u6bd4\u5b83\u4eec\u9ad8\u3002\u5f53\u6bcf\u4e00\u4e2a\u53d8\u91cf\u90fd\u6709\u76f8\u5e94\u7684\u503c\u65f6\uff0c\u6574\u4e2a\u8868\u8fbe\u5f0f\u5c31\u4f1a\u5c31\u4f1a\u8fdb\u884c\u8ba1\u7b97\uff0c\u5e76\u7ed9\u51fa\u4e00\u4e2a\u5e03\u5c14\u503c\u3002dyx\u8fd8\u53d1\u73b0\uff0c\u5f53\u6574\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a$\\\\text{true}$\u65f6\uff0c\u5bc6\u7801\u9501\u5c31\u4f1a\u6253\u5f00\u3002<br/>\u5f88\u660e\u663e\uff0c\u6574\u4e2a\u5bc6\u7801\u9501\u7684\u8f93\u5165\u65b9\u6848\u5171\u6709$2^n$\u79cd\uff0c\u5176\u4e2d$n$\u662f\u8868\u8fbe\u5f0f\u4e2d\u53d8\u91cf\u7684\u6570\u91cf\u3002\u4e8e\u662fdyx\u77ac\u95f4\u660e\u767d\u4e3a\u4ec0\u4e48\u4ed6\u4e00\u6b21\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5bc6\u7801\u9501\u89e3\u5f00\u4e86\u3002\u7136\u800cdyx\u662f\u4e00\u4e2a\u52c7\u4e8e\u63a2\u7a76\u7684\u4eba\uff0c\u4ed6\u60f3\u77e5\u9053\u5230\u5e95\u6709\u591a\u5c11\u4e2d\u65b9\u6cd5\u53ef\u4ee5\u89e3\u5f00\u4e00\u4e2a\u5bc6\u7801\u9501\u3002<br/>\u4e0d\u77e5\u4e3a\u4f55\uff0cdyx\u53c8\u53d1\u73b0\u4e86\u4e00\u706b\u8f66\u7684\u5bc6\u7801\u9501\u3002\u575a\u6301\u4e0d\u61c8\u7684dyx\u4e0d\u505c\u7684\u8ba1\u7b97\u7740\u6bcf\u4e00\u4e2a\u5bc6\u7801\u9501\u80fd\u89e3\u5f00\u7684\u65b9\u6848\u6570......\u7531\u4e8e\u5bc6\u7801\u9501\u7684\u8868\u8fbe\u5f0f\u8d8a\u6765\u8d8a\u957f\u5e76\u4e14\u4eba\u8111\u8ba1\u7b97\u91cf\u662f$\\\\Theta(1)$\u7684\uff0cdyx\u4e0d\u5f97\u4e0d\u9700\u8981\u4e00\u4e2a\u7a0b\u5e8f\u6765\u5e2e\u52a9\u4ed6\u8ba1\u7b97\u8fd9\u4e2a\u65b9\u6848\u6570\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6bcf\u4e2a\u6d4b\u8bd5\u6570\u636e\u70b9\u6709\u591a\u4e2a\u8868\u8fbe\u5f0f\u3002\u6587\u4ef6\u4ee5EOF\u7ed3\u675f\u3002<br/>\u6bcf\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5360\u4e00\u884c\uff0c\u4e14\u4e2d\u95f4\u53ea\u6709\u5c0f\u5199\u5b57\u6bcd\u548c&\u3001|\u3001^\u3001!\u3001(\u3001)\u3002<br/>\u5bf9\u4e8e&\u3001|\u548c^\u8fd0\u7b97\uff0c\u5b83\u4eec\u5de6\u53f3\u4f1a\u5404\u6709\u4e00\u4e2a\u53d8\u91cf\u6216\u5b50\u8868\u8fbe\u5f0f\u3002\u5176\u8fd0\u7b97\u89c4\u5219\u5982\u4e0b\uff1a<br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ & $b$ ($a \\\\land b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ | $b$ ($a \\\\lor b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/><br/><br/><br/>$a$<br/>$b$<br/>$a$ ^ $b$ ($a \\\\oplus b$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/>$\\\\text{fasle}$<br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/>$\\\\text{true}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/>$\\\\text{false}$<br/><br/><br/><br/>\u5bf9\u4e8e!\u8fd0\u7b97\uff0c\u5b83\u540e\u9762\u4f1a\u6709\u4e00\u4e2a\u53d8\u91cf\u6216\u5b50\u8868\u8fbe\u5f0f\u3002\u5176\u8fd0\u7b97\u89c4\u5219\u5982\u4e0b\uff1a<br/><br/><br/><br/>$a$<br/>!$a$ ($\\\\lnot a$)<br/><br/><br/><br/><br/>$\\\\text{true}$<br/>$\\\\text{false}$<br/><br/><br/>$\\\\text{false}$<br/>$\\\\text{true}$<br/><br/><br/><br/>\u8f93\u5165\u4fdd\u8bc1\u8868\u8fbe\u5f0f\u662f\u6709\u6548\u7684\uff0c\u4e14\u8868\u8fbe\u5f0f\u4e2d\u4e0d\u5b58\u5728\u7f3a\u5c11\u53c2\u6570\u7684\u8fd0\u7b97\u7b26\u548c\u7a7a\u7684\u62ec\u53f7\u3002<br/>\u4e3a\u4e86\u9632\u6b62\u6b64\u9898\u53d8\u6210\u4e0d\u53ef\u505a\u7684NP-hard\u95ee\u9898\uff0c\u8f93\u5165\u4fdd\u8bc1\u8868\u8fbe\u5f0f\u4e2d\u6bcf\u4e00\u4e2a\u53d8\u91cf\u540d\u53ea\u51fa\u73b0\u4e00\u6b21\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u8f93\u51fa\u80fd\u591f\u89e3\u5f00\u5b83\u7684\u65b9\u6848\u603b\u6570\u3002\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u8fc7\u5927\uff0c\u56e0\u6b64\u5c06\u7b54\u6848\u5bf9$10^9 + 7$\u53d6\u6a21\u540e\u8f93\u51fa\u3002<br/>\u4e00\u79cd\u65b9\u6848\u5373\u6307\u5bf9\u6bcf\u4e00\u4e2a\u53d8\u91cf\u7ed9\u5b9a\u4e00\u4e2a\u503c\u3002<br/>\u4e24\u79cd\u65b9\u6848\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u81f3\u5c11\u4e00\u4e2a\u53d8\u91cf\u6240\u7ed9\u5b9a\u7684\u503c\u4e0d\u540c\u3002<br/>\u8f93\u5165\u6837\u4f8b<br/>1<br/>2<br/>3a&b<br/>a|b|c<br/>a|!(b|c)<br/><br/><br/>\u8f93\u51fa\u6837\u4f8b<br/>1<br/>2<br/>31<br/>7<br/>5<br/><br/><br/>\u6570\u636e\u8303\u56f4\u53ca\u63d0\u793a<br/>\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u53ea\u6709$a = \\\\text{true}, b = \\\\text{true}$\u624d\u4e3a$\\\\text{true}$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\uff0c\u53ea\u8981\u4e09\u8005\u6709\u4e00\u4e2a\u53d8\u91cf\u4e3a$\\\\text{true}$\u5c31\u662f$\\\\text{true}$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5148\u8fd0\u7b97b|c\uff0c\u7136\u540e\u5bf9\u5176\u53d6\u53cd\uff0c\u6700\u540e\u4e0e$a$\u505a\u903b\u8f91\u4e0e\u3002<br/>\u4ee5\u4e0b$n$\u8868\u793a\u53d8\u91cf\u6570\u91cf\uff0c$T$\u8868\u793a\u6d4b\u8bd5\u6570\u636e\u7ec4\u6570\uff0c$L$\u8868\u793a\u8868\u8fbe\u5f0f\u7684\u603b\u957f\u5ea6\u3002<br/>\u5bf9\u4e8e$10\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 10,\\\\; T = 15$\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u53ea\u6709\u903b\u8f91\u6216\u8fd0\u7b97\uff0c\u6ca1\u6709\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$10\\\\% $\u7684\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u903b\u8f91\u975e\u548c\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u62ec\u53f7\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$20\\\\% $\u7684\u6570\u636e\uff0c$n \\\\le 500$\u3002<br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c\u53d8\u91cf\u540d\u957f\u5ea6$\\\\le 4$\uff0c$L \\\\le 10^6$\uff0c$n \\\\le 3\\\\times10^5$\u3002<br/>\u5176\u4e2d$90\\\\% $\u7684\u6570\u636e\uff0c$T \\\\le 5$\u3002",
"url": "blog/2016-6-30/expression.html"
},
"\u5dee\u5206\u5e8f\u5217\u4e0eStirling\u6570": {
"tags": "\u5dee\u5206 Stirling\u6570 \u591a\u9879\u5f0f\u63d2\u503c",
"text": "\u5dee\u5206\u5e8f\u5217\u4e0eStirling\u6570<br/>\u521a\u770b\u5b8c\u300a\u7ec4\u5408\u6570\u5b66\u300b\u7684\u8fd9\u4e00\u8282\uff0c\u5199\u4e00\u70b9\u7b14\u8bb0\u3002<br/>\u5dee\u5206\u5e8f\u5217<br/>\u5b9a\u4e49<br/>\u8bbe\u4e00\u4e2a\u5e8f\u5217\uff1a<br/>$$<br/>h(0), h(1), h(2), h(3), h(4), \\\\dots<br/>$$<br/>\u7684\u4e00\u9636\u5dee\u5206\u5e8f\u5217\u4e3a\uff1a<br/>$$<br/>\\\\Delta h(0), \\\\Delta h(1), \\\\Delta h(2), \\\\Delta h(3), \\\\dots<br/>$$<br/>\u5176\u4e2d\uff1a<br/>$$<br/>\\\\Delta h(n) = h(n + 1) - h(n)<br/>$$<br/>\u540c\u6837\uff0c\u5c06\u5dee\u5206\u51fa\u6765\u7684\u5e8f\u5217\u518d\u6b21\u8fdb\u884c\u5dee\u5206\uff0c\u53ef\u4ee5\u5f97\u5230\u4e8c\u9636\u5dee\u5206\u5e8f\u5217\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5b9a\u4e49\u96f6\u9636\u5dee\u5206\u5e8f\u5217\u5c31\u662f\u539f\u5e8f\u5217\uff0c$p$\u9636\u5dee\u5206\u5e8f\u5217\u4e3a\uff1a<br/>$$<br/>\\\\Delta^{(p)} h(n) = \\\\Delta^{(p - 1)} h(n + 1) - \\\\Delta^{(p - 1)} h(n) \\\\;\\\\;\\\\;\\\\; (p \\\\gt 0)<br/>$$<br/>\u5dee\u5206\u5e8f\u5217\u6709\u4e00\u79cd\u6c42\u5bfc\u7684\u610f\u5473\u3002<br/>\u591a\u9879\u5f0f\u7684\u5dee\u5206\u5e8f\u5217<br/>\u591a\u9879\u5f0f$h(n) = 2n^3 + 2n^2 - 4n + 233$\u7684\u5dee\u5206\u5e8f\u5217\u5982\u4e0b\uff1a<br/>$$<br/>233, 233, 249, 293, 377, 513, \\\\dots \\\\\\\\<br/>0, \\\\;16, \\\\;44, \\\\;84, \\\\;136, \\\\dots \\\\\\\\<br/>16, \\\\;28, \\\\;40, \\\\;96, \\\\dots \\\\\\\\<br/>12, \\\\;12, \\\\;12, \\\\dots \\\\\\\\<br/>0, \\\\;\\\\;0, \\\\dots \\\\\\\\<br/>\\\\dots<br/>$$<br/>\u6211\u4eec\u53d1\u73b0$h(n)$\u662f\u4e2a$3$\u6b21\u591a\u9879\u5f0f\uff0c\u800c\u5b83\u7684\u5e8f\u5217\u7ecf\u8fc7$4$\u6b21\u5dee\u5206\u5c31\u53d8\u6210\u4e86\u5168\u662f$0$\u7684\u5e8f\u5217\u3002<br/>\u53ef\u4ee5\u8bc1\u660e\uff0c\u4e00\u4e2a$p$\u6b21\u591a\u9879\u5f0f\u7684\u5e8f\u5217\u6700\u591a\u7ecf\u8fc7$p + 1$\u6b21\u5dee\u5206\u5c31\u4f1a\u53d8\u4e3a\u5168$0$\u5e8f\u5217\u3002<br/>\u9996\u5148\u8003\u8651$0$\u6b21\u591a\u9879\u5f0f\uff0c\u5b83\u7684\u5e8f\u5217\u503c\u662f\u4e00\u4e2a\u5e38\u6570\uff0c\u6240\u4ee5\u81f3\u591a\u7ecf\u8fc7\u4e00\u6b21\u5dee\u5206\u5c31\u53ef\u4ee5\u53d8\u4e3a$0$\u3002<br/>\u73b0\u5728\u8fdb\u884c\u5f52\u7eb3\u5047\u8bbe\uff1a\u5047\u8bbe\u5bf9\u4e8e$p$\u6b21\u591a\u9879\u5f0f\u7684\u5e8f\u5217\u6700\u591a\u7ecf\u8fc7$p + 1$\u6b21\u5dee\u5206\u5c31\u4f1a\u5f97\u5230\u5168$0$\u5e8f\u5217\uff0c\u90a3\u4e48\u73b0\u5728\u8bc1\u660e\u5bf9\u4e8e$p + 1$\u6b21\u591a\u9879\u5f0f\u6700\u591a\u5dee\u5206$p + 2$\u6b21\u5c31\u53ef\u4ee5\u5f97\u5230\u5168$0$\u5e8f\u5217\u3002<br/>\u89c2\u5bdf\u6700\u9ad8\u6b21\u6570\u7684\u9879\uff0c\u5728\u6bcf\u4e00\u6b21\u5dee\u5206\u4e2d\u7684\u53d8\u5316\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\Delta^{(c)} h(n) & = \\\\Delta^{(c-1)} h(n + 1) - \\\\Delta^{(c-1)}h(n) \\\\\\\\<br/>& = (n + 1)^{p} + \\\\cdots - n^p - \\\\cdots \\\\\\\\<br/>& = \\\\sum_{k = 0}^p {p \\\\choose k} n^k + \\\\cdots - n^p - \\\\cdots<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u4e8e${p \\\\choose p} = 1$\uff0c\u6240\u4ee5\u6700\u9ad8\u6b21\u6570\u7684\u9879\u5728\u4e00\u6b21\u5dee\u5206\u4e2d\u88ab\u51cf\u53bb\u4e86\uff0c\u6240\u4ee5\u5dee\u5206\u540e\u7684\u5e8f\u5217\u662f\u4e00\u4e2a\u81f3\u591a$p$\u6b21\u7684\u591a\u9879\u5f0f\u7684\u5e8f\u5217\u3002\u56e0\u6b64\uff0c\u6839\u636e\u5f52\u7eb3\u5047\u8bbe\uff0c$p + 1$\u6b21\u7684\u591a\u9879\u5f0f\u6700\u591a\u8fdb\u884c$p + 2$\u6b21\u5dee\u5206\u5c31\u53ef\u4ee5\u5bf9\u5230\u5168$0$\u5e8f\u5217\u3002<br/>\u5dee\u5206\u7684\u7ebf\u6027\u6027<br/>\u5982\u679c\uff1a<br/>$$<br/>h(n) = af(n) + bg(n)<br/>$$<br/>\u90a3\u4e48\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\Delta h(n) & = \\\\Delta (af(n) + bg(n)) \\\\\\\\<br/>& = a(f(n + 1) - f(n)) + b(g(n + 1) - g(n)) \\\\\\\\<br/>& = a\\\\Delta f(n) + b\\\\Delta g(n)<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u6b64\u6211\u4eec\u8bc1\u660e\u4e86\u5dee\u5206\u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\u3002\u8fd9\u79f0\u4e3a\u5dee\u5206\u7684\u7ebf\u6027\u6027\u3002<br/>\u7279\u6b8a\u5dee\u5206\u8868<br/>\u5728\u5dee\u5206\u8868\u4e2d\uff1a<br/>$$<br/>233, 233, 249, 293, 377, 513, \\\\dots \\\\\\\\<br/>0, \\\\;16, \\\\;44, \\\\;84, \\\\;136, \\\\dots \\\\\\\\<br/>16, \\\\;28, \\\\;40, \\\\;96, \\\\dots \\\\\\\\<br/>12, \\\\;12, \\\\;12, \\\\dots \\\\\\\\<br/>0, \\\\;\\\\;0, \\\\dots \\\\\\\\<br/>\\\\dots<br/>$$<br/>\u79f0\u7b2c\u4e00\u6a2a\u884c\u4e3a\u7b2c$0$\u884c\uff0c\u8868\u793a\u539f\u6570\u5217\uff0c\u5982\u4e0a\u9762\u7684$233, 233, 249, 293, 377, 513, \\\\dots$\u3002\u800c\u5de6\u8fb9\u7684\u7b2c\u4e00\u659c\u5217\u4e3a\u7b2c$0$\u6761\u5bf9\u89d2\u7ebf\uff0c\u5982\u4e0a\u9762\u7684$233,0,16,12,0,\\\\dots$\u3002\u663e\u7136\u77e5\u9053\u4e86\u8fd9\u4e24\u4e2a\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5c31\u53ef\u4ee5\u786e\u5b9a\u6574\u4e2a\u5dee\u5206\u8868\u3002<br/>\u8003\u8651\u4e00\u4e0b\u7531\u4e0b\u9762\u7684\u5bf9\u89d2\u7ebf\u6784\u6210\u7684\u5dee\u5206\u8868\u4f1a\u662f\u600e\u6837\u7684\u6570\u5217\u6784\u6210\u7684\uff1a<br/>$$<br/>0, 0, 0, 0, 1, 0, 0\\\\dots<br/>$$<br/>\u9996\u5148\uff0c\u8fd9\u4e2a\u5dee\u5206\u8868\u540e\u9762\u5168\u90e8\u53d8\u6210\u4e86$0$\uff0c\u6240\u4ee5\u8fd9\u80af\u5b9a\u662f\u4e00\u4e2a$4$\u6b21\u591a\u9879\u5f0f\u7684\u5dee\u5206\u8868\u3002\u540c\u65f6\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u8fd9\u4e2a\u591a\u9879\u5f0f\u6709$4$\u4e2a\u96f6\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\uff1a<br/>$$<br/>f(n) = cn(n-1)(n-2)(n-3)<br/>$$<br/>\u5176\u4e2d$c$\u8fd8\u662f\u5f85\u786e\u5b9a\u7684\u3002<br/>\u540c\u65f6\uff0c\u6211\u4eec\u6ce8\u610f\u5230$f(4) =  1$\uff0c\u6240\u4ee5\uff1a<br/>$$<br/>c \\\\cdot 4 \\\\cdot 3 \\\\cdot 2 \\\\cdot 1 = 1 \\\\Longrightarrow c = \\\\frac1{4!}<br/>$$<br/>\u6362\u8a00\u4e4b\uff1a<br/>$$<br/>f(n) = {n! \\\\over 4!(n - 4)!} = {n \\\\choose 4}<br/>$$<br/>\u662f\u4e0d\u662f\u611f\u89c9\u5f88\u795e\u5947\uff1f\u8fd9\u4e00\u7ed3\u8bba\u53ef\u4ee5\u63a8\u5e7f\u5230\u4efb\u610f\u4f4d\u7f6e\u7684$1$\u7684\u5dee\u5206\u8868\u3002\u540c\u65f6\uff0c\u5229\u7528\u5dee\u5206\u8868\u7684\u7ebf\u6027\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u66f4\u52a0\u795e\u5947\u7684\u4e1c\u897f\uff1a<br/><br/>\u5982\u679c$\\\\Delta f(n)$\u7684\u7b2c$0$\u6761\u5bf9\u89d2\u7ebf\u4e3a$c_0, c_1, c_2, c_3, \\\\dots, c_p, 0, 0, \\\\dots$\uff0c\u90a3\u4e48\uff1a<br/>$$ f(n) = \\\\sum_{k=0}^p c_k{n \\\\choose k}$$<br/><br/>\u6b64\u65f6\u4f60\u4e5f\u8bb8\u4f1a\u60f3\u95ee\u8fd9\u4e1c\u897f\u6709\u4ec0\u4e48\u7528\uff1f\u7531\u4e8e\u5b83\u662f\u5bf9\u4e8e\u4e00\u4e2a\u591a\u9879\u5f0f\u7684\u5dee\u5206\u5206\u6790\u5f97\u5230\u7684\u7ed3\u8bba\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5982\u679c\u77e5\u9053\u4e86\u7b2c$0$\u6761\u5bf9\u89d2\u7ebf\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u8fd9\u4e2a\u591a\u9879\u5f0f\u3002<br/>\u5e76\u4e14\uff0c\u6839\u636ePascal\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>\\\\sum_{k=0}^p {n \\\\choose k} = {n + 1 \\\\choose p}<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$<br/>\\\\sum_{k = 0}^n f(k) = \\\\sum_{k = 0}^p c_k {n + 1 \\\\choose k}<br/>$$<br/>\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u62e5\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u540c\u6837\u7684\u4ee3\u4ef7\u6765\u8ba1\u7b97\u5b83\u7684\u524d\u7f00\u548c\u3002<br/>\u73b0\u5728\u6765\u8003\u8651\u4e00\u4e2a\u5177\u4f53\u4e00\u70b9\u5e76\u4e14\u4e0d\u662f\u5f88\u590d\u6742\u7684\u95ee\u9898\uff0c\u4f46\u662f\u53ef\u80fd\u5f53\u573a\u5e76\u4e0d\u80fd\u89e3\u51b3\u5b83\uff1a<br/><br/>\u7ed9\u4f60$T$\u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa$n$\u548c$p$\uff0c\u8981\u6c42\u4f60\u8ba1\u7b97\uff1a<br/>$$ \\\\sum_{a = 1}^n a^p \\\\pmod{10^9 + 7}$$<br/>$1 \\\\leqslant T \\\\leqslant 5000$\uff0c$1 \\\\leqslant p \\\\leqslant 5000$\uff0c$1 \\\\leqslant n \\\\leqslant 10^{18}$\u3002<br/><br/>\u5982\u679c\u91c7\u7528\u76f4\u63a5\u8ba1\u7b97$c_0, c_1, c_2, \\\\dots$\u7684\u8bdd\uff0c\u603b\u7684\u590d\u6742\u5ea6\u4e3a$\\\\Theta(q^3 + Tq)$\u3002\u8fd9\u91cc\u51fa\u73b0\u7684\u95ee\u9898\u5c31\u662f\u7cfb\u6570\u7684\u9884\u5904\u7406\u4ee3\u4ef7\u592a\u9ad8\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5bfb\u627e\u4e00\u79cd\u66f4\u5feb\u901f\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002<br/>\u5bf9\u6b64\uff0c\u6211\u4eec\u8bbe$f_p(n) = n^p$\uff0c\u540c\u65f6\u8bbe\u5b83\u7684\u7cfb\u6570\u4e3a\uff1a<br/>$$<br/>c(p, 0), c(p, 1), c(p, 2), \\\\dots, c(p, p)<br/>$$<br/>\u90a3\u4e48\u7b54\u6848\u5c31\u662f\uff1a<br/>$$<br/>\\\\sum_{k = 0}^p c(p, k){n + 1 \\\\choose k}<br/>$$<br/>\u7b2c\u4e8c\u7c7bStirling\u6570<br/>\u5b9a\u4e49<br/>\u6709\u7b2c\u4e8c\u7c7bStirling\u6570\u5c31\u6709\u7b2c\u4e00\u7c7bStirling\u6570\uff0c\u4f46\u662f\u7531\u4e8e\u7b2c\u4e8c\u7c7bStirling\u6570\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u89e3\u51b3\u4e4b\u524d\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u5148\u4ecb\u7ecd\u5b83\u3002<br/>\u7b2c\u4e8c\u7c7bStirling\u6570\u7684\u7528\u9014\u662f\u4f7f\u7528\u4e0b\u964d\u5e42\u6765\u8868\u793a\u6570\u7684\u5e42\u3002\u4e0b\u964d\u5e42\u662f\u8fd9\u6837\u7684\u4e00\u79cd\u4e1c\u897f\uff1a<br/>$$<br/>x^{\\\\underline{n}} = {x! \\\\over (x - n)!}<br/>$$<br/>\u56de\u5230\u524d\u9762\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u53d1\u73b0\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>n^p & = \\\\sum_{k = 0}^p c(p, k){n \\\\choose k} \\\\\\\\<br/>& = \\\\sum_{k = 0}^p \\\\frac{c(p, k)}{k!} n^{\\\\underline{k}}<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5\u8bbe\uff1a<br/>$$<br/>S(p, k) = {c(p, k) \\\\over k!}<br/>$$<br/>\u4e3a\u7b2c\u4e8c\u7c7bStirling\u6570\u3002\u5e76\u4e14\u6ee1\u8db3\uff1a<br/>$$<br/>n^p = \\\\sum_{k = 0}^p S(p, k)n^{\\\\underline{k}}<br/>$$<br/>\u540c\u65f6\u6ce8\u610f\u4e00\u4e0b\u5b83\u7684\u8fb9\u754c\u503c\uff1a<br/>$$<br/>S(n, n) = 1 \\\\;\\\\;\\\\;\\\\; \\\\forall n \\\\in N \\\\\\\\<br/>S(n, 0) = 0 \\\\;\\\\;\\\\;\\\\; \\\\forall n \\\\in N_+<br/>$$<br/>\u4e0d\u59a8\u6765\u8003\u8651\u4e00\u4e0b\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>n^{p-1} & = \\\\sum_{k = 0}^{p-1} S(p-1, k)n^{\\\\underline{k}} \\\\\\\\<br/>n^p = n \\\\cdot n^{p-1} & = n\\\\sum_{k = 0}^{p-1} S(p-1, k)n^{\\\\underline{k}} \\\\\\\\<br/>& = \\\\sum_{k = 0}^{p-1} S(p-1, k) \\\\cdot n \\\\cdot n^{\\\\underline{k}} \\\\\\\\<br/>& = \\\\sum_{k = 0}^{p-1} S(p-1, k) \\\\cdot (n - k + k) \\\\cdot n^{\\\\underline{k}} \\\\\\\\<br/>& = \\\\sum_{k = 0}^{p-1} S(p-1, k) n^{\\\\underline{k + 1}} + \\\\sum_{k = 0}^{p-1} kS(p-1, k) n^{\\\\underline{k}} \\\\\\\\<br/>& = \\\\sum_{k = 1}^{p} S(p-1, k - 1) n^{\\\\underline{k}} + \\\\sum_{k = 0}^{p-1} kS(p-1, k) n^{\\\\underline{k}}<br/>\\\\end{aligned}<br/>$$<br/>\u901a\u8fc7\u6bd4\u8f83\u540c\u4e00\u9879\u7684\u7cfb\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u4e0b\u9762\u7684\u9012\u63a8\u5f0f\uff1a<br/>$$<br/>S(p, k) = kS(p - 1, k) + S(p - 1, k - 1)<br/>$$<br/>\u89e3\u51b3\u4e4b\u524d\u7684\u95ee\u9898<br/>\u5728\u4e4b\u524d\u7684\u95ee\u9898\u4e2d\uff0c\u6211\u4eec\u77e5\u9053\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{a = 1}^n a^p & = \\\\sum_{k = 0}^p c(p, k){n + 1 \\\\choose k} \\\\\\\\<br/>& = \\\\sum_{k = 0}^p S(p, k)(n + 1)^{\\\\underline{k}}<br/>\\\\end{aligned}<br/>$$<br/>\u5bf9\u4e8e\u540e\u9762\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u901a\u8fc7\u9012\u63a8\u7b97\u51fa$(n + 1)^{\\\\underline{0}}$\u81f3$(n + 1)^{\\\\underline{p}}$\u7684\u503c\uff0c\u540c\u65f6\uff0c\u6211\u4eec\u6709\u4e86\u4e4b\u524d\u7684\u9012\u63a8\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5728$\\\\Theta(p^2)$\u7684\u65f6\u95f4\u5185\u9884\u5904\u7406\u51fa\u7b2c\u4e8c\u7c7bStirling\u6570\u3002\u6240\u4ee5\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u53ef\u4ee5\u4ee5$\\\\Theta(p^2 + Tp)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002<br/>\u5176\u5b9e\uff0c\u6839\u636e\u7b2c\u4e8c\u7c7bStirling\u6570\u7684\u9012\u63a8\u516c\u5f0f\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u7684\u63a8\u51fa$c(p, k)$\u7684\u9012\u63a8\u516c\u5f0f\uff1a<br/>$$<br/>c(p, k) = k(c(p - 1, k - 1) + c(p - 1, k))<br/>$$<br/>\u8bfb\u8005\u53ef\u4ee5\u81ea\u5df1\u8bd5\u4e00\u8bd5\u3002<br/>\u4f46\u662f\u8fd9\u8fd8\u4e0d\u662f\u8fd9\u4e2a\u95ee\u9898\u7684\u6700\u4f18\u89e3\u6cd5\u3002\u4f7f\u7528\u4f2f\u52aa\u5229\u6570\u548c\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u66f4\u597d\u7684\u590d\u6742\u5ea6\u3002\u8fd9\u91cc\u5c31\u6ca1\u6709\u4ecb\u7ecd\u4e86\u3002<br/>\u53e6\u5916\uff0c\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u4e5f\u53ef\u4ee5\u5feb\u901f\u6c42\u89e3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5177\u4f53\u7684\u53ef\u4ee5\u53c2\u89c1\u8fd9\u7bc7\u535a\u5ba2\u3002<br/>\u7ec4\u5408\u610f\u4e49<br/>\u73b0\u5728\u6765\u8003\u8651\u4e00\u4e0b\u8fd9\u4e2a\u7b80\u5355\u95ee\u9898\uff1a<br/><br/>\u6c42$p$\u4e2a\u4eba\uff0c\u653e\u5165$k$\u4e2a\u76f8\u540c\u7684\u623f\u5b50 (\u623f\u5b50\u4e0d\u53ef\u4ee5\u4e3a\u7a7a) \u7684\u65b9\u6848\u6570\u3002<br/><br/>\u4e0d\u96be\u6211\u4eec\u53ef\u4ee5\u60f3\u51fa\u4e00\u4e2a\u9012\u63a8\uff1a\u8bbe$f(p, k)$\u4e3a$p$\u4e2a\u4eba\u653e\u5165$k$\u4e2a\u76f8\u540c\u7684\u623f\u5b50\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u5b83\u6ee1\u8db3\uff1a<br/>$$<br/>f(p, k) = kf(p - 1, k) + f(p - 1, k - 1)<br/>$$<br/>\u5bf9\u4e8e\u5176\u6b63\u786e\u6027\uff0c\u8003\u8651\u4e24\u70b9\uff1a<br/><br/>\u5982\u679c\u7b2c$p$\u4e2a\u4eba\u5355\u72ec\u8fdb\u5165\u4e00\u4e2a\u623f\u95f4\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u4e3a$f(p - 1, k - 1)$\u3002<br/>\u5982\u679c\u7b2c$p$\u4e2a\u4eba\u8fdb\u5165\u4e4b\u524d\u7684\u623f\u95f4\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u6311\u9009\u4e4b\u524d\u7684$k$\u4e2a\u623f\u95f4\u7684\u4efb\u610f\u4e00\u95f4\uff0c\u5373\u65b9\u6848\u6570\u4e3a$kf(p - 1, k)$\u3002<br/><br/>\u540c\u65f6\u6211\u4eec\u6ce8\u610f\u5230\uff1a<br/>$$<br/>f(n, n) = 1<br/>$$<br/>\u5e76\u4e14\uff1a<br/>$$<br/>f(n, 0) = 0 \\\\;\\\\;\\\\;\\\\; \\\\forall n \\\\in N_+<br/>$$<br/>\u4e5f\u5c31\u662f$f$\u548c\u7b2c\u4e8c\u7c7bStirling\u6570\u6ee1\u8db3\u4e00\u6837\u7684\u521d\u59cb\u6761\u4ef6\u548c\u9012\u63a8\u516c\u5f0f\uff0c\u90a3\u4e48\u610f\u5473\u7740$f(p, k)$\u548c$S(p, k)$\u662f\u4e00\u6837\u7684\u3002\u6240\u4ee5\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u5c31\u662f$S(p, k)$\u3002\u8fd9\u4e5f\u6b63\u662f\u7b2c\u4e8c\u7c7bStirling\u6570\u7684\u7ec4\u5408\u610f\u4e49\u3002<br/>\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u5bb9\u65a5\u539f\u7406\u7684\u89d2\u5ea6\u6765\u83b7\u5f97\u53e6\u5916\u4e00\u4e2a\u4e0d\u540c\u7684\u516c\u5f0f\u3002\u8bbe$A_1,\\\\; A_2, \\\\;A_3,\\\\dots,A_k$\u4e3a\u7b2c$1$\u5230\u7b2c$k$\u4e2a\u623f\u95f4\u4e3a\u7a7a\u7684\u65b9\u6848\u96c6\u5408\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u7b54\u6848\u5c31\u662f\uff1a<br/>$$<br/>S(p, k) = \\\\frac1{k!}\\\\left|\\\\overline{A}_1 \\\\cup \\\\overline{A}_2 \\\\cup \\\\cdots \\\\cup \\\\overline{A}_k\\\\right|<br/>$$<br/>\u6ce8\u610f\u5728\u4e4b\u524d\u7684\u63a8\u5bfc\u91cc\u9762\u6211\u4eec\u533a\u5206\u4e86\u8fd9$k$\u4e2a\u623f\u95f4\uff0c\u800c\u7b2c\u4e8c\u7c7bStirling\u6570\u662f\u6ca1\u6709\u533a\u5206\u7684\uff0c\u6240\u4ee5\u8981\u4e58\u4ee5$1/k!$\u3002<br/>\u8003\u8651\u5230\u5982\u679c\u6709$t$\u4e2a\u623f\u95f4\u4e3a\u7a7a\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4eba\u800c\u8a00\uff0c\u5c31\u53ea\u6709$k - t$\u4e2a\u9009\u62e9\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6b64\u7684\u65b9\u6848\u6570\u7684\u5c31\u662f$(k - t)^p$\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>S(p, k) = \\\\frac1{k!}\\\\sum_{t = 0}^k (-1)^t{k \\\\choose t}(k - t)^p<br/>$$<br/>\u8fd9\u4e5f\u5c31\u662f\u8ba1\u7b97\u5355\u4e2a\u7b2c\u4e8c\u7c7bStirling\u6570\u7684\u516c\u5f0f\u3002<br/>\u7b2c\u4e00\u7c7bStirling\u6570<br/>\u5b9a\u4e49<br/>\u73b0\u5728\u6765\u4ecb\u7ecd\u7b2c\u4e00\u7c7bStirling\u6570\u3002\u4e0e\u7b2c\u4e8c\u7c7bStirling\u6570\u7c7b\u4f3c\uff0c\u7b2c\u4e00\u7c7bStirling\u6570\u662f\u4f7f\u7528\u6570\u7684\u5e42\u6765\u8868\u793a\u4e0b\u964d\u5e42\u3002<br/>\u73b0\u5728\u6765\u89c2\u5bdf\u4e00\u4e0b\u89c4\u5f8b\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>& n^{\\\\underline{0}} = 1 \\\\\\\\<br/>& n^{\\\\underline{1}} = n \\\\\\\\<br/>& n^{\\\\underline{2}} = n(n - 1) = n^2 - n \\\\\\\\<br/>& n^{\\\\underline{3}} = n(n - 1)(n - 2) = n^3 - 3n^2 + 2n \\\\\\\\<br/>& n^{\\\\underline{4}} = n(n - 1)(n - 2)(n - 3) = n^4 - 6n^3 + 11n^2 - 6n \\\\\\\\<br/>& \\\\dots<br/>\\\\end{aligned}<br/>$$<br/>\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e0b\u964d\u5e42\u5c55\u5f00\u4ee5\u540e\u662f\u4e00\u4e2a\u7cfb\u6570\u6b63\u8d1f\u53f7\u4ea4\u66ff\u7684\u591a\u9879\u5f0f\u3002\u4e0e\u5728\u7b2c\u4e8c\u7c7bStirling\u6570\u4e2d\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u8bbe$s(p, k)$\u4e3a\u7b2c\u4e00\u7c7bStirling\u6570\uff0c\u5e76\u4e14\u6ee1\u8db3\uff1a<br/>$$<br/>n^{\\\\underline{p}} = \\\\sum_{k = 0}^p (-1)^{p - k}s(p, k)n^k<br/>$$<br/>\u4ee5\u53ca\u8fb9\u754c\u503c\uff1a<br/>$$<br/>s(n, n) = 1 \\\\;\\\\;\\\\;\\\\; \\\\forall n \\\\in N \\\\\\\\<br/>s(n, 0) = 0 \\\\;\\\\;\\\\;\\\\; \\\\forall n \\\\in N_+<br/>$$<br/>\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u636e\u6b64\u63a8\u51fa\u7b2c\u4e8c\u7c7bStirling\u6570\u7684\u9012\u63a8\u516c\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>n^{\\\\underline{p - 1}} & = \\\\sum_{k = 0}^{p-1} (-1)^{p - k - 1}s(p - 1, k)n^k \\\\\\\\<br/>n^{\\\\underline{p}} & = (n - p + 1)\\\\sum_{k = 0}^{p-1} (-1)^{p - k - 1}s(p - 1, k)n^k \\\\\\\\<br/>& = \\\\sum_{k = 0}^{p-1} (-1)^{p - k - 1}s(p - 1, k)n^{k+1} + \\\\sum_{k = 0}^{p-1} (-1)^{p - k}(p - 1)s(p - 1, k)n^k \\\\\\\\<br/>& = \\\\sum_{k = 1}^{p} (-1)^{p - k}s(p - 1, k - 1)n^{k} + \\\\sum_{k = 0}^{p-1} (-1)^{p - k}(p - 1)s(p - 1, k)n^k<br/>\\\\end{aligned}<br/>$$<br/>\u901a\u8fc7\u6bd4\u8f83\u540c\u6b21\u9879\u7684\u7cfb\u6570\u53ef\u4ee5\u5f97\u77e5\uff1a<br/>$$<br/>s(p, k) = (p - 1)s(p - 1, k) + s(p - 1, k - 1)<br/>$$<br/>\u7ec4\u5408\u610f\u4e49<br/>\u540c\u6837\u7684\uff0c\u7b2c\u4e00\u7c7bStirling\u6570\u4e5f\u5177\u6709\u5176\u7ec4\u5408\u610f\u4e49\u3002\u901a\u8fc7\u8003\u8651\u4e0b\u9762\u7684\u95ee\u9898\u5c31\u53ef\u4ee5\u8bc1\u660e\uff1a<br/><br/>\u6c42$p$\u4e2a\u4eba\u56f4\u6210$k$\u4e2a\u5708 (\u5708\u4e0d\u80fd\u4e3a\u7a7a) \u7684\u65b9\u6848\u6570\u3002<br/>\u6ce8\u610f\u8fd9\u91cc\u7684\u5708\u4e2d\u7684\u4eba\u7684\u987a\u5e8f\u4e0d\u540c\u4e5f\u4f1a\u89c6\u4e3a\u5708\u4e0d\u540c\u3002<br/><br/>\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8bc1\u660e\u5176\u7b54\u6848$f(p, k)$\u6ee1\u8db3\u4e0b\u9762\u7684\u9012\u63a8\u5173\u7cfb\uff1a<br/>$$<br/>f(p, k) = (p - 1)f(p - 1, k) + f(p - 1, k - 1)<br/>$$<br/>\u8bc1\u660e\uff1a<br/><br/>\u5982\u679c\u7b2c$p$\u4e2a\u4eba\u72ec\u81ea\u7ad9\u6210\u4e00\u4e2a\u5708\uff0c\u90a3\u4e48\u5171\u6709$f(p - 1, k - 1)$\u79cd\u65b9\u6848\u3002<br/>\u5982\u679c\u7b2c$p$\u4e2a\u4eba\u4e0e\u4e4b\u524d\u7684\u4eba\u7ad9\u5728\u4e00\u8d77\uff0c\u90a3\u4e48\u4ed6\u6709$p - 1$\u79cd\u65b9\u6848\u7ad9\u5728\u4e00\u4e2a\u4eba\u7684\u53f3\u8fb9\uff0c\u6240\u4ee5\u5171\u6709$(p - 1)f(p - 1, k)$\u4e2d\u65b9\u6848\u3002<br/><br/>\u4e0d\u96be\u9a8c\u8bc1\u8fd9\u4e2a\u95ee\u9898\u7684\u521d\u59cb\u6761\u4ef6\u4e0e\u7b2c\u4e00\u7c7bStirling\u6570\u4e00\u81f4\uff0c\u6240\u4ee5$f(p, k)$\u548c$s(p, k)$\u5c31\u662f\u4e00\u6837\u7684\u5566\uff5e",
"url": "blog/2016-11-29/delta-and-stirling.html"
},
"\u5e73\u8861\u6811\u5957\u94fe\u8868": {
"tags": "\u6570\u636e\u7ed3\u6784 \u5e73\u8861\u6811 \u94fe\u8868",
"text": "\u5e73\u8861\u6811\u5957\u94fe\u8868<br/>\u524d\u8a00<br/><br/>\u8fd9\u662f\u4e00\u4e2a\u95f2\u5f97\u5375\u75bc\u7684\u4ea7\u7269<br/><br/>\u6709\u65f6\u5019\u6211\u4eec\u5e0c\u671b\u80fd\u591f\u5728\u4e00\u4e2a\u5e8f\u5217\u4e0a\u5feb\u901f\u904d\u5386\uff0c\u7136\u800c\u8fd9\u4e2a\u5e8f\u5217\u5374\u53c8\u662f\u52a8\u6001\u7684\uff0c\u56e0\u6b64\u4f1a\u8003\u8651\u5230\u5e73\u8861\u6811\u6765\u7ef4\u62a4\u5e8f\u5217\u3002<br/>\u7136\u800c\u666e\u901a\u5e73\u8861\u6811\u67e5\u627e\u524d\u8d8b\u540e\u7ee7\u662f\u6bd4\u8f83\u9ebb\u70e6\u7684\uff0c\u9664\u4e86Splay\u6709\u4e00\u4e2a\u5f88\u7b80\u5355\u76f4\u89c2\u7684\u65b9\u6cd51\uff0c\u5176\u5b83\u5e73\u8861\u6811\u90fd\u8981\u4e0e\u7236\u4eb2\u8282\u70b9\u7ea0\u7f20\u4e00\u756a\u3002<br/>\u7136\u800c\u6700\u5173\u952e\u7684\u662f\uff0c\u5b83\u4eec\u67e5\u8be2\u524d\u8d8b\u540e\u7ee7\u8fd8\u4e0d\u662f$\\\\Theta(1)$\u7684\u65f6\u95f4\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\u662f$O(\\\\log n)$\u7684\u3002<br/>\u56e0\u6b64\u8003\u8651\u5c06\u94fe\u8868\u201d\u6302\u8f7d\u201d\u5728\u5e73\u8861\u6811\u4e0a\uff0c\u53ef\u4ee5\u5c06\u67e5\u627e\u524d\u8d8b\u540e\u7ee7\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a$\\\\Theta(1)$\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u5728\u63d2\u5165\u548c\u5220\u9664\u65f6\u6bcf\u4e2a\u8282\u70b9\u4ed8\u51fa$\\\\Theta(1)$\u7684\u4ee3\u4ef7\u3002\u540c\u65f6\u987a\u5e8f\u904d\u5386\u8282\u70b9\u7684\u4ee3\u7801\u5c06\u4e0e\u666e\u901a\u94fe\u8868\u4e00\u6837\u3002\u8fd9\u6837\u5728\u52a8\u6001\u7ef4\u62a4\u51f8\u5305\u7b49\u4e00\u4e9b\u590d\u6742\u7684\u5e73\u8861\u6811\u5e94\u7528\u4e2d\u505a\u5230\u4e00\u4e9b\u4f18\u5316\u3002<br/>\u60f3\u5fc5\u5f3a\u80052\u770b\u5b8c\u524d\u8a00\u5df2\u7ecf\u8111\u8865\u51fa\u8fd9\u73a9\u610f\u4e86\u3002<br/>\u63d2\u5165<br/>\u5b9e\u9645\u4e0a\u6211\u4eec\u5c31\u662f\u9700\u8981\u5728\u63d2\u5165\u8282\u70b9\u65f6\u540c\u65f6\u8bb0\u5f55\u4e00\u4e2a\u8282\u70b9\u7684\u524d\u8d8b\u548c\u540e\u7ee7\u3002<br/>\u7531\u4e8e\u65b0\u63d2\u5165\u7684\u8282\u70b9\u4e00\u5b9a\u662f\u5728\u6811\u7684\u5e95\u90e8\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8003\u8651\u7684\u60c5\u51b5\u5f88\u5c11\u3002<br/>\u8fd9\u65f6\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u4e00\u79cd\u662f\u63d2\u5165\u5230\u5de6\u513f\u5b50\uff1a<br/><br/>\u90a3\u4e48\u65b0\u63d2\u5165\u7684\u8282\u70b9\u5fc5\u5b9a\u662f\u5176\u7236\u4eb2\u7684\u524d\u8d8b\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u770b\u4f5c\u662f\u5f80\u94fe\u8868\u4e2d\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u3002<br/>\u540c\u6837\uff0c\u5bf9\u4e8e\u63d2\u5165\u5230\u53f3\u513f\u5b50\uff0c\u60c5\u51b5\u4e5f\u662f\u7c7b\u4f3c\u7684\uff1a<br/><br/>\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u65b0\u63d2\u5165\u7684\u8282\u70b9\uff0c\u53ea\u9700\u8981\u82b1\u8d39$\\\\Theta(1)$\u7684\u65f6\u95f4\u6765\u8bb0\u5f55\u524d\u8d8b\u540e\u7ee7\u3002<br/>\u65cb\u8f6c<br/>\u8bb8\u591a\u5e73\u8861\u6811 (Treap\u3001Splay\u7b49) \u90fd\u662f\u4ee5\u65cb\u8f6c\u64cd\u4f5c\u6765\u8fdb\u884c\u5e73\u8861\u7684\u3002\u7136\u800c\u5e73\u8861\u7684\u65f6\u5019\u662f\u5426\u8981\u7ef4\u62a4\u94fe\u8868\u4fe1\u606f\u5462\uff1f<br/>\u5b9e\u9645\u4e0a\u6839\u672c\u4e0d\u9700\u8981\uff0c\u56e0\u4e3a\u65cb\u8f6c\u64cd\u4f5c\u4e0d\u4f1a\u5f71\u54cd\u5e73\u8861\u6811\u7684\u6709\u5e8f\u6027\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u800c\u8a00\uff0c\u5b83\u7684\u524d\u8d8b\u540e\u7ee7\u662f\u4e0d\u4f1a\u53d8\u5316\u7684\uff0c\u6240\u4ee5\u6ca1\u6709\u5fc5\u8981\u6539\u52a8\u4fe1\u606f\u3002<br/>\u5220\u9664<br/>\u6709\u4e86\u524d\u9762\u7684\u57fa\u7840\uff0c\u5220\u9664\u64cd\u4f5c\u5176\u5b9e\u5f88\u81ea\u7136\u4e86\u3002\u5b9e\u9645\u4e0a\u5c31\u662f\u6700\u540e\u8981\u771f\u6b63\u5220\u9664\u8282\u70b9\u65f6\uff0c\u5c06\u94fe\u8868\u4e0a\u7684\u6307\u9488\u91cd\u8bbe\u3002\u5982\u679c\u4f60\u5199\u8fc7\u94fe\u8868\u7684\u5220\u9664 (\u8fd9\u4e1c\u897f\u5f88\u7b80\u5355)\uff0c\u5728\u5e73\u8861\u6811\u4e0a\u4e5f\u5c31\u662f\u4e00\u6837\u7684\u4e86\u3002<br/>\u5e94\u7528<br/>\u8fd9\u4e2a\u4e1c\u897f\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e2a\u5c0f\u6280\u5de7\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u7b80\u4fbf\u4e00\u4e9b\u4ee3\u7801\uff0c\u5c24\u5176\u662f\u7ef4\u62a4\u52a8\u6001\u51f8\u5305\u8fd9\u79cd\u8981\u4e0d\u505c\u5730\u5411\u5de6\u5411\u53f3\u8bbf\u95ee\u8282\u70b9\u7684\u4e1c\u897f\u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528\u7684\u662f\u5faa\u73af\u94fe\u8868\uff0c\u5c31\u53ef\u4ece\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\u5f00\u59cb\u5faa\u73af\u904d\u5386\u6bcf\u4e00\u4e2a\u8282\u70b9\u3002<br/><br/><br/><br/><br/>\u5c06\u5f53\u524d\u8282\u70b9Splay\u81f3\u6839\uff0c\u7136\u540e\u5c31\u4e0d\u7528\u8ba8\u8bba\u7236\u4eb2\u8282\u70b9\u4e86\u3002\u00a0\u21a9<br/><br/><br/>LinkSBK\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-7-28/bst-with-list.html"
},
"\u5e73\u9762\u8ba1\u7b97\u51e0\u4f55": {
"tags": "\u6570\u5b66 \u8ba1\u7b97\u51e0\u4f55",
"text": "\u5e73\u9762\u8ba1\u7b97\u51e0\u4f55<br/>1 \u7ebf\u6bb5<br/>\u4e0b\u56fe\u4e2d\u5c55\u793a\u4e86\u4e00\u6761\u65e0\u5411\u7ebf\u6bb5$AB$\u3002<br/><br/>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u6240\u89c1\u7684\u7ebf\u6bb5\u90fd\u662f\u4e0d\u5b9a\u65b9\u5411\u7684\u3002\u4f46\u5728\u8ba1\u7b97\u51e0\u4f55\u4e2d\uff0c\u6211\u4eec\u4f1a\u501f\u52a9\u5411\u91cf\u8fd9\u4e00\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5c06\u7ebf\u6bb5\u8868\u793a\u6210\u6709\u5411\u7ebf\u6bb5(Directed Segment)\u7684\u5f62\u5f0f\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u4e8b\u5b9e\u4e0a\uff0c\u6709\u5411\u7ebf\u6bb5\u5c31\u662f\u4e00\u4e2a\u5411\u91cf\u3002\u5728\u4e0a\u9762\uff0c\u7ebf\u6bb5$AB$\u88ab\u5411\u91cf$\\\\vec{AB}$\u6240\u66ff\u4ee3\u3002<br/>\u540c\u6837\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u76f8\u53cd\u7684\u5411\u91cf$\\\\vec{BA}$\u6765\u8868\u793a$AB$\u3002<br/>2 \u53c9\u79ef<br/>2.1 \u5b9a\u4e49<br/>\u5bf9\u4e8e\u4e24\u4e2a\u5411\u91cf$p_1$\u548c$p_2$\uff0c\u5b83\u4eec\u7684\u53c9\u79ef(Cross Product)$p_1 \\\\times p_2$\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a<br/>$$<br/>p_1 \\\\times p_2 = <br/>\\\\begin{vmatrix}<br/>x_1 & x_2 \\\\\\\\<br/>y_1 & y_2<br/>\\\\end{vmatrix} = <br/>x_1y_2 - x_2y_1<br/>\\\\tag{2.1}<br/>$$<br/>\u4e0a\u9762\u7684\u5b9a\u4e49\u4f7f\u7528\u4e86\u884c\u5217\u5f0f\uff0c\u521d\u5b66\u8005\u53ef\u80fd\u611f\u5230\u8ff7\u7cca\u3002\u597d\u5728\u53c9\u79ef\u6709\u7740\u5f88\u597d\u7684\u51e0\u4f55\u89e3\u91ca\u3002<br/>2.2 \u51e0\u4f55\u89e3\u91ca<br/>\u4e0b\u56fe\u4e2d\uff0c\u5411\u91cf$p_1$\u548c\u5411\u91cf$p_2$\u7684\u53c9\u79ef$p_1 \\\\times p_2$\u5c31\u662f\u5b83\u4eec\u548c\u4e0e$p_1$\u5e73\u884c\u7684\u5411\u91cf$p_3$\u548c\u4e0e$p_2$\u5e73\u884c\u7684\u5411\u91cf$p_4$\u6240\u56f4\u6210\u7684\u5e73\u884c\u56db\u8fb9\u5f62$ABCD$\u7684\u6709\u5411\u9762\u79ef\u3002<br/><br/>\u4e3a\u4ec0\u4e48\u4f1a\u662f\u6709\u5411\u9762\u79ef\u5462\uff1f\u4f60\u53ef\u4ee5\u81ea\u5df1\u9020\u4e2a\u6570\u636e\u6765\u7b97\u4e00\u4e0b\uff0c\u4f60\u4f1a\u53d1\u73b0$p_1 \\\\times p_2 = -p_2 \\\\times p_1$\u3002<br/>\u6211\u4eec\u53d1\u73b0\uff0c\u53c9\u79ef\u7ed3\u679c\u7684\u7b26\u53f7\u4e0e$p_1$\u548c$p_2$\u7684\u76f8\u5bf9\u4f4d\u7f6e\u5173\u7cfb\u6709\u5f88\u5927\u8054\u7cfb\uff1a<br/><br/>\u5f53$p_2$\u5728$p_1$\u7684\u987a\u65f6\u9488\u65b9\u5411\u65f6\uff0c$ p_1 \\\\times p_2 \\\\lt 0$\u3002  <br/>\u5f53$p_2$\u5728$p_1$\u7684\u9006\u65f6\u9488\u65b9\u5411\u65f6\uff0c$ p_1 \\\\times p_2 \\\\gt 0$\u3002  <br/>\u5f53$p_2$\u4e0e$p_1$\u5171\u7ebf\uff08\u65b9\u5411\u76f8\u540c\u6216\u76f8\u53cd\uff09\u65f6\uff0c$ p_1 \\\\times p_2 = 0$\u3002<br/><br/>\u5229\u7528\u8fd9\u4e9b\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u5b8c\u6210\u8bb8\u591a\u6709\u8da3\u7684\u4e8b\u60c5\u3002<br/>\u540c\u65f6\uff0c\u5229\u7528\u4e0a\u9762\u7684\u56fe\u50cf\uff0c\u6211\u4eec\u53ef\u4ee5\u63a2\u7a76\u51fa\u53c9\u79ef\u516c\u5f0f\u7684\u53e6\u5916\u4e00\u79cd\u5f62\u5f0f\uff1a<br/><br/>\u5728\u524d\u9762\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u4f5c$ BE \\\\bot p_2 $\uff0c\u90a3\u4e48\u5e73\u884c\u56db\u8fb9\u5f62$ABCD$\u7684\u9762\u79ef\u53c8\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a<br/>$$ S_{ABCD} = |p_2| \\\\cdot |BE| $$<br/>\u53c8\u56e0\u4e3a\uff1a<br/>$$ |BE| = |p_1| \\\\sin \\\\alpha $$<br/>\u56e0\u6b64\uff1a<br/>$$ p_1 \\\\times p_2 = |p_1|\\\\cdot|p_2|\\\\sin \\\\alpha \\\\tag{2.2} $$<br/>\u4f46\u662f\u663e\u7136\u8fd9\u6837\u7684\u516c\u5f0f\u5bf9\u4e8e\u8ba1\u7b97\u673a\u800c\u8a00\u9700\u8981\u5927\u91cf\u7684\u6d6e\u70b9\u6570\u8fd0\u7b97\uff0c\u6240\u4ee5\u7528\u8fd9\u4e2a\u516c\u5f0f\u8ba1\u7b97\u53c9\u79ef\u7cbe\u5ea6\u53ef\u80fd\u4e0d\u9ad8\u3002<br/>\u4f46\u662f\u8fd9\u4e2a\u516c\u5f0f\u53ef\u4ee5\u6539\u4e3a\u4e0b\u9762\u7684\u5f62\u5f0f\uff1a<br/>$$ \\\\alpha = \\\\sin^{-1}\\\\left({p_1 \\\\times p_2 \\\\over |p_1| \\\\cdot |p_2|}\\\\right) \\\\tag{2.3}$$<br/>\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u516c\u5f0f\u6765\u8ba1\u7b97\u4e24\u4e2a\u5411\u91cf\u95f4\u7684\u5939\u89d2\u3002<br/>\u5982\u679c\u4e24\u4e2a\u5411\u91cf\u7684\u8d77\u70b9\u90fd\u4e0d\u5728\u539f\u70b9\u65f6\uff0c\u8be5\u600e\u4e48\u8ba1\u7b97\u8fd9\u4e2a\u6709\u5411\u9762\u79ef\u5462\uff1f<br/>\u8fd9\u5176\u5b9e\u76f8\u5f53\u7b80\u5355\uff0c\u6211\u4eec\u5c06\u4e24\u4e2a\u5411\u91cf\u7684\u516c\u5171\u8d77\u70b9\u4f5c\u4e3a\u539f\u70b9\uff0c\u7136\u540e\u8fd0\u7528\u5411\u91cf\u51cf\u6cd5\u6765\u8ba1\u7b97\u76f8\u5bf9\u5411\u91cf\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8ba1\u7b97\u4e86\u3002<br/>2.3 \u8ba1\u7b97\u9762\u79ef<br/>\u4e0b\u9762\u6211\u4eec\u5c06\u5229\u7528\u53c9\u79ef\u6765\u8ba1\u7b97\u7b80\u5355\u591a\u8fb9\u5f62\u7684\u9762\u79ef\u3002<br/>\u9996\u5148\uff0c\u7b80\u5355\u591a\u8fb9\u5f62\u65f6\u591a\u8fb9\u5f62\u4e2d\u6ca1\u6709\u8fb9\u76f8\u4ea4\u7684\u591a\u8fb9\u5f62\u3002\u6ce8\u610f\u5305\u62ec\u51f8\u591a\u8fb9\u5f62\u4ee5\u53ca\u4ee4\u4eba\u8ba8\u538c\u7684\u51f9\u591a\u8fb9\u5f62\u3002<br/>\u9996\u5148\u4ece\u5e73\u884c\u56db\u8fb9\u5f62\u5165\u624b\u3002<br/><br/>\u8fd9\u662f\u4e4b\u524d\u7684\u56fe\u3002\u867d\u7136\u5411\u91cf\u7684\u53c9\u79ef\u7b97\u51fa\u6765\u65f6\u6709\u5411\u9762\u79ef\uff0c\u4f46\u662f\u6211\u4eec\u53ea\u7528\u53d6\u7edd\u5bf9\u503c\uff0c\u5c31\u662f\u5e73\u884c\u56db\u8fb9\u5f62\u7684\u9762\u79ef\u4e86\u3002<br/>\u5bf9\u4e8e\u4e09\u89d2\u5f62\uff0c\u901a\u8fc7\u5bf9\u79f0\u7684\u65b9\u6cd5\u53ef\u4ee5\u6784\u9020\u51fa\u5e73\u884c\u56db\u8fb9\u5f62\u3002\u56e0\u6b64\u4e09\u89d2\u5f62\u5c31\u662f\u53c9\u79ef\u7684\u7edd\u5bf9\u503c\u7684\u4e00\u534a\u3002<br/>\u5148\u6765\u770b\u4e00\u4e0b\u6b63\u65b9\u5f62\uff1a<br/><br/>\u663e\u7136\uff0c\u5b83\u7684\u9762\u79ef\u662f$1$\u3002<br/>\u4f46\u73b0\u5728\u8981\u4f60\u7528\u5411\u91cf\u7684\u65b9\u6cd5\u6765\u8ba1\u7b97\uff0c\u8be5\u600e\u4e48\u529e?<br/>\u6211\u4eec\u7684\u6b63\u65b9\u5f62\u662f\u7528\u4e00\u7ec4\u5411\u91cf\u6765\u8868\u793a\u7684($\\\\vec{AB}$\u3001$\\\\vec{BC}$\u3001$\\\\vec{CD}$\u548c$\\\\vec{DA}$)\uff0c\u5e76\u4e14\u6309\u7167\u9006\u65f6\u9488\u6392\u5217\uff0c\u8fd9\u6837\u5c31\u6307\u5b9a\u4e86\u9876\u70b9\u7684\u987a\u5e8f\u3002<br/>\u7136\u540e\u6211\u4eec\u6309\u7167\u4e0b\u9762\u7684\u6d41\u7a0b\u6765\u8ba1\u7b97\u9762\u79ef\uff1a<br/><br/>\u5728\u5e73\u9762\u5185\u4efb\u9009\u4e00\u70b9\u4f5c\u4e3a\u539f\u70b9\u3002  <br/>\u6309\u7167\u6709\u5411\u8fb9\u7684\u987a\u5e8f\u4f9d\u6b21\u8ba1\u7b97\u53c9\u79ef\u5e76\u7d2f\u79ef\u6c42\u548c\uff0c\u6700\u540e\u7684\u7ed3\u679c\u9664\u4ee5$2$\u5c31\u662f\u591a\u8fb9\u5f62\u7684\u9762\u79ef\u3002<br/><br/>\u73b0\u5728\u6211\u4eec\u6765\u6f14\u793a\u4e00\u6b21\uff1a<br/><br/>\u9009\u5b9a\u539f\u70b9\uff0c\u5e73\u9762\u5185\u4efb\u610f\u4e00\u4e2a\u70b9\u90fd\u53ef\u4ee5\u3002\u8fd9\u91cc\u9009\u62e9\u7684\u662f$O$\u70b9\u3002<br/><br/>\u8ba1\u7b97\u53c9\u79ef\uff0c\u9996\u5148\u662f$\\\\vec{AB}$\uff0c\u6211\u4eec\u8ba1\u7b97\u7684\u662f$\\\\vec{OA} \\\\times \\\\vec{OB} = -1 $\u3002<br/><br/>\u7136\u540e\u662f$\\\\vec{BC}$\uff0c$\\\\vec{OB} \\\\times \\\\vec{OC} = 2$\u3002<br/><br/>\u4e4b\u540e\u662f$\\\\vec{CD}$\uff0c$\\\\vec{OC} \\\\times \\\\vec{OD} = 2$\u3002<br/><br/>\u6700\u540e\u662f$\\\\vec{DA}$\uff0c$\\\\vec{OD} \\\\times \\\\vec{OA} = -1$\u3002<br/>\u5c06\u53c9\u79ef\u7ed3\u679c\u7d2f\u52a0\u8d77\u6765\u5e76\u9664\u4ee5$2$\uff0c\u5f97\u5230$ S_{ABCD} = 1$\u3002<br/>\u7b97\u6cd5\u5f97\u5230\u4e86\u6b63\u786e\u7ed3\u679c\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u5c31\u662f\u7b80\u5355\u591a\u8fb9\u5f62\u7684\u9762\u79ef\u7b97\u6cd5\u3002\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8ba1\u7b97\u662f\u6b63\u786e\u7684\u5462\uff1f<br/>\u6211\u4eec\u9996\u5148\u6765\u8003\u8651$\\\\vec{AB}$\u548c$\\\\vec{BC}$\u3002<br/><br/>\u8fd9\u4e24\u4e2a\u5411\u91cf\u4ece$O$\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u4eec\u662f\u76f8\u53cd\u7684\u65b9\u5411\uff0c\u5e76\u4e14\u5b83\u4eec\u53c9\u79ef\u51fa\u6765\u7684\u7ed3\u679c\u662f\u5f02\u53f7\u7684\u3002<br/>\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c${\\\\vec{OA} \\\\times \\\\vec{OB} \\\\over 2}$\u5c31\u662f$-S_{\\\\triangle OBA}$\uff0c${\\\\vec{OB} \\\\times \\\\vec{OC} \\\\over 2}$\u5c31\u662f$S_{\\\\triangle OBC}$\uff0c$S_{\\\\triangle OBC}-S_{\\\\triangle OBA} = S_{\\\\triangle ABC}$\u3002\u56e0\u6b64\u8fd9\u4e00\u5bf9\u8fb9\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u6b63\u65b9\u5f62\u4e00\u534a\u7684\u9762\u79ef\u3002\u5bf9\u4e8e\u53e6\u4e00\u534a\uff0c\u4e5f\u662f\u5982\u6b64\u3002<br/>\u56e0\u6b64\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u65f6\u5148\u8ba1\u7b97\u8fd9\u4e2a\u591a\u8fb9\u5f62\u4e0e\u9009\u5b9a\u7684\u539f\u70b9\u6784\u6210\u7684\u66f4\u5927\u7684\u591a\u8fb9\u5f62\u7684\u9762\u79ef\uff1a<br/><br/>\u4e0a\u56fe\u5c31\u662f\u7ebf\u8ba1\u7b97\u4e86$S_{OCDEFG}$\u3002\u8fd9\u51e0\u6761\u8fb9\u7684\u53c9\u79ef\u4e4b\u548c\u4e3a\u6b63\u6570\u3002<br/>\u7136\u540e\u8ba1\u7b97\u4e0d\u5c5e\u4e8e\u591a\u8fb9\u5f62\u7684\u90e8\u5206\uff1a<br/><br/>\u4e0a\u56fe\u4e2d\u5c31\u662f\u8ba1\u7b97$S_{OCBAG}$\uff0c\u800c\u8fd9\u51e0\u6761\u8fb9\u7684\u53c9\u79ef\u4e4b\u548c\u662f\u8d1f\u6570\u3002\u56e0\u6b64\u76f8\u52a0\u540e\u5c31\u53ea\u5269\u4e0b\u591a\u8fb9\u5f62\u7684\u9762\u79ef\u4e86\u3002<br/>\u53c8\u56e0\u4e3a\u53c9\u79ef\u8ba1\u7b97\u7684\u662f\u5e73\u884c\u56db\u8fb9\u5f62\u7684\u9762\u79ef\uff0c\u6240\u4ee5\u6700\u540e\u8981\u9664\u4ee5$2$\u3002",
"url": "blog/2016-4-12/geometry.html"
},
"\u5feb\u901f\u6570\u8bba\u53d8\u6362 (NTT)": {
"tags": "FFT NTT",
"text": "\u5feb\u901f\u6570\u8bba\u53d8\u6362 (NTT)<br/>\u4e4b\u524d\u5199\u4e86\u4e00\u7bc7\u5173\u4e8e\u591a\u9879\u5f0f\u7b97\u6cd5\u7684\u535a\u5ba2\uff0c\u63d0\u5230\u4e86\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362 (FFT)\u3002<br/>\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\u4e2d\u4f7f\u7528\u4e86\u5355\u4f4d\u590d\u6570\u6839\u6765\u8fdb\u884c\u91c7\u6837\u4e0e\u63d2\u503c\uff0c\u5feb\u901f\u6570\u8bba\u53d8\u6362\u548c\u8fd9\u662f\u7c7b\u4f3c\u7684\uff0c\u53ea\u4e0d\u8fc7\u4f7f\u7528\u7684\u662f\u539f\u6839\u3002<br/>\u539f\u6839\u7684\u6027\u8d28<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5047\u8bbe\u4e0b\u9762\u6240\u6709\u7684 $n$ \u90fd\u662f\u5927\u4e8e $1$ \u7684 $2$ \u7684\u5e42\uff0c\u6211\u4eec\u8bbe\uff1a<br/>$$<br/>g_n = g^{(p-1) / n}<br/>$$<br/>\u5176\u4e2d $p$ \u662f\u7d20\u6570\u5e76\u4e14 $n \\\\mid (p-1)$\uff0c\u53e6\u5916 $g$ \u662f\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u539f\u6839\u3002<br/>\u8003\u8651\u4e0b\u5355\u4f4d\u590d\u6570\u6839\u4e3a\u4ec0\u80fd\u505a\u5230 $\\\\Theta(n \\\\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u662f\u56e0\u4e3a\u5b83\u5177\u6709\u4e0b\u9762\u7684\u6027\u8d28\uff1a<br/><br/>$$ \\\\omega_n^n = 1 \\\\\\\\ \\\\omega_n^{n/2} = -1$$<br/><br/>\u5bf9\u539f\u6839\u800c\u8a00\uff1a<br/>$$<br/>g_n^n = g^{n(p-1) / n} = g^{p-1} = g^{\\\\varphi(p)} = 1 \\\\\\\\<br/>g_n^{n/2} = g^{(p - 1)/2}<br/>$$<br/>\u800c\uff1a<br/>$$<br/>g^{(p - 1)/2} \\\\equiv \\\\sqrt{1} \\\\pmod{p}<br/>$$<br/>\u56e0\u6b64\u5e94\u8be5\u6709 $\\\\pm 1$ \u8fd9\u4e24\u79cd\u53d6\u503c\u3002\u4f46\u662f\u7531\u4e8e $g^{(p-1) / 2} \\\\neq g^{p-1} = 1$\uff0c\u6240\u4ee5\u4e0d\u80fd\u4e3a $1$\u3002<br/><br/>$$ \\\\omega_{dn}^{dk} = \\\\omega_n^k $$<br/><br/>\u539f\u6839\u4e5f\u53ef\u4ee5\uff1a<br/>$$<br/>g_{dn}^{dk} = g^{dk(p-1) / dn} = g^{k(p-1) / n} = g_n^k<br/>$$<br/><br/>(\u6298\u534a\u5f15\u7406)<br/>$$ \\\\{(\\\\omega_n^k)^2\\\\} = \\\\{\\\\omega_{n/2}^k\\\\} $$<br/><br/>\u539f\u6839\u4f9d\u7136\u53ef\u4ee5\u3002<br/>\u6839\u636e\u4e0a\u9762\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>(g_n^{k})^2 = g_{n}^{2k} = g_{n/2}^k \\\\\\\\<br/>(g_n^{k+n/2})^2 = g_n^{2k+n} = g_n^{2k} = g_{n/2}^k<br/>$$<br/>\u56e0\u6b64\uff0c\u5355\u4f4d\u590d\u6570\u6839\u8be5\u6709\u7684\u6027\u8d28\u539f\u6839\u5c45\u7136\u90fd\u6709\uff01<br/>NTT\u7b97\u6cd5<br/>\u4ece\u4e0a\u9762\u7684\u8ba8\u8bba\u4e2d\u6211\u4eec\u77e5\u9053\uff0c\u5c06\u4f60\u7684 FFT \u4ee3\u7801\u4e2d\u7684\u5355\u4f4d\u590d\u6570\u6839\u6362\u6210 $g_n^k$\uff0c\u5c31\u662f NTT\u3002\u6ce8\u610f\u5230\u5904\u53d6\u6a21\u3002<br/>\u9006 FFT \u53d8\u6362\u65f6\u9700\u8981\u9664\u4ee5 $n$\uff0c\u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u8bb0\u4f4f\u662f\u4f7f\u7528\u9006\u5143\u3002<br/>NTT \u7684\u603b\u590d\u6742\u5ea6\u4e0e FFT \u4e00\u81f4\uff0c\u662f $\\\\Theta(n \\\\log n)$\u3002<br/>\u6700\u540e\u8fd8\u5269\u4e0b\u4e00\u4e2a\u95ee\u9898\uff1a$p$ \u548c $g$ \u8be5\u600e\u4e48\u529e\u3002<br/>\u5728 FFT \u4e2d\uff0c\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406\uff0c$n$ \u4e00\u822c\u90fd\u662f\u9009\u5b9a\u4e86\u4e00\u4e2a $2$ \u7684\u5e42\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e $p$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9009\u51fa\u4e00\u4e2a $p-1$ \u4e2d\u542b\u6709 $2$ \u7684\u5e42\u7684\u56e0\u5b50\u7684\u7d20\u6570\uff0c\u5e76\u4e14\u8fd9\u4e2a $2$ \u7684\u5e42\u8981\u5927\u4e8e $n$\u3002\u901a\u5e38\u9009\u62e9\u5f62\u5982 $a\\\\cdot 2^k + 1$ \u7684\u7d20\u6570\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u901a\u5e38\u9009\u5b9a\uff1a<br/>$$<br/>p = 1004535809 = 479 \\\\times 2^{21} + 1<br/>$$<br/>\u5b83\u7684\u6700\u5c0f\u6b63\u539f\u6839\u662f $3$\u3002<br/>\u53e6\u5916\u4e00\u4e2a\u662f\u8457\u540d\u7684 UOJ \u6a21\u6570 $998244353 = 2^{23} \\\\times 7 \\\\times 17 + 1$\uff0c\u6700\u5c0f\u6b63\u539f\u6839\u4e5f\u662f $3$\u3002<br/>\u4f7f\u7528\u5feb\u901f\u6570\u8bba\u53d8\u6362\u7684\u597d\u5904\u5c31\u662f\u907f\u514d\u4e86\u6d6e\u70b9\u6570\u7cbe\u5ea6\u8bef\u5dee\u3002\u5f53\u8f93\u5165\u7cfb\u6570\u90fd\u662f\u6574\u578b\u7684\u65f6\u5019\u6700\u597d\u4f18\u5148\u8003\u8651 NTT\u3002",
"url": "blog/2016-8-22/ntt.html"
},
"\u6240\u6709\u6587\u7ae0": {
"tags": "Posts",
"text": "\u6240\u6709\u6587\u7ae0<br/>2018<br/>2018-9<br/><br/>\u675c\u6559\u7b5b\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790<br/><br/>2018-7<br/><br/>\u9644\u4e2d 2018 \u590f\u4ee4\u8425\u8bfe\u4ef6<br/><br/>2018-6<br/><br/>\u6700\u5c0f\u6811\u5f62\u56fe: \u6700\u5c0f\u6811\u5f62\u56fe\u6731\u5218\u7b97\u6cd5\u4ee5\u53ca Tarjan \u7684\u6539\u8fdb\u7248\u672c<br/><br/>2018-3<br/><br/>\u780d\u6728\u68cd\u95ee\u9898: \u5c06\u4e00\u6839\u957f\u4e3a $a$ \u7684\u6728\u68cd\u6bcf\u6b21\u968f\u673a\u780d\u6389\u4e00\u6bb5\uff0c\u671f\u671b\u591a\u5c11\u6b21\u540e\u6728\u68cd\u957f\u5ea6\u5c0f\u4e8e $b$ \uff1f<br/><br/>2018-1<br/><br/>\u533a\u95f4\u52a0\u591a\u9879\u5f0f\u95ee\u9898\u7684\u7814\u7a76<br/><br/>2017<br/>2017-12<br/><br/>\u6570\u5b66\u95ee\u9898\u6742\u8bb0: \u4e00\u4e9b\u6bd4\u8f83\u6709\u610f\u601d\u7684\u6570\u5b66\u95ee\u9898<br/><br/>2017-10<br/><br/>\u8ba1\u7b97\u7eaf\u7535\u963b\u7f51\u7edc\u7684\u7b49\u6548\u7535\u963b<br/>OI Coding Guidelines: \u4e2a\u4eba\u5bf9 OI \u7f16\u7a0b\u7684\u4e00\u4e9b\u7ecf\u9a8c<br/>\u8ba1\u7b97\u5206\u62c6\u6570\u7684\u4e00\u79cd\u65b9\u6cd5: \u4f7f\u7528\u591a\u9879\u5f0f\u4e58\u6cd5\u52a0\u901f\u8ba1\u7b97\u5206\u62c6\u6570<br/><br/>2017-9<br/><br/>\u9759\u6001\u6811\u4e0a\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898: \u4ecb\u7ecd\u4e86\u6c42\u89e3\u6700\u8fd1\u516c\u5171\u7956\u5148\u7684\u4e3b\u8981\u7684\u7b97\u6cd5<br/><br/>2017-6<br/><br/>\u53cc\u91cd\u8ba1\u6570\u7684\u7b80\u5355\u5e94\u7528: \u4ecb\u7ecd\u4e86\u51e0\u4e2a\u53cc\u91cd\u8ba1\u6570\u5728\u56fe\u8ba1\u6570\u4e0a\u7684\u4f8b\u5b50<br/><br/>2017-5<br/><br/>\u3010NOI2016\u3011\u201c\u5faa\u73af\u4e4b\u7f8e\u201d \u65e0\u8111\u89e3\u6cd5: NOI2016 Day1 T3 \u76f4\u63a5 DP \u505a\u6cd5<br/>$n = p \\\\mathrm{\\\\;mod\\\\;} n$\u9012\u63a8\u6b21\u6570\u7684\u4e0a\u754c\uff1f: \u4e00\u4e2a\u7b80\u5355\u7684\u6c42\u6a21\u8d28\u6570\u610f\u4e49\u4e0b\u7684\u9006\u5143\u7684\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\uff0c\u672a\u5b8c\u5de5\u3002<br/><br/>2017-3<br/><br/>\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5: \u62c9\u683c\u6717\u65e5\u63d2\u503c\u516c\u5f0f\u548c\u5176\u5e94\u7528\uff0c\u7528\u4e8e\u6c42\u81ea\u7136\u6570\u7684$k$\u6b21\u5e42\u7684\u524d\u7f00\u548c<br/>\u6307\u6570\u4e0e\u539f\u6839\u7b14\u8bb0: \u6570\u8bba\u4e2d\u6709\u5173\u6307\u6570\u548c\u539f\u6839\u7684\u4e00\u4e9b\u5b9a\u7406\u548c\u76f8\u5173\u7b97\u6cd5<br/><br/>2017-2<br/><br/>\u65e0\u5411\u56fe\u6700\u5c0f\u5272: \u5173\u4e8e\u65e0\u5411\u56fe\u4e0a\u7684\u6700\u5c0f\u5272\u95ee\u9898\u4ee5\u53ca\u8be5\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5<br/>\u957f\u94fe\u5256\u5206: \u957f\u94fe\u5256\u5206\u7b97\u6cd5\uff0c\u4e0e\u6811\u94fe\u5256\u5206\u7c7b\u4f3c\uff0c\u4f46\u53ef\u4ee5\u4ee5 $O(n \\\\log n) - \\\\Theta(1)$ \u7684\u590d\u6742\u5ea6\u67e5\u8be2\u6811\u4e0a\u7956\u5148<br/><br/>2017-1<br/><br/>\u66fc\u54c8\u987f\u8ddd\u79bb\u6700\u5c0f\u751f\u6210\u6811: \u8bb0\u5f55\u4e00\u4e0b\u6c42 $n$ \u4e2a\u70b9\u7684\u6700\u5c0f\u66fc\u54c8\u987f\u8ddd\u79bb\u751f\u6210\u6811\u7684\u7b97\u6cd5<br/><br/>2016<br/>2016-12<br/><br/>\u516c\u5e73\u7ec4\u5408\u6e38\u620f: \u516c\u5e73\u7ec4\u5408\u6e38\u620f\u4e2d\u5341\u5206\u91cd\u8981\u7684\u6982\u5ff5\u548c Sprague-Grundy \u5b9a\u7406<br/>\u67d3\u8272\u8ba1\u6570: \u4ecb\u7ecd\u4e86\u7528\u4e8e\u89e3\u51b3\u672c\u8d28\u4e0d\u540c\u7684\u67d3\u8272\u95ee\u9898\u7684\u6709\u529b\u5de5\u5177 Burnside \u5b9a\u7406<br/>\u6b27\u62c9\u56de\u8def: \u6b27\u62c9\u56de\u8def\u7684\u5224\u5b9a\u4e0e\u6784\u9020\u7b97\u6cd5<br/><br/>2016-11<br/><br/>\u5dee\u5206\u5e8f\u5217\u4e0e Stirling \u6570: \u4ecb\u7ecd\u4e86\u5dee\u5206\u5e8f\u5217\u548c\u4e24\u7c7b Stirling \u6570<br/>\u4f4d\u8fd0\u7b97\u5377\u79ef\u4e0e FWT: \u4ecb\u7ecd\u4e86\u4f4d\u8fd0\u7b97\u5377\u79ef\u4ee5\u53ca\u5feb\u901f\u8ba1\u7b97\u7684 FWT \u7b97\u6cd5<br/>\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5: \u7b80\u5355\u4ecb\u7ecd\u4e86\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u548c\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5<br/>RSRL\u5f00\u53d1\u8bb0\u5f55\uff08\u4e00\uff09<br/><br/>2016-10<br/><br/>\u6536\u5230\u4e00\u5c01\u5947\u602a\u7684\u90ae\u4ef6<br/><br/>2016-9<br/><br/>Hall \u5b9a\u7406: \u4e00\u4e2a\u7528\u4e8e\u5224\u5b9a\u4e8c\u5206\u56fe\u662f\u5426\u5177\u6709\u6700\u5927\u5339\u914d\u7684\u5b9a\u7406<br/><br/>2016-8<br/><br/>HNSDFZ2016 #5: HNSDFZ2016 \u7b2c\u4e94\u6b21\u6b22\u4e50\u4e92\u6d4b<br/>\u5feb\u901f\u6570\u8bba\u53d8\u6362 (NTT): \u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\u7684\u53cc\u80de\u80ce\uff0c\u7528\u539f\u6839\u4ee3\u66ff\u5355\u4f4d\u590d\u6570\u6839<br/>\u4e8c\u8fdb\u5236 GCD: \u5728\u7b97\u5bfc\u4e0a\u53d1\u73b0\u4e86\u4e00\u4e2a\u6709\u8da3\u7684\u7b97\u6cd5\uff0c\u6709\u6c27\u73af\u5883\u4e0b\u53ef\u4ee5\u62ff\u6765\u5361\u5361\u5e38.....<br/>\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14: \u4ecb\u7ecd\u4e86\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u548c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f<br/>\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ca\u5176\u5b83: \u8bb0\u5f55\u4e00\u4e0b\u4e8c\u9879\u5f0f\u5b9a\u7406\u3001\u591a\u9879\u5f0f\u5b9a\u7406\u548c\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u4e00\u4e9b\u4e1c\u897f<br/>\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 (CRT): \u4ecb\u7ecd\u4e86\u57fa\u672c\u7684\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406<br/>HNSDFZ2016 #4: HNSDFZ2016 \u7b2c\u56db\u6b21\u6b22\u4e50\u4e92\u6d4b<br/>\u51f8\u5305\u76f8\u5173: \u51f8\u5305\u7684\u6784\u9020\u7b97\u6cd5\u4e0e\u52a8\u6001\u51f8\u5305\u3001\u65cb\u8f6c\u5361\u58f3\u548c\u659c\u7387\u4f18\u5316<br/><br/>2016-7<br/><br/>\u5e73\u8861\u6811\u5957\u94fe\u8868: \u7528\u94fe\u8868\u52a0\u901f\u5e73\u8861\u6811\u4e0a\u524d\u8d8b\u540e\u7ee7\u7684\u67e5\u8be2<br/>\u6709\u5173\u591a\u9879\u5f0f\u7684\u7b97\u6cd5:\u8bb0\u5f55\u4e00\u4e9b\u4e0e\u591a\u9879\u76f8\u5173\u5f0f\u7b97\u6cd5<br/>HNSDFZ2016 #3: HNSDFZ2016 \u7b2c\u4e09\u6b21\u6b22\u4e50\u4e92\u6d4b<br/><br/>2016-6<br/><br/>\u6781\u9650\u4e0e\u5bfc\u6570: \u6700\u8fd1\u5b66\u4e86\u4e00\u4e9b\u57fa\u7840\u5fae\u79ef\u5206\uff0c\u8fd9\u91cc\u7a0d\u5fae\u8bb0\u5f55\u4e00\u4e0b<br/>\u8bf1\u5bfc\u6392\u5e8f\u4e0e SA-IS \u7b97\u6cd5: \u4ecb\u7ecd\u4e00\u79cd\u5728 2009 \u5e74\u51fa\u73b0\u7684\u57fa\u4e8e\u8bf1\u5bfc\u6392\u5e8f\u601d\u60f3\u7684\u7ebf\u6027\u65f6\u95f4\u6784\u5efa\u540e\u7f00\u6570\u7ec4\u7684\u7b97\u6cd5 SA-IS\u3002\u6b64\u7b97\u6cd5\u53f7\u79f0\u662f\u76ee\u524d\u901f\u5ea6\u6700\u5feb\u7684\u540e\u7f00\u6570\u7ec4\u6784\u5efa\u7b97\u6cd5<br/>\u6811\u72b6\u6570\u7ec4: \u603b\u7ed3\u4e00\u4e0b\u6811\u72b6\u6570\u7ec4\u7684\u7528\u6cd5<br/><br/>2016-5<br/><br/>HNSDFZ2016 #2: HNSDFZ2016 \u7b2c\u4e8c\u6b21\u6b22\u4e50\u4e92\u6d4b<br/>HNSDFZ2016 #1: HNSDFZ2016 \u7b2c\u4e00\u6b21\u6b22\u4e50\u4e92\u6d4b<br/>\u6392\u5217\u4e0e\u7ec4\u5408: \u4ecb\u7ecd\u4e86\u6392\u5217\u4e0e\u7ec4\u5408\u7684\u57fa\u7840\u77e5\u8bc6<br/><br/>2016-4<br/><br/>\u4f2a\u4ee3\u7801\u89c4\u5b9a: \u89c4\u5b9a\u4e0b\u672c\u535a\u5ba2\u7684\u4f2a\u4ee3\u7801\u89c4\u8303\uff0c\u4e0d\u8981\u60f3\u592a\u591a<br/>\u6811\u94fe\u5256\u5206: \u4ecb\u7ecd\u4e86\u6811\u94fe\u5256\u5206\u7b97\u6cd5\u53ca\u5176\u5c0f\u6269\u5c55<br/>Graphviz: \u53ef\u89c6\u5316\u8c03\u8bd5\u5229\u5668: \u4ecb\u7ecd\u53ef\u89c6\u5316\u5de5\u5177 Graphviz \u7684\u57fa\u672c\u4f7f\u7528<br/>\u5e73\u9762\u8ba1\u7b97\u51e0\u4f55: \u8ba1\u7b97\u51e0\u4f55\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u7b97\u6cd5<br/>\u79e9\u5e73\u8861\u6811 (Rank Balanced Tree): \u5229\u7528\u79e9\u8fdb\u884c\u5e73\u8861\u7684\u4e8c\u53c9\u641c\u7d22\u6811<br/>\u66ff\u7f6a\u7f8a\u6811 (Scapegoat Tree): \u4e8c\u53c9\u5e73\u8861\u6811\u66ff\u7f6a\u7f8a\u6811<br/><br/>2016-3<br/><br/>$x^n-1$ \u95ee\u9898: \u5bf9 $x^n-1$ \u8fdb\u884c\u56e0\u5f0f\u5206\u89e3<br/>2-3 \u6811\u4e0e\u7ea2\u9ed1\u6811: 2-3 \u6811\u4e0e\u7ea2\u9ed1\u6811<br/><br/>2016-2<br/><br/>DevIL \u5feb\u901f\u5165\u95e8: \u4e86\u89e3\u56fe\u7247\u5e93 DevIL<br/>\u6b63\u5f0f\u5f00\u59cb\u7f16\u5199 ne2d: \u542f\u52a8 ne2d<br/>\u6d4b\u8bd5\u591a\u8bf4: \u6d4b\u8bd5\u591a\u8bf4\u8bc4\u8bba\u7cfb\u7edf<br/>\u7f16\u8bd1\u5e76\u4f7f\u7528 bgfx: bgfx \u5728 Ubuntu \u4e0a\u7f16\u8bd1<br/>\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41: \u589e\u5e7f\u8def\u7b97\u6cd5<br/>[POJ2135] Farm Tour: POJ2135 \u9898\u89e3<br/>[NOIP2014] \u5bfb\u627e\u9053\u8def: NOIP2014 Day2 T2 \u9898\u89e3<br/>[NOIP2015] \u4fe1\u606f\u4f20\u9012: NOIP2015 Day1 T2 \u9898\u89e3<br/>\u6700\u8fd1\u516c\u5171\u7956\u5148 (LCA): \u6734\u7d20 LCA \u7b97\u6cd5\uff0cTarjan LCA \u7b97\u6cd5\uff0c\u500d\u589e\u6cd5<br/><br/>2016-1<br/><br/>pagegen.py \u7684\u8bd5\u70bc: \u6d4b\u8bd5 pagegen.py<br/><br/>\u4e34\u65f6\u94fe\u63a5<br/><br/>\u65e0\u5c3d\u7684\u9ec4\u91d1 (HNSDFZ OIER FORBIDDEN before self contest #6)<br/>\u7a7a\u88ad (HNSDFZ OIER FORBIDDEN before self contest #5)<br/>$k$-SBK \u53d8\u6362 (HNSDFZ OIER FORBIDDEN before self contest #4)<br/>HNSDFZ #3<br/>Lesson 16<br/>",
"url": "posts.html"
},
"\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5": {
"tags": "\u591a\u9879\u5f0f\u63d2\u503c",
"text": "\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5<br/>\u7b80\u4ecb<br/>\u4f17\u6240\u5468\u77e5\uff0c\u7ed9\u5b9a$n + 1$\u4e2a\u6a2a\u5750\u6807\u4e0d\u76f8\u540c\u7684\u70b9\uff0c\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a$n$\u6b21\u7684\u591a\u9879\u5f0f\u3002\u90a3\u4e48\u5982\u4f55\u6c42\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\uff1f\u6700\u76f4\u89c2\u7684\u505a\u6cd5\u5c31\u662f\u5217\u65b9\u7a0b\u6c42\u89e3\u3002\u4f46\u662f\u8fd9\u6837\u9700\u8981$\\\\Theta(n^3)$\u7684\u65f6\u95f4\u6765\u8ba1\u7b97\u3002\u800c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u5219\u901a\u8fc7\u6784\u9020\u7684\u65b9\u6cd5\uff0c\u5f97\u5230\u4e86\u4e00\u4e2a\u7ecf\u8fc7$n + 1$\u4e2a\u70b9\u7684$n$\u6b21\u591a\u9879\u5f0f\u3002<br/>\u5177\u4f53\u7684\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff0c\u5047\u8bbe\u73b0\u5728\u6211\u4eec\u5f97\u5230\u4e86$n + 1$\u4e2a\u70b9\uff1a<br/>$$<br/>(x_0, y_0), \\\\;(x_1, y_1),\\\\; \\\\dots,\\\\;(x_n, y_n)<br/>$$<br/>\u8bbe\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f\u4e3a\uff1a<br/>$$<br/>\\\\ell_j(x) = \\\\prod_{i = 0, i \\\\neq j}^n {x - x_i \\\\over x_j - x_i}<br/>\\\\tag{1.1}<br/>$$<br/>\u8fd9\u4e2a\u57fa\u672c\u591a\u9879\u5f0f\u6784\u9020\u5341\u5206\u5de7\u5999\uff0c\u56e0\u4e3a\u6ce8\u610f\u5230$\\\\ell_j(x_j) = 1$\uff0c\u5e76\u4e14$\\\\ell_j(x_i) = 0, \\\\;\\\\forall i \\\\neq j$\u3002\u90a3\u4e48\uff0c\u63a5\u7740\u6784\u9020\u51fa\u8fd9\u4e2a$n$\u6b21\u591a\u9879\u5f0f\uff1a<br/>$$<br/>P(x) = \\\\sum_{i = 0}^n y_i\\\\ell_i(x)<br/>\\\\tag{1.2}<br/>$$<br/>\u6839\u636e\u57fa\u672c\u591a\u9879\u5f0f\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053$P(x_i) = y_i$\uff0c\u4e5f\u5c31\u662f\u7ecf\u8fc7\u4e86\u8fd9$n + 1$\u4e2a\u70b9\u3002<br/>\u901a\u8fc7\u7b80\u5355\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u548c\u591a\u9879\u5f0f\u9664\u6cd5\u5c31\u53ef\u4ee5\u5728$\\\\Theta(n^2)$\u7684\u65f6\u95f4\u6c42\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u8fbe\u3002<br/>\u62c9\u683c\u6717\u65e5\u63d2\u503c\u516c\u5f0f\u5f62\u5f0f\u6bd4\u8f83\u4f18\u7f8e\uff0c\u63a5\u4e0b\u6765\u5c06\u4ecb\u7ecd\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53e6\u5916\u4e00\u4e2a\u5e94\u7528\u3002<br/>\u81ea\u7136\u6570\u7684\u5e42\u7684\u524d\u7f00\u548c<br/>\u8fd9\u662f\u4e00\u4e2a\u5341\u5206\u7ecf\u5178\u7684\u95ee\u9898\uff1a<br/><br/>\u5bf9\u4e8e\u7ed9\u5b9a\u7684$n$\u548c$k$\uff0c\u8981\u6c42\u6c42\u51fa\uff1a<br/>$$ \\\\sum_{a = 1}^n a^k $$<br/>\u901a\u5e38$n$\u4f1a\u6bd4\u8f83\u5927\uff0c\u800c$k$\u53ea\u6709\u51e0\u5343\u6216\u8005\u51e0\u4e07\u3002<br/><br/>\u5f53$k = 1$\u65f6\uff0c\u6211\u4eec\u77e5\u9053\u516c\u5f0f\u4e3a$n(n + 1) / 2$\uff0c\u662f\u4e00\u4e2a\u4e8c\u6b21\u591a\u9879\u5f0f\u3002<br/>\u66f4\u4e00\u822c\u7684\uff0c\u7b54\u6848\u4e00\u5b9a\u662f$k + 1$\u6b21\u591a\u9879\u5f0f\u3002\u901a\u8fc7\u5dee\u5206\u53ef\u4ee5\u5904\u7406\u8fd9\u79cd\u591a\u9879\u5f0f\uff0c\u5177\u4f53\u7684\u53ef\u4ee5\u53c2\u8003\u6211\u4e4b\u524d\u7684\u535a\u5ba2\u6216\u8005\u6709\u5173\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u8d44\u6599\u3002<br/>\u73b0\u5728\u6211\u4eec\u6765\u8003\u8651\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u6765\u83b7\u5f97\u7b54\u6848\u591a\u9879\u5f0f\u3002<br/>\u9996\u5148\u5982\u679c\u6211\u4eec\u5f97\u77e5\u4e86$n = 0, 1, \\\\dots, k + 1$\u5904\u7684\u7b54\u6848$f(n)$\uff0c\u90a3\u4e48\u7ed9\u5b9a\u7684$n$\u5904\u7684\u7b54\u6848\u53ef\u4ee5\u5199\u6210\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f(n) & = \\\\sum_{i = 0}^{k + 1} f(i) {(n - 0)(n - 1)\\\\cdots[n - (i - 1)][(n - (i + 1)]\\\\cdots[n - (k + 1)] \\\\over (i - 0)(i - 1)\\\\cdots[i - (i - 1)][(i - (i + 1)]\\\\cdots[i - (k + 1)]} \\\\\\\\<br/>& = \\\\sum_{i = 0}^{k + 1} f(i) {\\\\prod_{j = 0}^{i - 1} (n - j) \\\\prod_{j = i + 1}^{k + 1} (n - j) \\\\over i!(-1)^{k - i + 1}(k + 1 - i)!} \\\\\\\\<br/>& = \\\\sum_{i = 0}^{k + 1} (-1)^{k - i + 1}f(i) {\\\\prod_{j = 0}^{i - 1} (n - j) \\\\prod_{j = i + 1}^{k + 1} (n - j) \\\\over i!(k + 1 - i)!}<br/>\\\\end{aligned}<br/>$$<br/>\u6ce8\u610f\u5230\u540e\u9762\u7684\u5206\u5f0f\u4e2d\uff0c\u5206\u5b50\u662f\u4e00\u4e2a\u524d\u7f00\u79ef\u4e58\u4ee5\u4e00\u4e2a\u540e\u7f00\u79ef\uff0c\u800c\u5206\u6bcd\u662f\u4e24\u4e2a\u9636\u4e58\u3002\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u5728$\\\\Theta(k)$\u7684\u65f6\u95f4\u5185\u6c42\u51fa\u3002<br/>\u73b0\u5728\u5269\u4e0b\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u6c42\u51fa$f(0), f(1), \\\\dots, f(k + 1)$\u4e86\u3002\u7531\u4e8e$g(x) = x^k$\u662f\u4e2a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6b27\u62c9\u7b5b\u6cd5\u6c42\u51fa$g$\u51fd\u6570\u524d\u9762\u7684\u4e00\u4e9b\u503c\u3002\u5177\u4f53\u7684\u5c31\u662f\u5bf9\u4e8e\u8d28\u6570\u91c7\u53d6\u76f4\u63a5\u5feb\u901f\u5e42\uff0c\u5408\u6570\u5219\u62c6\u51fa\u4efb\u610f\u4e00\u4e2a\u56e0\u5b50\u6765\u7b97\uff0c\u901a\u5e38\u662f\u6b27\u62c9\u7b5b\u6cd5\u4e2d\u53ef\u4ee5\u987a\u4fbf\u6c42\u5f97\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u3002\u6839\u636e\u7d20\u6570\u5b9a\u7406\uff0c\u7d20\u6570\u5927\u7ea6\u6709$O(k/\\\\ln k)$\u4e2a\u3002\u6bcf\u6b21\u5feb\u901f\u5e42\u9700\u8981\u82b1\u8d39$\\\\Theta(\\\\log k)$\u7684\u65f6\u95f4\uff0c\u56e0\u6b64\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u4f30\u8ba1\u4e3a$\\\\Theta(k)$\uff0c\u662f\u4e00\u4e2a\u975e\u5e38\u4f18\u79c0\u7684\u7b97\u6cd5\u3002<br/>\u4e0a\u9762\u7684\u65b9\u6cd5\u5177\u6709\u901a\u7528\u6027\uff0c\u53ea\u8981\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u7684\u6c42\u51fa\u67d0\u4e2a$k$\u6b21\u591a\u9879\u5f0f\u7684\u524d$k + 1$\u4e2a\u503c\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u90e8\u5206\u53ef\u4ee5\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u5728$\\\\Theta(k)$\u7684\u65f6\u95f4\u5185\u5b8c\u6210\u8ba1\u7b97\u3002",
"url": "blog/2017-3-18/lagrange-interpolation.html"
},
"\u6307\u6570\u4e0e\u539f\u6839\u7b14\u8bb0": {
"tags": "\u6570\u8bba \u539f\u6839",
"text": "\u6307\u6570\u4e0e\u539f\u6839\u7b14\u8bb0<br/>\u8fd9\u91cc\u5927\u90e8\u5206\u5b9a\u7406\u7684\u8bc1\u660e\u65b9\u6cd5\u6458\u81ea\u300a\u521d\u7b49\u6570\u8bba\u300b\u7b2c\u4e09\u7248\u3002<br/>\u6307\u6570<br/>\u4ee4$\\\\delta_m(a)$\u4e3a\u6ee1\u8db3\u4e0b\u9762\u7b49\u5f0f\u7684\u6700\u5c0f\u6b63\u6574\u6570$d$\uff0c\u79f0\u4e3a\u6a21$m$\u4e0b$a$\u7684\u6307\u6570\uff1a<br/>$$<br/>a^d \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u5bb9\u6613\u77e5\u9053\uff0c\u5982\u679c$a$\u4e0e$m$\u4e0d\u4e92\u8d28\uff0c\u90a3\u4e48\u8fd9\u6837\u7684\u6b63\u6574\u6570$d$\u4e0d\u5b58\u5728\u3002\u56e0\u6b64\u4e0b\u9762\u5747\u8ba4\u4e3a$a \\\\bot m$\u3002<br/><br/>\u5b9a\u74061 \u8bbe$d_0 = \\\\delta_m(a)$\uff0c\u5bf9\u4e8e\u4efb\u610f\u6ee1\u8db3<br/>$$ a^d \\\\equiv 1 \\\\pmod{m} $$<br/>\u7684$d$\uff0c\u5747\u6ee1\u8db3$d_0 \\\\mid d$\u3002<br/><br/>\u8bc1\u660e \u5982\u679c\u5b58\u5728$d$\u6ee1\u8db3\u8be5\u7b49\u5f0f\u4f46$d_o \\\\nmid d$\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>a^{d - d_0} \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u5bf9\u4e8e$d - d_0$\uff0c\u5982\u679c$d - d_0 < d_0$\uff0c\u90a3\u4e48\u8fdd\u80cc\u4e86$d_0$\u7684\u5b9a\u4e49\uff0c\u5047\u8bbe\u4e0d\u6210\u7acb\u3002\u5982\u679c$d - d_0 \\\\geqslant d_0$\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06$d$\u6362\u4e3a$d - d_0$\u7ee7\u7eed\u4ee5\u4e0a\u8fc7\u7a0b\uff0c\u540c\u6837\u5f97\u5230\u5047\u8bbe\u4e0d\u6210\u7acb\u3002<br/>\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c$d_0 \\\\mid d$\uff0c\u90a3\u4e48\u6700\u540e\u5f97\u5230$a^0 \\\\equiv 1 \\\\pmod{m}$\uff0c\u6b64\u65f6\u4f9d\u7136\u6ee1\u8db3$d_0$\u7684\u5b9a\u4e49\uff0c\u6240\u4ee5$d_0 \\\\mid d$\u3002<br/>\u6839\u636e\u6b27\u62c9\u5b9a\u7406\u6211\u4eec\u77e5\u9053\uff1a<br/>$$<br/>a^{\\\\varphi(m)} \\\\equiv 1 \\\\pmod{m} \\\\;\\\\;\\\\;\\\\; \\\\forall\\\\; a\\\\bot m<br/>$$<br/>\u56e0\u6b64\u53ef\u4ee5\u63a8\u51fa\uff1a<br/>$$<br/>\\\\delta_m(a) \\\\mid \\\\varphi(m) \\\\tag{1.1}<br/>$$<br/>\u8003\u8651\u4e00\u4e2a\u6570$a$\u548c\u5b83\u7684\u9006\u5143$a^{-1}$\uff0c\u7531\u4e8e\uff1a<br/>$$<br/>a^d \\\\equiv 1 \\\\Longleftrightarrow (a^{-1})^d \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\delta_m(a) = \\\\delta_m(a^{-1}) \\\\tag{1.2}<br/>$$<br/>\u4e0b\u9762\u7684\u5b9a\u7406\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u8ba1\u7b97\u4e00\u4e2a\u6570\u7684\u5e42\u7684\u6307\u6570\uff1a<br/><br/>\u5b9a\u74062 \u8bbe$k$\u662f\u975e\u8d1f\u6574\u6570\uff0c\u5219\u6709\uff1a<br/>$$ \\\\delta_m(a^k) = {\\\\delta_m(a) \\\\over \\\\gcd(\\\\delta_m(a), k)} \\\\tag{1.3} $$<br/><br/>\u8bc1\u660e \u4ee4$\\\\delta = \\\\delta_m(a)$\uff0c$\\\\delta_1 = \\\\delta_m(a^k)$\uff0c$\\\\delta_2 = \\\\delta / \\\\gcd(\\\\delta, k)$\uff0c\u90a3\u4e48\u6839\u636e\u6307\u6570\u7684\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>a^{k\\\\delta_1} \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u4ee5\u53ca<br/>$$<br/>a^{k\\\\delta_2} \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u6839\u636e\u5b9a\u74061\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\delta \\\\mid k\\\\delta_1, \\\\; \\\\delta_1 \\\\mid \\\\delta_2<br/>$$<br/>\u6240\u4ee5\u53ef\u4ee5\u63a8\u51fa\uff1a<br/>$$<br/>\\\\delta_2 = { \\\\delta \\\\over \\\\gcd(\\\\delta, k) } \\\\;\\\\left|\\\\; { k\\\\delta_1 \\\\over \\\\gcd(\\\\delta, k) } \\\\right.<br/>$$<br/>\u53c8\u56e0\u4e3a$\\\\delta_2 \\\\bot k / \\\\gcd(\\\\delta, k)$\uff0c\u6240\u4ee5$\\\\delta_2 \\\\mid \\\\delta_1$\u3002\u7efc\u4e0a\u53ef\u4ee5\u5f97\u5230\u5b9a\u7406\u3002<br/><br/>\u5b9a\u74063<br/>$$ \\\\delta_m(ab) = \\\\delta_m(a)\\\\delta_m(b) \\\\Longleftrightarrow \\\\delta_m(a) \\\\bot \\\\delta_m(b) \\\\tag{1.4} $$<br/><br/>\u8bc1\u660e \u8bbe$\\\\delta = \\\\delta_m(ab)$\uff0c$\\\\delta_1 = \\\\delta_m(a)$\u4ee5\u53ca$\\\\delta_2 = \\\\delta_m(b)$\u3002<br/>(\u5145\u5206\u6027) $\\\\delta_m(a) \\\\bot \\\\delta_m(b) \\\\Longrightarrow \\\\delta_m(ab) = \\\\delta_m(a)\\\\delta_m(b)$<br/>\u56e0\u4e3a\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>(ab)^\\\\delta & \\\\equiv 1 \\\\equiv (ab)^{\\\\delta_1\\\\delta} \\\\\\\\<br/>& \\\\equiv b^{\\\\delta_1\\\\delta} \\\\pmod{m}<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5\u53ef\u4ee5\u77e5\u9053$\\\\delta_2 \\\\mid \\\\delta_1\\\\delta$\u3002\u53c8\u56e0\u4e3a$\\\\delta_1 \\\\bot \\\\delta_2$\uff0c\u6240\u4ee5$\\\\delta_2 \\\\mid \\\\delta$\u3002\u540c\u7406\u53ef\u5f97$\\\\delta_1 \\\\mid \\\\delta$\u3002<br/>\u56e0\u4e3a$\\\\delta_1 \\\\bot \\\\delta_2$\uff0c\u6240\u4ee5\u5f97\u5230$\\\\delta_1\\\\delta_2 \\\\mid \\\\delta$\u3002<br/>\u53e6\u4e00\u65b9\u9762\uff0c\u7531\u4e8e\uff1a<br/>$$<br/>(ab)^{\\\\delta_1\\\\delta_2} \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u6240\u4ee5$\\\\delta \\\\mid \\\\delta_1\\\\delta_2$\u3002\u7efc\u4e0a\u53ef\u4ee5\u5f97\u5230$\\\\delta = \\\\delta_1\\\\delta_2$\u3002<br/>(\u5fc5\u8981\u6027) $\\\\delta_m(ab) = \\\\delta_m(a)\\\\delta_m(b) \\\\Longrightarrow \\\\delta_m(a) \\\\bot \\\\delta_m(b)$<br/>\u5229\u7528$\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)$\u4f5c\u4e3a\u4e2d\u4ecb\u3002\u56e0\u4e3a\uff1a<br/>$$<br/>(ab)^{\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)} \\\\equiv 1 \\\\pmod{m}<br/>$$<br/>\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230$\\\\delta = \\\\delta_1\\\\delta_2 \\\\mid \\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)$\u3002\u53c8\u56e0\u4e3a$\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2) \\\\mid \\\\delta_1\\\\delta_2$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\u4e24\u8005\u76f8\u7b49\u3002\u7531\u6b64\u53ef\u4ee5\u5f97\u77e5$\\\\delta_1 \\\\bot \\\\delta_2$\u3002<br/><br/>\u5b9a\u74064 \u5982\u679c$n \\\\mid m$\uff0c\u90a3\u4e48$\\\\delta_n(a) \\\\mid \\\\delta_m(a)$\u3002<br/><br/>\u8bc1\u660e \u4ee4$\\\\delta_1 = \\\\delta_n(a)$\u4ee5\u53ca$\\\\delta_2 = \\\\delta_m(a)$\u3002<br/>\u7531\u4e8e\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>a^{\\\\delta_2} & \\\\equiv 1 & \\\\pmod{m} \\\\\\\\<br/>& \\\\equiv 1 \\\\equiv a^{\\\\delta_1} & \\\\pmod{n}<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5\u53ef\u4ee5\u63a8\u51fa$\\\\delta_1  \\\\mid \\\\delta_2$\u3002<br/><br/>\u5b9a\u74065 \u5982\u679c$m_1 \\\\bot m_2$\uff0c\u90a3\u4e48$\\\\delta_{m_1m_2}(a) = \\\\mathrm{lcm}(\\\\delta_{m_1}(a), \\\\delta_{m_2}(a))$\u3002<br/><br/>\u8bc1\u660e \u4ee4$\\\\delta = \\\\delta_{m_1m_2}(a)$\uff0c$\\\\delta_1 = \\\\delta_{m_1}(a)$\u4ee5\u53ca$\\\\delta_2 = \\\\delta_{m_2}(a)$\uff0c<br/>\u90a3\u4e48\u6839\u636e\u5b9a\u74064\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053$\\\\delta_1 \\\\mid \\\\delta$\u548c$\\\\delta_2 \\\\mid \\\\delta$\u3002\u56e0\u6b64$\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2) \\\\mid \\\\delta$\u3002<br/>\u7531\u4e8e\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>a^{\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)} \\\\equiv 1 \\\\pmod{m_1} \\\\\\\\<br/>a^{\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)} \\\\equiv 1 \\\\pmod{m_2}<br/>\\\\end{aligned}<br/>$$<br/>\u540c\u65f6\u6210\u7acb\uff0c\u5e76\u4e14$m_1 \\\\bot m_2$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230$a^{\\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)} \\\\equiv 1 \\\\pmod{m_1m_2}$\uff0c\u6240\u4ee5$\\\\delta \\\\mid \\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)$\u3002\u6240\u4ee5\u53ef\u4ee5\u63a8\u51fa$\\\\delta = \\\\mathrm{lcm}(\\\\delta_1, \\\\delta_2)$\u3002<br/><br/>\u63a8\u8bba \u5982\u679c$m_1, m_2, \\\\dots, m_k$\u4e24\u4e24\u4e92\u8d28\uff0c\u90a3\u4e48\uff1a<br/>$$ \\\\delta_{\\\\prod_{i=1}^k m_i}(a) = \\\\mathrm{lcm}(\\\\delta_{m_1}(a), \\\\delta_{m_2}(a), \\\\dots, \\\\delta_{m_k}(a)) \\\\tag{1.5} $$<br/><br/>\u539f\u6839<br/>\u5982\u679c\u4e00\u4e2a\u6570$a$\u6ee1\u8db3$\\\\delta_m(a) = \\\\varphi(m)$\uff0c\u90a3\u4e48$a$\u662f$m$\u7684\u4e00\u4e2a\u539f\u6839\u3002<br/>\u4e00\u4e2a\u6570$m$\u5b58\u5728\u539f\u6839\u5f53\u4e14\u4ec5\u5f53$m = 1, 2, 4, p^a, 2p^a$\uff0c\u5176\u4e2d$p$\u662f\u5947\u7d20\u6570\u3002<br/>\u5f53$m$\u6709\u539f\u6839$g$\u65f6\uff0c\u6240\u6709\u4e0e$m$\u4e92\u8d28\u7684\u6570\u5747\u53ef\u4ee5\u7528$g$\u7684\u67d0\u6b21\u5e42\u6765\u8868\u793a\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e0e$m$\u4e92\u8d28\u7684\u6240\u6709\u7684\u6570\u662f\uff1a<br/>$$<br/>g^0, g^1, \\\\dots, g^{\\\\varphi(m) - 1}<br/>$$<br/>\u5bf9\u4e8e\u4e00\u4e2a\u4e0e$m$\u4e92\u8d28\u7684\u6570$a$\uff0c\u7528$\\\\log_{m,g} a$\u8868\u793a\u6a21$m$\u610f\u4e49\u4e0b\u4ee5\u539f\u6839$g$\u4e3a\u5e95$a$\u7684\u79bb\u6563\u5bf9\u6570\uff08\u6709\u4e9b\u5730\u65b9\u4e5f\u79f0\u4e3a\u6307\u6807\uff09\u3002\u6ee1\u8db3\uff1a<br/>$$<br/>g^{\\\\log_{m,g}a} \\\\equiv a \\\\pmod{m}<br/>$$<br/>\u6c42\u89e3\u4e00\u4e2a\u6570\u7684\u79bb\u6563\u5bf9\u6570\u53ef\u4ee5\u4f7f\u7528\u5927\u6b65\u5c0f\u6b65\u7b97\u6cd5 (BSGS)\u3002\u5927\u81f4\u60f3\u6cd5\u5c31\u662f$a$\u4e00\u5b9a\u80fd\u8868\u793a\u6210\u5982\u4e0b\u5f62\u5f0f1\uff1a<br/>$$<br/>a \\\\equiv g^{i\\\\sqrt{\\\\varphi(m)} - j} \\\\pmod{m}<br/>$$<br/>\u76f8\u5f53\u4e8e\u6211\u4eec\u8981\u6c42\u6ee1\u8db3\u4e0b\u5217\u65b9\u7a0b\u7684\u89e3\uff1a<br/>$$<br/>a g^j \\\\equiv g^{i\\\\sqrt{\\\\varphi(m)}} \\\\pmod{m}<br/>$$<br/>\u5176\u4e2d$i, j \\\\leqslant \\\\sqrt{\\\\varphi(m)}$\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728$\\\\Theta\\\\left(\\\\sqrt{\\\\varphi(m)}\\\\right)$\u7684\u65f6\u95f4\u5185\u6c42\u51fa\u4e00\u4e2a\u89e3\u6216\u8005\u62a5\u544a\u4e0d\u5b58\u5728\u89e3\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6ca1\u6709\u6b67\u4e49\u7684\u60c5\u51b5\u4e0b\uff0c\u79bb\u6563\u5bf9\u6570\u5c06\u4e0d\u4f1a\u5199\u4e0b\u6807\u3002<br/><br/>\u5b9a\u74066 \u5f53$a$\u3001$b$\u548c$ab$\u7684\u79bb\u6563\u5bf9\u6570\u5b58\u5728\u65f6\uff0c\u6ee1\u8db3\uff1a<br/>$$ \\\\log_{m,g} ab \\\\equiv \\\\log_{m,g} a + \\\\log_{m,g} b \\\\pmod{\\\\varphi(m)} \\\\tag{2.1}$$<br/><br/>\u8bc1\u660e \u6839\u636e\u79bb\u6563\u5bf9\u6570\u7684\u5b9a\u4e49\uff1a<br/>$$<br/>ab \\\\equiv g^{\\\\log a} \\\\cdot g^{\\\\log b} \\\\equiv g^{\\\\log a + \\\\log b} \\\\equiv g^{\\\\log ab} \\\\pmod{m}<br/>$$<br/><br/>\u5b9a\u74067 (\u79bb\u6563\u5bf9\u6570\u6362\u5e95\u516c\u5f0f)<br/>\u5982\u679c$g$\u548c$\\\\hat g$\u662f$m$\u7684\u4e24\u4e2a\u539f\u6839\uff0c\u90a3\u4e48\uff1a<br/>$$ \\\\log_{\\\\hat g} a \\\\equiv \\\\log_{\\\\hat g} g \\\\cdot \\\\log_{g} a \\\\pmod{\\\\varphi(m)} \\\\tag{2.2} $$<br/><br/>\u8bc1\u660e \u6839\u636e\u79bb\u6563\u5bf9\u6570\u7684\u5b9a\u4e49\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>a & \\\\equiv g^{\\\\log_g a} \\\\equiv (\\\\hat g^{\\\\log_{\\\\hat g} g})^{\\\\log_g a} \\\\\\\\<br/>& \\\\equiv \\\\hat g^{\\\\log_{\\\\hat g} g \\\\cdot \\\\log_g a} \\\\pmod{m}<br/>\\\\end{aligned}<br/>$$<br/><br/>\u5b9a\u74068 (\u6307\u6570\u4e0e\u79bb\u6563\u5bf9\u6570\u7684\u5173\u7cfb)<br/>$$ \\\\delta_m(a) = { \\\\varphi(m) \\\\over \\\\gcd(\\\\log_{m, g} a, \\\\varphi(m))} \\\\tag{2.3}$$<br/><br/>\u8bc1\u660e \u7531\u4e8e$a \\\\equiv g^{log_{m,g} a}$\uff0c\u5229\u7528\u5b9a\u74062\u5c31\u53ef\u5f97\u5230\u4e0a\u5f0f\u3002<br/><br/>\u5b9a\u74069 (\u539f\u6839\u7684\u4e2a\u6570)<br/>\u5982\u679c$m$\u5b58\u5728\u539f\u6839\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709$\\\\varphi(\\\\varphi(m))$\u4e2a\u539f\u6839\u3002<br/><br/>\u8bc1\u660e \u6839\u636e\u539f\u6839\u7684\u5b9a\u4e49\uff0c\u539f\u6839$g$\u5fc5\u987b\u6ee1\u8db3$\\\\delta_m(g) = \\\\varphi(m)$\u3002<br/>\u5982\u679c$m$\u5b58\u5728\u4e00\u4e2a\u539f\u6839$g$\uff0c\u6839\u636e$(2.3)$\u5f0f\uff0c\u53e6\u5916\u4e0e$m$\u4e92\u8d28\u7684\u6570$a$\u5982\u679c\u662f\u539f\u6839\uff0c\u5fc5\u987b\u6ee1\u8db3$\\\\log_g a \\\\bot \\\\varphi(m)$\u3002\u7531\u4e8e$0 \\\\leqslant \\\\log_g a \\\\lt \\\\varphi(m)$\uff0c\u6240\u4ee5\u8fd9\u6837\u7684\u6570\u5171\u6709$\\\\varphi(\\\\varphi(m))$\u4e2a\u3002<br/>\u6700\u540e\u6765\u5173\u6ce8\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c$m$\u6ee1\u8db3\u4e86\u5b58\u5728\u539f\u6839\u7684\u6761\u4ef6\uff0c\u5982\u4f55\u6c42\u51fa\u5b83\u7684\u539f\u6839\uff1f<br/>\u663e\u7136\uff0c\u5229\u7528\u5b9a\u74069\uff0c\u5982\u679c\u6211\u4eec\u6c42\u51fa\u4e86\u4e00\u4e2a\u539f\u6839\uff0c\u90a3\u4e48\u5176\u4ed6\u7684\u539f\u6839\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u6240\u6709\u4e0e$\\\\varphi(m)$\u4e92\u8d28\u7684\u6570\uff0c\u4ece\u800c\u5f88\u5feb\u5730\u6c42\u51fa\u6765\u3002<br/>\u4f46\u662f\u6c42\u51fa\u4e00\u4e2a\u539f\u6839\u4f3c\u4e4e\u73b0\u5728\u6ca1\u6709\u597d\u7684\u529e\u6cd5\uff0c\u4f46\u662f\u8003\u8651\u5230\u539f\u6839\u6709$\\\\varphi(\\\\varphi(m))$\u4e2a\uff0c\u4e00\u822c\u7684\u6700\u5c0f\u6b63\u539f\u6839\u90fd\u6bd4\u8f83\u5c0f\u3002\u56e0\u6b64\u4e00\u822c\u7684\u65b9\u6cd5\u5c31\u662f\u679a\u4e3e\u539f\u6839\u5e76\u68c0\u9a8c\u5176\u6b63\u786e\u6027\u3002\u68c0\u9a8c\u7684\u65b9\u6cd5\u5c31\u662f\u5229\u7528$(1.1)$\u5f0f\uff0c\u770b\u8fd9\u4e2a\u6570\u662f\u4e0d\u662f\u53ea\u6709$\\\\varphi(m)$\u6b21\u5e42\u624d\u662f$1$\uff0c\u5426\u5219\u5c31\u4e0d\u662f\u539f\u6839\u3002<br/><br/><br/><br/><br/>\u6709\u53e6\u5916\u4e00\u79cd\u5f62\u5f0f$a \\\\equiv g^{i\\\\sqrt{\\\\varphi(m)} + j} \\\\pmod{m}$\uff0c\u4f46\u662f\u8fd9\u79cd\u5f62\u5f0f\u6700\u540e\u5c06\u4f1a\u9700\u8981\u9006\u5143\uff0c\u8ba1\u7b97\u8fc7\u7a0b\u548c\u53ef\u63a8\u5e7f\u6027\u90fd\u4e0d\u5982$a \\\\equiv g^{i\\\\sqrt{\\\\varphi(m)} - j} \\\\pmod{m}$\u4f18\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-3-8/exp-and-primitive-root.html"
},
"\u6392\u5217\u4e0e\u7ec4\u5408": {
"tags": "\u7ec4\u5408\u6570\u5b66",
"text": "\u6392\u5217\u4e0e\u7ec4\u5408<br/>\u6392\u5217\u4e0e\u7ec4\u5408\u662f\u7ec4\u5408\u6570\u5b66\u4e2d\u6700\u57fa\u7840\u7684\u4e1c\u897f\u4e86\u3002\u5728\u6b64\u505a\u4e00\u70b9\u8bb0\u5f55\u3002<br/>\u9636\u4e58<br/>\u5728\u7ec4\u5408\u6570\u5b66\u4e2d\uff0c\u9636\u4e58\u968f\u5904\u53ef\u89c1\uff0c\u5b83\u6781\u5927\u7684\u7b80\u5316\u4e86\u516c\u5f0f\u7684\u5f62\u5f0f\u3002<br/>\u6211\u4eec\u5c06$n!$\u8bb0\u4f5c$n$\u7684\u9636\u4e58\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\uff1a<br/>$$ n! = \\\\prod^n_{i=1} i \\\\tag{1.1} $$<br/>\u7279\u522b\u7684\uff0c$0! = 1$\u3002\u4e4b\u6240\u4ee5$0$\u7684\u9636\u4e58\u8fd9\u6837\u5b9a\u4e49\uff0c\u662f\u4e3a\u4e86\u4f7f\u540e\u9762\u7684\u516c\u5f0f\u66f4\u5177\u6709\u666e\u904d\u6027\u3002<br/>\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u9636\u4e58\u51fd\u6570\u7684\u589e\u957f\uff1a<br/><br/>\u4e0a\u56fe\u4e2d\uff0c\u7ea2\u8272\u7684\u9636\u4e58\u51fd\u6570$ f(x) = x! $\uff0c\u84dd\u8272\u7684\u662f$g(x) = x^2 $\uff0c\u800c\u7eff\u8272\u7684\u662f$ h(x) = x^3 $\u3002<br/>\u7531\u6b64\u53ef\u89c1\u9636\u4e58\u51fd\u6570\u7684\u589e\u957f\u6bd4\u5e73\u65b9\u5feb\u3002\u4e0e\u4e09\u6b21\u65b9\u76f8\u6bd4\uff0c\u9636\u4e58\u51fd\u6570\u5728\u4e4b\u540e\u4e5f\u5c06\u8d76\u8d85\u3002<br/>\u56e0\u6b64\u5982\u679c\u65f6\u95f4\u590d\u6742\u5ea6\u91cc\u9762\u51fa\u73b0\u4e86\u9636\u4e58\uff0c\u90a3\u5c06\u662f\u4e00\u4ef6\u53ef\u6015\u7684\u4e8b\u60c5\u3002<br/>\u6392\u5217<br/>\u5bf9\u4e8e\u4e00\u4e2a\u96c6\u5408$S$\uff0c\u5176\u6392\u5217\u662f$S$\u4e2d\u7684\u5143\u7d20\u7684\u6709\u5e8f\u653e\u7f6e\u3002<br/>\u4f8b\u5982\u96c6\u5408$S = \\\\{ a, b, c \\\\}$\uff0c\u5b83\u76841\u6392\u5217\u4e3a\uff1a<br/>$$ a, b, c $$<br/>\u51762\u6392\u5217\u4e3a\uff1a<br/>$$ ab, ac, ba, bc, ca, cb $$<br/>3\u6392\u5217\u4e3a\uff1a<br/>$$ abc, acb, bac, bca, cab, cba $$<br/>\u7531\u4e8e$|S| < 4$\uff0c\u6240\u4ee5$S$\u6ca1\u67094\u6392\u5217\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\u8ba1\u6570\uff0c\u6211\u4eec\u5c06\u4e00\u4e2a\u542b\u6709$n$\u4e2a\u5143\u7d20\u7684\u96c6\u5408\u7684$r$\u6392\u5217\u4e2a\u6570\u8bb0\u4e3a$ P(n, r) $1\u3002<br/>\u5982\uff1a$P(3,1)=3, \\\\; P(3,2)=P(3,3)=6 $\u3002<br/>\u7279\u522b\u7684\uff0c\u6211\u4eec\u5b9a\u4e49$P(n,0)=1$\u3002<br/>\u5982\u4f55\u8ba1\u7b97\u8fd9\u4e2a\u503c\u5462\uff1f\u5f53\u7136\u6211\u4eec\u662f\u6709\u516c\u5f0f\u7684\uff1a<br/>\u5b9a\u7406 \u5bf9\u4e8e\u4efb\u610f\u7684$n, r \\\\in N_+$\uff0c\u5e76\u4e14$ r \\\\le n$\uff0c\u6709\uff1a<br/>$$ P(n, r) = {n! \\\\over (n-r)!} \\\\tag{2.1} $$<br/>\u8bc1\u660e \u6211\u4eec\u6709$r$\u4e2a\u7a7a\u4f4d\u6765\u6446\u653e\u5143\u7d20\u3002\u5728\u7b2c\u4e00\u4e2a\u7a7a\u4f4d\u6211\u4eec\u6709$n$\u79cd\u9009\u62e9\uff0c\u5728\u7b2c\u4e8c\u4e2a\u7a7a\u4f4d\u6211\u4eec\u6709$n - 1$\u4e2d\u9009\u62e9......\u7531\u6b64\u53ef\u4ee5\u5f97\u77e5\uff1a<br/>$$ P(n, r) = \\\\prod^n_{i=n-r+1} i = {n! \\\\over (n-r)!} $$<br/>\u73b0\u5728\u6211\u4eec\u6765\u8fd0\u7528\u4e00\u4e0b\u6392\u5217\u3002<br/>\u9996\u5148\u6765\u8ba1\u6570\u7531$1$\u81f3$9$\u7684\u6570\u6784\u6210\u7684\u6bcf\u4e00\u4f4d\u5747\u4e0d\u540c\u7684$7$\u4f4d\u6570\u6709\u591a\u5c11\u4e2a\u3002<br/>\u8fd9\u4e2a\u975e\u5e38\u7b80\u5355\uff0c\u5c31\u662f$P(9, 7) = 181440$\u3002<br/>\u5982\u679c\u73b0\u5728\u8981\u6c42$5$\u548c$6$\u4e0d\u80fd\u8fde\u7eed\u51fa\u73b0\uff0c\u90a3\u4e48\u8fd9\u6837\u7684\u6570\u53c8\u6709\u591a\u5c11\u4e2a\uff1f<br/>\u6211\u4eec\u8003\u8651\u5c06\u8fde\u7eed\u51fa\u73b0\u7684\u6570\u7ed9\u8ba1\u6570\u51fa\u6765\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002<br/>\u6211\u4eec\u53d1\u73b0\uff0c\u901a\u8fc7\u5411\u4e00\u4e2a$5$\u4f4d\u6570\u4e2d\u63d2\u5165\u4e24\u4e2a\u6570\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a$7$\u4f4d\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u6765\u8003\u8651\u5c06$5$\u548c$6$\u8fde\u7eed\u7684\u63d2\u5165\u4e00\u4e2a$5$\u4f4d\u6570\u4e2d\u3002\u6211\u4eec\u53ea\u4f1a\u63d2\u5165$56$\u6216$65$\uff0c\u5b83\u4eec\u5728\u4e00\u4e2a$5$\u4f4d\u6570\u4e2d\u4e00\u5171\u6709$6$\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u63d2\u5165\u3002\u56e0\u6b64$5$\u548c$6$\u8fde\u7eed\u51fa\u73b0\u7684\u6570\u5171\u6709$ 2 \\\\times 6 \\\\times P(7, 5) = 30240 $\u4e2a\u3002<br/>\u56e0\u6b64\u6700\u7ec8\u7684\u7b54\u6848\u4e3a$ 181440 - 30240 = 151200 $\u3002<br/>\u7ec4\u5408<br/>\u4e0e\u6392\u5217\u76f8\u5bf9\uff0c\u4e00\u4e2a\u96c6\u5408\u7684\u7ec4\u54082\u662f\u5176\u5143\u7d20\u7684\u65e0\u5e8f\u653e\u7f6e\u3002<br/>\u5176\u542b\u4e49\u5c31\u662f\u4ece\u96c6\u5408\u4e2d\u201d\u9009\u53d6\u201d\u51fa\u51e0\u4e2a\u5143\u7d20\u3002\u7531\u4e8e\u4e0d\u8003\u8651\u4f4d\u7f6e\u5173\u7cfb\uff0c\u6240\u4ee5\u50cf$abc$\u548c$bac$3\u662f\u7b49\u4ef7\u7684\u3002<br/>\u7ec4\u5408\u8fd9\u4e00\u6982\u5ff5\u5728\u6574\u4e2a\u7ec4\u5408\u6570\u5b66\u4e2d\u7528\u5904\u5341\u5206\u5de8\u5927\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5148\u770b\u5230\u5982\u4f55\u8ba1\u6570\u5b83\u3002<br/>\u9996\u5148\u6211\u4eec\u5c06\u7ec4\u5408\u6570\u8bb0\u4e3a${n \\\\choose r}$4\uff0c\u8868\u793a\u4e00\u4e2a\u5927\u5c0f\u4e3a$n$\u7684\u96c6\u5408\u7684$r$\u7ec4\u5408\u7684\u4e2a\u6570\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u5927\u5c0f\u4e3a$4$\u7684\u96c6\u5408$ S = \\\\{ a,b,c,d\\\\}$\u76843\u7ec4\u5408\u4e3a\uff1a<br/>$$ \\\\{a,b,c\\\\}, \\\\{a,b,d\\\\}, \\\\{a,c,d\\\\}, \\\\{b,c,d\\\\} $$<br/>\u56e0\u6b64${4 \\\\choose 3} = 4$\u3002<br/>\u540c\u6837\uff0c\u4e3a\u4e86\u80fd\u591f\u66f4\u52a0\u65b9\u4fbf\u7684\u8ba1\u6570\u5b83\uff0c\u6211\u4eec\u5f53\u7136\u4e5f\u662f\u6709\u516c\u5f0f\u7684\u3002<br/>\u6211\u4eec\u53d1\u73b0\uff0c\u4efb\u610f\u4e00\u4e2a$r$\u7ec4\u5408\uff0c\u90fd\u4f1a\u6709$P(r,r) = r! $\u79cd\u6392\u5217\u3002\u800c\u6bcf\u4e00\u79cd\u6392\u5217\uff0c\u90fd\u4f1a\u5bf9\u5e94\u5230\u4e00\u4e2a\u7ec4\u5408\u3002\u56e0\u6b64\uff0c\u4e00\u4e2a\u96c6\u5408\u7684$r$\u7ec4\u5408\u4e0e\u6392\u5217\u4e4b\u95f4\u5b58\u5728\u4ee5\u4e0b\u5173\u7cfb\uff1a<br/>$$ {n \\\\choose r}r! = P(n,r) \\\\tag{3.1} $$<br/>\u5c06\u6392\u5217\u6570\u5c55\u5f00\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u7684\u516c\u5f0f\uff1a<br/>$$ {n \\\\choose r} = {n! \\\\over (n-r)!r! } \\\\tag{3.2} $$<br/>\u5176\u4e2d\uff0c$n,r \\\\in N_+$\uff0c\u4e14$r\\\\le n$\u3002<br/>\u7ec4\u5408\u6570\u7684\u57fa\u672c\u6027\u8d28<br/>\u7ec4\u5408\u6570\u6709\u7740\u8bb8\u591a\u975e\u5e38\u6709\u7528\u7684\u6027\u8d28\u3002\u9996\u5148\u4e00\u4e2a\u975e\u5e38\u57fa\u672c\u7684\u7b49\u5f0f\u5c31\u662f\uff1a<br/>$$ {n \\\\choose r} = {n \\\\choose n-r} \\\\tag{4.1} $$<br/>\u76f4\u63a5\u5229\u7528\u7ec4\u5408\u6570\u7684\u516c\u5f0f\u53ef\u4ee5\u5f97\u8bc1\u8fd9\u4e00\u6027\u8d28\u3002<br/>\u901a\u8fc7\u5bf9\u7ec4\u5408\u6570\u8fdb\u884c\u6c42\u548c\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u4e00\u4e2a\u96c6\u5408\u7684\u5b50\u96c6\u6570\u91cf\uff1a<br/>$$ \\\\sum^n_{i=0} {n\\\\choose i} = 2^n \\\\tag{4.2} $$<br/>\u8fd9\u4e2a\u7b49\u5f0f\u5f53\u7136\u53ef\u4ee5\u7528\u6c42\u548c\u6765\u5f97\u51fa\u3002\u6211\u4eec\u53ef\u4ee5\u6362\u4e2a\u89d2\u5ea6\u6765\u8003\u91cf\u5b83\u3002\u4e00\u4e2a\u96c6\u5408\u7684\u5b50\u96c6\u4e2d\uff0c\u67d0\u4e9b\u5143\u7d20\u8981\u4e48\u6ca1\u6709\u51fa\u73b0\uff0c\u8981\u4e48\u5c31\u51fa\u73b0\u4e86\u3002\u56e0\u6b64\u5bf9\u4e8e\u6bcf\u4e2a\u5143\u7d20\u4e00\u5171\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u56e0\u6b64\u5b50\u96c6\u7684\u603b\u6570\u4e3a$2^n$\u4e2a\u3002<br/>\u63a5\u4e0b\u6765\u662f\u6bd4\u8f83\u91cd\u8981\u7684\u5e15\u65af\u5361\u516c\u5f0f\uff1a<br/>\u5b9a\u7406 \u5bf9\u4e8e\u6240\u6709\u7684$ 1 \\\\le k \\\\le n-1$\u7684\u6574\u6570$n$\u548c$k$\uff1a<br/>$$ {n\\\\choose k} = {n-1\\\\choose k} + {n-1\\\\choose k-1} \\\\tag{4.3} $$<br/>\u8bc1\u660e \u5c1d\u8bd5\u5c06\u53f3\u5f0f\u5316\u4e3a\u5de6\u5f0f\u5373\u53ef\u3002<br/>$$<br/>\\\\begin{aligned}<br/>{n-1\\\\choose k} + {n-1\\\\choose k-1} &= {(n-1)! \\\\over k!(n-k-1)!} + {(n-1)! \\\\over (k-1)!(n-k)!} \\\\\\\\<br/>&= {(n-1)!(n-k) \\\\over k!(n-k)!} + {(n-1)!k \\\\over k!(n-k)!} \\\\\\\\<br/>&= {(n-1)!n \\\\over k!(n-k)!} \\\\\\\\<br/>&= {n! \\\\over k!(n-k)!} \\\\\\\\<br/>&= {n \\\\choose k}<br/>\\\\end{aligned}<br/>$$<br/>\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u8bc1\u660e\u3002\u6ce8\u610f\uff0c\u5728\u4e0a\u9762\u7684\u8bc1\u660e\u4e2d\uff0c\u5229\u7528\u5230\u4e86\u9636\u4e58\u7684\u6027\u8d28\uff1a$(n-1)!\\\\cdot n=n!$\u3002<br/>\u4e0d\u96be\u53d1\u73b0\uff0c\u5e15\u65af\u5361\u516c\u5f0f\u5b9e\u9645\u4e0a\u662f\u7ec4\u5408\u6570\u7684\u4e00\u4e2a\u9012\u63a8\u516c\u5f0f\u3002<br/><br/>\u4e0a\u56fe\u662f\u7531\u5e15\u65af\u5361\u516c\u5f0f\u5f97\u5230\u7684\u4e00\u4e2a\u9012\u63a8\u7684\u5173\u7cfb\u56fe\uff0c\u8fd9\u91cc\u4ee5${4 \\\\choose 3}$\u4e3a\u4f8b\u3002\u5176\u4e2d\u7070\u8272\u7684\u8282\u70b9\u662f\u65e0\u6548\u7684\u503c\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u76f4\u63a5\u5c06\u5176\u8bbe\u4e3a$0$\u3002\u9664\u4e86${1 \\\\choose 0} = {1 \\\\choose 1} = 1$\u4e3a\u521d\u59cb\u503c\u5916\uff0c\u5176\u5b83\u7684\u503c\u90fd\u662f\u7531\u5176\u6240\u6307\u5411\u7684\u8282\u70b9\u7684\u503c\u6c42\u548c\u800c\u6765\u3002<br/>\u4e0a\u9762\u7684\u6b65\u9aa4\u5c31\u662f\u52a8\u6001\u89c4\u5212\u4e2d\u7684\u72b6\u6001\u8f6c\u79fb\u7684\u8fc7\u7a0b\u3002\u5229\u7528\u8fd9\u4e2a\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5728$\\\\Theta(nr)$\u7684\u65f6\u95f4\u6765\u8ba1\u7b97\u5927\u91cf\u7684\u7ec4\u5408\u6570\u3002\u56e0\u6b64\u53ef\u4ee5\u5c06\u6b64\u4f5c\u4e3a\u4e00\u4e2a\u9884\u5904\u7406\u3002<br/>\u5728\u5177\u4f53\u5b9e\u73b0\u7684\u65f6\u5019\u53ea\u9700\u6ce8\u610f\u4e00\u4e9b\u65e0\u6548\u7684\u7279\u6b8a\u60c5\u51b5\uff0c\u5176\u4e2d\u5305\u62ec$ r > n $\u548c$n < 0$\u6216$r < 0$\u3002\u8fd9\u4e9b\u60c5\u51b5\u4e0b\u7684\u503c\u5747\u8bbe\u4e3a$0$\u3002\u7136\u540e\u901a\u8fc7${1 \\\\choose 0}$\u548c${1 \\\\choose 1}$\u8fd9\u4e24\u4e2a\u521d\u59cb\u503c\u5c31\u53ef\u4ee5\u5b8c\u6210\u9012\u63a8\u3002<br/><br/><br/><br/><br/>\u5f53\u7136\u4e5f\u53ef\u8bb0\u4f5c$_nP_r$\u6216$P^n_r$\u3002\u00a0\u21a9<br/><br/><br/>\u300a\u7ec4\u5408\u6570\u5b66\u300b\u4e2d\u79f0\u4e4b\u4e3a\u201d\u5b50\u96c6\u201d\uff0c\u4e5f\u8bb8\u66f4\u4e3a\u6070\u5f53\u3002\u00a0\u21a9<br/><br/><br/>\u4e0b\u9762\u5c06\u4f7f\u7528\u96c6\u5408\u7684\u65b9\u5f0f\u8868\u793a\u7ec4\u5408\uff0c\u5982$\\\\{a,b,c\\\\}$\u3002\u00a0\u21a9<br/><br/><br/>\u4e5f\u53ef\u8bb0\u4f5c$_nC_r$\u6216$C(n,r)$\u6216$C^n_r$\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-5-7/permutation-and-combination.html"
},
"\u6536\u5230\u4e00\u5c01\u5947\u602a\u7684\u90ae\u4ef6": {
"tags": "Email",
"text": "\u6536\u5230\u4e00\u5c01\u5947\u602a\u7684\u90ae\u4ef6<br/>\u4eca\u5929\u7ffb\u5783\u573e\u7bb1\u65f6\u53d1\u73b0\u4e86\u4e00\u5c01\u90ae\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a<br/><br/>My beloved friend,<br/>I sent this mail praying for it to reach you in good health, since I myself are in a very critical health condition in which I sleep every night without knowing if I may be alive next day. My name is Mrs. Sarah Al moubi, a widow suffering from long time illness. I have some funds I inherited from my late husband, which I will need the help of a person like you to assist for this desired project, as my Doctor told me recently that I would not last due to the illness. Having known my condition, I decided to donate this fund to a good person that will utilize it the way I am going to instruct herein. I need a very honest and God fearing person who can use it for Charity works, for orphanages, widows and also build schools for less privilege that will be named after my late husband if possible.<br/>The sum is currently deposited in an existing bank. Your role will be to:<br/>[1]. Receive the funds into a business/private bank account.<br/>[2]. Invest/donate the funds to any orphanage home.<br/>[3]. Value of funds: (USD) $10.5 Million.<br/>I accept this decision because I do not have any child who will inherit this money after me.<br/>Please I want your sincerely and urgent answer to know if you will be available for this project, and I will give you more information on how the fund will be transferred to you. And everything will be done legally to ensure that the funds are transferred to you.<br/>I am waiting for your reply.<br/>Thank you,<br/>Mrs. Sarah Al moubi.<br/><br/>\u5e76\u4e0d\u77e5\u9053\u662f\u6211\u7684\u54ea\u4e2a\u90ae\u7bb1\u6536\u5230\u7684\uff0c\u6240\u4ee5\u731c\u4e0d\u51fa\u662f\u4ec0\u4e48\u7f51\u7ad9\u4e0a\u5f97\u5230\u7684\u90ae\u7bb1\u3002<br/>\u6211\u5230\u5e95\u8be5\u4e0d\u8be5\u76f8\u4fe1\u5462\uff1f",
"url": "blog/2016-10-30/strange-email.html"
},
"\u6570\u5b66\u95ee\u9898\u6742\u8bb0": {
"tags": "\u6570\u5b66",
"text": "\u6570\u5b66\u95ee\u9898\u6742\u8bb0<br/>\u8fd9\u91cc\u653e\u4e9b\u6211\u89c1\u5230\u8fc7\u7684\u6bd4\u8f83\u6709\u610f\u601d\u7684\u6570\u5b66\u9898\u5427\u3002\u672c\u6587\u4f1a\u4e0d\u5b9a\u671f\u66f4\u65b0\u3002\u6240\u6709\u95ee\u9898\u7684\u6807\u9898\u90fd\u662f\u8bb0\u5f55\u5230\u535a\u5ba2\u4e0a\u7684\u65f6\u95f4\u3002<br/>2017.6.14<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u7ed9\u4f60\u4e00\u4e2a\u65e0\u9650\u957f\u5ea6\u7684\u7a7a\u767d\u7684\u5c3a\u5b50\uff0c\u95ee\u6700\u5c11\u5728\u4e0a\u9762\u753b\u591a\u5c11\u4e2a\u523b\u5ea6\uff0c\u4f7f\u5f97\u53ef\u4ee5\u91cf\u51fa $1$ \u5230 $10$ \u6bcf\u4e00\u4e2a\u6574\u6570\u957f\u5ea6\uff1f<br/>\u5047\u8bbe\u4e00\u5171\u753b\u4e86 $n$ \u4e2a\u523b\u5ea6\uff0c\u6bcf\u4e2a\u523b\u5ea6\u5230\u6700\u5de6\u8fb9\u7684\u523b\u5ea6\u7684\u8ddd\u79bb\u4e3a $a_1,\\\\; a_2, \\\\;..., \\\\;a_n$\uff0c\u90a3\u4e48\u79f0\u4e00\u4e2a\u957f\u5ea6 $x$ \u4e3a\u53ef\u6d4b\u91cf\u7684\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e00\u5bf9 $i, \\\\;j$\uff0c\u6ee1\u8db3 $a_i - a_j = x$\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u9996\u5148\u6211\u4eec\u53ef\u4ee5 xjb \u8bd5\u4e00\u8bd5\uff0c$7$ \u4e2a\u70b9\u7684\u65b9\u6848\u662f\u975e\u5e38 na\u00efve \u7684\uff1a<br/><br/>\u901a\u8fc7\u4e00\u756a\u5c1d\u8bd5\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa $6$ \u4e2a\u70b9\u7684\u65b9\u6848\uff1a<br/><br/>\u5f53\u7136\uff0c\u56e0\u4e3a\u6ca1\u6709\u957f\u5ea6\u9650\u5236\uff0c\u6240\u4ee5\u66f4\u957f\u7684\u65b9\u6848\u6211\u4e5f\u6784\u9020\u51fa\u6765\u8fc7\u3002\u603b\u800c\u8a00\u4e4b\uff0c$6$ \u4e2a\u70b9\u7684\u65b9\u6848\u4e0d\u662f\u975e\u5e38\u56f0\u96be\u3002\u6784\u9020\u4e0a\u9762\u8fd9\u4e2a\u65b9\u6848\u65f6\uff0c\u6211\u5148\u753b\u4e86\u4e00\u4e2a\u539f\u70b9\uff0c\u7136\u540e\u5411\u53f3\u8d70\u4e00\u6b65\uff0c\u753b\u4e00\u4e2a\u70b9\uff0c\u7ee7\u7eed\u8d70\u4e24\u6b65\uff0c\u753b\u4e00\u4e2a\u70b9\u3002\u968f\u540e\u56de\u5230\u539f\u70b9\u5de6\u8fb9\u56db\u683c\u7684\u4f4d\u7f6e\u753b\u4e00\u4e2a\u70b9\u3002\u7136\u540e\u94a6\u5b9a\u6700\u53f3\u8fb9\u7684\u4e3a $10$\uff0c\u5c06 $0$ \u523b\u5ea6\u753b\u51fa\u6765\u3002\u6b64\u65f6\u53d1\u73b0 $9$ \u4e0d\u5b58\u5728\uff0c\u6240\u4ee5\u5c06 $1$ \u4e5f\u70b9\u4e0a\u3002<br/>\u90a3\u4e48\u73b0\u5728\u95ee\u9898\u6765\u4e86\uff0c$5$ \u4e2a\u70b9\u7684\u65b9\u6848\u80fd\u5426\u627e\u51fa\u6765\uff1f<br/>\u7406\u8bba\u4e0a\uff0c$5$ \u4e2a\u70b9\u4e24\u4e24\u914d\u5bf9\u521a\u597d $10$ \u5bf9\uff0c\u7ed9\u4eba\u4e00\u79cd\u53ef\u4ee5\u6784\u9020\u7684\u611f\u89c9\u3002\u4e0d\u8fc7\u5f88\u53ef\u60dc\uff0c$5$ \u4e2a\u70b9\u7684\u65b9\u6848\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u8fd9\u4e00\u7ed3\u8bba\u53ef\u4ee5\u4f7f\u7528\u8ba1\u7b97\u673a\u66b4\u529b\u5f97\u51fa\u3002<br/>\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u4e0d\u9700\u8981\u4efb\u4f55\u66b4\u529b\u7684\u8bc1\u660e\uff1a<br/><br/>\u7531\u4e8e $5$ \u4e2a\u70b9\u4e24\u4e24\u914d\u5bf9\u4e00\u5171 $10$ \u5bf9\uff0c\u6240\u4ee5\u6240\u6709\u70b9\u5bf9\u4e4b\u95f4\u7684\u8ddd\u79bb\u521a\u597d\u662f $1$ \u5230 $10$\uff0c\u5373\u4e0d\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u70b9\u5bf9\u4e4b\u95f4\u7684\u8ddd\u79bb\u76f8\u540c\u3002\u7531\u6b64\u53ef\u4ee5\u63a8\u51fa\uff0c\u6700\u8fdc\u7684\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e3a $10$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u94a6\u5b9a\u523b\u5ea6 $0$ \u548c\u523b\u5ea6 $10$ \u4e0a\u6709\u4e24\u4e2a\u70b9\u3002<br/>\u5269\u4e0b\u8fd8\u6709 $3$ \u4e2a\u70b9\uff0c\u5b83\u4eec\u5c06\u957f\u5ea6\u4e3a $10$ \u7684\u7ebf\u6bb5\u5206\u4e3a $4$ \u6bb5\uff0c\u8fd9\u56db\u6bb5\u7684\u957f\u5ea6\u603b\u548c\u8981\u4e3a $10$\uff0c\u800c $10$ \u7684\u56db\u62c6\u5206\u53ea\u6709 $10 = 1 + 2 + 3 + 4$\uff0c\u6240\u4ee5\u8fd9\u56db\u6bb5\u7684\u957f\u5ea6\u6784\u6210 $1$ \u81f3 $4$ \u7684\u4e00\u4e2a\u6392\u5217\u3002<br/>\u6839\u636e\u7b2c\u4e00\u70b9\uff0c\u6211\u4eec\u77e5\u9053 $1$ \u4e0d\u80fd\u4e0e $2$ \u6216 $3$ \u76f8\u90bb\uff0c\u56e0\u4e3a\u90a3\u6837\u76f8\u90bb\u7684\u4e24\u6bb5\u7684\u957f\u5ea6\u4e4b\u548c\u5c31\u4f1a\u4e0e\u5355\u72ec\u7684\u957f\u5ea6\u4e3a $3$ \u6216 $4$ \u7684\u4e00\u6bb5\u51b2\u7a81\uff0c\u56e0\u6b64 $1$ \u53ea\u80fd\u4e0e $4$ \u76f8\u90bb\uff0c\u5e76\u4e14 $1$ \u53ea\u80fd\u5728\u7b2c\u4e00\u4f4d\u6216\u8005\u6700\u540e\u4e00\u4f4d\u3002\u8fd9\u6837 $2$ \u548c $3$ \u5fc5\u987b\u76f8\u90bb\u3002\u53c8\u56e0\u4e3a $1+4 = 2+3$\uff0c\u6240\u4ee5\u6211\u4eec\u63a8\u51fa\u77db\u76fe\uff0c\u6545\u4e0d\u5b58\u5728 $5$ \u4e2a\u70b9\u7684\u65b9\u6848\u3002<br/><br/>\u5230\u6b64\u5904\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u56de\u7b54\u4e0a\u9762\u7684\u95ee\u9898\u4e86\uff0c\u6700\u5c11\u4f7f\u7528 $6$ \u4e2a\u523b\u5ea6\u3002<br/>2017.6.14<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u5bf9\u4e8e $n$ \u4e2a\u975e\u8d1f\u5b9e\u6570 $x_1, \\\\;x_2, \\\\;...,\\\\;x_n$\uff0c\u8bc1\u660e\uff1a<br/>$$<br/>x_1x_2\\\\cdots x_n \\\\leqslant \\\\left( \\\\frac{x_1 + x_2 + \\\\cdots x_n}n \\\\right)^n<br/>$$<br/>\u5373\u57fa\u672c\u4e0d\u7b49\u5f0f\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u6211\u662f\u5728\u300a\u5177\u4f53\u6570\u5b66\u300b\u4e00\u4e66\u7684\u4e60\u9898\u4e0a\u770b\u5230\u7684\uff0c\u5c45\u7136\u53ef\u4ee5\u7528\u53cd\u5411\u5f52\u7eb3\u6cd5\uff0c\u53ea\u80fd\u8868\u793a\u6211\u8fd9\u79cd\u83dc\u9e21\u6839\u672c\u60f3\u4e0d\u51fa\u6765\u3002<br/>\u9996\u5148 $n = 1$ \u65f6\u663e\u7136\uff0c\u5c31\u4e0d\u518d\u8003\u8651\u4e86\u3002<br/>\u5176\u6b21\uff0c\u6839\u636e\u521d\u4e2d\u77e5\u8bc6\uff0c$(x_1 + x_2)^2 - 4x_1 x_2 = (x_1 - x_2)^2 \\\\geqslant 0$\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $n = 2$ \u65f6\u7684\u7ed3\u8bba\u3002<br/>\u63a5\u4e0b\u6765\u5c31\u6bd4\u8f83\u673a\u667a\u4e86\uff0c\u9996\u5148\u5982\u679c\u5bf9\u4e8e $n$ \u6210\u7acb\uff0c\u90a3\u4e48\u5bf9\u4e8e $2n$ \u4e5f\u6210\u7acb\u3002\u6211\u4eec\u53ef\u4ee5\u8003\u8651 $2n$ \u65f6\u7684\u4e0d\u7b49\u5f0f\uff0c\u662f\u8fd9\u6837\u5b50\u7684\uff08\u73b0\u5728\u8fd8\u4e0d\u6210\u7acb\uff09\uff1a<br/>$$<br/>x_1x_2\\\\cdots x_{2n} \\\\leqslant \\\\left({x_1 + x_2 + \\\\cdots x_{2n} \\\\over 2n}\\\\right)^{2n}<br/>$$<br/>\u8bbe $n$ \u4e2a\u53d8\u91cf $y_1, \\\\;y_2, \\\\;..., \\\\;y_n$ \u548c $z_1, \\\\;z_2$\u3002\u6211\u4eec\u4ee4\uff1a<br/>$$<br/>x_{i + (j - 1)n} = y_i z_j \\\\;\\\\;\\\\;\\\\; (1 \\\\leqslant i \\\\leqslant n, \\\\; j = 1, \\\\;2)<br/>$$<br/>\u6240\u4ee5\u4e4b\u524d\u7684\u4e0d\u7b49\u5f0f\u53ef\u4ee5\u53d8\u4e3a\uff1a<br/>$$<br/>(y_1y_2\\\\cdots y_n)^2(z_1z_2)^n \\\\leqslant \\\\left( {y_1 + y_2 + \\\\cdots y_n \\\\over n} \\\\right)^{2n} \\\\left( {z_1 + z_2 \\\\over 2} \\\\right)^{2n}<br/>$$<br/>\u7531\u4e8e\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>y_1y_2\\\\cdots y_n &\\\\leqslant \\\\left( {y_1 + y_2 + \\\\cdots + y_n \\\\over n} \\\\right)^n \\\\\\\\<br/>z_1z_2 &\\\\leqslant \\\\left( {z_1 + z_2 \\\\over 2} \\\\right)^2<br/>\\\\end{aligned}<br/>$$<br/>\u90fd\u6210\u7acb\uff0c\u6240\u4ee5\u5bf9\u4e8e $2n$ \u65f6\u57fa\u672c\u4e0d\u7b49\u5f0f\u4e5f\u6210\u7acb\u3002<br/>\u6700\u540e\u4e00\u6b65\u5c31\u662f\u53cd\u5411\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u3002\u5047\u8bbe\u73b0\u5728 $n$ \u662f\u6210\u7acb\u7684\uff0c\u90a3\u4e48\u9700\u8981\u8bc1\u660e $n - 1$ \u4e5f\u662f\u6210\u7acb\u7684\u3002\u8fd9\u4e2a\u8bc1\u660e\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u4ee4 $x_n$ \u4e3a $E = \\\\left(\\\\sum_{k=1}^{n-1}x_k\\\\right) / (n - 1)$\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>x_1x_2\\\\cdots x_{n-1}E &\\\\leqslant \\\\left( {x_1 + x_2 + \\\\cdots + x_{n - 1} + E \\\\over n} \\\\right)^n \\\\\\\\<br/>x_1x_2\\\\cdots x_{n-1}E &\\\\leqslant \\\\left( {(n - 1)E + E \\\\over n} \\\\right)^n \\\\\\\\<br/>x_1x_2\\\\cdots x_{n-1}E &\\\\leqslant E^n \\\\\\\\<br/>x_1x_2\\\\cdots x_{n-1} &\\\\leqslant E^{n-1} \\\\\\\\<br/>x_1x_2\\\\cdots x_{n-1} &\\\\leqslant \\\\left( {x_1 + x_2 + \\\\cdots + x_{n - 1} \\\\over n - 1} \\\\right)^{n - 1}<br/>\\\\end{aligned}<br/>$$<br/>\u56e0\u6b64\u5bf9\u4e8e $n - 1$ \u4e5f\u662f\u6210\u7acb\u7684\u3002<br/>\u6700\u540e\u7efc\u5408\u4e00\u4e0b\uff0c\u5982\u679c\u8981\u60f3\u8bc1\u660e $n > 2$ \u6210\u7acb\uff0c\u53ea\u9700\u8981\u4ece $m = 2$ \u5f00\u59cb\uff0c\u500d\u589e $m$ \u76f4\u5230 $m \\\\geqslant n$\uff0c\u7136\u540e\u53cd\u5411\u5f52\u7eb3\u5230 $n$ \u5373\u53ef\u3002\u56e0\u6b64\u57fa\u672c\u4e0d\u7b49\u5f0f\u5bf9\u4e8e\u6240\u6709\u6b63\u6574\u6570 $n$ \u5747\u6210\u7acb\u3002<br/>2017.12.16<br/>\u95ee\u9898\u63cf\u8ff0<br/>\uff08\u54e5\u5fb7\u5df4\u8d6b-\u6b27\u62c9\u5b9a\u7406\uff09<br/>(1) \uff08\u300a\u5177\u4f53\u6570\u5b66\u300b\u7b2c\u4e8c\u7ae0\u4e60\u9898 31\uff09\u8bc1\u660e\uff1a<br/>$$<br/>\\\\sum_{j=2}^\\\\infty\\\\sum_{k=2}^\\\\infty \\\\frac1{j^k} = 1<br/>$$<br/>(2) \uff08\u300a\u5177\u4f53\u6570\u5b66\u300b\u7b2c\u4e8c\u7ae0\u4e60\u9898 35\uff09\u8bbe\u96c6\u5408 $P = \\\\{m^n \\\\mid m,\\\\;n \\\\geqslant 2,\\\\;m,\\\\;n\\\\in \\\\mathbf{N}\\\\}$\uff0c\u56e0\u6b64\u6211\u4eec\u77e5\u9053\uff1a<br/>$$<br/>P = \\\\{4,\\\\;8,\\\\;9,\\\\;16,\\\\;25,\\\\;27,\\\\;32,\\\\;36,\\\\;...\\\\}<br/>$$<br/>\u8bc1\u660e\uff1a<br/>$$<br/>\\\\sum_{k \\\\in P} {1 \\\\over k - 1} = 1<br/>$$<br/>\u89e3\u51b3\u65b9\u6848<br/>(1) \u7b2c\u4e00\u95ee\u4f7f\u7528\u51e0\u4f55\u7ea7\u6570\u5373\u53ef\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{j=2}^\\\\infty\\\\sum_{k=2}^\\\\infty {1\\\\over j^k} & = \\\\sum_{j=2}^\\\\infty \\\\left({1 \\\\over 1 - \\\\frac1j} - 1 - \\\\frac1j\\\\right) \\\\\\\\<br/>& = \\\\sum_{j=2}^\\\\infty \\\\left(\\\\frac1{j-1} - \\\\frac1j\\\\right) \\\\\\\\<br/>& = 1<br/>\\\\end{aligned}<br/>$$<br/>(2) \u8003\u8651\u5230 (1) \u8ba1\u7b97\u51fa\u7684\u7b54\u6848\u662f $1$\uff0c\u8fd9\u5728\u9690\u9690\u7ea6\u7ea6\u4e4b\u4e2d\u6307\u5f15\u7740\u6211\u4eec\u53bb\u5bfb\u627e (1) \u548c (2) \u4e4b\u95f4\u7684\u8054\u7cfb\u3002<br/>\u7ecf\u8fc7\u4e00\u756a\u8003\u8651\uff0c\u6211\u4eec\u53d1\u73b0\u5982\u679c\u5206\u5b50\u5206\u6bcd\u540c\u9664 $k$ \u4f1a\u6709\u5947\u6548\uff1a<br/>$$<br/>{1 \\\\over k - 1} = \\\\frac1k \\\\cdot {1 \\\\over 1 - \\\\frac1k} = \\\\frac1k\\\\sum_{j=0}^\\\\infty {1 \\\\over k^j} = \\\\sum_{j=1}^\\\\infty {1 \\\\over k^j}<br/>$$<br/>\u6240\u4ee5\u539f\u5f0f\u53d8\u8eab\u4e3a\uff1a<br/>$$<br/>\\\\sum_{k \\\\in P}\\\\sum_{j=1}^\\\\infty \\\\frac1{k^j}<br/>$$<br/>\u5341\u5206\u5de7\u5999\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u51fa\u4e00\u79cd\u4e00\u4e00\u5bf9\u5e94\u7684\u5173\u7cfb\uff0c\u6ee1\u8db3 $p^q = k^j$\uff0c\u5176\u4e2d $p,\\\\;q \\\\geqslant 2$ \uff08\u5373 (1) \u4e2d\u7684\u4e0b\u6807 $j$ \u548c $k$\uff09\uff0c\u800c $k \\\\in P,\\\\;j\\\\geqslant 1$ \uff08\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u7684\u4e0b\u6807\uff09\u3002<br/>\u6839\u636e $P$ \u7684\u5b9a\u4e49\uff0c\u8bbe $k = m^n$\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u8981\u6c42 $m \\\\notin P$\uff0c\u56e0\u4e3a\u5982\u679c $m \\\\in P$\uff0c\u90a3\u4e48\u610f\u5473\u7740 $m$ \u53c8\u53ef\u4ee5\u88ab\u8868\u793a\u6210 $a^b$ \u7684\u5f62\u5f0f\uff0c\u8fd9\u65f6\u6211\u4eec\u53ea\u9700\u4ee4 $m = a$ \u5e76\u4e14\u4f7f $n$ \u4e58\u4e0a $b$ \u5c31\u53ef\u4ee5\u4e86\u3002\u6240\u4ee5\u5177\u4f53\u5bf9\u5e94\u65b9\u6848\u5982\u4e0b\uff1a<br/><br/>\u5f53 $j > 1$ \u65f6\uff0c\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u76f4\u63a5\u4ee4 $p = k$ \u4ee5\u53ca $q = j$\uff0c\u5c31\u53ef\u4ee5\u6ee1\u8db3\u8981\u6c42\u3002<br/>\u5f53 $j = 1$ \u65f6\uff0c\u7531\u4e8e $k = m^n$\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u4ee4 $p = m$ \u800c $q = n$\u3002<br/><br/>\u4e3a\u4e86\u8bc1\u660e\u8fd9\u662f\u53cc\u5c04\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u4ece\u53e6\u4e00\u4e2a\u65b9\u5411\u6765\u5bf9\u5e94\uff1a<br/><br/>\u82e5 $p \\\\in P$\uff0c\u5219 $k = p$ \u5e76\u4e14 $j = q$\uff0c\u8fd9\u662f\u56e0\u4e3a $k \\\\in P$\u3002<br/>\u82e5 $p \\\\notin P$\uff0c\u5219 $k = p^q$\uff0c\u6b64\u65f6 $j = 1$\u3002\u4ece\u8fd9\u91cc\u53ef\u4ee5\u770b\u51fa\u6211\u4eec\u8981\u6c42 $m \\\\notin P$ \u7684\u597d\u5904\u3002<br/><br/>\u81f3\u6b64\uff0c\u6211\u4eec\u5c31\u6210\u529f\u8bc1\u660e\u4e86 (2) \u4e2d\u7684\u7b49\u5f0f\u3002<br/>2018.1.7<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u8bc1\u660e\uff1a\u5bf9\u4e8e\u4efb\u610f\u7684\u6b63\u6574\u6570 $n$\uff0c\u5747\u53ef\u88ab\u8868\u793a\u4e3a $\\\\left\\\\lfloor \\\\sqrt2 k \\\\right\\\\rfloor$ \u6216 $\\\\left\\\\lfloor (2 + \\\\sqrt2)k \\\\right\\\\rfloor$ \u4e2d\u7684\u6709\u4e14\u4ec5\u6709\u4e00\u79cd\u5f62\u5f0f\uff0c\u5176\u4e2d $k$ \u4e5f\u662f\u6b63\u6574\u6570\u3002<br/>\u6362\u53e5\u8bdd\u8bf4\uff0c\u96c6\u5408 $A = \\\\left\\\\{\\\\left\\\\lfloor \\\\sqrt2 k \\\\right\\\\rfloor \\\\mid k \\\\in \\\\mathbf{N}^+\\\\right\\\\}$\uff0c$B = \\\\left\\\\{\\\\left\\\\lfloor (2 + \\\\sqrt2) k \\\\right\\\\rfloor \\\\mid k \\\\in \\\\mathbf{N}^+ \\\\right\\\\}$\uff0c\u8bc1\u660e $A \\\\cap B = \\\\varnothing$ \u5e76\u4e14 $A \\\\cup B = \\\\mathbf{N}^+$\uff0c\u5c31\u50cf\u628a\u6b63\u6574\u6570\u96c6\u5212\u5206\u4e3a\u4e24\u534a\u4e00\u6837\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u8fd9\u4e2a\u601d\u8def\u786e\u5b9e\u6bd4\u8f83\u6709\u8da3\uff0c\u6211\u4eec\u5c1d\u8bd5\u8bc1\u660e\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u6b63\u6574\u6570 $n$\uff0c\u96c6\u5408 $A$ \u4e2d\u4e0d\u5927\u4e8e $n$ \u7684\u5143\u7d20\u4e2a\u6570 $a$ \u4e0e\u96c6\u5408 $B$ \u4e2d\u4e0d\u5927\u4e8e $n$ \u7684\u5143\u7d20\u4e2a\u6570 $b$ \u4e4b\u548c\u7b49\u4e8e $n$\u3002\u5982\u679c\u5f97\u5230\u4e86\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u539f\u547d\u9898\u5c31\u5f88\u5bb9\u6613\u8bf4\u660e\u4e86\u3002<br/>\u5148\u8003\u8651\u96c6\u5408 $A$:<br/>$$<br/>\\\\begin{aligned}<br/>a & = \\\\sum_k  \\\\left[1 \\\\leqslant \\\\left\\\\lfloor \\\\sqrt2 k \\\\right\\\\rfloor \\\\leqslant n \\\\right] \\\\\\\\<br/>& = \\\\sum_k  \\\\left[1 \\\\leqslant \\\\sqrt2 k < n + 1\\\\right] \\\\\\\\<br/>& = \\\\left\\\\lceil {n + 1 \\\\over \\\\sqrt2} \\\\right\\\\rceil - \\\\left\\\\lceil {1 \\\\over \\\\sqrt2} \\\\right\\\\rceil \\\\\\\\<br/>& = \\\\left\\\\lceil {n + 1 \\\\over \\\\sqrt2} \\\\right\\\\rceil - 1<br/>\\\\end{aligned}<br/>$$<br/>\u540c\u7406\u53ef\u5f97\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>b & = \\\\left\\\\lceil {n + 1 \\\\over 2 + \\\\sqrt2} \\\\right\\\\rceil - 1 = \\\\left\\\\lceil {(2 - \\\\sqrt2)(n + 1) \\\\over 2} \\\\right\\\\rceil - 1 \\\\\\\\<br/>& = n + 1 + \\\\left\\\\lceil -{\\\\sqrt2(n + 1) \\\\over 2} \\\\right\\\\rceil - 1 \\\\\\\\<br/>& = n - \\\\left\\\\lfloor {n + 1 \\\\over \\\\sqrt2} \\\\right\\\\rfloor<br/>\\\\end{aligned}<br/>$$<br/>\u56e0\u6b64\uff1a<br/>$$<br/>a + b = n - 1 + \\\\left\\\\lceil {n + 1 \\\\over \\\\sqrt2} \\\\right\\\\rceil - \\\\left\\\\lfloor {n + 1 \\\\over \\\\sqrt2} \\\\right\\\\rfloor \\\\tag{1}<br/>$$<br/>\u6211\u4eec\u77e5\u9053\uff0c\u5bf9\u4e8e\u4efb\u610f\u5b9e\u6570 $r$\uff1a<br/>$$<br/>\\\\lceil r \\\\rceil - \\\\lfloor r \\\\rfloor  = \\\\begin{cases}<br/>0 &  (r \\\\in \\\\mathbf{N}) \\\\\\\\<br/>1 &  (\\\\text{otherwise})<br/>\\\\end{cases}<br/>$$<br/>\u800c $(n+1) / \\\\sqrt2$ \u4e00\u5b9a\u662f\u65e0\u7406\u6570\uff0c\u6545 $(1)$ \u5f0f\u4e2d\u7684\u53d6\u4e0a\u6574\u51cf\u53d6\u4e0b\u6574\u7684\u90e8\u5206\u6052\u4e3a $1$\uff0c\u5373 $a + b = n$\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u6b63\u65e0\u7406\u6570 $\\\\alpha$ \u548c $\\\\beta$\uff0c\u53ea\u8981\u6ee1\u8db3 $1/\\\\alpha + 1/\\\\beta = 1$\uff0c\u96c6\u5408 $A = \\\\left\\\\{\\\\left\\\\lfloor \\\\alpha k \\\\right\\\\rfloor \\\\mid k \\\\in \\\\mathbf{N}^+\\\\right\\\\}$ \u548c\u96c6\u5408 $B = \\\\left\\\\{\\\\left\\\\lfloor \\\\beta k \\\\right\\\\rfloor \\\\mid k \\\\in \\\\mathbf{N}^+\\\\right\\\\}$ \u5c31\u4f1a\u662f\u4e00\u4e2a\u6b63\u6574\u6570\u7684\u5212\u5206\u3002\u5177\u4f53\u7684\u8bc1\u660e\u65b9\u6cd5\u4e0e\u4e0a\u9762\u7c7b\u4f3c\u3002<br/>2018.1.13<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u6c42\u4e0b\u9762\u8fd9\u4e2a\u9012\u63a8\u5f0f\u7684\u901a\u9879\u516c\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>R(1) & = 4  \\\\\\\\<br/>R(n + 1) & = 3R(n) + 2^{n-1}-4n ~~~~(\\\\forall n > 1)<br/>\\\\end{aligned}<br/>$$<br/>\u89e3\u51b3\u65b9\u6848<br/>\u8fd9\u91cc\u4e3b\u8981\u662f\u8bb0\u5f55\u4e00\u4e0b Repertoire Method \u8fd9\u79cd\u65b9\u6cd5\uff0c\u4e0d\u8fc7\u73b0\u5728\u6211\u8fd8\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u7ffb\u8bd1\u8fd9\u4e2a\u540d\u79f0\u2026<br/>\u8fd9\u4e2a\u65b9\u6cd5\u57fa\u4e8e\u4e00\u4e2a\u7b80\u5355\u7684\u89c2\u5bdf\uff1a\u5982\u679c\u8bbe<br/>$$<br/>\\\\begin{aligned}<br/>R(1) & = a \\\\\\\\<br/>R(n + 1) & = 3R(n) + b\\\\cdot 2^{n-1} + c\\\\cdot  n + d<br/>\\\\end{aligned}<br/>$$<br/>\u6211\u4eec\u4f1a\u53d1\u73b0\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>R(1) & = a \\\\\\\\<br/>R(2) & = 3a + b + c + d \\\\\\\\<br/>R(3) & = 9a + 5b + 5c + 4d \\\\\\\\<br/>R(4) & = 27a + 19b + 18c + 13d \\\\\\\\<br/>R(5) & = 81a + 65b + 58c + 40d \\\\\\\\<br/>&\\\\cdots<br/>\\\\end{aligned}<br/>$$<br/>\u53ef\u4ee5\u731c\u6d4b\uff0c$R(n)$ \u7684\u901a\u9879\u516c\u5f0f\u53ef\u4ee5\u88ab\u5199\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff1a<br/>$$<br/>R(n) = a\\\\cdot f(n) + b \\\\cdot g(n) + c\\\\cdot h(n) + d \\\\cdot \\\\varphi(n)<br/>$$<br/>\u5176\u4e2d $f(n)$\u3001$g(n)$\u3001$h(n)$ \u548c $\\\\varphi(n)$ \u90fd\u662f\u5173\u4e8e $n$ \u7684\u7b80\u5355\u51fd\u6570\u3002\u8fd0\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u4e0d\u96be\u8bc1\u660e\u53ef\u4ee5\u4e00\u76f4\u4fdd\u6301\u8fd9\u79cd\u5f62\u5f0f\u3002<br/>\u6211\u4eec\u73b0\u5728\u7684\u76ee\u6807\u5c31\u662f\u6c42\u51fa\u8fd9\u56db\u4e2a\u51fd\u6570\u3002\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u5c31\u6bd4\u8f83\u6295\u673a\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u5f53 $a$\u3001 $b$\u3001$c$\u3001$d$ \u53d6\u4e0d\u540c\u503c\u7684\u65f6\u5019 $R(n)$ \u53ef\u80fd\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe $R(n) = 1$\uff0c\u5c1d\u8bd5\u627e\u51fa\u662f\u5426\u6709\u5bf9\u5e94\u7684\u503c\u3002\u6839\u636e\u9012\u63a8\u7684\u7b49\u5f0f\uff0c\u53ef\u4ee5\u5217\u51fa\uff1a<br/>$$<br/>\\\\begin{cases}<br/>1 = a \\\\\\\\<br/>1 = 3 \\\\times 1 + b \\\\cdot 2^{n-1} + c\\\\cdot n + d<br/>\\\\end{cases}<br/>$$<br/>\u4e0d\u96be\u53d1\u73b0\uff1a$a = 1$ \u4ee5\u53ca $d = -2$\uff0c\u5176\u4f59\u4e24\u4e2a\u53d8\u91cf\u53ea\u80fd\u4e3a $0$\u3002\u56de\u4ee3\u5230 $R(n)$ \u7684\u901a\u9879\u516c\u5f0f\u4e2d\uff1a<br/>$$<br/>R(n) = f(n) - 2\\\\varphi(n) = 1<br/>$$<br/>\u6211\u4eec\u660e\u767d\uff0c\u5982\u679c\u80fd\u6309\u7167\u7c7b\u4f3c\u7684\u65b9\u5f0f\u627e\u5230 $4$ \u4e2a\u8fd9\u6837\u7684\u65b9\u7a0b\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u56db\u4e2a\u51fd\u6570\u5168\u90e8\u90fd\u89e3\u51fa\u6765\u3002\u73b0\u5728\u7ee7\u7eed\u5c1d\u8bd5\u4e00\u4e9b\u5176\u5b83\u7684\u51fd\u6570\u3002\u8003\u8651\u5230\u9012\u63a8\u5f0f\u4e2d\u6709 $n$ \u8fd9\u79cd\u4e1c\u897f\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5f53 $R(n) = n$ \u65f6\u7684\u60c5\u51b5\uff1a<br/>$$<br/>\\\\begin{cases}<br/>0 = a \\\\\\\\<br/>n + 1 = 3n + b \\\\cdot 2^{n-1} + c\\\\cdot n + d<br/>\\\\end{cases}<br/>$$<br/>\u53ef\u4ee5\u89e3\u51fa $a = 1,\\\\;c = -2,\\\\;d = 1$\u3002\u56e0\u6b64 $f(n) - 2h(n) + \\\\varphi(n) = n$\u3002<br/>\u6839\u636e\u540c\u6837\u7684\u60f3\u6cd5\uff0c\u5c1d\u8bd5\u4e00\u4e0b $R(n) = 2^n$\uff1a<br/>$$<br/>\\\\begin{cases}<br/>2 = a \\\\\\\\<br/>2^{n+1} = 3 \\\\times 2^n + b \\\\cdot 2^{n-1} + c\\\\cdot n + d<br/>\\\\end{cases}<br/>$$<br/>\u6b64\u65f6 $a = 2,\\\\;b = -2$\uff0c\u540c\u65f6\u6211\u4eec\u6709 $f(n) - g(n) = 2^{n-1}$\u3002<br/>\u6b64\u5916\u6ce8\u610f\u5230\u7b2c\u4e8c\u4e2a\u9012\u63a8\u5f0f\u4e2d $R(n)$ \u524d\u7684\u7cfb\u6570\u662f $3$\uff0c\u8bf4\u660e\u901a\u9879\u516c\u5f0f\u4e2d\u5e94\u8be5\u662f\u6709 $3^n$ \u8fd9\u79cd\u4e1c\u897f\u7684\u3002\u4e8e\u662f\u5c1d\u8bd5 $R(n) = 3^n$\uff1a<br/>$$<br/>\\\\begin{cases}<br/>3 = a \\\\\\\\<br/>3^{n + 1} = 3^{n+1} + b \\\\cdot 2^{n-1} + c\\\\cdot n + d<br/>\\\\end{cases}<br/>$$<br/>So easy, $a = 3$\uff0c\u5e76\u4e14\u53ef\u4ee5\u76f4\u63a5\u77e5\u9053 $f(n) = 3^{n - 1}$\u3002<br/>\u73b0\u5728 $4$ \u4e2a\u65b9\u7a0b\u96c6\u9f50\u4e86\uff0c\u53ea\u9700\u8981\u89e3\u4e0b\u9762\u8fd9\u4e2a\u65b9\u7a0b\u7ec4\uff1a<br/>$$<br/>\\\\left\\\\{<br/>\\\\begin{aligned}<br/>f(n) - 2\\\\varphi(n) & = 1 \\\\\\\\<br/>f(n) - 2h(n) + \\\\varphi(n) & = n \\\\\\\\<br/>f(n) - g(n) &= 2^{n-1} \\\\\\\\<br/>f(n) & = 3^{n - 1}<br/>\\\\end{aligned}<br/>\\\\right.<br/>$$<br/>\u4e0d\u96be\u89e3\u51fa\uff1a<br/>$$<br/>\\\\left\\\\{<br/>\\\\begin{aligned}<br/>f (n) & = 3^{n - 1} \\\\\\\\<br/>g(n) & = 3^{n-1} - 2^{n - 1}\\\\\\\\<br/>h(n) & = \\\\frac14 3^n - \\\\frac12 n - \\\\frac14 \\\\\\\\<br/>\\\\varphi(n) & = \\\\frac12 3^{n - 1} - \\\\frac12<br/>\\\\end{aligned}<br/>\\\\right.<br/>$$<br/>\u73b0\u5728\u6765\u89e3\u51b3\u539f\u95ee\u9898\u3002\u539f\u95ee\u9898\u4e2d\uff0c$a = 4,\\\\;b = 1,\\\\;c = -4,\\\\;d = 0$\uff0c\u6240\u4ee5 $R(n) = 4f(n) + g(n) - 4h(n) = 2\\\\times 3^{n-1} - 2^{n-1}+2n+1$\u3002\u7eb5\u89c2\u6574\u4e2a\u8fc7\u7a0b\uff0cRepertoire Method \u5e76\u4e0d\u7b80\u5355\uff0c\u751a\u81f3\u6709\u70b9\u7e41\u7410\uff0c\u4f46\u4ecd\u4e0d\u5931\u4e3a\u63a2\u7a76\u95ee\u9898\u7684\u4e00\u79cd\u597d\u601d\u8def\u3002<br/>2018.2.17<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u8bc1\u660e\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u6574\u6570 $n$ \u548c\u6b63\u6574\u6570 $m$\uff0c\u6ee1\u8db3\uff1a<br/>$$<br/>\\\\left\\\\lceil {n \\\\over m} \\\\right\\\\rceil = \\\\left\\\\lfloor {n + m - 1 \\\\over m} \\\\right\\\\rfloor<br/>$$<br/>\u89e3\u51b3\u65b9\u6848<br/>\u76f4\u63a5\u8bc1\u660e\u8fd9\u4e2a\u95ee\u9898\u5e76\u4e0d\u662f\u7279\u522b\u56f0\u96be\uff0c\u56e0\u4e3a\u53f3\u8fb9\u5c31\u662f $1 + \\\\lfloor n/m - 1/m \\\\rfloor$\uff0c\u7136\u540e\u5206\u60c5\u51b5\u8ba8\u8bba $n/m$ \u662f\u5426\u4e3a\u6574\u6570\u5c31\u53ef\u4ee5\u5f97\u5230\u7ed3\u8bba\u3002\u8fd9\u91cc\u5c31\u4e0d\u8be6\u7ec6\u8bf4\u4e86\u3002<br/>\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\u6bd4\u8f83\u6709\u610f\u601d\uff0c\u8003\u8651\u5c06 $n$ \u8868\u793a\u4e3a $m\\\\lfloor n/m \\\\rfloor + n \\\\bmod m$ \u7684\u5f62\u5f0f\uff0c\u7136\u540e\u4e0a\u5f0f\u5de6\u53f3\u540c\u51cf $\\\\lfloor n/m \\\\rfloor$ \u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>& \\\\left\\\\lceil {n \\\\over m} \\\\right\\\\rceil = \\\\left\\\\lfloor {n + m - 1 \\\\over m} \\\\right\\\\rfloor \\\\\\\\<br/>\\\\Leftrightarrow \\\\  & \\\\left\\\\lceil {n \\\\over m} \\\\right\\\\rceil - \\\\left\\\\lfloor {n \\\\over m} \\\\right\\\\rfloor = \\\\left\\\\lfloor {m\\\\lfloor n/m \\\\rfloor + n \\\\bmod m + m - 1 \\\\over m} \\\\right\\\\rfloor  - \\\\left\\\\lfloor {n \\\\over m} \\\\right\\\\rfloor \\\\\\\\<br/>\\\\Leftrightarrow \\\\  & \\\\left[\\\\frac{n}m \\\\not\\\\in \\\\mathbf{Z} \\\\right] = \\\\left\\\\lfloor {n \\\\over m} \\\\right\\\\rfloor + \\\\left\\\\lfloor {n \\\\bmod m + m - 1 \\\\over m} \\\\right\\\\rfloor  - \\\\left\\\\lfloor {n \\\\over m} \\\\right\\\\rfloor \\\\\\\\<br/>\\\\Leftrightarrow \\\\  & [n \\\\bmod m \\\\neq 0] = [n \\\\bmod m + m - 1 \\\\geqslant m] \\\\\\\\<br/>\\\\Leftrightarrow \\\\  & [n \\\\bmod m > 0] = [n \\\\bmod m > 0]<br/>\\\\end{aligned}<br/>$$<br/>\u4ece\u800c\u8bc1\u660e\u4e86\u7b49\u5f0f\u3002<br/>2018.4.4<br/>\u95ee\u9898\u63cf\u8ff0<br/>\uff08IMO 2012 \u9884\u9009\u9898 C2\uff09<br/>\u5728 $\\\\{1,2,...,n\\\\}$ \u4e2d\u6700\u591a\u80fd\u9009\u51fa\u591a\u5c11\u5bf9\u4e0d\u76f8\u4ea4\u7684\u4e8c\u5143\u7ec4 $(a, b)$\uff0c\u6ee1\u8db3 $a + b \\\\leqslant n$\uff0c\u5e76\u4e14\u4efb\u610f\u4e24\u5bf9\u7684\u5143\u7d20\u4e4b\u548c\u4e0d\u540c\uff1f<br/>\u5982\uff0c\u5f53 $n = 6$ \u65f6\uff0c\u53ef\u4ee5\u627e\u51fa $2 + 4 = 6$ \u548c $1 + 3 = 4$\uff0c\u5e76\u4e14\u6700\u591a\u4e5f\u53ea\u80fd\u627e\u51fa\u4e24\u5bf9\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u9996\u5148\u8003\u8651\u4e0a\u754c\uff0c\u5047\u8bbe\u627e\u5230\u4e86 $m$ \u5bf9\uff0c\u5219\u9009\u51fa\u6765\u7684\u6570\u5b57\u4e4b\u548c\u81f3\u5c11\u662f\uff1a<br/>$$<br/>\\\\sum_{k=1}^{2m}k = m(2m + 1)<br/>$$<br/>\u800c\u6bcf\u5bf9\u7684\u548c\u4e24\u4e24\u4e0d\u540c\uff0c\u610f\u601d\u662f\u6570\u5b57\u4e4b\u548c\u81f3\u591a\u4e3a\uff1a<br/>$$<br/>\\\\sum_{k = 0}^{m-1}(n-k) = mn - {m(m-1) \\\\over 2}<br/>$$<br/>\u6839\u636e\u8fd9\u4e24\u4e2a\u754c\u9650\uff0c\u53ef\u77e5\uff1a<br/>$$<br/>m \\\\leqslant {2n - 1 \\\\over 5} \\\\Leftrightarrow m \\\\leqslant \\\\left\\\\lfloor {2n - 1 \\\\over 5} \\\\right\\\\rfloor<br/>$$<br/>\u73b0\u5728\u6211\u4eec\u6765\u5c1d\u8bd5\u6784\u9020\uff0c\u4f7f\u5f97\u6b63\u597d\u80fd\u9009\u51fa $\\\\lfloor (2n - 1)/5 \\\\rfloor$ \u5bf9\u4e8c\u5143\u7ec4\u3002\u4e3a\u4e86\u66f4\u65b9\u4fbf\u5730\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\uff0c\u9996\u5148\u6784\u5efa\u4e00\u4e2a\u76f4\u89c2\u4e00\u70b9\u7684\u6a21\u578b\u3002\u8bbe\u7b2c $k$ \u4e2a\u4e8c\u5143\u7ec4\uff08$1 \\\\leqslant k \\\\leqslant m$\uff09\u4e3a $(a_k, b_k)$\uff0c\u4ee5\u53ca $c_k = a_k + b_k$\u3002\u5c1d\u8bd5 $a_k = k$ \u4ee5\u53ca $c_k = n - k + 1$ \u7684\u60c5\u51b5\uff08\u4e5f\u5c31\u662f\u9009\u53d6\u7684\u6700\u5c0f\u7684 $m$ \u4e2a\u6570\u5b57\u548c\u6700\u5927\u7684 $m$ \u4e2a\u548c\uff0c\u56e0\u4e3a\u8fd9\u6837\u770b\u8d77\u6765\u6210\u529f\u7387\u9ad8\u4e00\u4e9b\uff09\uff0c\u5efa\u7acb\u4e00\u4e2a\u8868\u683c\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5176\u4e2d\u6bcf\u4e00\u4e2a\u5728\u7b2c $x$ \u884c\u7b2c $y$ \u5217\u7684\u5355\u5143\u683c\u4e0a\u7684\u6570\u5b57\u4e3a $c_y - a_x$\uff0c\u4ee3\u8868 $b_k$ \u7684\u5019\u9009\u503c\uff1a<br/><br/>(Fig.1. $n = 11$\uff0c$m = 4$ \u65f6\u7684\u60c5\u51b5\u3002 \u5de6\u8fb9\u4e00\u7ad6\u5217\u4ece\u4e0a\u81f3\u4e0b\u4e3a $a_1..a_m$\uff0c\u6700\u4e0a\u9762\u4e00\u6a2a\u6392\u4ece\u5de6\u81f3\u53f3\u4e3a $c_m..c_1$\uff0c\u4e2d\u95f4 $16$ \u4e2a\u5355\u5143\u683c\u4ee3\u8868\u7684\u662f $b_k$ \u7684\u5019\u9009\u503c\u3002\u56fe\u4e2d\u7ed9\u51fa\u4e86\u4e00\u79cd\u6784\u9020\u65b9\u6848\uff0c\u5373 $1 + 8 = 9$\uff0c$2+9=11$\uff0c$3+5=8$ \u548c $4+6=10$\uff0c\u8fd9\u4e5f\u662f\u6700\u4f18\u7684\u65b9\u6848\u4e4b\u4e00)<br/>\u89c2\u5bdf\u8fd9\u4e2a\u8868\u683c\uff0c\u4e00\u4e2a\u91cd\u8981\u7684\u4fe1\u606f\u5c31\u662f\u6bcf\u4e00\u4e2a\u4ece\u5de6\u4e0a\u81f3\u53f3\u4e0b\u7684\u659c\u5217\uff08\u540e\u7b80\u79f0\u659c\u5217\uff09\u4e0a\u7684\u6570\u5b57\u662f\u4e00\u6837\u7684\u3002\u6b63\u5982\u4e0a\u56fe\u4e2d\u6240\u5c55\u793a\u7684\uff0c\u6211\u4eec\u9700\u8981\u4ece\u4e2d\u95f4 $m^2$ \u4e2a\u5355\u5143\u683c\u4e2d\u5708\u51fa $m$ \u4e2a\u6570\u5b57\u4f5c\u4e3a $b_1..b_m$\u3002\u5f53\u7136\u8fd9\u662f\u6709\u8bb2\u7a76\u7684\u3002\u7531\u4e8e\u4e0d\u80fd\u9009\u76f8\u540c\u7684\u6570\u5b57\uff0c\u6240\u4ee5\u6bcf\u4e00\u884c\u3001\u6bcf\u4e00\u659c\u5217\u5747\u53ea\u80fd\u5708\u4e00\u4e2a\uff1b\u56e0\u4e3a\u548c\u8981\u4e24\u4e24\u4e0d\u540c\uff0c\u6240\u4ee5\u6bcf\u4e00\u7ad6\u5217\u4e5f\u53ea\u80fd\u5708\u4e00\u4e2a\u3002\u540c\u65f6\u6211\u4eec\u6ce8\u610f\u5230\u5de6\u4e0b\u89d2\u53ef\u80fd\u4f1a\u6709\u548c $a_1..a_m$ \u76f8\u540c\u7684\u533a\u57df\uff0c\u59d1\u4e14\u79f0\u5176\u4e3a \u201c\u7981\u533a\u201d\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u91cc\u9762\u7684\u6570\u5b57\u4e5f\u4e0d\u80fd\u5708\u3002\u5982\u679c\u8fd9\u4e9b\u6761\u4ef6\u5747\u6ee1\u8db3\u4e86\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u5408\u6cd5\u65b9\u6848\u3002<br/>\u6839\u636e\u4e0a\u9762\u7684\u9650\u5236\uff0c\u683c\u5b50\u4e2d\u7a76\u7adf\u5199\u4e86\u4ec0\u4e48\u6570\u5b57\u5df2\u7ecf\u4e0d\u518d\u91cd\u8981\u4e86\u3002\u73b0\u5728\u7684\u9ebb\u70e6\u4e3b\u8981\u5728\u4e8e\u5de6\u4e0b\u89d2\u7684 \u201c\u7981\u533a\u201d\uff0c\u5b83\u5bfc\u81f4\u6211\u4eec\u4e0d\u80fd\u968f\u610f\u9009\u62e9\u3002\u56e0\u6b64\uff0c\u5728\u6784\u9020\u7684\u65f6\u5019\uff0c\u8981\u5c3d\u53ef\u80fd\u8fdc\u79bb\u90a3\u4e2a\u533a\u57df\uff0c\u4e5f\u5c31\u662f\u5de6\u4e0b\u89d2\u8981\u5c3d\u53ef\u80fd\u7559\u51fa\u7a7a\u767d\u3002\u4e3a\u4e86\u63a2\u7a76\u89c4\u5f8b\uff0c\u624b\u73a9\u4e00\u4e0b $m$ \u8f83\u5c0f\u7684\u60c5\u51b5\uff1a<br/><br/>(Fig.2. $m$ \u4e3a $1..6$ \u65f6\u7684\u6700\u4f18\u89e3\uff1f)<br/>\u4e0a\u56fe\u4e2d $m = 6$ \u7684\u89c4\u5f8b\u5df2\u7ecf\u4f53\u73b0\u5f97\u5f88\u660e\u663e\u4e86\u3002\u8bb0\u7b2c $x$ \u884c\u7b2c $y$ \u5217\u4e3a $(x, y)$\u3002\u6211\u4eec\u4ece $(1, 2)$ \u5f00\u59cb\uff0c\u8bbe\u5f53\u524d\u5904\u5728 $(x, y)$ \u5904\uff0c\u5219\u4e0b\u4e00\u6b65\u79fb\u52a8\u5230 $(x+1,y+2)$ \u5904\u3002\u5982\u679c $y + 2 > m$\uff0c\u5219\u79fb\u52a8\u5230 $(x + 1, 1)$ \u5904\u3002\u8fd9\u6709\u70b9\u7c7b\u4f3c\u4e8e\u8c61\u68cb\u4e2d\u7684 \u201c\u8df3\u9a6c\u201d\u3002<br/>\u8fd9\u6837\u6784\u9020\u51fa\u6765\u7684\u65b9\u6848\u663e\u7136\u662f\u6ee1\u8db3\u8981\u6c42\u7684\uff0c\u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u8003\u5bdf $m$ \u7684\u6700\u5927\u503c\uff0c\u56e0\u4e3a\u968f\u7740 $m$ \u7684\u589e\u5927\uff0c\u201c\u7981\u533a\u201d \u7684\u8303\u56f4\u4e5f\u4f1a\u6269\u5927\u3002\u7531\u4e8e\u6211\u4eec\u7684 \u201c\u9a6c\u6b65\u201d \u8d70\u6cd5\u7684\u76f4\u7ebf\u7684\u659c\u7387\u5c0f\u4e8e \u201c\u7981\u533a\u201d \u8fb9\u754c\u7684\u659c\u7387\uff0c\u6240\u4ee5\u53ea\u9700\u8003\u8651\u7b2c $1$ \u5217\u4e2d\u7684\u60c5\u51b5\u3002\u5728\u8868\u683c\u4e2d $(x, y)$ \u4e0a\u7684\u6570\u5b57\u4e3a $n - m - x + y$\uff0c\u6613\u77e5\u6700\u5de6\u5217\u4e2d \u201c\u7981\u533a\u201d \u6700\u9ad8\u70b9\u662f\u5012\u6570\u7b2c $3m - n$ \u4e2a\u683c\u5b50\uff0c\u800c\u5728\u8fd9\u4e00\u5217\u4e2d\uff0c\u6211\u4eec\u9009\u53d6\u7684\u4f4d\u7f6e\u662f\u5012\u6570\u7b2c $\\\\lceil m/2 \\\\rceil$ \u4e2a\u683c\u5b50\uff0c\u6240\u4ee5\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>& 3m - n < \\\\left\\\\lceil {m\\\\over 2} \\\\right\\\\rceil \\\\\\\\<br/>\\\\Leftrightarrow \\\\: & 3m - n < \\\\frac{m}2 \\\\\\\\<br/>\\\\Leftrightarrow \\\\: & m < {2n \\\\over 5} \\\\\\\\<br/>\\\\Leftrightarrow \\\\: & m \\\\leqslant \\\\left\\\\lceil{2n \\\\over 5}\\\\right\\\\rceil - 1 = \\\\left\\\\lceil{2n - 5\\\\over 5}\\\\right\\\\rceil \\\\\\\\<br/>\\\\end{aligned}<br/>$$<br/>\u867d\u7136\u6211\u4eec\u5f97\u5230\u7684\u7ed3\u679c\u4e0e\u4e4b\u524d\u4e0d\u540c\uff0c\u4f46\u5b9e\u9645\u4e0a $\\\\lceil (2n - 5) / 5 \\\\rceil = \\\\lfloor (2n - 1) / 5 \\\\rfloor$\uff0c\u8fd9\u662f\u56e0\u4e3a\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>&\\\\left\\\\lceil {2n - 5 \\\\over 5} \\\\right\\\\rceil = \\\\left\\\\lfloor {2n - 1 \\\\over 5} \\\\right\\\\rfloor \\\\\\\\<br/>\\\\Leftrightarrow \\\\: & \\\\left\\\\lceil {2n - 5 \\\\over 5} \\\\right\\\\rceil \\\\leqslant {2n - 1 \\\\over 5} < \\\\left\\\\lceil {2n - 5 \\\\over 5} \\\\right\\\\rceil + 1 \\\\\\\\<br/>\\\\Leftrightarrow \\\\: & \\\\left\\\\lceil {2n - 1 \\\\over 5} - \\\\frac45 \\\\right\\\\rceil \\\\leqslant \\\\left\\\\lfloor {2n - 1 \\\\over 5} \\\\right\\\\rfloor \\\\leqslant {2n - 1 \\\\over 5} < {2n \\\\over 5} \\\\leqslant \\\\left\\\\lceil {2n \\\\over 5} \\\\right\\\\rceil<br/>\\\\end{aligned}<br/>$$<br/>\u6700\u540e\u4e00\u884c\u6700\u5de6\u8fb9\u7684\u5c0f\u4e8e\u7b49\u4e8e\u53f7\u662f\u901a\u8fc7\u5206 $(2n - 1) / 5$ \u662f\u5426\u4e3a\u6574\u6570\u7684\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\u5f97\u6765\u7684\uff1a\u5f53\u5b83\u662f\u6574\u6570\u65f6\u53d6\u7b49\uff0c\u5426\u5219\u5176\u5c0f\u6570\u90e8\u5206\u4e0d\u5927\u4e8e $4/5$\uff0c\u6240\u4ee5\u4e0d\u7b49\u5f0f\u6210\u7acb\u3002\u7efc\u4e0a\uff0c\u7b54\u6848\u5c31\u662f $\\\\lceil (2n - 5) / 5 \\\\rceil = \\\\lfloor (2n - 1) / 5 \\\\rfloor$\u3002<br/>2018.5.19<br/>\u95ee\u9898\u63cf\u8ff0<br/>(1) \u7ed9\u5b9a\u81ea\u7136\u6570 $n$\uff0c\u8ba1\u7b97 $\\\\newcommand{up}[1]{\\\\left\\\\lceil #1 \\\\right\\\\rceil}\\\\newcommand{dw}[1]{\\\\left\\\\lfloor #1 \\\\right\\\\rfloor} \\\\sum_{k=1}^\\\\infty 2^k\\\\lfloor n/2^k + 1/2\\\\rfloor^2$\u3002<br/>(2) \u7ed9\u5b9a\u5b9e\u6570 $x$\uff0c\u5b9a\u4e49 $\\\\newcommand{\\\\dis}[1]{\\\\lVert #1 \\\\rVert} \\\\dis{x} = \\\\min\\\\{\\\\up{x} - x,\\\\ x - \\\\dw{x}\\\\}$ \u5373 $x$ \u79bb\u6700\u8fd1\u7684\u6574\u6570\u7684\u8ddd\u79bb\uff0c\u8ba1\u7b97 $\\\\sum_{k \\\\in \\\\mathbf{Z}} 2^k \\\\lVert x / 2^k \\\\rVert^2$\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>(1) \u8ba1\u7b97\u8fd9\u4e2a\u548c\u7684\u601d\u8def\u6709\u70b9\u975e\u5e38\u89c4\uff0c\u8003\u8651\u9012\u63a8\u7684\u65b9\u6cd5\uff0c\u8bbe $S_n$ \u4e3a\u4e0a\u9762\u7684\u548c\u5f0f\u3002\u8003\u8651\u5230\u4efb\u610f\u81ea\u7136\u6570 $n$ \u5747\u53ef\u88ab\u552f\u4e00\u5206\u89e3\u4e3a $2^p \\\\cdot q$\uff08$q$ \u662f\u5947\u6570\uff09\uff0c\u5f53 $k = p + 1$ \u65f6\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\left\\\\lfloor {n \\\\over 2^k} + \\\\frac12 \\\\right\\\\rfloor & = \\\\left\\\\lfloor {q + 1 \\\\over 2} \\\\right\\\\rfloor = {q + 1 \\\\over 2} \\\\\\\\<br/>\\\\left\\\\lfloor {n - 1 \\\\over 2^k} + \\\\frac12 \\\\right\\\\rfloor & =  \\\\left\\\\lfloor {q + 1 \\\\over 2} \\\\right\\\\rfloor - 1 = {q - 1 \\\\over 2}<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5 $S_n$ \u548c $S_{n - 1}$ \u4e2d\u7b2c $k$ \u9879\u4e4b\u5dee\u4e3a $2^k \\\\cdot q = 2n$\uff0c\u800c\u5176\u4f59\u9879\u4e2d $n / 2^k$ \u5f97\u4e0d\u5230\u50cf\u4e0a\u9762 $q$ \u8fd9\u6837\u7684\u5947\u6570\uff0c\u4e24\u8005\u7ed3\u679c\u76f8\u540c\u3002\u6240\u4ee5 $S_n = S_{n - 1} + 2n = n^2 + n$\u3002<br/>(2) \u7b2c\u4e8c\u95ee\u5b9e\u9645\u4e0a\u9664\u4e86\u5f62\u5f0f\u4e0e\u7b2c\u4e00\u95ee\u7c7b\u4f3c\uff0c\u5176\u5b9e\u6ca1\u6709\u591a\u5c11\u5173\u8054......<br/>\u4e3a\u4e86\u65b9\u4fbf\u4e66\u5199\u548c\u63a2\u7a76\uff0c\u8bb0\u51fd\u6570 $f(x)$ \u4e3a\u6211\u4eec\u9700\u8981\u8ba1\u7b97\u7684\u5f0f\u5b50\u3002\u5199\u4e2a\u7a0b\u5e8f\u778e\u8bd5\u4e00\u4e0b\u5176\u5b9e\u4f1a\u53d1\u73b0 $f(x) = x \\\\ (x \\\\geqslant 0)$\u3002\u6b64\u5916\u7531\u4e8e\u5e73\u65b9\u7684\u539f\u56e0\uff0c$f(-x) = f(x)$\uff0c\u4e0d\u96be\u63a8\u6d4b $f(x) = \\\\lvert x \\\\rvert$\u3002<br/>\u96be\u7684\u662f\u5982\u4f55\u8bc1\u660e\u731c\u51fa\u6765\u7684\u7ed3\u8bba\u3002\u9996\u5148\u65e0\u8bba $k$ \u8d8b\u5411\u4e8e\u6b63\u65e0\u7a77\u8fd8\u662f\u8d1f\u65e0\u7a77\uff0c\u7ea7\u6570\u603b\u662f\u6536\u655b\u7684\uff0c\u6545\u5bf9\u4e8e\u6240\u6709\u7684 $x$\uff0c$f(x)$ \u603b\u5b58\u5728\u3002\u7531\u4e8e $f(-x) = f(x)$\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u53ea\u7528\u8003\u8651 $x \\\\geqslant 0$ \u7684\u60c5\u51b5\u3002\u53e6\u5916\u53ef\u4ee5\u6ce8\u610f\u5230 $f(2x) = 2f(x)$\u3002\u4ee4 $f(x) = l (x) + r(x)$\uff0c\u5c06 $f(x)$ \u4e2d $k \\\\leqslant 0$ \u7684\u9879\u653e\u5165 $l(x)$ \u4e2d\uff0c\u5176\u4f59\u7684\u653e\u5165 $r(x)$ \u4e2d\uff0c\u5206\u5f00\u5904\u7406\u8fd9\u4e24\u90e8\u5206\u3002<br/>\u5bf9\u4e8e $l(x)$\uff0c\u7531\u4e8e $1/2^k$ \u5f53 $k \\\\leqslant 0$ \u65f6\u5747\u4e3a\u6574\u6570\uff0c\u6240\u4ee5 $\\\\lVert x / 2^k \\\\rVert = \\\\lVert (x + 1) /2^k \\\\rVert$\uff0c\u5373 $l(x + 1) = l(x)$\u3002\u56e0\u4e3a $\\\\lVert x \\\\rVert \\\\leqslant 1/2$\uff0c\u6240\u4ee5 $l(x) \\\\leqslant \\\\sum_{k = 0}^\\\\infty 2^k / 4 = 1/2$\u3002<br/>\u5bf9\u4e8e $r(x)$\uff0c$k > 0 \\\\Rightarrow 2^k \\\\geqslant 2$\uff0c$0 \\\\leqslant x < 1$ \u65f6\uff0c$\\\\lVert x / 2^k \\\\rVert$ \u548c $\\\\dis{(x+1)/2^k}$ \u90fd\u53ef\u4ee5\u7b80\u5355\u5730\u5316\u7b80\u51fa\u6765\u3002\u6b64\u65f6 $r(x) = \\\\sum_{k=1}^\\\\infty x^2/2^k = x^2 < 1$\uff0c\u800c $r(x + 1) = (1-x)^2/2 + \\\\sum_{k=2}^\\\\infty (x+1)^2/2^k = x^2 + 1$\u3002\u5373 $r(x + 1) = r(x) + 1$\u3002\u7efc\u4e0a\uff0c\u5f53 $0 \\\\leqslant x < 1$ \u65f6 $f(x + 1) = f(x) + 1$\u3002<br/>\u662f\u5426\u6709\u66f4\u4e00\u822c\u7684\u7ed3\u8bba\u5462\uff1f\u5bf9\u4e8e\u4efb\u610f\u81ea\u7136\u6570 $n$\uff0c$f(x + n) = f(x) + n$ \u80fd\u5426\u88ab\u8bc1\u660e\uff1f\u8003\u8651\u5230 $f(2x) = 2f(x)$\uff0c\u56e0\u6b64\u5c1d\u8bd5\u5c06 $n$ \u8bbe\u4e3a $2^mq + r$ \u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $m \\\\geqslant 1$\uff0c$r$ \u4e3a $0$ \u6216 $1$ \u4ece\u800c\u4f7f\u5f97 $m$ \u7684\u6761\u4ef6\u53ef\u4ee5\u6ee1\u8db3\u3002\u5bf9 $n$ \u4f7f\u7528\u5f52\u7eb3\u6cd5\uff0c\u5f53 $n = 0,\\\\ 1$ \u65f6\u663e\u7136\uff0c\u4e4b\u540e $f(x + n) = 2^mf((x+r)/2^m + q)$\uff0c\u7531\u4e8e $q < n$ \u4e14 $x + r < 2 \\\\leqslant 2^m$ \u6839\u636e\u5f52\u7eb3\u5047\u8bbe\uff0c\u4e4b\u524d\u7684\u5f0f\u5b50\u7b49\u4e8e $2^mf((x+r)/2^m) + 2^mq = f(x + r) + n - r = f(x) + n$\u3002<br/>\u6839\u636e\u4ee5\u4e0a\u7ed3\u8bba\uff0c\u518d\u7ed3\u5408 $f(0) = 0$\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u4efb\u610f\u6574\u6570 $n$\uff0c$f(n) = \\\\lvert n \\\\rvert$\u3002\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u975e\u5e38\u5de7\u5999\u7684\u5229\u7528\u4e86\u5939\u903c\u539f\u7406\uff1a\u8fd8\u662f\u5047\u8bbe $x \\\\geqslant 0$\uff0c\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570 $m$\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f(x) & = 2^{-m}f(2^mx) \\\\\\\\<br/>& = 2^{-m}\\\\dw{2^mx} + 2^{-m}f(\\\\{2^mx\\\\})<br/>\\\\end{aligned}<br/>$$<br/>\u73b0\u5728\u662f\u65f6\u5019\u6765\u8bc1\u660e\u6211\u4eec\u7684\u731c\u60f3\u4e86\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>0 \\\\leqslant \\\\lvert f(x) - x \\\\rvert & = \\\\lvert 2^{-m}\\\\dw{2^mx} - x + 2^{-m}f(\\\\{2^mx\\\\}) \\\\rvert \\\\\\\\<br/>& \\\\leqslant 2^{-m}\\\\lvert \\\\dw{2^mx} - 2^mx \\\\rvert + 2^{-m}f(\\\\{2^mx\\\\}) \\\\\\\\<br/>& < 1\\\\cdot 2^{-m} + (1/2 + 1) \\\\cdot 2^{-m} = 5/2 \\\\times 2^{-m}<br/>\\\\end{aligned}<br/>$$<br/>\u5f53 $m$ \u8d8b\u8fd1\u4e8e\u65e0\u7a77\u5927\u65f6\uff0c\u53f3\u5f0f\u8d8b\u8fd1\u4e8e $0$\u3002\u56e0\u6b64\u4e0d\u96be\u5f97\u5230 $f(x) = \\\\lvert x \\\\rvert$ \u7684\u7ed3\u8bba\u3002<br/>2018.6.10<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u5df2\u77e5 $0 \\\\leqslant a < 1$\uff0c$b \\\\geqslant 0$\uff0c\u627e\u51fa\u5173\u4e8e $a$ \u548c $b$ \u7684\u5145\u8981\u6761\u4ef6\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u6839\u636e\u591a\u91cd\u96c6\u5408 $S(a,\\\\ b)$\uff1a<br/>$$<br/>S(a,\\\\ b) = \\\\{\\\\dw{na} + \\\\dw{nb}:\\\\ n \\\\in \\\\mathbf{N}^+\\\\}<br/>$$<br/>\u552f\u4e00\u786e\u5b9a $a$ \u548c $b$ \u7684\u503c\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u5173\u952e\u7684\u4e00\u4e2a\u5904\u7406\u6b65\u9aa4\u5c31\u662f\u4ee4 $\\\\newcommand{fa}[1]{\\\\{ #1 \\\\}}b = \\\\dw{b} + \\\\fa{b}$\u3002\u8003\u8651\u5230 $\\\\dw{b}$ \u662f\u6574\u6570\uff0c\u4e14 $0 \\\\leqslant \\\\fa{b} < 1$\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u505a\u51fa\u4ee5\u4e0b\u8f6c\u5316\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\dw{na} + \\\\dw{nb} & = \\\\dw{na} + \\\\dw{n\\\\dw{b} + n\\\\fa{b}} \\\\\\\\<br/>& = \\\\dw{n(a + \\\\dw{b})} + \\\\dw{n\\\\fa{b}}<br/>\\\\end{aligned}<br/>$$<br/>\u6362\u53e5\u8bdd\u8bb2\uff0c$S(a,\\\\ b) = S(\\\\fa{b},\\\\ a + \\\\dw{b})$\u3002\u56e0\u6b64\u53ef\u4ee5\u5f97\u51fa\u5176\u5fc5\u8981\u6761\u4ef6\u4e3a $a = \\\\fa{b}$\u3002<br/>\u5f97\u5230\u8fd9\u4e2a\u540e\u8bc1\u660e\u5b83\u540c\u65f6\u4e5f\u662f\u5145\u5206\u6761\u4ef6\u4e5f\u5c31\u4e0d\u96be\u4e86\u3002\u4ee4 $n = 1$\uff0c\u53ef\u4ee5\u5f97\u5230 $\\\\dw{b}$\u3002\u4e4b\u540e\u5c06\u6240\u6709\u7684 $n\\\\dw{b}$ \u4ece $S(a,\\\\ b)$ \u4e2d\u51cf\u53bb\uff0c\u5f97\u5230 $S(a,\\\\ \\\\fa{b})$\u3002\u7531\u4e8e $a = \\\\fa{b}$\uff0c\u6240\u4ee5\u5c06 $S(a,\\\\ \\\\fa{b})$ \u4e2d\u6bcf\u4e2a\u5143\u7d20\u9664\u4ee5 $2$ \u5c31\u662f $\\\\{\\\\dw{na}:\\\\ n \\\\in \\\\mathbf{N}^+\\\\}$\uff0c\u7531\u6b64\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a $a$\u3002<br/>2018.11.16<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u5df2\u77e5\u5b9e\u6570\u57df\u4e0a\u7684 Thomae Function $f(x)$ \u4e3a\uff1a<br/>$$<br/>f(x) = \\\\begin{cases}<br/>1/p & x \\\\in \\\\mathbf Q,\\\\ x = q/p,\\\\ p \\\\in \\\\mathbf N^+,\\\\ q \\\\in \\\\mathbf Z \\\\\\\\<br/>0 & x \\\\in \\\\mathbf R \\\\backslash \\\\mathbf Q<br/>\\\\end{cases}<br/>$$<br/>\u8bc1\u660e\uff1a$f(x)$ \u5904\u5904\u4e0d\u53ef\u5fae\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u5bf9\u4e8e\u4e00\u5143\u51fd\u6570\uff0c\u53ef\u5bfc\u548c\u53ef\u5fae\u662f\u7b49\u4ef7\u7684\u3002\u7531\u4e8e\u8fd9\u4e2a\u51fd\u6570\u5728\u6709\u7406\u70b9\u4e0d\u8fde\u7eed1\uff0c\u6545\u53ea\u9700\u8981\u8003\u8651\u5bf9\u4e8e\u65e0\u7406\u6570 $a$\uff0c\u4e0b\u9762\u8fd9\u4e2a\u6781\u9650\uff1a<br/>$$<br/>\\\\lim_{x\\\\rightarrow a} {f(x) - f(a) \\\\over x - a} \\\\xlongequal{a \\\\text{ irrational}} \\\\lim_{x \\\\rightarrow a} {f(x) \\\\over x - a}<br/>$$<br/>\u662f\u5426\u5b58\u5728\u3002\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u5047\u5b9a $a \\\\geqslant 0$\uff0c\u5c0f\u4e8e $0$ \u7684\u60c5\u51b5\u7684\u8ba8\u8bba\u662f\u7c7b\u4f3c\u7684\u3002\u7a0d\u4f5c\u5c1d\u8bd5\u4f30\u8ba1\u90fd\u4f1a\u89c9\u5f97\u4e0d\u5b58\u5728\u3002\u9996\u5148\uff0c\u5bf9\u4e8e\u8d8b\u8fd1\u4e8e $a$ \u7684\u65e0\u7406\u6570\u5217 $\\\\{x_n\\\\}$\uff0c\u663e\u7136\uff1a<br/>$$<br/>\\\\lim {f(x_n) \\\\over x_n - a} = 0<br/>$$<br/>\u4e3a\u4e86\u8bc1\u660e\u6781\u9650\u4e0d\u5b58\u5728\uff0c\u6211\u4eec\u9700\u8981\u518d\u6784\u9020\u4e00\u4e2a\u8d8b\u8fd1\u4e8e $a$ \u7684\u5b9e\u6570\u5217 $\\\\{y_n\\\\}$\uff0c\u4f7f\u5f97\u7c7b\u4f3c\u7684\u6781\u9650\u4e0d\u4e3a $0$\u3002\u8003\u8651\u6784\u9020\u4e00\u4e2a\u6709\u7406\u6570\u5217\uff1f\u9996\u5148\uff0c\u6240\u8c13\u8d8b\u8fd1\u4e8e $a$ \u5c31\u662f\u5bf9\u4efb\u610f\u5c0f\u7684 $\\\\varepsilon > 0$\uff0c\u4ece\u67d0\u4e00\u9879\u5f00\u59cb\u90fd\u6709 $|y_n - a| < \\\\varepsilon$\u3002\u8bbe $y_n = q/p > a $\uff0c\u90a3\u4e48\u4e0a\u9762\u8fd9\u4e2a\u6781\u9650\u5c31\u53ef\u4ee5\u5199\u6210\uff1a<br/>$$<br/>\\\\lim {1/p \\\\over q/p - a}<br/>$$<br/>\u5982\u679c $0 < q/p - a \\\\leqslant 1/p$\uff0c\u90a3\u4e48\u82e5\u5176\u6709\u6781\u9650\uff0c\u5219\u6781\u9650\u81f3\u5c11\u4e0d\u5c0f\u4e8e $1$\uff0c\u6211\u4eec\u7684\u76ee\u7684\u5c31\u8fbe\u6210\u4e86\u3002\u800c\u6211\u4eec\u603b\u80fd\u627e\u5230\u8fd9\u6837\u7684 $p$\uff0c\u6ee1\u8db3 $1/p < \\\\varepsilon$\u3002\u540c\u65f6\uff0c$q$ \u53ea\u9700\u8981\u6ee1\u8db3 $ap < q \\\\leqslant ap + 1$\u3002\u8fd9\u6837\u4ee4 $q = \\\\lceil ap \\\\rceil$ \u5c31 OK \u4e86\u3002\u4e8e\u662f\u6211\u4eec\u5c31\u6784\u9020\u51fa\u4e86\u8fd9\u6837\u7684\u6709\u7406\u6570\u5217\u3002\u6240\u4ee5 $f(x)$ \u5904\u5904\u4e0d\u53ef\u5bfc\uff0c\u540c\u65f6\u4e5f\u5904\u5904\u4e0d\u53ef\u5fae\u3002<br/><br/><br/><br/><br/>\u8bc1\u660e\u53ef\u4ee5\u67e5\u770b Wikipedia\uff1ahttps://en.wikipedia.org/wiki/Thomae% 27s_function#Properties \u201c$f$ is discontinuous at all rational numbers, dense within the real numbers\u201d\u3002\u867d\u7136\u8fd9\u4e2a\u547d\u9898 Wikipedia \u4e0a\u4e5f\u8bc1\u660e\u4e86\uff0c\u4f46\u662f\u8fd9\u91cc\u7a0d\u5fae\u521d\u7b49\u4e00\u4e9b\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-12-16/math-problems.html"
},
"\u65e0\u5411\u56fe\u6700\u5c0f\u5272": {
"tags": "\u6700\u5c0f\u5272 \u7f51\u7edc\u6d41 \u56fe\u8bba \u7ec4\u5408\u4f18\u5316",
"text": "\u65e0\u5411\u56fe\u6700\u5c0f\u5272<br/>\u57fa\u672c\u5b9a\u4e49<br/>\u5bf9\u4e8e\u4e00\u5f20\u65e0\u5411\u5e26\u6743\u56fe$G = (V, E, w)$\uff0c\u5c06\u70b9\u96c6$V$\u5206\u4e3a\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408$S$\u548c$T$\uff0c\u6ee1\u8db3$S \\\\cup T = V$\uff0c\u90a3\u4e48\u79f0$C = (S, T)$\u662f\u56fe$G$\u7684\u4e00\u4e2a\u5272\u3002\u5272\u7684\u6743\u503c\u5b9a\u4e49\u4e3a\u4e24\u4e2a\u7aef\u70b9\u4e0d\u5728\u540c\u4e00\u96c6\u5408\u5185\u7684\u8fb9\u7684\u6743\u503c\u4e4b\u548c\uff0c\u8bb0\u505a$W(C)$\uff1a<br/>$$<br/>W(C) = \\\\sum_{u \\\\in S, v \\\\in T, (u, v) \\\\in E} w(u, v)<br/>\\\\tag{1.1}<br/>$$<br/>\u5bf9\u4e8e\u6307\u5b9a\u7684$s$\u548c$t$\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u5272$C = (S, T)$\u6ee1\u8db3$s \\\\in S, t \\\\in T$\u6216\u8005$s \\\\in T, t \\\\in S$\uff0c\u90a3\u4e48\u79f0\u8fd9\u4e2a\u5272\u4e3a$s$-$t$\u5272\u3002<br/>\u5bf9\u4e8e\u4e00\u5f20\u56fe\uff0c\u6743\u503c\u6700\u5c0f\u7684\u5272\u79f0\u4e3a\u6700\u5c0f\u5272\u3002\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6700\u5c0f\u5272\u4e0d\u662f\u552f\u4e00\u7684\u3002<br/>\u4f8b\u5982\uff0c\u5728\u4e0b\u56fe\u4e2d\uff1a<br/><br/>$(\\\\{2\\\\}, \\\\{1,3,4,5,6\\\\})$\u548c$(\\\\{4\\\\}, \\\\{1,2,3,5,6\\\\})$\u5747\u662f\u6700\u5c0f\u5272\uff0c\u5176\u6743\u503c\u4e3a$3$\u3002\u800c$(\\\\{1,2,3\\\\}, \\\\{4,5,6\\\\})$\u662f\u4e00\u4e2a$1$-$6$\u6700\u5c0f\u5272\uff0c\u5176\u6743\u503c\u4e3a$51$\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5bf9\u4e8e\u4efb\u610f\u7684\u4e0d\u76f8\u4ea4\u96c6\u5408$U$\u3001$V$\uff0c\u8981\u6c42$U \\\\cup V \\\\subseteq V$\uff0c\u5b9a\u4e49\u5b83\u4eec\u4e4b\u95f4\u7684\u6743\u503c\u4e3a\uff1a<br/>$$<br/>W(U, V) = \\\\sum_{u \\\\in U, v \\\\in V, (u, v) \\\\in E} w(u, v)<br/>\\\\tag{1.2}<br/>$$<br/>\u6362\u8a00\u4e4b\u3002\u6743\u503c\u662f\u6a2a\u8de8$U$\u548c$V$\u7684\u8fb9\u7684\u6743\u503c\u4e4b\u548c\u3002<br/>\u73b0\u5728\u6765\u8003\u8651\u4e00\u4e2a\u6bd4\u8f83\u6d45\u663e\u7684\u5b9a\u7406\uff1a<br/><br/>\u5bf9\u4e8e\u4efb\u610f\u56db\u4e2a\u4e0d\u76f8\u4ea4\u96c6\u5408$S_1$\u3001$T_1$\u3001$S_2$\u548c$T_2$\uff0c\u6ee1\u8db3$S_1 \\\\cup T_1 \\\\cup S_2 \\\\cup T_2 \\\\subseteq V$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709\uff1a<br/>$$ W(S_1, T_1) + W(S_2, T_2) \\\\leqslant W(S_1 \\\\cup S_2, T_1 \\\\cup T_2) \\\\tag{1.3}$$<br/><br/>\u8bc1\u660e\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>& W(S_1 \\\\cup S_2, T_1 \\\\cup T_2) = W(S_1, T_1) + W(S_1, T_2) + W(S_2, T_1) + W(S_2, T_2) \\\\\\\\<br/>& \\\\because W(S_1, T_2), W(S_2, T_1) \\\\geqslant 0\\\\\\\\<br/>& \\\\therefore W(S_1 \\\\cup S_2, T_1 \\\\cup T_2) \\\\geqslant W(S_1, T_1) + W(S_2, T_2)<br/>\\\\end{aligned}<br/>$$<br/>\u6c42\u89e3$s$-$t$\u6700\u5c0f\u5272<br/>\u5229\u7528\u6700\u5927\u6d41\u6700\u5c0f\u5272\u5b9a\u7406\uff0c\u4e00\u4e2a\u56fe\u7684$s$-$t$\u6700\u5c0f\u5272\u5b9e\u9645\u4e0a\u5c31\u662f\u5c06\u539f\u56fe\u5efa\u6210\u4e00\u4e2a\u6e90\u70b9\u4e3a$s$\uff0c\u6c47\u70b9\u4e3a$t$\u7684\u7f51\u7edc\u4e0a\u7684\u6700\u5927\u6d41\uff0c\u56e0\u6b64\u53ef\u4ee5\u91c7\u7528\u5404\u79cd\u6700\u5927\u6d41\u7b97\u6cd5\u6765\u89e3\u51b3\u3002\u8fd9\u91cc\u4e0d\u518d\u8be6\u7ec6\u4ecb\u7ecd\u3002<br/>\u6c42\u89e3\u5168\u5c40\u6700\u5c0f\u5272<br/>\u6240\u8c13\u5168\u5c40\u6700\u5c0f\u5272\u5c31\u662f\u65e0\u5411\u56fe\u672c\u8eab\u7684\u6700\u5c0f\u5272\uff0c\u6ca1\u6709\u9650\u5b9a$s$\u548c$t$\u3002\u8003\u8651\u5230\u4e00\u4e2a$s$-$t$\u6700\u5c0f\u5272\u53ef\u80fd\u6210\u4e3a\u5168\u5c40\u6700\u5c0f\u5272\uff0c\u6240\u4ee5\u53ef\u4ee5\u60f3\u51fa\u4ee5\u4e0b\u7684\u8fc7\u7a0b\uff1a<br/><br/><br/>\u4ee4$i = 1, w_0 = \\\\infty$\u3002<br/>\u5982\u679c$|V| \\\\leqslant 1$\uff0c\u8fd4\u56de$\\\\min\\\\{w_0, w_1, \\\\dots, w_{n - 1}\\\\}$\u3002<br/>\u968f\u4fbf\u9009\u5b9a\u4e24\u4e2a\u70b9$s$\u548c$t$\uff0c\u6c42\u51fa\u5176$s$-$t$\u6700\u5c0f\u5272\uff0c\u8bb0\u6743\u503c\u4e3a$w_i$\u3002<br/>\u5c06$s$\u548c$t$\u5408\u5e76\uff0c\u5373\u5c06$E$\u4e2d\u7684\u6bcf\u6761\u8fb9\u7684$t$\u6539\u6210$s$\uff0c\u5e76\u4ece$V$\u4e2d\u5220\u53bb$t$\u3002<br/>$i = i + 1$\uff0c\u8df3\u56de\u7b2c\u4e8c\u6b65\u3002<br/><br/><br/>\u8fd9\u6837\u505a\u7684\u7406\u7531\u662f\uff1a\u5047\u8bbe\u5168\u5c40\u6700\u5c0f\u5272\u4e3a$(S, T)$\uff0c\u90a3\u4e48\u5206\u4e24\u79cd\u60c5\u51b5\uff1a<br/><br/>\u5982\u679c$s$\u548c$t$\u5206\u522b\u5728$S$\u548c$T$\u4e2d\uff0c\u90a3\u4e48$s$-$t$\u7684\u6700\u5c0f\u5272\u5c31\u662f\u5168\u5c40\u6700\u5c0f\u5272\u3002<br/>\u5982\u679c$s$\u548c$t$\u540c\u5728$S$\u6216$T$\u5185\uff0c\u90a3\u4e48\u5c06$s$\u548c$t$\u5408\u5e76\u4e3a\u4e00\u4e2a\u70b9\u540e\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5272\u7684\u6743\u503c\u3002<br/><br/>\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5728$\\\\Theta(n)$\u6b21\u7f51\u7edc\u6d41\u5185\u6c42\u51fa\u6700\u5c0f\u5272\u3002\u4f46\u662f\u7531\u4e8e\u7f51\u7edc\u6d41\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u6bd4\u8f83\u9ad8\uff0c\u6240\u4ee5\u8fd9\u5e76\u4e0d\u662f\u4e00\u4e2a\u5f88\u4f18\u7684\u8fc7\u7a0b\u3002<br/>\u8003\u8651\u5230\u5728\u7b2c\u4e09\u6b65\u4e2d\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u5e76\u4e0d\u5173\u5fc3$s$\u548c$t$\u662f\u8c01\uff0c\u6211\u4eec\u53ea\u5728\u610f\u5f97\u5230\u4e00\u4e2a$s$-$t$\u6700\u5c0f\u5272\u3002\u90a3\u4e48\u662f\u4e0d\u662f\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u66f4\u52a0\u9ad8\u6548\u7684\u65b9\u6cd5\u6765\u6c42\u51fa\u4efb\u610f\u4e00\u4e2a$s$-$t$\u6700\u5c0f\u5272\u5462\uff1f<br/>\u73b0\u5728\u6765\u8003\u8651\u4ee5\u4e0b\u8fd9\u4e2a\u7b97\u6cd5\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19function ST-MINCUT(G):<br/>    assert |V| > 1<br/><br/>    A = {}<br/>    B = V<br/>    s = 0<br/>    t = 0<br/>    while |B| > 0:<br/>        p = 0<br/>        for u in B:<br/>            if W(A, {u}) > W(A, {p}):  // Assume that W(A, 0) = 0<br/>                p = u<br/><br/>        A = A \u222a p<br/>        B = B - {p}<br/>        s = t<br/>        t = p<br/><br/>    return (s, t)<br/><br/><br/>\u8be5\u7b97\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4e8c\u5143\u7ec4$(s, t)$\uff0c\u8868\u793a$(V - {t}, {t})$\u662f\u4e00\u4e2a$s$-$t$\u6700\u5c0f\u5272\u3002<br/>\u4e0b\u9762\u6211\u4eec\u5c06\u8bc1\u660e\u8fd9\u662f\u5bf9\u7684\uff1a<br/><br/>\u8bbe$s$\u548c$t$\u4e3aST-MINCUT\u4e2d$A$\u96c6\u5408\u5012\u6570\u7b2c\u4e8c\u4e2a\u52a0\u5165\u7684\u70b9\u548c\u6700\u540e\u52a0\u5165\u7684\u70b9\uff0c\u90a3\u4e48$(V - \\\\{t\\\\}, \\\\{t\\\\})$\u662f\u4e00\u4e2a$s$-$t$\u6700\u5c0f\u5272\u3002<br/><br/>\u8bc1\u660e1\uff1a<br/>\u6211\u4eec\u4ee4$S^\\\\prime = V - \\\\{t\\\\}$\u3001$T^\\\\prime = \\\\{t\\\\}$\u3002\u5bf9\u4e8e\u56fe\u4e2d\u4efb\u610f\u4e00\u4e2a$s$-$t$\u5272$C = (S, T)$\uff0c\u5047\u8bbe$t \\\\in T$\u5e76\u4e14$s \\\\in S$\u3002\u8bbe$t^\\\\prime = v_i$\u4e3a$T$\u4e2d\u9664\u4e86$t$\u4e4b\u5916\u6700\u540e\u88ab\u52a0\u5165$A$\u7684\u70b9\u3002\u4ee4$V_i = \\\\{v_1, v_2, \\\\dots, v_i\\\\}$\u3002\u6b64\u5916\u6211\u4eec\u6ce8\u610f\u5230$V_i$\u5b9e\u9645\u4e0a\u662fST-MINCUT\u7b97\u6cd5\u5728$G$\u5173\u4e8e$V_i$\u7684\u5bfc\u51fa\u5b50\u56fe\u4e0a\u7684\u8fd0\u884c\u7ed3\u679c\u3002<br/>\u8fd9\u51e0\u4e2a\u96c6\u5408\u5185\u7684\u70b9\u7684\u4e00\u79cd\u53ef\u80fd\u5982\u4e0b\u8868\u6240\u793a\uff1a<br/>$$<br/>\\\\begin{matrix}<br/>S        & = &     & v_2 &          & \\\\dots  & s &   \\\\\\\\<br/>T        & = & v_1 &     & t^\\\\prime &        &   & t \\\\\\\\<br/>S^\\\\prime & = & v_1 & v_2 & v_3      & \\\\dots  & s &   \\\\\\\\<br/>T^\\\\prime & = &     &     &          &        &   & t \\\\\\\\<br/>\\\\end{matrix}<br/>$$<br/>\u8fdb\u884c\u5f52\u7eb3\u5047\u8bbe\uff0c\u5bf9\u4e8e$|V| = 2$\u7684\u56fe\uff0c\u4ee5\u4e0a\u7ed3\u8bba\u663e\u7136\u6210\u7acb\u3002\u73b0\u5728\u5047\u8bbe\u5bf9\u4e8e$|V| \\\\lt n$\u7684\u56fe\u5747\u6ee1\u8db3\uff0c\u5c1d\u8bd5\u8bc1\u660e\u5bf9\u4e8e$|V| = n$\u7684\u56fe\u4e5f\u6ee1\u8db3\u3002<br/>\u73b0\u5728\u6211\u4eec\u8981\u8bc1\u660e$W(S^\\\\prime, T^\\\\prime) \\\\leqslant W(S, T)$\uff0c\u5c31\u53ef\u4ee5\u5f97\u51fa\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u3002\u9996\u5148\u6ce8\u610f\u5230\uff1a<br/>$$<br/>W(S, T) \\\\geqslant W(V_i \\\\cap S, V_i \\\\cap T) + W(V_{n - 1} - V_{i - 1}, \\\\{t\\\\})<br/>\\\\tag{3.1}<br/>$$<br/>\u4ee5\u53ca\uff1a<br/>$$<br/>W(S^\\\\prime, T^\\\\prime) = W(V_{i - 1}, \\\\{t\\\\}) + W(V_{n - 1} - V_{i - 1}, \\\\{t\\\\})<br/>\\\\tag{3.2}<br/>$$<br/>\u6839\u636e\u5f52\u7eb3\u5047\u8bbe\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>W(V_{i - 1}, \\\\{t^\\\\prime\\\\}) \\\\leqslant W(V_i \\\\cap S, V_i \\\\cap T)<br/>\\\\tag{3.3}<br/>$$<br/>\u8003\u8651\u5230\u7b97\u6cd5\u7684$A$\u53d8\u4e3a$V_{i - 1}$\u65f6\uff0c\u9009\u62e9\u4e86$t^\\\\prime$\u800c\u4e0d\u662f$t$\u52a0\u5165$A$\u96c6\u5408\uff0c\u90a3\u4e48\u8bf4\u660e\uff1a<br/>$$<br/>W(V_{i - 1}, \\\\{t\\\\}) \\\\leqslant W(V_{i - 1}, \\\\{t^\\\\prime\\\\}) \\\\leqslant W(V_i \\\\cap S, V_i \\\\cap T)<br/>\\\\tag{3.4}<br/>$$<br/>\u7efc\u4e0a\u53ef\u77e5\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>W(S^\\\\prime, T^\\\\prime) & = W(V_{i - 1}, \\\\{t\\\\}) + W(V_{n - 1} - V_{i - 1}, \\\\{t\\\\}) \\\\\\\\<br/>& \\\\leqslant W(V_i \\\\cap S, V_i \\\\cap T) + W(V_{n - 1} - V_{i - 1}, \\\\{t\\\\}) \\\\\\\\<br/>& \\\\leqslant W(S, T)<br/>\\\\end{aligned}<br/>$$<br/>\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6267\u884c$\\\\Theta(n)$\u6b21ST-MINCUT\u7b97\u6cd5\u6765\u627e\u51fa\u5168\u5c40\u6700\u5c0f\u5272\u3002ST-MINCUT\u7684\u76f4\u63a5\u5b9e\u73b0\u662f$\\\\Theta(n^2)$\u7684\uff0c\u5982\u679c\u4f7f\u7528\u4e8c\u53c9\u5806\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u6765\u5b9e\u73b0\uff0c\u90a3\u4e48\u53ef\u4ee5\u505a\u5230$\\\\Theta((n + m) \\\\log n)$\u7684\u590d\u6742\u5ea6\u3002\u8fd9\u4e2a\u7b97\u6cd5\u5c31\u662fStoer-Wanger\u7b97\u6cd5\u3002<br/><br/><br/><br/><br/>\u8fd9\u4e2a\u8bc1\u660e\u662f\u539f\u8bba\u6587\u4e2d\u7684\u8bc1\u660e\u65b9\u5f0f\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u5176\u4e2d\u6709\u4e00\u4e9b\u4e0d\u59a5\u4e4b\u5904\uff0c\u56e0\u4e3a\u5728\u6700\u540e\u4e00\u6b65\u65f6\uff0c\u597d\u50cf\u5ffd\u7565\u4e86$w(t^\\\\prime, t)$\uff0c\u5bfc\u81f4\u4e0d\u7b49\u5f0f\u4f1a\u4e0d\u6210\u7acb\u3002\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u4e2a\u4eba\u7684\u7406\u89e3\u4e0a\u7684\u504f\u5dee\u8fd8\u662f\u786e\u5b9e\u6709\u8bef\uff0c\u5982\u679c\u6709\u770b\u8fc7\u539f\u8bc1\u660e\u7684\u5927\u795e\u5e0c\u671b\u80fd\u6307\u70b9\u6211\u4e00\u4e0b\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-2-12/mincut.html"
},
"\u65e0\u5c3d\u7684\u9ec4\u91d1": {
"tags": "Problems",
"text": "\u65e0\u5c3d\u7684\u9ec4\u91d1 (gold.cpp/in/out)<br/>\u65f6\u95f4\u9650\u5236\uff1a3s / \u7a7a\u95f4\u9650\u5236\uff1a512MB / \u6253\u5f00-O2\u4f18\u5316<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u63a2\u9669\u5bb6Lunk\u53d1\u73b0\u4e86\u4e00\u4e2a\u85cf\u5728\u5927\u5c71\u6df1\u5904\u7684\u6d1e\u7a74\u3002\u7ecf\u8fc7\u4e94\u5929\u4e94\u591c\u7684\u63a2\u7d22\uff0cLunk\u5728\u6d1e\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u975e\u5e38\u795e\u5947\u7684\u5730\u65b9\u3002\u8fd9\u91cc\u6709\u4e00\u4e2a\u4e0d\u65ad\u751f\u6210\u9ec4\u91d1\u7684\u5c0f\u53e3\uff0c\u6bcf\u5206\u949f\u53ef\u4ee5\u53d6\u51fa\u4e00\u4e2a\u9ec4\u91d1\uff0c\u4e0d\u7136\u8fd9\u4e2a\u9ec4\u91d1\u5c31\u4f1a\u9a6c\u4e0a\u6d88\u5931\u3002\u53d6\u51fa\u7684\u9ec4\u91d1\u81ea\u7136\u4f1a\u53d8\u6210Lunk\u7684\u4e86\u3002\u8d2a\u5a6a\u7684\u8d44\u672c\u5bb6\u7edd\u5bf9\u4e0d\u4f1a\u9519\u8fc7\u8fd9\u4e2a\u53d1\u8d22\u7684\u5927\u597d\u65f6\u673a\uff0cLunk\u60f3\u8981\u53d6\u8d70\u5927\u91cf\u7684\u9ec4\u91d1\u3002<br/>\u7136\u800c\u5728\u8fd9\u65c1\u8fb9\u5374\u7acb\u7740\u4e00\u4e2a\u724c\u5b50\uff0c\u4e0a\u9762\u5199\u7740\uff1a<br/><br/>Hello, Lunk,<br/>\u606d\u559c\u4f60\uff0c\u4f60\u975e\u5e38\u673a\u667a\u5730\u53d1\u73b0\u4e86\u8fd9\u4e2a\u5947\u5999\u7684\u5730\u65b9\uff0c\u6211\u65e9\u5df2\u77e5\u9053\u4f60\u5230\u5e95\u60f3\u5e72\u4ec0\u4e48\u3002\u4e0d\u5982\u6211\u4eec\u6765\u73a9\u4e2a\u6e38\u620f\uff0c\u4f60\u53ef\u968f\u610f\u53d6\u8d70\u9ec4\u91d1\uff0c\u4f46\u662f\u4efb\u610f\u8fde\u7eed\u7684$K$\u5206\u949f\u5185\uff0c\u4f60\u4e0d\u53ef\u4ee5\u53d6\u8d70\u8fc7\u591a\u7684\u9ec4\u91d1\uff0c\u5426\u5219\uff0c\u4f60\u5c06\u627e\u4e0d\u5230\u51fa\u53bb\u7684\u8def\u3002<br/>Best wishes<br/>\u2014\u2014XL<br/><br/>\u8fd9\u8ba9Lunk\u611f\u5230\u5341\u5206\u5bb3\u6015\uff0c\u5b83\u62c5\u5fc3\u81ea\u5df1\u4e00\u4e0d\u7559\u795e\u5c31\u4f1a\u89e6\u72af\u7684\u8fd9\u4e2a\u53ef\u6015\u7684\u89c4\u5219\u3002\u4f46\u662f\u8d2a\u5a6a\u7684\u8d44\u672c\u5bb6\u662f\u4e0d\u4f1a\u653e\u5f03\u7684\uff0cLunk\u60f3\u77e5\u9053\u7a76\u7adf\u6709\u591a\u5c11\u79cd\u53d6\u8d70\u9ec4\u91d1\u7684\u65b9\u6cd5\uff08\u53ef\u4ee5\u5168\u90fd\u4e0d\u53d6\uff09\uff0c\u4f7f\u5f97\u81ea\u5df1\u4e0d\u4f1a\u846c\u8eab\u4e8e\u5c71\u6d1e\u4e4b\u4e2d\u3002<br/>Lunk\u73b0\u5728\u8fd8\u6709\u4e00\u4e9b\u65f6\u95f4\uff0c\u5e0c\u671b\u4f60\u80fd\u591f\u5feb\u901f\u7ed9\u51fa\u7b54\u6848\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6bcf\u4e2a\u6570\u636e\u4ec5\u4e00\u884c\uff0c\u5305\u542b\u4e09\u4e2a\u6574\u6570$T$\uff0c$K$\u548c$C$\u3002<br/>$T$\u8868\u793aLunk\u8fd8\u5269\u4e0b\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u5206\u949f\u3002<br/>$K$\u548c$C$\u8868\u793aLunk\u5728\u4efb\u610f\u8fde\u7eed\u7684$K$\u5206\u949f\u5185\u53ef\u4ee5\u53d6\u8d70\u5c11\u4e8e$C$\u4e2a\u9ec4\u91d1\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793aLunk\u53d6\u8d70\u9ec4\u91d1\u7684\u65b9\u6848\u6570\u3002\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u975e\u5e38\u5927\uff0c\u6240\u4ee5\u8bf7\u5c06\u7b54\u6848\u5bf9$1073741824$\u53d6\u6a21\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>12 2 2<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>13<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca<br/>\u53ea\u8981Lunk\u4e0d\u628a\u6240\u6709\u9ec4\u91d1\u53d6\u8d70\u5c31\u597d\u4e86\uff0c\u5171\u6709\u4e09\u79cd\u53d6\u6cd5\u3002<br/>\u6570\u636e\u9650\u5236<br/>\u672c\u9898\u91c7\u7528\u6346\u7ed1\u6d4b\u8bd5\uff0c\u5171$6$\u4e2a\u5b50\u4efb\u52a1\u3002<br/>\u6bcf\u4e2a\u5b50\u4efb\u52a1\u548c\u6570\u636e\u70b9\u7ea6\u5b9a\u5982\u4e0b\uff1a<br/><br/><br/><br/>\u5b50\u4efb\u52a1 (\u5206\u503c)<br/>$T$\u7684\u9650\u5236<br/>$K$\u7684\u9650\u5236<br/>$C$\u7684\u9650\u5236<br/><br/><br/><br/><br/>$1$ ($10\\\\% $)<br/>$\\\\le 10^3$<br/>$= 2$<br/>$= 2$<br/><br/><br/>$2$ ($10\\\\% $)<br/>$\\\\le 10^3$<br/>$= 3$<br/>$= 2$<br/><br/><br/>$3$ ($10\\\\% $)<br/>$\\\\le 10^3$<br/>$\\\\le 9$<br/>$\\\\le K$<br/><br/><br/>$4$ ($20\\\\% $)<br/>$\\\\le 10^5$<br/>$\\\\le 9$<br/>$\\\\le K$<br/><br/><br/>$5$ ($20\\\\% $)<br/>$\\\\le 2 \\\\times 10^7$<br/>$\\\\le 6$<br/>$\\\\le K$<br/><br/><br/>$6$ ($30\\\\% $)<br/>$\\\\le 2 \\\\times 10^7$<br/>$\\\\le 9$<br/>$\\\\le K$<br/><br/><br/><br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c\u5747\u4fdd\u8bc1$1 \\\\le T \\\\le 2 \\\\times 10^7$\uff0c$1 \\\\le K \\\\le 9$\uff0c$0 \\\\le C \\\\le K$\u3002<br/>\u65f6\u95f4\u9650\u5236\uff1a$2\\\\text{s}$<br/>\u7a7a\u95f4\u9650\u5236\uff1a$512\\\\text{MB}$",
"url": "blog/2016-10-3/gold.html"
},
"\u66fc\u54c8\u987f\u8ddd\u79bb\u6700\u5c0f\u751f\u6210\u6811": {
"tags": "\u6700\u5c0f\u751f\u6210\u6811 \u8ba1\u7b97\u51e0\u4f55",
"text": "\u66fc\u54c8\u987f\u8ddd\u79bb\u6700\u5c0f\u751f\u6210\u6811<br/>\u95ee\u9898<br/>\u7ed9\u4f60\u5e73\u9762\u4e0a\u7684$n$\u4e2a\u70b9\uff0c$n$\u4e2a\u70b9\u4e4b\u95f4\u4e24\u4e24\u8fde\u8fb9\uff0c\u8fb9\u6743\u4e3a\u4e24\u70b9\u95f4\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u6784\u6210\u4e00\u5f20\u5b8c\u5168\u56fe\u3002\u6c42\u8fd9\u5f20\u5b8c\u5168\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u3002<br/>\u6734\u7d20\u7b97\u6cd5<br/>\u7531\u4e8e\u5b8c\u5168\u56fe\u7684\u8fb9\u6570\u662f$\\\\Theta(n^2)$\u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u4f7f\u7528\u7a00\u758f\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u7b97\u6cd5\u5c06\u4f1a\u5f97\u5230$\\\\Omega(n^2)$\u7ea7\u522b\u7684\u7b97\u6cd5\u3002\u8fd9\u662f\u6bd4\u8f83\u96be\u4ee5\u63a5\u53d7\u7684\u3002<br/>\u5e73\u9762\u5212\u5206<br/>\u9274\u4e8e\u5b8c\u5168\u56fe\u8fb9\u6570\u5341\u5206\u4e4b\u591a\uff0c\u7136\u800c\u751f\u6210\u6811\u4e0a\u7684\u8fb9\u5374\u53ea\u6709$n - 1$\u6761\uff0c\u662f\u4e0d\u662f\u771f\u6b63\u6709\u7528\u7684\u8fb9\u6570\u4e5f\u662f$O(n)$\u7ea7\u522b\u7684\uff1f<br/>\u4e8b\u5b9e\u4e0a\u786e\u5b9e\u5982\u6b64\uff0c\u5982\u679c\u6211\u4eec\u968f\u610f\u9009\u62e9\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u4e2d\u5fc3$O$\uff0c\u7528\u56db\u6761\u76f4\u7ebf\u5c06\u5e73\u9762\u5212\u4e3a\u516b\u4e2a\u5bf9\u79f0\u7684\u533a\u57df\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u4e0a\u56fe\u4e2d$R_1$\u5230$R_8$\u5c31\u662f\u88ab\u516b\u7b49\u5206\u51fa\u6765\u7684\u533a\u57df\u3002<br/>\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u8bc1\u660e\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u533a\u57df\uff0c\u53ea\u9700\u8981\u7559\u4e0b\u79bb$O$\u6700\u8fd1\u7684\u70b9\u7684\u8fde\u8fb9\uff0c\u6700\u540e\u5f62\u6210\u7684\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u5c31\u662f\u539f\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u3002<br/>\u5047\u8bbe\u73b0\u5728\u5728\u533a\u57df$R_1$\u6709\u4e24\u4e2a\u70b9$A$\u548c$B$\uff0c\u5e76\u4e14\u6ee1\u8db3$|OA| \\\\leqslant |OB|$\u3002\u90a3\u4e48\u6839\u636e\u6700\u5c0f\u751f\u6210\u6811\u7684\u73af\u5207\u6027\u8d281\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e$|OB| \\\\geqslant |AB|$\u5c31\u53ef\u4ee5\u4e86\u3002\u5728\u8fd9\u91cc\uff0c$|AB|$\u8868\u793a$A$\u5230$B$\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u3002<br/>\u8bbe$A(x_1, y_1)$\u548c$B(x_2, y_2)$\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651$4$\u79cd\u60c5\u51b5\uff1a<br/>\u60c5\u51b52\uff1a$x_1 \\\\leqslant x_2, \\\\;y_1 \\\\leqslant y_2$<br/><br/>\u6b64\u65f6\u6709\uff1a<br/>$$<br/>|AB| = x_2 - x_1 + y_2 - y_1 \\\\leqslant x_2 + y_2 = |OB|<br/>$$<br/>\u60c5\u51b52\uff1a$x_2 \\\\leqslant x_1, \\\\;y_1 \\\\leqslant y_2$<br/><br/>\u6b64\u65f6\u6709\uff1a<br/>$$<br/>|AB| = x_1 - x_2 + y_2 - y_1<br/>$$<br/>\u5982\u679c$|OB| \\\\geqslant |AB|$\uff0c\u90a3\u4e48\u4e5f\u5c31\u6709$|OB| - |AB| \\\\geqslant 0$\uff0c\u4e8e\u662f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>|OB| - |AB| & = x_2 + y_2 - x_1 + x_2 - y_2 + y_1 \\\\\\\\<br/>& = 2x_2 - x_1 + y_1<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u4e8e\u5728\u533a\u57df$R_1$\u6ee1\u8db3$x_1 \\\\leqslant y_1$\uff0c\u6240\u4ee5\u4e0a\u5f0f\u5927\u4e8e\u7b49\u4e8e$0$\uff0c\u5373\u6ee1\u8db3$|OB| \\\\geqslant |AB|$\u3002<br/>\u60c5\u51b53\uff1a$x_1 \\\\leqslant x_2, \\\\;y_2 \\\\leqslant y_1$<br/><br/>\u6b64\u65f6\u6709\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>|AB| & = x_2 - x_1 + y_1 - y_2 \\\\\\\\<br/>|OB| - |AB| & = x_2 + y_2 - x_2 + x_1 - y_1 + y_2 \\\\\\\\<br/>& = 2y_2 + x_1 - y_1<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u4e8e$|OA| \\\\leqslant |OB|$\u548c$x_2 \\\\leqslant y_2$\uff0c\u90a3\u4e48\u6211\u4eec\u77e5\u9053\uff1a<br/>$$<br/>x_1 + y_1 \\\\leqslant x_2 + y_2 \\\\Longrightarrow y_1 \\\\leqslant x_2 + y_2 \\\\leqslant 2y_2<br/>$$<br/>\u6240\u4ee5$|OB| \\\\geqslant |AB|$\u3002<br/>\u60c5\u51b54\uff1a$x_2 \\\\leqslant x_1, \\\\;y_2 \\\\leqslant y_1$<br/><br/>\u8fd9\u79cd\u60c5\u51b5\u8fdd\u53cd\u4e86$|OA| \\\\leqslant |OB|$\u8fd9\u4e2a\u6761\u4ef6\uff0c\u6545\u4e0d\u8003\u8651\u3002<br/>\u7efc\u4e0a\uff0c\u5728\u533a\u57df$R_1$\u5185\uff0c\u53ea\u7528\u4fdd\u7559\u79bb$O$\u6700\u8fd1\u7684\u70b9\u7684\u8fde\u8fb9\u5c31\u53ef\u4ee5\u4e86\u3002<br/>\u5bf9\u4e8e\u5176\u5b83\u7684\u533a\u57df\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u5bf9\u79f0\u6216\u8005\u65cb\u8f6c\uff0c\u4ece\u800c\u53d8\u6210$R_1$\u7684\u60c5\u51b5\u3002\u56e0\u6b64$8$\u4e2a\u533a\u57df\u5747\u6ee1\u8db3\u8fd9\u4e00\u6027\u8d28\u3002<br/>\u8fd9\u6837\u4e00\u6765\uff0c\u6bcf\u4e2a\u70b9\u53ea\u7528\u8fde\u51fa$8$\u6761\u8fb9\uff0c\u7136\u540e\u5728\u5f97\u5230\u7684\u56fe\u4e0a\u4f7f\u7528\u7a00\u758f\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u7b97\u6cd5\uff0c\u5c31\u53ef\u5f97\u5230\u539f\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u3002\u7531\u4e8e\u8fd9\u5f20\u56fe\u7684\u8fb9\u6570\u662f$O(n)$\u7684\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u4f7f\u7528Kruskal\u7b97\u6cd5\uff0c\u6211\u4eec\u7684\u7b97\u6cd5\u4e5f\u5c31\u662f$O(n \\\\log n)$\u7684\u3002<br/>\u4e00\u6761\u8fb9\u5728\u4e0a\u9762\u7684\u56fe\u4e2d\u88ab\u4e24\u4e2a\u7aef\u70b9\u90fd\u88ab\u8ba1\u6570\u4e86\u4e00\u6b21\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u8fb9\u6570\u662f\u4e0d\u8d85\u8fc7$4n$\u7684\u3002<br/>\u6c42\u51fa\u6700\u8fd1\u70b9<br/>\u4e0a\u9762\u7684\u6027\u8d28\u4e2d\u8fd8\u7559\u4e0b\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u4f55\u6c42\u51fa\u6bcf\u4e2a\u533a\u57df\u5185\u79bb$O$\u6700\u8fd1\u7684\u70b9\uff1f<br/>\u4ece\u4e4b\u524d\u7684\u5173\u4e8e\u8fb9\u6570\u7684\u8ba8\u8bba\u4e2d\u53ef\u77e5\uff0c\u6211\u4eec\u53ea\u7528\u6c42$R_1$\u5230$R_4$\u7684\u6700\u8fd1\u70b9\u5373\u53ef\u3002\u6b64\u5916\uff0c\u5229\u7528\u5bf9\u79f0\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u5168\u90e8\u5f52\u7ed3\u5230\u5728$R_1$\u6c42\u6700\u8fd1\u70b9\u7684\u7b97\u6cd5\u4e2d\uff0c\u53ea\u9700\u8981\u63d0\u524d\u505a\u4e00\u4e2a\u5750\u6807\u7684\u53d8\u6362\u3002\u4e0b\u9762\u4e5f\u5c06\u53ea\u8003\u8651$R_1$\u7684\u7b97\u6cd5\u3002<br/>\u8003\u8651\u4f7f\u7528\u626b\u63cf\u7ebf\u7b97\u6cd5\uff1a\u5c06\u6240\u6709\u70b9\u6309\u7167$x$\u5750\u6807\u5347\u5e8f\u6392\u597d\u5e8f\uff0c$x$\u5750\u6807\u76f8\u540c\u7684\u5c31\u6309\u7167$y$\u964d\u5e8f\u6392\u5e8f\u3002\u7136\u540e\u4ece\u524d\u5f80\u540e\u626b\u63cf\u3002\u6211\u4eec\u5c06\u6bcf\u4e2a\u70b9\u6309\u7167$y - x$\u8fdb\u884c\u79bb\u6563\u5316\uff08\u4e5f\u5c31\u662f\u7ecf\u8fc7\u8be5\u70b9\u7684\u659c\u7387\u4e3a$1$\u7684\u76f4\u7ebf\u7684\u7eb5\u622a\u8ddd\uff09\u3002\u5bf9\u4e8e\u67d0\u4e2a\u70b9$i$\u800c\u8a00\uff0c\u5728\u4ee5$i$\u4e3a\u539f\u70b9\u7684$R_1$\u533a\u57df\u5185\u70b9$j$\u6ee1\u8db3$y_j - x_j \\\\geqslant y_i - x_i$\u3002\u800c$R_1$\u5185\u79bb$i$\u6700\u8fd1\u7684\u70b9$j$\u6ee1\u8db3$y_j + x_j$\u6700\u5c0f\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5982\u7ebf\u6bb5\u6811\u6216\u8005\u6811\u72b6\u6570\u7ec4\uff0c\u5c31\u53ef\u7ef4\u62a4$[y - x, \\\\;\\\\infty]$\u5185$y + x$\u6700\u5c0f\u7684\u662f\u8c01\uff0c\u4ece\u800c\u6c42\u5f97\u6bcf\u4e00\u4e2a\u70b9\u7684\u6700\u8fd1\u70b9\u3002<br/>\u8fd9\u4e2a\u7b97\u6cd5\u662f$O(n \\\\log n)$\u7684\u3002\u56e0\u6b64\uff0c$n$\u4e2a\u70b9\u7684\u6700\u5c0f\u66fc\u54c8\u987f\u751f\u6210\u6811\u53ef\u4ee5\u5728$O(n \\\\log n)$\u8ba1\u7b97\u51fa\u6765\u3002<br/>\u81f3\u4e8e\u5750\u6807\u53d8\u6362\uff0c\u4e00\u4e2a\u6bd4\u8f83\u65b9\u4fbf\u7684\u987a\u5e8f\u5c31\u662f\u5148\u5173\u4e8e$y = x$\u5bf9\u79f0\uff0c\u4e5f\u5c31\u662f\u4ea4\u6362$x$\u548c$y$\u3002\u7136\u540e\u5173\u4e8e$y = 0$\u5bf9\u79f0\uff0c\u4e5f\u5c31\u662f\u5c06$y$\u53d6\u53cd\uff0c\u7136\u540e\u518d\u5173\u4e8e$y = x$\u5bf9\u79f0\u3002\u8fd9\u6837\u6267\u884c$4$\u6b21\u626b\u63cf\u7ebf\u7b97\u6cd5\u5c31\u53ef\u4ee5\u5b8c\u6210\u6784\u56fe\u3002<br/><br/><br/><br/><br/>\u5bf9\u4e8e\u56fe\u4e0a\u4e00\u4e2a\u73af\uff0c\u5220\u53bb\u73af\u4e0a\u6743\u91cd\u6700\u5927\u7684\u8fb9\u540e\u7684\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u4e0e\u539f\u56fe\u4e00\u81f4\u3002\u8bc1\u660e\u5728\u5f88\u591a\u5730\u65b9\u90fd\u6709\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-1-17/manhattan-mst.html"
},
"\u66ff\u7f6a\u7f8a\u6811(Scapegoat Tree)": {
"tags": "\u7b97\u6cd5 \u6570\u636e\u7ed3\u6784 \u66ff\u7f6a\u7f8a\u6811",
"text": "\u66ff\u7f6a\u7f8a\u6811(Scapegoat Tree)<br/>\u70ed\u8eab\uff1a\u7ebf\u6027\u65f6\u95f4\u5efa\u6811<br/>\u95ee\u9898 \u7ed9\u5b9a\u6709\u5e8f\u6392\u597d\u7684\u5143\u7d20\u5e8f\u5217\uff0c\u73b0\u5728\u8981\u4f60\u5728$ \\\\Theta(n) $\u7684\u65f6\u95f4\u5185\u5efa\u7acb\u4e00\u68f5\u5e73\u8861\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u3002<br/>\u6700\u6734\u7d20\u7684\u505a\u6cd5\u5c31\u662f\u5c06\u5143\u7d20\u9010\u4e00\u63d2\u5165\uff0c\u7531\u4e8e\u8bb8\u591a\u5e73\u8861\u6811\u7684\u63d2\u5165\u662f$O(\\\\log n)$\u7684\uff0c\u56e0\u6b64\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n\\\\log n)$\u7684\u3002<br/>\u8003\u8651\u5230\u5143\u7d20\u5df2\u7ecf\u662f\u6392\u597d\u5e8f\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u505a\u70b9\u4f18\u5316\u3002<br/>\u4f17\u6240\u5468\u77e5\uff0c\u4e8c\u53c9\u641c\u7d22\u6811\u662f\u6709\u5e8f\u7684\uff0c\u5373\u5b83\u7684\u4e2d\u5e8f\u904d\u5386\u662f\u6709\u5e8f\u7684\u3002\u90a3\u4e48\u5728\u5b83\u7684\u4e2d\u5e8f\u904d\u5386\u4e2d\uff0c\u5047\u8bbe\u4e00\u4e2a\u8282\u70b9\u6240\u5904\u7684\u4f4d\u7f6e\u4e3a$i$\uff0c\u90a3\u4e48$i-1$\u5c31\u662f\u5b83\u7684\u5de6\u5b50\u6811\u7684\u5927\u5c0f\uff0c$n-i$\u5c31\u662f\u53f3\u5b50\u6811\u7684\u5927\u5c0f\u3002<br/>\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u5efa\u4e00\u68f5\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u6240\u4ee5\u5de6\u53f3\u5b50\u6811\u7684\u5927\u5c0f\u5e94\u5f53\u76f8\u8fd1\u3002\u6700\u4f18\u7684\u60c5\u51b5\u4e3a\u5de6\u53f3\u5b50\u6811\u5927\u5c0f\u4e00\u81f4\uff0c\u6b64\u65f6\u8be5\u8282\u70b9\u5728\u4e2d\u5e8f\u904d\u5386\u7684\u6700\u4e2d\u95f4\u3002<br/>\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u8f83\u597d\u7684\u7b97\u6cd5\uff0c\u5c31\u662f\u9009\u53d6\u4e2d\u95f4\u7684\u5143\u7d20\u4f5c\u4e3a\u6839\u8282\u70b9\uff0c\u5c06\u5e8f\u5217\u5207\u4e3a\u4e24\u90e8\u5206\uff0c\u9012\u5f52\u7684\u5efa\u7acb\u5de6\u53f3\u5b50\u6811\u5373\u53ef\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u5143\u7d20\u9700\u8981\u82b1\u8d39$\\\\Theta(1)$\u7684\u65f6\u95f4\u6765\u5efa\u7acb\uff0c\u603b\u5171\u6709$\\\\Theta(n)$\u4e2a\u8282\u70b9\u3002\u56e0\u6b64\u8be5\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(n)$\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14def build(s):<br/>    return build(s, 1, len(s))<br/><br/>def build(s, left, right):<br/>    if right < left:<br/>        return None<br/><br/>    mid = (left + right) / 2<br/>    node = new Node()                      # \u65b0\u5efa\u8282\u70b9<br/>    node.left = build(s, left, mid - 1)    # \u9012\u5f52\u5efa\u7acb\u5de6\u5b50\u6811<br/>    node.right = build(s, mid + 1, right)  # \u9012\u5f52\u5efa\u7acb\u53f3\u5b50\u6811<br/>    node.update()                          # \u5bf9\u8be5\u8282\u70b9\u505a\u5fc5\u8981\u7684\u66f4\u65b0<br/><br/>    return node<br/><br/><br/>\u03b1\u6743\u91cd\u5e73\u8861<br/>\u4e0a\u9762\u7684\u70ed\u8eab\u975e\u5e38\u7b80\u5355\u3002\u4e0b\u9762\u8981\u8bb2\u7684\u66ff\u7f6a\u7f8a\u6811\u5176\u5b9e\u4e5f\u5f88\u7b80\u5355\u3002\u5728\u4ecb\u7ecd\u66ff\u7f6a\u7f8a\u6811\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u4e86\u89e3\u4e0b\u5b83\u7684\u4e00\u4e2a\u57fa\u672c\u7406\u8bba\uff1a\u03b1\u6743\u91cd\u5e73\u8861(\u03b1-weight-balanced)\u3002\u4e0b\u6587\u6240\u8ff0\u7684\u5e73\u8861\u5747\u4e3a\u03b1\u6743\u91cd\u5e73\u8861\u3002<br/>\u6211\u4eec\u8ba4\u4e3a\u4e00\u68f5\u6811$x$\u662f\u5e73\u8861\u7684\u5f53\u4e14\u4ec5\u5f53\u5b83\u6bcf\u4e00\u68f5\u5b50\u6811\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\text{size}(x.\\\\text{left}) &\\\\le \\\\alpha \\\\cdot \\\\text{size}(x) \\\\\\\\<br/>\\\\text{size}(x.\\\\text{right}) &\\\\le \\\\alpha \\\\cdot \\\\text{size}(x)<br/>\\\\end{aligned}<br/>$$<br/>\u5176\u4e2d\uff0c$ \\\\alpha \\\\in [0.5, 1] $\u3002<br/>\u8fd9\u4e2a$\\\\alpha$\u53ef\u80fd\u4f1a\u4ee4\u4eba\u975e\u5e38\u7591\u60d1\u3002\u6211\u4eec\u9996\u5148\u6765\u601d\u8003\u4e00\u4e0b\u4e24\u4e2a\u6781\u503c\uff1a$1$\u548c$0.5$\u3002<br/>\u5f53$a = 1$\u65f6\uff0c\u65e0\u8bba\u4ec0\u4e48\u4e8c\u53c9\u6811\u90fd\u4f1a\u88ab\u89c6\u4e3a\u5e73\u8861\u7684\uff0c\u56e0\u4e3a\u5de6\u53f3\u5b50\u6811\u7684\u5927\u5c0f\u4e0d\u4f1a\u8d85\u8fc7\u8fd9\u68f5\u6811\u7684\u5927\u5c0f\u3002\u8fd9\u6b63\u5bf9\u5e94\u7740\u666e\u901a\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u3002<br/>\u800c\u5f53$ a = 0.5$\u65f6\uff0c\u8fd9\u65f6\u7684\u8981\u6c42\u5c06\u975e\u5e38\u4e25\u683c\uff0c\u5de6\u53f3\u5b50\u6811\u7684\u5927\u5c0f\u90fd\u5fc5\u987b\u662f\u8fd9\u68f5\u6811\u7684\u5927\u5c0f\u7684\u4e00\u534a\uff0c\u6b64\u65f6\u53ea\u6709\u5b8c\u5168\u4e8c\u53c9\u6811\u80fd\u6ee1\u8db3\u5e73\u8861\u8981\u6c42\u3002AVL\u6811\u5c31\u662f\u5c1d\u8bd5\u4fdd\u6301\u8fd9\u79cd\u5e73\u8861\u3002<br/>\u6211\u4eec\u90fd\u77e5\u9053\uff0c\u4e8c\u53c9\u641c\u7d22\u6811\u6781\u6613\u9000\u5316\uff0c\u800cAVL\u6811\u53c8\u4e3a\u4e86\u5e73\u8861\u5bfc\u81f4\u5e38\u6570\u76f8\u5f53\u5927\uff0c\u5e76\u4e14\u4ee3\u7801\u53c8\u81ed\u53c8\u957f\uff0c\u51e0\u4e4e\u6ca1\u6709\u4eba\u5199\u3002<br/>\u4f5c\u4e3aAVL\u6811\u7684\u6539\u8fdb\uff0c\u7ea2\u9ed1\u6811\u5e76\u4e0d\u8ffd\u6c42\u5b8c\u7f8e\u7684\u5e73\u8861\u3002\u901a\u8fc7\u653e\u5bbd\u4e00\u4e9b\u4e25\u683c\u7684\u5e73\u8861\u9650\u5236\uff0c\u4fdd\u8bc1\u4e86$ \\\\alpha = 0.666\\\\dots $\u7684\u5e73\u8861\uff0c\u540c\u65f6\u964d\u4f4e\u4e86\u5e38\u6570\uff0c\u6709\u7740\u4f18\u826f\u7684\u6027\u80fd\u3002\u73b0\u5728\u7edd\u5927\u591a\u6570\u8bed\u8a00\u7684\u6807\u51c6\u5e93\u90fd\u6709\u5b83\u7684\u8eab\u5f71\u3002\u7136\u800c\uff0c\u7ea2\u9ed1\u6811\u5bf9\u4e8eOI\u7ade\u8d5b\u800c\u8a00\u4ee3\u7801\u91cf\u592a\u5927\uff0c\u4e0d\u9002\u5408\u73b0\u573a\u53d1\u6325\u3002<br/>\u8f83\u4e3a\u5e38\u7528\u7684Treap\u548cSplay\u6811\u5219\u5bf9$ \\\\alpha$\u6ca1\u6709\u5f3a\u5236\u7684\u9650\u5b9a\uff0c\u5b83\u4eec\u5229\u7528\u968f\u673a\u5316\u7684\u601d\u60f3\u6765\u4f7f\u6811\u5c3d\u53ef\u80fd\u5e73\u8861\uff0c\u5373\u5b83\u4eec\u4f1a\u5c3d\u91cf\u4f7f$\\\\alpha$\u503c\u964d\u4f4e\u3002\u6211\u7c97\u7565\u6d4b\u5b9a\u4e86Treap\u3001\u975e\u65cb\u8f6c\u5f0fTreap\u548cSplay\u7684$\\\\alpha$\u3002\u7ed3\u679c\u5982\u4e0b\uff1a<br/><br/><br/><br/>BST \\\\ \u6d4b\u8bd5<br/>1<br/>2<br/>3<br/>4<br/>5<br/>\u5e73\u5747<br/><br/><br/><br/><br/>Splay\uff085\u4e2a\u4e0d\u540c\u6570\u636e\uff09<br/>0.758<br/>0.588<br/>0.582<br/>0.612<br/>0.759<br/>0.659<br/><br/><br/>Treap\uff08\u540c\u4e00\u4e2a\u6570\u636e\uff09<br/>0.766<br/>0.578<br/>0.601<br/>0.587<br/>0.781<br/>0.662<br/><br/><br/>\u975e\u65cb\u8f6c\u5f0fTreap\uff08\u540c\u4e00\u4e2a\u6570\u636e\uff09<br/>0.914<br/>0.860<br/>0.613<br/>0.678<br/>0.803<br/>0.773<br/><br/><br/><br/>\u4ee5\u4e0a\u7684\u7ed3\u679c\u4ec5\u4f9b\u53c2\u8003\u3002\u53ef\u89c1\u4e00\u822c\u7684BST\u90fd\u80fd\u591f\u4f7f$\\\\alpha$\u7ef4\u6301\u5728$0.6$\u5230$0.7$\u4e4b\u95f4\u3002  <br/>\u66ff\u7f6a\u7f8a\u6811<br/>\u66ff\u7f6a\u7f8a\u6811\u662f\u4e00\u79cd\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u5b83\u6709\u4e00\u4e2a\u5f88\u5927\u7684\u7279\u70b9\uff0c\u5c31\u662f\u5b83\u53ef\u4ee5\u4eba\u4e3a\u8bbe\u5b9a\u4e00\u4e2a$\\\\alpha$\u503c\uff0c\u5e76\u4e14\u5b83\u4f1a\u5728\u64cd\u4f5c\u4e2d\u6765\u7ef4\u62a4\u6307\u5b9a\u7684\u5e73\u8861\u3002\u4e2a\u4eba\u611f\u89c9\u66ff\u7f6a\u7f8a\u6811\u201c\u53c8\u61d2\u53c8\u66b4\u529b\u201d\uff0c\u4f46\u7ecf\u8fc7\u5b9e\u6d4b\uff0c\u5b83\u7684\u901f\u5ea6\u5b8c\u5168\u4e0d\u4e9a\u4e8e\u4e0a\u9762\u63d0\u53ca\u7684BST\u3002<br/>\u66b4\u529b\u91cd\u6784<br/>\u66ff\u7f6a\u7f8a\u6811\u4e4b\u6240\u4ee5\u80fd\u7ef4\u6301\u5e73\u8861\uff0c\u5c31\u662f\u56e0\u4e3a\u5b83\u628a\u4e0d\u5e73\u8861\u7684\u6811\u90fd\u66b4\u529b\u91cd\u6784\u6210\u4e00\u68f5\u5b8c\u5168\u4e8c\u53c9\u6811\uff01<br/>\u4f46\u662f\u8fd9\u6837\u4e00\u6765\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f1a\u66b4\u6da8\u3002\u56e0\u6b64\u66ff\u7f6a\u7f8a\u6811\u5e94\u5f53\u8bbe\u7f6e\u4e00\u4e2a\u5408\u9002\u7684$\\\\alpha$\u503c\uff0c\u907f\u514d\u8fc7\u591a\u7684\u91cd\u6784\uff0c\u4ece\u800c\u5747\u644a\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u53ef\u4ee5\u8bc1\u660e\uff0c\u53ea\u8981$\\\\alpha$\u8bbe\u7f6e\u5408\u7406\uff0c\u66ff\u7f6a\u7f8a\u6811\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u662f$O(\\\\log n)$\u7684\u3002<br/>\u9996\u5148\u8003\u8651\u5982\u4f55\u91cd\u6784\u3002\u5728\u4e4b\u524d\u7ebf\u6027\u65f6\u95f4\u5efa\u6811\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u5148\u5c06\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u7ed9\u590d\u5236\u51fa\u6765\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u91cd\u5efa\u3002<br/>\u67e5\u8be2<br/>\u66ff\u7f6a\u7f8a\u6811\u7684\u67e5\u8be2\u548c\u4e8c\u53c9\u641c\u7d22\u6811\u4e00\u6a21\u4e00\u6837\uff0c\u6bd5\u7adf\u67e5\u627e\u4e0d\u4f1a\u5bfc\u81f4\u6811\u7684\u4e0d\u5e73\u8861\uff0c\u90a3\u4e48\u5b83\u4e5f\u6ca1\u6709\u5fc5\u8981\u8fdb\u884c\u91cd\u6784\u3002<br/>\u63d2\u5165<br/>\u66ff\u7f6a\u7f8a\u6811\u7684\u63d2\u5165\u64cd\u4f5c\u548c\u4e8c\u53c9\u641c\u7d22\u6811\u662f\u5dee\u4e0d\u591a\u7684\uff0c\u53ea\u662f\u6700\u540e\u8981\u68c0\u67e5\u56de\u6eaf\u65f6\u7684\u6811\u94fe\u4e0a\u6709\u54ea\u68f5\u5b50\u6811\u8fdd\u53cd\u4e86\u5e73\u8861\u3002\u7136\u540e\u76f4\u63a5\u5c06\u5176\u91cd\u6784\u5373\u53ef\u3002<br/>\u5728\u91cd\u6784\u65f6\u4f60\u53ef\u80fd\u4f1a\u8003\u8651\u5230\u4e00\u6761\u6811\u94fe\u4e0a\u53ef\u80fd\u6709\u591a\u4e2a\u5b50\u6811\u8fdd\u53cd\u4e86\u5e73\u8861\u3002\u5bf9\u6b64\uff0c\u4f60\u53ea\u9700\u8981\u5c06\u6700\u5927\u7684\u90a3\u68f5\u5b50\u6811\u91cd\u6784\u5373\u53ef\u3002\u4f46\u662f\u8fd9\u6837\u5728\u5b9e\u9645\u4ee3\u7801\u4e2d\u4f1a\u7565\u663e\u590d\u6742\u3002\u5982\u679c\u4f60\u60f3\u5077\u61d2\uff0c\u5c31\u53ea\u5728\u56de\u6eaf\u65f6\u627e\u5230\u4e86\u7b2c\u4e00\u68f5\u4e0d\u5e73\u8861\u7684\u6811\u91cd\u6784\u4e5f\u662f\u53ef\u4ee5\u7684\u3002\u56e0\u4e3a\u5728\u66ff\u7f6a\u7f8a\u6811\u4e2d\uff0c\u540c\u65f6\u51fa\u73b0\u51e0\u4e2a\u4e0d\u5e73\u8861\u7684\u5b50\u6811\u7684\u60c5\u51b5\u4e5f\u4e0d\u662f\u5f88\u591a\u3002\u5728\u5b9e\u9645\u6d4b\u8bd5\u4e2d\uff0c\u5077\u61d2\u7684\u5199\u6cd5\u5728\u4e0a\u5343\u4e07\u7684\u6570\u636e\u91cf\u4e0b\u6027\u80fd\u5dee\u8ddd\u5c0f\u4e8e1s\u3002<br/>\u5220\u9664<br/>\u66ff\u7f6a\u7f8a\u6811\u7684\u5220\u9664\u64cd\u4f5c\u5f88\u597d\u7684\u4f53\u73b0\u4e86Lazy\u601d\u60f3\u3002\u5b83\u5728\u5220\u9664\u8282\u70b9\u65f6\uff0c\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u5220\u9664\uff0c\u800c\u662f\u5c06\u5176\u6807\u8bb0\u3002\u6b64\u540e\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u5c06\u5176\u65e0\u89c6\uff0c\u91cd\u6784\u5c31\u76f4\u63a5\u4e22\u5f03\uff0c\u9664\u975e\u6709\u63d2\u5165\u64cd\u4f5c\u5c06\u5176\u6062\u590d\u3002\u5f53\u7136\u6211\u4eec\u4e0d\u80fd\u65e0\u6b62\u5c3d\u5730\u8fdb\u884c\u6807\u8bb0\u3002\u5982\u679c\u88ab\u6807\u8bb0\u7684\u8282\u70b9\u6570\u8d85\u8fc7\u4e86\u6574\u68f5\u6811\u5927\u5c0f\u7684\u4e00\u534a\uff0c\u6211\u4eec\u5c31\u76f4\u63a5\u5c06\u6574\u68f5\u6811\u91cd\u6784\uff0c\u540c\u65f6\u6e05\u9664\u5220\u9664\u7684\u8282\u70b9\u3002<br/>\u5b9e\u73b0\u7ec6\u8282\u53ca\u5176\u65f6\u95f4\u590d\u6742\u5ea6<br/>\u8282\u70b9\u5b9a\u4e49<br/>\u9664\u4e86\u5b58\u50a8\u952e\u503c\u5916\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5b58\u50a8\u6811\u7684\u5927\u5c0f\u548c\u5220\u9664\u6807\u8bb0\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25struct Node<KeyType, ValueType>:<br/>    key:     KeyType    # \u952e<br/>    value:   ValueType  # \u503c<br/>    size:    int        # \u6811\u7684\u5927\u5c0f<br/>    deleted: bool       # \u5220\u9664\u6807\u8bb0<br/>    left:    Node       # \u5de6\u5b50\u6811<br/>    right:   Node       # \u53f3\u5b50\u6811<br/><br/>    def update(self):<br/>        self.size = self.left.size + self.right.size<br/><br/>        if not self.deleted:  # \u5982\u679c\u81ea\u5df1\u4e0d\u662f\u88ab\u5220\u9664\u7684\u8282\u70b9<br/>            self.size += 1<br/><br/># \u7a7a\u7ed3\u70b9<br/>struct NoneNode<*, *>:<br/>    key     = None<br/>    value   = None<br/>    size    = 0<br/>    deleted = True<br/>    left    = NodeNode()<br/>    right   = NodeNode()<br/><br/>    def update(self):<br/>        pass<br/><br/><br/>\u9009\u5b9a\u03b1<br/>\u66ff\u7f6a\u7f8a\u6811\u7684\u597d\u5904\u5728\u4e8e\u6211\u4eec\u6709\u4e86\u66f4\u597d\u7684\u8c03\u63a7\u80fd\u529b\u3002$\\\\alpha$\u8fd9\u4e2a\u503c\u53ef\u4ee5\u9009\u53d6$0.5$\u5230$1$\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u503c\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u9009\u53d6$0.7$\u5230$0.8$\u6700\u4f73\u3002\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u8981\u6765\u4f5c\u51fa\u9002\u5f53\u8c03\u6574\u3002$\\\\alpha$\u8d8a\u5927\u63d2\u5165\u901f\u5ea6\u5c31\u8d8a\u5feb\uff0c\u800c\u8bbf\u95ee\u548c\u5220\u9664\u901f\u5ea6\u5c31\u4f1a\u964d\u4f4e\u3002\u53cd\u4e4b\u5219\u63d2\u5165\u53d8\u6162\u3002\u8fd9\u91cc\u6211\u4eec\u9009\u62e9$0.75$\uff1a<br/>1ALPHA = 0.75<br/><br/><br/>\u91cd\u6784<br/>\u91cd\u6784\u64cd\u4f5c\u5341\u5206\u7b80\u5355\uff0c\u53ea\u9700\u8981\u4e2d\u5e8f\u904d\u5386\u4e00\u904d\u5c31\u53ef\u4ee5\u91cd\u5efa\u6811\u4e86\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21# \u4e2d\u5e8f\u904d\u5386<br/>def travel(h, s):<br/>    if h is NoneNode:<br/>        return<br/><br/>    travel(h.left, s)<br/>    if h is not deleted:  # \u5ffd\u7565\u5220\u9664\u7684\u8282\u70b9<br/>        s.append(h)<br/>    travel(h.right, s)<br/><br/>    if h is deleted:<br/>        del h<br/><br/>def refact(h):<br/>    assert h is not NoneNode<br/><br/>    s = []<br/>    travel(h, s)<br/><br/>    # \u91cd\u5efa<br/>    return build(s)<br/><br/><br/>\u63d2\u5165<br/>\u63d2\u5165\u64cd\u4f5c\u4e0e\u4e8c\u53c9\u641c\u7d22\u6811\u4e00\u81f4\uff0c\u53ea\u662f\u5728\u6700\u540e\u8981\u91cd\u65b0\u4ece\u9876\u5411\u4e0b\u68c0\u67e5\u4e00\u904d\u662f\u5426\u6709\u4e0d\u5e73\u8861\u7684\u5b50\u6811\u3002\u5982\u679c\u6709\u5c31\u91cd\u6784\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12def check(h, key):<br/>    if h is NoneNode:<br/>        return NoneNode()<br/>    elif max(h.left.size, h.right.size) > ALPHA * h.size:<br/>        return refact(h)<br/>    elif key < h.key:<br/>        h.left = check(h.left, key)<br/>    elif key > h.key:<br/>        h.right = check(h.right, key)<br/><br/>    h.update()<br/>    return h<br/><br/><br/>\u5220\u9664<br/>\u5f53\u6211\u4eec\u547d\u4e2d\u5220\u9664\u7684\u8282\u70b9\u65f6\uff0c\u76f4\u63a5\u5c06\u5176\u4f5c\u5220\u9664\u6807\u8bb0\uff0c\u7136\u540e\u9000\u56de\u3002\u5220\u9664\u7ed3\u675f\u540e\uff0c\u68c0\u67e5\u6574\u68f5\u6811\u4e2d\u88ab\u5220\u9664\u7684\u8282\u70b9\u6570\u662f\u5426\u8d85\u8fc7\u4e86\u603b\u7ed3\u70b9\u6570\u7684\u4e00\u534a\uff0c\u5982\u679c\u8d85\u8fc7\u5c31\u6574\u4f53\u91cd\u6784\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12# \u547d\u4e2d\u65f6<br/>h.deleted = True<br/>h.update()<br/>deleted_count += 1<br/><br/># ...<br/><br/># \u5220\u9664\u5b8c\u540e<br/>if deleted_count > size / 2:<br/>    tree = refact(tree)<br/>    size -= deleted_count<br/>    deleted_count = 0<br/><br/><br/>\u65f6\u95f4\u590d\u6742\u5ea6<br/>\u66ff\u7f6a\u7f8a\u6811\u7684\u6240\u6709\u64cd\u4f5c\u5747\u644a\u590d\u6742\u5ea6\u4e3a$O(\\\\log n)$\u3002<br/><br/><br/><br/>\u64cd\u4f5c<br/>\u65f6\u95f4\u590d\u6742\u5ea6\uff08\u5747\u644a\uff09<br/><br/><br/><br/><br/>\u67e5\u8be2<br/>$O(\\\\log n)$<br/><br/><br/>\u63d2\u5165<br/>$O(\\\\log n)$<br/><br/><br/>\u5220\u9664<br/>$O(\\\\log n)$<br/><br/><br/><br/>\u5bf9\u4e8e\u67e5\u8be2\u64cd\u4f5c\uff0c\u56e0\u4e3a\u66ff\u7f6a\u7f8a\u6811\u662f\u4fdd\u6301\u4e86$\\\\alpha$\u5e73\u8861\u7684.\u53ea\u8981$\\\\alpha$\u503c\u662f\u5408\u7406\u7684\uff0c\u90a3\u4e48\u8fd9\u68f5\u6811\u5c31\u80fd\u4fdd\u6301\u6bd4\u8f83\u5e73\u8861\u7684\u72b6\u6001\uff0c\u6545\u63d2\u5165\u662f$O(\\\\log n)$\u7684\u3002<br/>\u5bf9\u4e8e\u63d2\u5165\u64cd\u4f5c\uff0c\u6211\u4eec\u5047\u8bbe\u4e00\u4e2a\u521a\u597d\u91cd\u6784\u8fc7\u7684\u5b50\u6811\u7684\u5927\u5c0f\u4e3a$x$\u3002\u5728\u6700\u574f\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5411\u5b83\u7684\u4e00\u4fa7\u4e0d\u505c\u7684\u63d2\u5165\u8282\u70b9\u3002\u5047\u8bbe\u5f53\u5411\u4e00\u4fa7\u63d2\u5165\u4e86$k$\u4e2a\u8282\u70b9\u65f6\u6070\u597d\u7834\u574f\u4e86\u5e73\u8861\uff0c\u90a3\u4e48\u6b64\u65f6$k$\u5c06\u6ee1\u8db3\uff1a<br/>$$ \\\\left\\\\lfloor\\\\frac{x}{2}\\\\right\\\\rfloor + k \\\\gt \\\\alpha \\\\cdot (x + k) $$<br/>\u5373<br/>$$ k > {\\\\alpha - \\\\frac{1}{2} \\\\over 1 - \\\\alpha}x $$<br/>\u56e0\u6b64\u6bcf${\\\\alpha - \\\\frac{1}{2} \\\\over 1 - \\\\alpha}x $\u6b21\u5c31\u4f1a\u8fdb\u884c\u4e00\u6b21\u91cd\u6784\u3002\u91cd\u6784\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(x)$\u3002\u6211\u4eec\u5747\u644a\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a<br/>$$ {\\\\Theta(x) \\\\over (\\\\alpha - \\\\frac{1}{2}) / (1 - \\\\alpha) \\\\cdot x} = \\\\Omega(1) \\\\; (\\\\alpha = 0.75) $$<br/>\u56e0\u6b64\u6700\u597d\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u4ee5\u5747\u644a\u5230$\\\\Omega(1)$\u3002\u7531\u4e8e\u6811\u80fd\u4fdd\u6301$\\\\alpha$\u5e73\u8861\uff0c\u56e0\u6b64\u63d2\u5165\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(\\\\log n)$\u3002<br/>\u540c\u65f6\u6211\u4eec\u53ef\u89c1\uff0c$\\\\alpha$\u8d8a\u5927\uff0c\u5747\u644a\u7684\u5e38\u6570\u5c31\u4f1a\u8d8a\u4f4e\u3002<br/>\u5bf9\u4e8e\u5220\u9664\u64cd\u4f5c\uff0c\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u8fdb\u884c\u4e86$\\\\frac{n}{2}$\u6b21\u5220\u9664\uff0c\u5e76\u4e14\u4e3a\u6b64\u89e6\u53d1\u4e86\u91cd\u6784\u3002\u7531\u4e8e\u6bcf\u6b21\u5220\u9664\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(\\\\log n)$\u7684\uff0c\u56e0\u6b64\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff1a<br/>$$ \\\\sum_1^{\\\\frac{n}{2}} O(\\\\log n) + \\\\Theta(n) = \\\\frac{n}{2}O(\\\\log n) + \\\\Theta(n) $$<br/>\u6211\u4eec\u5c06\u5176\u5747\u644a\u5230$\\\\frac{n}{2}$\u6b21\u64cd\u4f5c\u4e0a\uff1a<br/>$$ {\\\\frac{n}{2}O(\\\\log n) + \\\\Theta(n) \\\\over \\\\frac{n}{2}} = O(\\\\log n) + \\\\Theta(1) = O(\\\\log n) $$<br/>\u6700\u7ec8\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$ O(\\\\log n) $\u3002<br/>\u66f4\u591a\u64cd\u4f5c<br/>\u66ff\u7f6a\u7f8a\u6811\u4f5c\u4e3a\u4e00\u79cd\u201c\u53c8\u61d2\u53c8\u66b4\u529b\u201d\u7684\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u4ee3\u7801\u7b80\u5355\u6613\u4e8e\u5b9e\u73b0\uff0c\u5e76\u4e14\u6027\u80fd\u5341\u5206\u4e0d\u9519\u3002\u5f53\u7136\u6211\u4eec\u4f1a\u60f3\u62d3\u5c55\u66f4\u591a\u7684\u64cd\u4f5c\u3002\u5f53\u7136\uff0c\u7531\u4e8e\u66ff\u7f6a\u7f8a\u6811\u53ea\u4f1a\u5b9a\u65f6\u91cd\u6784\uff0c\u4e0d\u4f9d\u8d56\u5176\u5b83\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u53ef\u4ee5\u6269\u5c55\u8bb8\u591a\u64cd\u4f5c\u3002\u4e0b\u9762\u5217\u4e3e\u4e00\u4e9b\uff1a<br/><br/>rank\u53d6\u6392\u540d\uff1a\u8bb0\u5f55\u4e86\u5b50\u6811\u7684\u5927\u5c0f\u5c31\u53ef$O(\\\\log n)$\u6c42\u51fa\u4e86\u3002  <br/>\u7b2ck\u5927\uff1a\u8bb0\u5f55\u4e86size\u53ef\u4ee5$O(\\\\log n)$\u6c42\u51fa\u3002  <br/>split\u62c6\u5206\uff1a\u975e\u65cb\u8f6c\u5f0fTreap\u7684\u641e\u6cd5\u5373\u53ef\uff0c$O(\\\\log n)$\u3002  <br/>merge\u5408\u5e76\u6309\u7167\u53ef\u5408\u5e76\u5806\u7684\u641e\u6cd5\u5373\u53ef\uff0c$O(\\\\log n)$\u3002  <br/>slice\u63d0\u53d6\u533a\u95f4Splay\u4e71\u641e\uff0c$O(\\\\log n)$\u3002  <br/>\u5404\u79cd\u533a\u95f4\u64cd\u4f5c\uff0c\u4e71\u5957\u5404\u79cd\u6811\u2026$O(\\\\log n)$\u3001$O(\\\\log n)$\u3001$O(\\\\log n)$\u2026  <br/>\u2026  <br/>\uff08\u5f53\u7136\u6709\u4e9b\u65f6\u5019\u4f55\u82e6\u6765\u4e71\u641e\uff09<br/>",
"url": "blog/2016-4-6/scapegoat.html"
},
"\u6700\u5c0f\u6811\u5f62\u56fe": {
"tags": "\u56fe\u8bba \u6570\u636e\u7ed3\u6784 \u5e76\u67e5\u96c6 \u53ef\u5e76\u5806 \u6700\u5c0f\u6811\u5f62\u56fe",
"text": "\u6700\u5c0f\u6811\u5f62\u56fe<br/>\u95ee\u9898\u5f15\u5165<br/>\u5728\u5e26\u6743\u65e0\u5411\u56fe\u4e2d\uff0c\u6700\u5c0f\u751f\u6210\u6811\u662f\u4e00\u4e2a\u5e7f\u4e3a\u4eba\u77e5\u7684\u95ee\u9898\u3002\u5bf9\u5e94\u7684\uff0c\u5728\u6709\u5411\u56fe\u4e2d\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u6709\u5411\u751f\u6210\u6811\uff08Directed Spanning Trees\uff0c\u7b80\u79f0 DST\uff09\u3002\u5728\u6709\u5411\u56fe $G = (V,\\\\ E)$ \u4e2d\uff0c\u6211\u4eec\u9009\u5b9a\u4e00\u4e2a\u751f\u6210\u6811\u7684\u6839\u8282\u70b9 $r$\uff0c\u4ee5 $r$ \u4e3a\u6839\u7684\u6709\u5411\u751f\u6210\u6811\u662f\u56fe $G$ \u7684\u4e00\u4e2a\u5b50\u56fe $T$\uff0c\u5e76\u4e14\u5b50\u56fe $T$ \u4e2d $r$ \u5230\u4efb\u610f\u975e $r$ \u8282\u70b9 $u$ \u7684\u8def\u5f84\u5b58\u5728\u4e14\u552f\u4e00\u3002\u6839\u636e\u6811\u7684\u5b9a\u4e49\uff0c\u5b50\u56fe $T$ \u7684\u5f62\u72b6\u5c31\u662f\u4e00\u68f5\u4ee5 $r$ \u4e3a\u6839\u7684\u6811\uff0c\u53ea\u4e0d\u8fc7\u6240\u6709\u7684\u8fb9\u90fd\u662f\u4ece\u7236\u4eb2\u6307\u5411\u513f\u5b50\u7684\u6709\u5411\u8fb9\u3002\u6240\u4ee5\u4e5f\u79f0\u4e3a \u201c\u6811\u5f62\u56fe\u201d\u3002<br/>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5e76\u975e\u56fe $G$ \u4e2d\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\u90fd\u80fd\u6210\u4e3a\u67d0\u4e2a DST \u7684\u6839\u3002\u5177\u4f53\u800c\u8a00\uff0c\u5fc5\u987b\u8981\u6ee1\u8db3\u4ece $r$ \u51fa\u53d1\u80fd\u591f\u5230\u8fbe\u5176\u5b83\u7684\u9876\u70b9\u3002\u5982\u679c\u5c06\u56fe $G$ \u7684\u6240\u6709\u5f3a\u8fde\u901a\u5206\u91cf\u7f29\u70b9\uff0c\u5f97\u5230\u4e00\u5f20\u62d3\u6251\u56fe\uff0c\u4e14\u62d3\u6251\u56fe\u4e2d\u53ea\u6709\u4e00\u4e2a\u5165\u5ea6\u4e3a $0$ \u7684\u70b9 $u$\uff0c\u5219 $r$ \u5fc5\u987b\u6765\u81ea $u$ \u6240\u4ee3\u8868\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u3002<br/>\u7c7b\u6bd4\u6700\u5c0f\u751f\u6210\u6811\uff0c\u6700\u5c0f\u6811\u5f62\u56fe\u5c31\u662f\u5e26\u6743\u6709\u5411\u56fe $G = (V,\\\\ E,\\\\ w)$ \u4e2d\u8fb9\u6743\u603b\u548c\u6700\u5c0f\u7684 DST\uff0c\u7b80\u79f0 MDST\uff08Minimum DST\uff09\u3002\u867d\u7136\u5b9a\u4e49\u7c7b\u4f3c\uff0c\u4f46\u7b97\u6cd5\u5374\u4e0d\u5c3d\u76f8\u540c\u3002\u56e0\u4e3a\u5728\u6709\u5411\u56fe\u4e2d\uff0c\u7ed9\u5b9a DST \u7684\u6839 $r$\uff0c\u6709\u4e00\u4e9b\u8fb9\u53ef\u80fd\u4e0d\u80fd\u6210\u4e3a\u4efb\u4f55\u4e00\u4e2a DST \u7684\u6811\u8fb91\u3002\u8fd9\u5bfc\u81f4\u5bf9\u4e8e\u65e0\u5411\u56fe\u7684\u7b97\u6cd5\uff08Kruskal \u7b97\u6cd5\u3001Prim \u7b97\u6cd5\u7b49\u7b49\uff09\u90fd\u65e0\u6cd5\u5728\u6709\u5411\u56fe\u4e0a\u7b97\u51fa\u6700\u5c0f\u6811\u5f62\u56fe\u3002<br/>1965 \u5e74\uff0c\u6731\u6c38\u6d25\u548c\u5218\u632f\u5b8f [1] \u6700\u5148\u63d0\u51fa\u4e86\u6700\u5c0f\u6811\u5f62\u56fe\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(VE)$ \u7684\u7b97\u6cd5\u3002\u4e24\u5e74\u540e\uff0c\u4e5f\u5c31\u662f 1967 \u5e74\uff0cEdmonds [2] \u4e5f\u72ec\u7acb\u53d1\u73b0\u4e86\u540c\u6837\u7684\u7b97\u6cd5\u3002\u53ef\u80fd Edmonds \u540d\u6c14\u6bd4\u8f83\u5927\uff0c\u73b0\u5728\u82f1\u6587\u8d44\u6599\u91cc\u9762\u5173\u4e8e\u8fd9\u4e2a\u7b97\u6cd5\u7684\u53eb\u6cd5\u603b\u5c11\u4e0d\u4e86 Edmonds \u7684\u540d\u5b57 QAQ<br/>\u7b97\u6cd5\u6d41\u7a0b<br/>\u9996\u5148\uff0cDST \u6709\u4e00\u4e2a\u7279\u70b9\uff1a\u9664\u6839\u8282\u70b9\u5916\uff0c\u5176\u5b83\u8282\u70b9\u7684\u5165\u5ea6\u4e3a $1$\u3002\u6b64\u5916\uff0cDST \u662f\u4e0d\u5b58\u5728\u73af\u7684\u3002\u4e00\u4e2a\u975e\u5e38\u5947\u602a\u7684\u60f3\u6cd5\u5c31\u662f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u975e\u6839\u8282\u70b9\uff0c\u9009\u62e9\u5165\u8fb9\u4e2d\u8fb9\u6743\u6700\u5c0f\u7684\u3002\u56e0\u4e3a\u8fd9\u6837\u9009\u62e9\u4e4b\u540e\uff0c\u5982\u679c\u56fe\u4e2d\u6ca1\u6709\u73af\uff0c\u4e0d\u96be\u53d1\u73b0\u5c31\u6784\u6210\u4e86\u4e00\u68f5 DST\uff0c\u5e76\u4e14\u663e\u7136\u5b83\u7684\u8fb9\u6743\u4e4b\u548c\u4e5f\u662f\u6700\u5c0f\u7684\uff0c\u56e0\u6b64\u76f4\u63a5\u627e\u5230\u4e86 MDST\u3002<br/>\u5f53\u7136\u73b0\u5b9e\u6ca1\u6709\u90a3\u4e48\u7f8e\u597d\uff0c\u5f88\u5927\u6982\u7387\u4e0b\uff0c\u8fd9\u6837\u9009\u62e9\u4f1a\u51fa\u73b0\u73af\u3002\u73b0\u5728\u6765\u8003\u8651\u5176\u4e2d\u7684\u4e00\u4e2a\u73af $C$\uff0c\u8fd9\u4e2a\u73af\u4e0a\u81f3\u5c11\u6709\u4e00\u6761\u8fb9\u662f\u4e0d\u80fd\u9009\u7684\u3002\u4f46\u53ef\u80fd\u8fd8\u6709\u66f4\u591a\u7684\u8fb9\u5728\u771f\u6b63\u7684 MDST \u4e2d\u4e5f\u4e0d\u80fd\u9009\uff1f\u7136\u800c\u4e8b\u5b9e\u5374\u975e\u5e38\u5de7\uff0c\u6ce8\u610f\u5230\u73af $C$ \u4e0d\u662f\u4e00\u822c\u7684\u73af\uff0c\u5b83\u662f\u7531\u8fb9\u6743\u6700\u5c0f\u7684\u5165\u8fb9\u7ec4\u6210\u7684\u73af\u3002\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\uff0c\u5b58\u5728\u4e00\u68f5 MDST\uff0c\u5176\u4e2d\u8fdb\u5165\u73af $C$ \u7684\u8fb9\u53ea\u6709\u4e00\u6761\u3002<br/><br/>Fig.1. \u73af $C$ \u7684\u4e00\u4e2a\u793a\u610f\u56fe\u3002\u7ea2\u8272\u7684\u8fb9\u4e0d\u662f\u73af\u4e0a\u7684\u8fb9\uff0c\u662f\u67d0\u68f5 MDST \u4e2d\u7684\u8fb9\u3002\u865a\u7ebf\u8fb9\u88ab\u7ea2\u8272\u8fb9\u6240\u53d6\u4ee3\u3002<br/>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684 MDST\uff0c\u8bbe\u4e3a $T$\uff0c\u5982\u679c\u53ea\u6709\u4e00\u6761\u8fdb\u5165\u73af $C$ \u7684\u8fb9\uff0c\u90a3\u6211\u4eec\u7684\u76ee\u7684\u5c31\u8fbe\u6210\u4e86\u3002\u5426\u5219\uff0c\u5c06\u4f1a\u6709\u81f3\u5c11\u4e24\u6761\u8fb9\u8fdb\u5165\u3002\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u8fdb\u5165\u70b9 $y$\uff08\u5373\u4e0a\u56fe\u4e2d\u8fb9 $u$ \u548c\u8fb9 $v$ \u8fdb\u5165\u7684\u70b9\uff09\uff0c\u8bbe\u8fb9 $u$ \u7684\u53e6\u4e00\u4e2a\u7aef\u70b9\u4e3a $x$\u3002\u4e0d\u96be\u53d1\u73b0 $x$ \u548c $y$ \u5728\u6811 $T$ \u4e0a\u7684 LCA\uff08\u6700\u8fd1\u516c\u5171\u7956\u5148\uff09\u4e0d\u5728\u73af $C$ \u4e0a\uff0c\u6240\u4ee5\u5c06\u8fb9 $v$ \u4ece $T$ \u4e2d\u5220\u53bb\uff0c\u7136\u540e\u52a0\u5165\u8fb9 $u$\uff0c\u5f97\u5230\u7684\u4f9d\u7136\u662f\u4e00\u68f5 DST\uff0c\u8bbe\u4e3a $T'$\u3002\u800c\u8fb9 $u$ \u662f $y$ \u5165\u8fb9\u4e2d\u8fb9\u6743\u6700\u5c0f\u8005\uff0c\u5373 $w(u) \\\\leqslant w(v)$\uff0c\u6240\u4ee5 $T'$ \u7684\u8fb9\u6743\u4e4b\u548c\u4e0d\u8d85\u8fc7 $T$ \u7684\u8fb9\u6743\u4e4b\u548c\uff0c\u6240\u4ee5 $T'$ \u4e5f\u662f\u4e00\u68f5 MDST\u3002\u91cd\u590d\u6b64\u64cd\u4f5c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u53ea\u6709\u4e00\u6761\u8fdb\u5165\u73af $C$ \u7684\u8fb9\u7684 MDST\u3002<br/>\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u7528\u8003\u8651\u5220\u53bb\u73af $C$ \u7684\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u76f8\u5f53\u4e8e\u73af $C$ \u53ea\u6709\u4e00\u6761\u5165\u8fb9\u3002\u8fd9\u53c8\u4e0e DST \u6709\u76f8\u4f3c\u4e4b\u5904\u3002\u8003\u8651\u5c06\u73af $C$ \u7f29\u6210\u4e00\u4e2a\u70b9\uff0c\u5728\u5f97\u5230\u7684\u65b0\u56fe $G'$ \u4e2d\uff0c\u56fe $G'$ \u4e2d\u7684\u4e00\u4e2a DST \u53ef\u4ee5\u5bf9\u5e94\u6211\u4eec\u6240\u9700\u8981\u7684\u8003\u8651\u7684\u4e00\u4e2a DST\u3002\u8fd9\u542f\u53d1\u7740\u6211\u4eec\u8fdb\u884c\u4e00\u6b21\u9012\u5f52\u7684\u64cd\u4f5c\uff1a\u5047\u5b9a\u539f\u6765\u6211\u4eec\u9009\u62e9\u4e86\u73af $C$ \u4e2d\u6240\u6709\u7684\u8fb9\uff0c\u4f46\u7531\u4e8e DST \u5b9a\u4e49\u7684\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u4ece\u4e2d\u66ff\u6362\u6389\u4e00\u6761\u8fb9 $u$\uff0c\u6362\u6210\u73af $C$ \u5916\u7684\u4e00\u6761\u8fb9 $v$\uff0c\u6b64\u65f6\u8fb9\u6743\u4e4b\u548c\u4f1a\u591a\u589e\u52a0 $w(v) - w(u)$\u3002\u6240\u4ee5\uff0c\u5c06\u73af $C$ \u7f29\u4e3a\u4e00\u4e2a\u70b9 $c$ \u65f6\uff0c\u8bbe\u73af $C$ \u4e2d\u8fdb\u5165\u70b9 $x$ \u7684\u8fb9\u4e3a $\\\\mathrm{in}(x)$\uff0c\u5bf9\u56fe $G$ \u4e2d\u7684\u6240\u6709\u8fb9 $e:\\\\ u \\\\rightarrow v$ \u4f5c\u5982\u4e0b\u5904\u7406\uff1a<br/><br/>\u5982\u679c $u,\\\\ v \\\\notin C$\uff0c\u5373\u73af\u5916\u4e00\u6761\u8fb9\uff0c\u8be5\u8fb9\u4fdd\u6301\u4e0d\u53d8\u3002<br/>\u5982\u679c $u,\\\\ v \\\\in C$\uff0c\u5373\u5185\u63a5\u5728\u73af\u4e0a\u7684\u4e00\u6761\u8fb9\uff0c\u5c06\u8fd9\u6761\u8fb9\u5220\u53bb\u3002<br/>\u5982\u679c $u \\\\in C$ \u800c $v \\\\notin C$\uff0c\u76f8\u5f53\u4e8e\u4ece\u73af $C$ \u51fa\u53d1\u7684\u8fb9\uff0c\u5219\u5c06 $u$ \u6539\u4e3a $c$\u3002<br/>\u5426\u5219\u5c31\u662f\u8fdb\u5165\u73af $C$ \u7684\u8fb9\uff0c\u6b64\u65f6\u5c06 $v$ \u6539\u4e3a $c$\uff0c\u4e14\u8fb9\u6743\u53d8\u4e3a $w(e) - w(\\\\mathrm{in}(v))$\u3002<br/><br/>\u5728\u5f97\u5230\u7684\u65b0\u56fe $G'$ \u4e2d\u8ba1\u7b97 MDST\uff0c\u5f97\u5230 $T'$\uff0c\u6839\u636e $T'$ \u8fdb\u5165 $c$ \u7684\u8fb9\u7684 \u201c\u524d\u8eab\u201d \u5c31\u53ef\u4ee5\u77e5\u9053\u73af $C$ \u4e2d\u5e94\u8be5\u629b\u5f03\u54ea\u4e00\u6761\u8fb9\u4e86\u3002\u5c06\u539f\u56fe $G$ \u4e2d\u7684\u81ea\u73af\u6392\u9664\u540e\uff0c\u6bcf\u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\u81f3\u5c11\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(VE)$\u3002<br/>\u5feb\u901f\u5b9e\u73b0<br/>\u6211\u4eec\u77e5\u9053\uff0c\u65e0\u5411\u56fe\u4e2d\u6700\u5c0f\u751f\u6210\u6811\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u53d6\u51b3\u4e0e\u6392\u5e8f\u7684\u590d\u6742\u5ea6\uff0c\u5373 $O(E \\\\log E)$ \u6216\u6bd4\u8fd9\u66f4\u597d\u7684 $O(E + V \\\\log V)$\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u4e4b\u524d\u7684\u7b97\u6cd5\u5b9e\u5728\u662f\u592a\u6162\u4e86\u3002\u4e8e\u662f\u4f1f\u5927\u7684 Tarjan \u8001\u7237\u5b50 [3] \u5c31\u51fa\u73b0\u4e86\u3002Tarjan \u5728 1977 \u5e74\u63d0\u51fa\u4e86\u4e00\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(E \\\\log V)$ \u7684\u5b9e\u73b0\uff0c\u4ed6\u5c06\u4e0a\u8ff0\u7b97\u8fdb\u884c\u4e86\u8c03\u6574\uff0c\u4f7f\u7528\u4e00\u4e2a\u8fed\u4ee3\u5f0f\u7684\u8fc7\u7a0b\u5b8c\u6210\u4e86\u7b97\u6cd5\u3002\u9996\u5148\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5047\u5b9a\u5e26\u6743\u6709\u5411\u56fe $G$ \u662f\u5f3a\u8fde\u901a\u7684\u3002\u5373\u4f7f\u6ca1\u6709\u5f3a\u8fde\u901a\uff0c\u53ef\u4ee5\u6dfb\u52a0 $V$ \u6761\u8fb9\u5c06\u6bcf\u4e2a\u70b9\u987a\u6b21\u8fde\u6210\u4e00\u4e2a\u73af\uff0c\u5e76\u4e14\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u8db3\u591f\u5927\uff0c\u4f7f\u5f97\u5b83\u4eec\u4e0d\u4f1a\u51fa\u73b0\u5728 MDST \u4e2d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u5f3a\u8fde\u901a\u3002<br/>\u7b97\u6cd5\u5f00\u59cb\u65f6\uff0c\u9009\u53d6\u56fe\u4e2d\u4efb\u610f\u4e00\u4e2a\u70b9 $x$\uff0c\u7136\u540e\u9009\u53d6 $x$ \u7684\u5165\u8fb9\u4e2d\u8fb9\u6743\u6700\u5c0f\u7684\u8fb9 $e:\\\\ u \\\\rightarrow x$\uff0c\u5982\u679c \u4e4b\u524d\u6ca1\u6709\u8bbf\u95ee\u8fc7 $u$\uff0c\u5219\u5c06 $u$ \u8ffd\u52a0\u5230 $x$ \u540e\u9762\uff0c\u6784\u6210\u4e00\u6761\u94fe\uff0c\u7136\u540e\u7ee7\u7eed\u4ece $u$ \u5f00\u59cb\u6267\u884c\u540c\u6837\u7684\u6b65\u9aa4\u3002\u5982\u679c $u$ \u5df2\u7ecf\u88ab\u8bbf\u95ee\u8fc7\uff0c\u8bf4\u660e\u5728\u94fe\u4e2d\u5f62\u6210\u4e86\u4e00\u4e2a\u73af\uff0c\u6b64\u65f6\u5219\u6267\u884c\u7f29\u73af\u64cd\u4f5c\u3002\u6700\u540e\uff0c\u7531\u4e8e\u5f3a\u8fde\u901a\u7684\u7279\u6027\uff0c\u6574\u5f20\u56fe\u4f1a\u88ab\u7f29\u6210\u4e00\u4e2a\u70b9\u3002\u5728\u6b64\u671f\u95f4\uff0c\u6211\u4eec\u53ef\u4ee5\u5b58\u4e0b\u7f29\u73af\u7684\u64cd\u4f5c\u7ed3\u679c\uff0c\u8fd9\u7528\u4e00\u68f5\u6811\u6765\u8868\u793a\uff1a<br/><br/>Fig.2. \u5de6\u8fb9\u662f\u4e00\u4e2a $4$ \u4e2a\u70b9\u7684\u5f3a\u8fde\u901a\u56fe\uff0c\u53f3\u8fb9\u662f\u7b97\u6cd5\u5b8c\u6210\u540e\u6240\u7ed9\u51fa\u7684\u6811\u7ed3\u6784\u3002\u9996\u5148\u5c06\u73af $1 \\\\rightarrow 2 \\\\rightarrow 3$ \u7f29\u4e3a\u4e86\u70b9 $5$\uff0c\u7136\u540e\u5c06\u73af $5 \\\\rightarrow 4$ \u7f29\u4e3a\u4e86\u70b9 $6$\u3002\u8fd9\u68f5\u6811\u5c55\u793a\u4e86\u73af\u4e0e\u73af\u4e4b\u95f4\u5d4c\u5957\u7684\u5173\u7cfb\u3002<br/>\u5f97\u5230\u8fd9\u68f5\u6811\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u4efb\u610f\u5408\u6cd5\u7684\u6839\u8282\u70b9\u5f00\u59cb\u5c55\u5f00\u6574\u4e2a MDST \u4e86\u3002\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\u7f29\u70b9\u4e00\u822c\u91c7\u7528\u5e76\u67e5\u96c6\u6570\u636e\u7ed3\u6784\uff0c\u800c\u4e3a\u4e86\u80fd\u591f\u65e2\u5b8c\u6210\u7f29\u70b9\uff0c\u53c8\u80fd\u968f\u65f6\u4ece\u67d0\u4e2a\u70b9\u4e2d\u62bd\u51fa\u8fb9\u6743\u6700\u5c0f\u7684\u5165\u8fb9\uff0c\u8fd9\u91cc\u5219\u9700\u8981\u53ef\u5e76\u5806\u6765\u9ad8\u6548\u5b9e\u73b0\u3002\u4e0a\u9762\u8bf4\u7684\u6bd4\u8f83\u7c97\u7cd9\uff0c\u56e0\u4e3a\u4ed4\u7ec6\u8bb2\u8d77\u6765\u5c31\u592a\u7ec6\u8282\u5316\u4e86\u3002\u6211\u5b9e\u73b0\u4e86\u6734\u7d20\u7684 $O(VE)$ \u7b97\u6cd5\u548c Tarjan \u7684\u5feb\u901f\u7b97\u6cd5\uff0c\u7528 POJ 3164 \u6d4b\u8bd5\u4e86\u4e0b\uff0c\u5982\u679c\u7ec6\u8282\u4e0a\u6709\u95ee\u9898\u7684\u53ef\u4ee5\u53c2\u8003\u4e00\u4e0b\uff1a<br/>$O(VE)$ \u7248\u672c\u3001$O(E \\\\log V)$ \u7248\u672c<br/>\u53e6\u5916\uff0c\u6211\u662f\u770b\u7684 Uri Zwick \u6559\u6388 [4] \u7684\u8bb2\u7a3f\u5199\u7684\u7b97\u6cd5\uff0c\u91cc\u9762\u7684\u5b9e\u73b0\u90e8\u5206\u5199\u7684\u6bd4\u8f83\u8be6\u7ec6\u3002<br/>\u76f8\u5173\u95ee\u9898<br/>\u4e0a\u9762\u7684\u8ba8\u8bba\u4e2d\uff0cMDST \u7684\u6811\u6839\u90fd\u662f\u7ed9\u5b9a\u4e86\u7684\u3002\u800c\u5728\u6709\u4e9b\u95ee\u9898\u4e2d\uff0c\u53ef\u80fd\u6ca1\u6709\u7ed9\u5b9a\u6811\u6839\uff08\u66f4\u7c7b\u4f3c\u4e8e\u65e0\u5411\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u4e86\uff09\u3002\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u5e76\u4e0d\u9700\u8981\u8fdb\u884c $O(V)$ \u6b21\u5c55\u5f00\u3002\u6211\u4eec\u53ef\u4ee5\u7ed9\u56fe\u65b0\u589e\u4e00\u4e2a\u70b9 $x$\uff0c\u5411\u539f\u56fe\u4e2d\u6bcf\u4e00\u4e2a\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u8db3\u591f\u5927\u7684\u8fb9\uff0c\u8fd9\u6837\u4ee5 $x$ \u4e3a\u6839\u7684 MDST \u4e2d\uff0c\u7b97\u6cd5\u53ea\u4f1a\u9009\u62e9\u4e00\u6761 $x$ \u7684\u51fa\u8fb9\uff0c\u6bd5\u7adf\u9009\u62e9\u8fd9\u6837\u7684\u8fb9\u975e\u5e38\u4e0d\u5212\u7b97\u3002\u800c\u6b64\u65f6 $x$ \u7684\u51fa\u8fb9\u6240\u6307\u5411\u7684\u70b9\u5c31\u662f\u539f\u95ee\u9898\u4e2d MDST \u7684\u6811\u6839\u3002<br/>\u53c2\u8003\u6587\u732e<br/>[1]. Chu, Y. J.; Liu, T. H. (1965), On the Shortest Arborescence of a Directed Graph, Science Sinica, 14: 1396\u20131400<br/>[2]. Edmonds, J. (1967), Optimum Branchings, J. Res. Nat. Bur. Standards, 71B: 233\u2013240, doi:10.6028/jres.071b.032<br/>[3]. R.E. Tarjan. (1977), Finding optimum branchings, Networks, 7:25\u201335<br/>[4]. Uri Zwick. (2013), Directed Minimum Spanning Trees, Lecture notes on \u201cAnalysis of Algorithms\u201d<br/>[5]. H.N. Gabow, Z. Galil, T.H. Spencer, and R.E. Tarjan. (1986), Efficient algorithms for finding minimum spanning trees in undirected and directed graphs, Combinatorica, 6:109\u2013122<br/><br/><br/><br/><br/>\u4f8b\u5982\uff0c\u4e00\u68f5 DST \u4e0a\u7684\u6240\u6709 \u201c\u8fd4\u7956\u8fb9\u201d\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2018-6-18/mdst.html"
},
"\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41": {
"tags": "\u7b97\u6cd5 \u7f51\u7edc\u6d41 \u6700\u5c0f\u8d39\u7528\u6d41 \u56fe\u8bba",
"text": "\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41<br/>\u4e4b\u524d\u4e00\u76f4\u60f3\u4e0d\u660e\u767d\u6700\u5c0f\u8d39\u7528\u6d41\uff0c\u4eca\u5929\u7ffb\u4e86\u5f88\u591a\u8d44\u6599\u624d\u7406\u89e3\u4e86\uff0c\u5728\u6b64\u505a\u70b9\u8bb0\u5f55\u3002<br/>\u6700\u5c0f\u8d39\u7528\u6d41<br/>\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u6d41$f$\u7684\u8d39\u7528$w(f)$\u4e3a\uff1a<br/>$$<br/>w(f) = \\\\sum_{(u,v)\\\\in f} w(u,v)f(u,v)<br/>$$<br/>\u90a3\u4e48\u6700\u5c0f\u8d39\u7528\uff08\u53ef\u884c\uff09\u6d41\u5c31\u662f\u6307\u4e00\u4e2a\u5728\u6240\u6709\u540c\u6d41\u91cf\u7684\u6d41\u4e2d\u8d39\u7528\u6700\u5c0f\u7684\u6d41\u3002<br/>\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u95ee\u9898<br/>\u5728\u7ed9\u5b9a\u7684\u6d41\u7f51\u7edc$G$\u4e2d\uff0c\u82e5$(u,v)\\\\in E$\uff0c\u5219$c(u,v)$\u8868\u793a\u5176\u5bb9\u91cf\uff0c$w(u,v)$\u8868\u793a\u5176\u5355\u4f4d\u6d41\u8d39\u7528\u3002\u8bbe$f$\u4e3a\u5176\u4e2d\u7684\u53ef\u884c\u6d41\uff0c\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u95ee\u9898\u5c31\u662f\u8981\u6c42\u5728\u4f7f$f$\u4e3a\u6700\u5927\u6d41\u7684\u60c5\u51b5\u4e0b\uff0c\u5176\u603b\u8d39\u7528$w(f)$\u6700\u5c0f\u3002<br/>\u589e\u5e7f\u8def\u7b97\u6cd5<br/>\u672c\u6587\u4e2d\u6211\u4eec\u53ea\u8ba8\u8bba\u589e\u5e7f\u8def\u7b97\u6cd5\u3002\u6700\u5c0f\u8d39\u7528\u6d41\u8fd8\u6709\u6d88\u5708\u6cd5\u548c\u795e\u5947\u7684ZKW\u7b97\u6cd5\u3002<br/>\u589e\u5e7f\u8def\u7b97\u6cd5\u6709\u4e00\u4e2a\u8d2a\u5fc3\u7684\u57fa\u672c\u601d\u60f3\uff1a\u5df2\u77e5\u4e00\u4e2a\u6700\u5c0f\u8d39\u7528\u6d41$f$\uff0c\u5728\u6d41\u7f51\u7edc\u4e2d\u627e\u51fa\u4e00\u6761\u8d39\u7528\u6700\u5c0f\u7684\u589e\u5e7f\u8def\u5bf9\u5176\u589e\u5e7f\u5f97\u5230$f^,$\uff0c\u90a3\u4e48$f^,$\u4e5f\u662f\u6700\u5c0f\u8d39\u7528\u6d41\u3002<br/>\u8fd9\u4e2a\u7ed3\u8bba\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u56e0\u4e3a\u539f\u6d41\u8d39\u7528\u6700\u5c0f\uff0c\u589e\u5e7f\u51fa\u6765\u7684\u65b0\u6d41\u8d39\u7528\u4e5f\u6700\u5c0f\uff0c\u90a3\u4e48\u603b\u8d39\u7528\u4e5f\u662f\u6700\u5c0f\u7684\u3002<br/>\u56e0\u6b64\uff0c\u5bfb\u627e\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u7684\u601d\u8def\u5c31\u51fa\u6765\u4e86\uff1a<br/><br/>\u521d\u59cb\u5316\u96f6\u6d41$f$ <br/>\u5bfb\u627e\u8d39\u7528\u6700\u5c0f\u7684\u589e\u5e7f\u8def\uff0c\u5982\u679c\u6ca1\u6709\u5219\u8868\u660e$f$\u5df2\u4e3a\u6700\u5927\u6d41  <br/>\u589e\u5e7f\u6d41$f$\uff0c\u8df3\u81f3\u7b2c\u4e8c\u6b65<br/><br/>\u5728\u4e0a\u9762\u7684\u6b65\u9aa4\u4e2d\uff0c\u7b2c\u4e8c\u6b65\u662f\u5173\u952e\u3002<br/>\u6211\u4eec\u9996\u5148\u8981\u786e\u5b9a\u8d39\u7528\u6700\u5c0f\u7684\u8861\u91cf\u6807\u51c6\u3002\u9996\u5148\u8003\u8651\u4e00\u6761\u589e\u5e7f\u8def\u4f1a\u5bf9\u6d41\u589e\u52a0\u591a\u5c11\u7684\u8d39\u7528\u3002<br/>\u5047\u8bbe$p$\u662f\u4e00\u6761\u589e\u5e7f\u8def\uff0c\u5176\u74f6\u9888\u8fb9\uff08\u5373\u5269\u4f59\u5bb9\u91cf\u6700\u5c0f\u7684\u8fb9\uff09\u7684\u5bb9\u91cf\u4e3a$c_{min}$\uff0c\u90a3\u4e48\u589e\u52a0\u7684\u8d39\u7528\u5c31\u662f\u6240\u6709\u8fb9\u6240\u4ea7\u751f\u7684\u8d39\u7528\u4e4b\u548c\uff1a<br/>$$w(p) = \\\\sum_{(u,v)\\\\in p} w(u,v)c_{min} = c_{min}\\\\sum_{(u,v)\\\\in p} w(u,v)$$<br/>\u7531\u4e8e\u6211\u4eec\u8981\u4fdd\u8bc1\u6bcf\u4e00\u6b65\u90fd\u662f\u6700\u5c0f\u8d39\u7528\u6d41\uff0c\u800c\u6d41\u7684\u5927\u5c0f\u5e76\u4e0d\u5728\u610f\uff0c\u56e0\u4e3a\u6700\u540e\u80af\u5b9a\u80fd\u8fbe\u5230\u6700\u5927\u6d41\u3002<br/>\u6545\u6211\u4eec\u4e0d\u5728\u4e4e\u6bcf\u6b21\u6d41\u7684\u589e\u91cf$c_{min}$\uff0c\u800c\u53ea\u8981\u4f7f\u5355\u4f4d\u8d39\u7528\u4e4b\u548c\u6700\u5c0f\u5373\u53ef\u3002<br/>\u56e0\u6b64\u6211\u4eec\u628a\u6bcf\u6761\u5f27\u7684\u5355\u4f4d\u8d39\u7528\u4f5c\u4e3a\u5176\u8fb9\u6743\uff0c\u7136\u540e\u5bfb\u627e\u4e00\u6761\u4ece\u6e90\u70b9\u5230\u6c47\u70b9\u7684\u6700\u77ed\u8def\uff0c\u8fd9\u6837\u5c31\u80fd\u4f7f\u5355\u4f4d\u8d39\u7528\u4e4b\u548c\u6700\u5c0f\u3002<br/>\u5b9e\u73b0\u7ec6\u8282<br/>\u73b0\u5728\u6211\u4eec\u6765\u5c1d\u8bd5\u5b9e\u73b0\u589e\u5e7f\u8def\u7b97\u6cd5\uff0c\u9996\u5148\u6211\u4eec\u5b9a\u4e49\u8fb9\u7684\u7ed3\u6784\u4f53\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8# \u8868\u793a\u6709\u5411\u8fb9<br/>class DirectedEdge(object):<br/>    u:int                      # \u51fa\u53d1\u70b9<br/>    v:int                      # \u8fdb\u5165\u70b9<br/>    capacity:int               # \u5bb9\u91cf<br/>    flow:int                   # \u73b0\u6709\u6d41\u91cf<br/>    cost:int                   # \u5355\u4f4d\u6d41\u8d39\u7528<br/>    reverse_edge:DirectedEdge  # \u8868\u793a\u5176\u5728\u6b8b\u7559\u7f51\u7edc\u4e2d\u7684\u53cd\u5411\u8fb9<br/><br/><br/>\u6211\u4eec\u6dfb\u52a0\u4e00\u4e2a\u51fd\u6570\uff0c\u8ba1\u7b97\u8fb9\u7684\u7684\u5269\u4f59\u6d41\u91cf\uff1a<br/>1<br/>2def r(edge:DirectedEdge):<br/>    return edge.capacity - edge.flow<br/><br/><br/>\u5728\u6b8b\u7559\u7f51\u7edc\u4e2d\uff0c\u5982\u679c\u5269\u4f59\u5bb9\u91cf\u4e3a0,\u5b83\u5c31\u5df2\u7ecf\u4e0d\u5b58\u5728\u4e86\u3002<br/>\u6211\u4eec\u4f7fG\u4e3a\u4e00\u4e2a\u6709\u5411\u8fb9\u94fe\u8868\u7684\u6570\u7ec4\uff0c\u8868\u793a\u4ece\u67d0\u4e2a\u70b9\u51fa\u53d1\u7684\u8fb9\u96c6\u5408\u3002<br/>\u73b0\u5728\u601d\u8003\u4e0b\u6b8b\u7559\u7f51\u7edc\u4e2d\u53cd\u5411\u8fb9\u7684\u8d39\u7528\u3002\u53cd\u5411\u8fb9\u672c\u610f\u662f\u4e3a\u4e86\u6700\u5927\u6d41\u7b97\u6cd5\u80fd\u91cd\u65b0\u8c03\u6574\u6574\u4e2a\u6d41\uff0c\u8ba9\u7b97\u6cd5\u80fd\u591f\u201c\u53cd\u6094\u201d\uff0c<br/>\u56e0\u6b64\u6211\u4eec\u7ed9\u53cd\u5411\u8fb9\u7684\u8d39\u7528\u4e3a-cost\uff0c\u80fd\u591f\u4e0e\u4e4b\u524d\u7684\u9009\u62e9\u62b5\u6d88\u3002\u8fd9\u6837\u5bfc\u81f4\u51fa\u73b0\u4e86\u8d1f\u8fb9\uff0c\u56e0\u6b64\u627e\u6700\u77ed\u8def\u4e0d\u80fd\u4f7f\u7528Dijkstra\u7b97\u6cd5\uff0c<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u6dfb\u52a0\u4e00\u4e2aadd_edge\u51fd\u6570\u6765\u6dfb\u52a0\u8fb9\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10def add_edge(u:int, v:int, capacity:int, cost:int):<br/>    e  = DirectedEdge(u, v, capacity,  cost, flow=0)         # \u521d\u59cb\u4e3a\u96f6\u6d41<br/>    re = DirectedEdge(v, u, capacity, -cost, flow=capacity)  # \u6ce8\u610f\u662f\u53cd\u5411\u8fb9<br/><br/>    # \u8bbe\u7f6e\u53cd\u5411\u8fb9<br/>    e.reverse_edge = re<br/>    re.reverse_edge = e<br/><br/>    G[u].append(e)<br/>    G[v].append(re)<br/><br/><br/>\u8fd9\u6837\u5c31\u53ef\u65b9\u4fbf\u7684\u6dfb\u52a0\u8fb9<br/>\u6700\u597d\u91c7\u7528Bellman Ford\u7b97\u6cd5\uff0c\u8fd9\u91cc\u4f7f\u7528\u5176\u6539\u8fdb\u7248SPFA\u7b97\u6cd5\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23dist:int[]             = [INFTY...]  # \u8ddd\u79bb\u6570\u7ec4<br/>edge_to:DirectedEdge[] = [None...]   # \u524d\u8d8b\u8fb9\u6570\u7ec4<br/><br/>def SPFA(s:int, t:int):<br/>    q:queue<br/>    q.push(s)<br/>    dist[s] = 0<br/><br/>    while q not empty:<br/>        u:int = q.pop()<br/><br/>        for edge in G[u]:<br/>            if r(edge) == 0:  # \u5982\u679c\u5269\u4f59\u5bb9\u91cf\u4e3a0,\u8fd9\u6761\u8fb9\u5c31\u4e0d\u5b58\u5728<br/>                continue<br/><br/>            # \u677e\u5f1b\u64cd\u4f5c<br/>            v:int = edge.v<br/>            if dist[v] > dist[u] + edge.cost:<br/>                dist[v]    = dist[u] + edge.cost<br/>                edge_to[v] = edge  # \u66f4\u65b0\u524d\u8d8b\u8fb9<br/><br/>                if v not in q:<br/>                    q.push(v)<br/><br/><br/>\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u5199\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u7b97\u6cd5\u4e86\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33s:int  # \u6e90\u70b9<br/>t:int  # \u6c47\u70b9<br/><br/>def compute_maxflow():<br/>    answer:int = 0<br/><br/>    while True:<br/>        SPFA(s, t)  # \u5bfb\u627e\u589e\u5e7f\u8def<br/><br/>        if dist[t] == INFTY:  # \u5982\u679c\u6ca1\u6709\u589e\u5e7f\u8def\uff0cs\u5230t\u7684\u8ddd\u79bb\u5c31\u4e0d\u4f1a\u66f4\u65b0<br/>            return<br/><br/>        minflow:int = INFTY  # \u74f6\u9888\u8fb9\u5bb9\u91cf<br/><br/>        # \u5bfb\u627e\u74f6\u9888\u8fb9<br/>        x:int = t<br/>        while edge_to[x] is not None:<br/>            minflow = min(minflow, r(edge_to[x]))<br/><br/>            x = edge_to[x].u<br/><br/>        # \u589e\u5e7f<br/>        x = t<br/>        while edge_to[x] is not None:<br/>            DirectedEdge e = edge_to[x]<br/><br/>            answer += minflow * e.cost  # \u66f4\u65b0\u603b\u8d39\u7528<br/>            e.flow += minflow<br/>            e.reverse_edge.flow -= minflow<br/><br/>            x = edge_to[x].u<br/><br/>    return answer<br/><br/><br/>\u81f3\u6b64\uff0c\u589e\u5e7f\u8def\u7b97\u6cd5\u5c31\u7ed3\u675f\u4e86\u3002\u73b0\u5728\u603b\u7ed3\u4e0b\u5176\u4e2d\u6d89\u53ca\u5230\u7684\u5173\u952e\uff1a<br/>1. \u8d2a\u5fc3\u9009\u62e9\uff1a\u6bcf\u6b21\u5bfb\u627e\u8d39\u7528\u6700\u5c11\u7684\u589e\u5e7f\u8def<br/>2. \u53cd\u5411\u8fb9\u8fb9\u6743\uff1a\u662f\u76f8\u53cd\u7684<br/>3. SPFA: \u5bfb\u627e\u6700\u77ed\u8def",
"url": "blog/2016-2-2/mincost-maxflow.html"
},
"\u6700\u8fd1\u516c\u5171\u7956\u5148(LCA)": {
"tags": "\u7b97\u6cd5 LCA",
"text": "\u6700\u8fd1\u516c\u5171\u7956\u5148(LCA)<br/><br/>NOTICE: \u8fd9\u662f\u4e00\u7bc7\u65e7\u6587\uff0c\u53ef\u80fd\u5b58\u5728\u4e00\u4e9b\u6ca1\u6709\u88ab\u52d8\u5bdf\u51fa\u7684\u9519\u8bef\u3002\u53e6\u6709\u4e00\u7bc7\u540c\u4e3b\u9898\u7684\u6587\u7ae0\u5728\u6b64\u3002<br/><br/>1 \u6982\u8ff0<br/>1.1 \u4ec0\u4e48\u662fLCA\uff1f<br/>\u4e0b\u9762\u662f\u4e00\u68f5\u6709\u6839\u6811\uff0c\u6ce8\u610f\u4e0d\u4e00\u5b9a\u662f\u4e8c\u53c9\u6811\u3002<br/><br/>\u6211\u4eec\u5148\u5b9a\u4e49\u6df1\u5ea6\u51fd\u6570$ d(u): u \\\\text{\u5230\u6839\u7684\u6700\u77ed\u8ddd\u79bb} $\u3002<br/>\u4f8b\u5982\uff0c\u5728\u4e0a\u56fe\u4e2d$ d(1)=0,\\\\,d(3)=1,\\\\,d(9)=3$<br/>\u6211\u4eec\u518d\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570$ LCA(u, v) $\u8868\u793a\u8282\u70b9$ u $\u548c$ v $\u7684\u6700\u5c0f\u516c\u5171\u7956\u5148\u3002<br/>\u5176\u5b9a\u4e49\u4e3a\uff1a<br/>$$ LCA(u,v):u\u548cv\u7684\u6240\u6709\u7956\u5148p\u4e2d,d(p)\u6700\u5927 $$<br/>\u4e3e\u4e2a\u4f8b\u5b50\uff1a$ LCA(5,6)=3,\\\\,LCA(7,6)=3,\\\\,LCA(1,8)=1 $<br/>\u5e94\u8be5\u5f88\u7b80\u5355\u5427\u3002<br/>1.2 \u6709\u4ec0\u4e48\u5375\u7528\uff1f<br/>\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u8ba1\u7b97\u5b8cLCA\u540e\uff0c\u53ef\u4ee5\u5728$ \\\\Theta (1) $\u7684\u65f6\u95f4\u5185\u7b97\u51fa\u4efb\u610f\u4e24\u70b9\u7684\u8ddd\u79bb\u3002<br/>\u8fd8\u662f\u4e0b\u9762\u8fd9\u4e2a\u56fe\u89e3\u91ca\uff1a<br/><br/>\u4e0a\u9762\u7684\u6811\u8fb9\u4e0a\u5e26\u4e86\u6743\u91cd\uff0c\u4e24\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u5c31\u662f\u4e24\u70b9\u95f4\u7684\u7b80\u5355\u8def\u5f84\u4e0a\u7684\u8fb9\u6743\u4e4b\u548c\u3002<br/>\u4f8b\u5982$ distance(1,1)=0,\\\\,distance(2,3)=3,\\\\,distance(7,6)=6$<br/>\u5982\u679c\u7528DFS\u6216BFS\u6765\u8ba1\u7b97\u7684\u8bdd\uff0c\u9700\u8981$ O(n) $\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002<br/>\u5982\u679c\u5148\u9884\u5904\u7406LCA\uff0c\u5c31\u53ea\u9700$ \\\\Theta (1) $\u7684\u65f6\u95f4\u3002<br/>\u5148\u4e0d\u8003\u8651\u662f\u5982\u4f55\u7b97\u51faLCA\u7684\uff0c\u5148\u8bb2\u4e0b\u5982\u4f55\u5feb\u901f\u6c42\u8ddd\u79bb\u3002<br/>\u4e0a\u56fe\u4e2d\uff0cdist\u6570\u7ec4\u8868\u793a\u8282\u70b9\u5230\u6811\u6839\u7684\u8ddd\u79bb\uff0c\u5728\u56fe\u4e2d\u5df2\u7ecf\u8ba1\u7b97\u51fa\u6765\u3002<br/>\u8fd9\u4e2a\u6570\u7ec4\u5f88\u597d\u8ba1\u7b97\uff0c\u6839\u636e\u4e0b\u9762\u7684\u516c\u5f0f\u76f4\u63a5\u5c06\u6811BFS\u4e00\u904d\u5373\u53ef\uff0c\u5176\u4e2d$ u $\u662f$ v $\u7684\u7236\u8282\u70b9\uff0c$w[u, v]$\u8868\u793a$ u $\u5230$ v $\u7684\u8fb9\u6743\u3002<br/>$$ dist[v] = dist[u] + w[u,v] \\\\tag{1.1}$$<br/>\u90a3\u4e48\u4e24\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb$ distance(u,v) $\u7684\u8ba1\u7b97\u975e\u5e38\u7b80\u5355\uff1a<br/>$$ distance(u,v) = dist[u] + dist[v] - 2 \\\\times dist[LCA(u, v)] \\\\tag{1.2} $$<br/>\u53ef\u4ee5\u60f3\u8c61\u6210\u662fLink\u8fd9\u4e2a\u4eba\u4ece$ u $\u5148\u8d70\u5230\u6839\u8282\u70b9\uff0c\u518d\u4ece\u6839\u8282\u70b9\u8d70\u5230$ v $\u3002\u7531\u4e8e\u4ece\u6839\u8282\u70b9\u5230$ LCA(u,v) $\u8d70\u4e86\u4e24\u904d\uff0c\u56e0\u6b64Link\u8d70\u7684\u603b\u8def\u7a0b\uff0c\u51cf\u53bb\u8fd9\u4e00\u6bb5\u6765\u56de\u8d70\u7684\u5373\u53ef\u3002<br/>1.3 \u9884\u5907\u77e5\u8bc6<br/>\u56e0\u4e3aLCA\u7684\u7b97\u6cd5\u4e2d\u4f1a\u7528\u5230\u5e76\u67e5\u96c6\uff0c\u4f46\u6211\u4eec\u8fd8\u6ca1\u5b66\uff0c\u56e0\u6b64\u5e76\u67e5\u96c6\u7684\u5b9e\u73b0\u4e0d\u4f1a\u8fc7\u591a\u7ea0\u7ed3\uff0c\u6211\u4eec\u53ea\u9700\u77e5\u9053\u5e76\u67e5\u96c6\u63d0\u4f9b\u7684\u51e0\u4e2a\u51fd\u6570\u5373\u53ef\u3002<br/>\u5e76\u67e5\u96c6\u63d0\u4f9b\u67e5\u8be2\u548c\u8fde\u63a5\u64cd\u4f5c\uff1a<br/>1<br/>2def find(u) -> int<br/>def union(u, v) -> void<br/><br/><br/><br/><br/>find\u51fd\u6570\u4f1a\u8fd4\u56de\u8282\u70b9u\u6240\u5728\u7684\u96c6\u5408\u7f16\u53f7\uff0c\u5982\u679cfind(a) == find(b)\u5219\u8868\u793aa\u548cb\u5904\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002<br/><br/><br/>union\u51fd\u6570\u4f1a\u5c06u\u548cv\u6240\u5728\u7684\u96c6\u5408\u5e76\u8d77\u6765\uff0c\u5373\u4f7fu\u548cv\u5904\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002<br/><br/><br/>\u540e\u9762\u4f1a\u63d0\u5230\u5728\u7ebf\u548c\u79bb\u7ebf\u7684\u6982\u5ff5\uff0c\u53ea\u8981\u77e5\u9053\u79bb\u7ebf\u662f\u5148\u5c06\u6240\u6709\u64cd\u4f5c\u8bfb\u5165\u540e\u518d\u4f5c\u5904\u7406\u5c31\u884c\u4e86\u3002<br/>2 LCA\u7b97\u6cd5<br/>\u8ba1\u7b97LCA\u7684\u7b97\u6cd5\u6709\u5f88\u591a\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u4e09\u4e2a\u3002<br/>2.1 \u6734\u7d20\u7b97\u6cd5<br/>\u6734\u7d20\u7b97\u6cd5\u662f\u6700\u7b80\u5355\u7684\u4e86\uff0c\u6309\u7167\u56fd\u9645\u60ef\u4f8b\uff0c\u5148\u653e\u56fe\uff1a<br/><br/>\u6734\u7d20\u7b97\u6cd5\u7684\u505a\u6cd5\u5982\u4e0b\uff1a<br/><br/><br/>\u5148\u5c06\u4e24\u4e2a\u7ed3\u70b9\u8c03\u4e3a\u540c\u4e00\u6df1\u5ea6<br/>\u5c06\u4e24\u4e2a\u7ed3\u70b9\u540c\u65f6\u4e0a\u8c03\uff0c\u76f4\u5230\u8fd9\u4e24\u4e2a\u7ed3\u70b9\u5230\u8fbe\u540c\u4e00\u4f4d\u7f6e\u65f6\uff0c\u6b64\u65f6\u5373\u4e3aLCA<br/><br/><br/>\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14def Plain_LCA(u, v):<br/>    if d(u) < d(v):<br/>        swap(u, v)  # \u59cb\u7ec8\u4fdd\u6301u\u6240\u5904\u7684\u6df1\u5ea6\u8f83\u6df1<br/><br/>    while d(u) != d(v):<br/>        u = father(u)  # \u5c06u\u4e0a\u8c03<br/><br/>    # \u5c06u\u548cv\u540c\u65f6\u4e0a\u8c03<br/>    while u != v:<br/>        u = father(u)<br/>        v = father(v)<br/><br/>    # \u6700\u540e\u4f1a\u4f7fu == v\uff0c\u5373\u4ed6\u4eec\u5230\u8fbe\u4e86LCA<br/>    return u<br/><br/><br/>2.2 \u79bb\u7ebf\u7b97\u6cd5\uff1aTarjan-LCA<br/>\u6734\u7d20\u7b97\u6cd5\u5f88\u7b80\u5355\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u80fd\u5f88\u5feb\u7b97\u51faLCA\u3002<br/>\u7136\u800c\u5728\u8ba1\u7b97$ LCA(4,6) $\u65f6\uff0c\u9700\u8981\u4ece\u6811\u7684\u5e95\u90e8\u8d70\u5230\u6839\u8282\u70b9\u3002<br/>\u56e0\u6b64\u6734\u7d20\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$ O(n) $\uff0c\u5f88\u5bb9\u6613TLE\u3002<br/>\u56e0\u6b64\u6211\u4eec\u7684\u524d\u4eba\u60f3\u51fa\u4e86\u673a\u667a\u7684Tarjan-LCA\u7b97\u6cd5\uff01<br/>Tarjan-LCA\u7b97\u6cd5\u6bd4\u8f83\u96be\u7406\u89e3\uff0c\u6700\u597d\u7684\u7406\u89e3\u65b9\u6cd5\u662f\u624b\u52a8\u6a21\u62df\u4e00\u4e0b\u3002<br/>\u5148\u653e\u51fa\u4f2a\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18def Tarjan_LCA(u):<br/>    # ancestor\u6570\u7ec4\u8868\u793a\u4e00\u4e2a\u96c6\u5408\u7684\u516c\u5171\u7956\u5148<br/>    # \u5982ancestor[i]\u8868\u793a\u6807\u53f7\u4e3ai\u7684\u96c6\u5408\u4e2d\u6240\u6709\u7ed3\u70b9\u7684\u516c\u5171\u7956\u5148\u3002<br/>    # marked\u6570\u7ec4\u8868\u793a\u7ed3\u70b9\u662f\u5426\u88ab\u5904\u7406\u8fc7<br/><br/>    ancestor[find(u)] = u<br/><br/>    for v in u.children:  # \u904d\u5386u\u7684\u513f\u5b50\u8282\u70b9<br/>        Tarjan_LCA(v)<br/>        union(u, v)<br/>        ancestor[find(u)] = u<br/><br/>    marked[u] = true<br/><br/>    # query\u6570\u7ec4\u8868\u793a\u67e5\u8be2\u64cd\u4f5c\uff0c\u4fdd\u5b58\u7684\u662f(x, y)\uff0c\u8868\u793a\u8981\u8ba1\u7b97LCA(x, y)<br/>    for (x, y) in query:<br/>        if y == u and marked[x] == True:<br/>            LCA(x, y) = LCA(y, x) = ancestor[x]<br/><br/><br/>\u8fd9\u4e2a\u7b97\u6cd5\u7684\u8fdb\u884c\u7c7b\u4f3c\u4e8eDFS\uff0c\u662f\u4e2a\u9012\u5f52\u8c03\u7528\u7684\u8fc7\u7a0b\u3002<br/>\u56e0\u4e3aDFS\u603b\u662f\u5148\u5c06\u5c0f\u7684\u5b50\u6811\u904d\u5386\u5b8c\uff0c\u56e0\u6b64ancestor\u6570\u7ec4\u4e2d\u7684\u7956\u5148\u90fd\u662f\u5c3d\u53ef\u80fd\u5c0f\u7684\u3002<br/>\u62ff\u4e00\u68f5\u8f83\u5c0f\u7684\u5b50\u6811\u4f5c\u4e3a\u793a\u4f8b\uff1a<br/><br/>\u4e00\u5f00\u59cb\u5148DFS\u52307\u5904\u3002<br/><br/>\u5904\u7406\u52307\u65f6\u8fd8\u5e76\u6ca1\u6709\u4ec0\u4e48\u7ed3\u70b9\u88ab\u5904\u7406\u8fc7\uff0c\u53ea\u597d\u9ed8\u9ed8\u7684\u56de\u52305\u3002<br/><br/>5\u5904\u5c067\u548c\u81ea\u5df1\u76f8\u8fde\uff0c\u5f62\u6210\u96c6\u5408{5, 7}\uff0c5\u662f\u8fd9\u4e2a\u96c6\u5408\u7684\u516c\u5171\u7956\u5148\u3002<br/><br/>\u73b0\u5728DFS\u52309\u3002<br/><br/>\u5047\u8bbe\u6211\u4eec\u8be2\u95ee\u4e86$ LCA(7,9) $\uff0c\u90a3\u4e48\u5728\u5904\u74069\u65f6\uff0c\u4f1a\u53d1\u73b07\u88ab\u5904\u7406\u8fc7\u4e86\uff0c7\u6240\u5728\u7684\u96c6\u5408\u7684\u516c\u5171\u7956\u5148\u4e3a5\u3002<br/>\u800c9\u662f\u4ece5\u9012\u5f52\u4e0b\u6765\u7684\uff0c\u56e0\u6b649\u4e0e7\u7684\u516c\u5171\u7956\u5148\u4e2d\u67095\u3002<br/>\u53c8\u56e0\u4e3aDFS\u4f1a\u5c3d\u53ef\u80fd\u7684\u5904\u7406\u8f83\u5c0f\u7684\u5b50\u6811\uff0c\u56e0\u6b645\u5c06\u4f1a\u662f$ LCA(7, 9) $\u3002<br/>\u5269\u4e0b\u7684\u6b65\u9aa4\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u624b\u63a8\u4e00\u4e0b\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\u7406\u89e3\uff0c\u5927\u5bb6\u53ef\u4ee5\u5c06Tarjan-LCA\u7b97\u6cd5\u6362\u4e2a\u8bf4\u6cd5\uff1a<br/><br/>\u4e00\u4e2a\u718a\u5b69\u5b50Link\u4ece\u4e00\u68f5\u6709\u6839\u6811\u7684\u6700\u5de6\u8fb9\u6700\u5e95\u4e0b\u7684\u7ed3\u70b9\u704c\u5ca9\u6d46\uff0cLink\u8868\u793a\u5f88\u8ba8\u538c\u8fd9\u79cd\u5012\u7740\u957f\u7684\u6811\u3002<br/>\u5ca9\u6d46\u4f1a\u4e0d\u65ad\u7684\u6ce8\u5165\uff0c\u76f4\u5230\u6ce8\u6ee1\u6574\u4e2a\u6811\u2026<br/>\u5982\u679c\u5ca9\u6d46\u704c\u6ee1\u4e86\u4e00\u68f5\u5b50\u6811\uff0cLink\u53d1\u73b0\u6811\u7684\u53e6\u4e00\u8fb9\u6709\u4e00\u68f5\u66f4\u6df1\u7684\u5b50\u6811\uff0cLink\u4f1a\u5148\u53bb\u5c06\u90a3\u68f5\u5b50\u6811\u704c\u6ee1\u3002<br/>\u5ca9\u6d46\u53ea\u6709\u5728\u8feb\u4e0d\u5f97\u5df2\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u5411\u4e0a\u5347\u9ad8\uff0c\u627e\u5230\u4e00\u4e2a\u65b0\u7684\u5b50\u6811\u7ee7\u7eed\u6ce8\u5165\u3002<br/>\u673a(yu)\u667a(chun)\u7684Link\u53d1\u73b0\u4e86\u627eLCA\u7684\u597d\u65b9\u6cd5\uff0c\u5373\u5982\u679c\u4e24\u4e2a\u7ed3\u70b9\u90fd\u88ab\u5ca9\u6d46\u70e7\u6389\u65f6\uff0c\u4ed6\u4eec\u7684LCA\u5373\u4e3a\u90a3\u68f5\u5b50\u6811\u4e0a\u5ca9\u6d46\u6700\u9ad8\u7684\u4f4d\u7f6e\u3002<br/><br/>Tarjan-LCA\u7b97\u6cd5\u80fd\u5728$ \\\\Theta (n + q) $\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa\u6240\u6709\u8be2\u95ee\u7684LCA\uff0c\u5176\u4e2d$ q $\u4e3a\u8be2\u95ee\u603b\u6570\u3002<br/>\u8fd9\u5f97\u76ca\u4e8e\u5e76\u67e5\u96c6\u7684\u9ad8\u6548\u3002<br/>\u540c\u6837\u6211\u4eec\u4e5f\u80fd\u4ee5\u6b64\u7b97\u51fa\u6240\u6709\u70b9\u5bf9\u7684LCA\u3002<br/>2.3 \u5728\u7ebf\u7b97\u6cd5\uff1a\u500d\u589e\u6cd5<br/>Tarjan-LCA\u7b97\u6cd5\u901f\u5ea6\u5f88\u5feb\uff0c\u6548\u679c\u4e5f\u5f88\u597d\uff0c\u4f46\u6709\u4e00\u4e2a\u81f4\u547d\u7684\u95ee\u9898\u2026<br/>\u5c31\u662f\u5185\u5b58\u5360\u7528\u3002<br/>\u9996\u5148\u5b83\u9700\u8981\u79bb\u7ebf\u64cd\u4f5c\uff0c\u5982\u679c\u7a7a\u95f4\u6bd4\u8f83\u7d27\u4e14\u64cd\u4f5c\u8f83\u591a\u65f6\uff0c\u663e\u7136\u4e0d\u5408\u9002\u3002<br/>\u53e6\u5916\uff0c\u5982\u679c\u8981\u5904\u7406\u4efb\u610f\u7ed3\u70b9\u5bf9\u7684LCA\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u5de8\u5927\u7684\u4e8c\u7ef4\u6570\u7ec4\u6765\u5b58\u50a8\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c$ n > 10000 $\u6b64\u7b97\u6cd5\u5c06\u62a5\u5e9f\u3002<br/>\u4f46\u5982\u679c\u7528\u6734\u7d20\u7b97\u6cd5\uff0c\u5c31\u53c8\u592a\u6162\u4e86\u2026<br/>\u8fd9\u65f6\uff0c\u500d\u589e\u6cd5\u5c31\u6765\u62ef\u6551\u4e16\u754c\u4e86\u3002<br/>\u500d\u589e\u6cd5\u80fd\u4ee5$ \\\\Theta (\\\\log n) $\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u548c$ \\\\Theta (n \\\\log n) $\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210LCA\u7684\u8ba1\u7b97\u3002<br/>\u76f8\u6bd4\u4e0eTarjan-LCA\u7684$ \\\\Theta (n^2) $\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u80fd\u8282\u7701\u66f4\u591a\u7684\u7a7a\u95f4\u3002<br/>\u5e76\u4e14\u5b83\u662f\u5728\u7ebf\u7b97\u6cd5\uff0c\u5f25\u8865\u4e86LCA\u7b97\u6cd5\u7684\u4e0d\u8db3\u3002<br/>\u500d\u589e\u6cd5\u8fd0\u7528\u4e86\u52a8\u6001\u89c4\u5212\u7684\u601d\u60f3\uff0c\u5e76\u5229\u7528\u4e8c\u8fdb\u5236\u8fbe\u5230\u4e86$ \\\\Theta (\\\\log n) $\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002<br/>2.3.1 \u9884\u5904\u7406<br/>\u500d\u589e\u6cd5\u9996\u5148\u9700\u8981\u8ba1\u7b97\u4e00\u4e2af\u6570\u7ec4\uff0c\u5176\u542b\u4e49\u4e3a\uff1a<br/>$$ f[i, j] : \u79bb\u8282\u70b9i\u76f8\u8ddd2^j\u7684\u7236\u8282\u70b9 $$<br/>\u6362\u8a00\u4e4b<br/>$$ distance(i, f[i, j]) = 2^j \\\\tag{2.1} $$<br/><br/>\u53c8\u662f\u8fd9\u4e2a\u56fe\u3002\u6211\u4eec\u5c06\u6811\u4e0a\u7684\u6bcf\u4e00\u6761\u8fb9\u7684\u957f\u5ea6\u90fd\u89c6\u4e3a1\uff0c\u90a3\u4e48$ f[7, 0] = 5,\\\\,f[7, 1] = 3 ... $\uff0c<br/>\u56e0\u6b64\u8282\u70b9$ 5 $\u5230$ 7 $\u7684\u8ddd\u79bb\u4e3a$ 1 = 2^0 $\uff0c\u8282\u70b9$ 3 $\u5230$ 7 $\u7684\u8ddd\u79bb\u4e3a$ 2 = 2^1 $\u3002<br/>\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u5230f\u6570\u7ec4\u7684\u4e00\u4e2a\u7279\u70b9\uff1a$ f[i, 0] $\u5c31\u662f$ i $\u7684\u7236\u8282\u70b9\u3002<br/>\u4e3a\u4e86\u7b97\u51faf\u6570\u7ec4\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a<br/>$$ f[i,j] = f[f[i, j - 1], j - 1] \\\\tag{2.2} $$<br/>\u5982\u4f55\u7406\u89e3\u8fd9\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u5462\uff1f<br/>\u6211\u4e48\u8bbe$ u = f[i,j],\\\\,v=f[i, j-1] $\uff0c<br/>\u90a3\u4e48\uff0c\u6839\u636e$ (2.1) $\u5f0f\u53ef\u5f97\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>distance(i, v) & = 2^{j-1} \\\\\\\\<br/>distance(i, u) & = 2^j \\\\\\\\<br/>distance(v, u) & = distance(i, u) - distance(i, v) \\\\\\\\<br/>&                = 2^j-2^{j-1} \\\\\\\\<br/>&                = 2^{j-1} \\\\times 2 - 2^{j-1} \\\\times 1 \\\\\\\\<br/>&                = 2^{j-1} \\\\\\\\<br/>&                \\\\Rightarrow u = f[v, j - 1] \\\\\\\\<br/>&                \\\\Rightarrow u = f[f[i, j-1],j-1]<br/>\\\\end{aligned}<br/>$$<br/>\u5373\u8bc1\u660e$ (2.2) $\u5f0f\u3002<br/>\u5229\u7528\u5f97\u5230\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728$ \\\\Theta (n \\\\log n) $\u7684\u65f6\u95f4\u5185\u63a8\u51faf\u6570\u7ec4\u3002<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8# \u521d\u59cb\u5316f[i, 0]<br/>for i in [1, n]:<br/>    f[i, 0] = father(i)<br/><br/># \u8ba1\u7b97\u6574\u4e2af\u6570\u7ec4<br/>for j in [1, log(n)]:<br/>    for i in [1, n]:<br/>        f[i, j] = f[f[i, j - 1], j - 1]<br/><br/><br/>2.3.2 \u5728\u7ebf\u7b97\u6cd5<br/>\u5f97\u5230\u4e86f\u6570\u7ec4\u540e\uff0c\u500d\u589e\u6cd5\u4e5f\u5c31\u5b8c\u6210\u4e8650% \u4e86\uff0c\u5269\u4e0b\u7684\u4efb\u52a1\u5c31\u662f\u8ba1\u7b97LCA\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u500d\u589e\u6cd5\u8ba1\u7b97LCA\u7684\u8fc7\u7a0b\u4e0e\u6734\u7d20\u7b97\u6cd5\u4e00\u6837\uff0c\u4e5f\u662f\u8981\u5148\u8c03\u5236\u540c\u4e00\u6df1\u5ea6\uff0c\u518d\u540c\u65f6\u4e0a\u8c03\u3002<br/>\u800c\u5de7\u5999\u7684\u662f\u500d\u589e\u6cd5\u5229\u7528\u7b97\u51fa\u7684f\u6570\u7ec4\u6765\u52a0\u901f\u63d0\u5347\u7684\u8fc7\u7a0b\uff0c\u4f7f\u5f97\u8282\u70b9\u7684\u4e0a\u5347\u7684\u8ddd\u79bb\u53ef\u4ee5\u8fbe\u5230$ 2^j $\uff0c\u800c\u4e0d\u662f\u4e00\u683c\u4e00\u683c\u5f80\u4e0a\u8c03\u3002<br/>\u601d\u8def\u5df2\u7ecf\u5f88\u6e05\u6670\u4e86\uff0c\u7136\u800c\u96be\u5728\u5982\u4f55\u8fd0\u7528f\u6570\u7ec4\u3002<br/>\u4e0b\u9762\u7684\u4f2a\u4ee3\u7801\u5c55\u793a\u4e86\u500d\u589e\u6cd5\u6c42LCA\u7684\u8fc7\u7a0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21def Double_LCA(u, v):<br/>    if d(u) < d(v):<br/>        swap(u, v)  # \u59cb\u7ec8\u4fdd\u6301u\u6240\u5904\u7684\u6df1\u5ea6\u8f83\u6df1<br/><br/>    # \u5c06u\u4e0a\u8c03dist\u4e2a\u8ddd\u79bb<br/>    dist = d(u) - d(v)<br/>    for i in [0, log(n)]:<br/>        if (1 << i) & dist  # KEY #1<br/>            u = f[u, i]<br/><br/>    if u == v:<br/>        return u  # \u7279\u5224\u6b64\u65f6u, v\u662f\u5426\u5728\u540c\u4e00\u4f4d\u7f6e\uff0c\u5982\u679c\u662f\uff0cu\u548cv\u90fd\u7ad9\u5728LCA\u4e0a<br/><br/>    # \u5c06u\u548cv\u540c\u65f6\u4e0a\u8c03<br/>    for i from log(n) to 0:<br/>        if f[u, i] != f[v, i]:  # KEY #2<br/>            u = f[u, i]<br/>            v = f[v, i]<br/><br/>    # \u6700\u540e\u4f1a\u4f7fu\u548cv\u6210\u4e3aLCA\u7684\u5b50\u8282\u70b9<br/>    return f[u, 0]<br/><br/><br/>\u5728\u4ee3\u7801\u4e2d\u6709\u4e24\u5904\u6bd4\u8f83\u5947\u7279\u7684\u5730\u65b9\uff0c\u88ab\u6ce8\u91ca\u6253\u4e0a\u4e86KEY\u3002<br/>\u5148\u770bKEY #1\uff0c\u8fd9\u91cc\u7684\u4ee3\u7801\u662f\u5c1d\u8bd5\u5c06$ u $\u4e0e$ v $\u8c03\u5236\u7edf\u4e00\u9ad8\u5ea6\uff0c\u800c\u8fd9\u91cc\u51fa\u73b0\u7684\u4f4d\u8fd0\u7b97\u4ee4\u4eba\u5341\u5206\u8d39\u89e3\u3002<br/>\u9996\u5148\u6211\u4eec\u601d\u8003\u4e00\u4e0b\u4e8c\u8fdb\u5236\uff1a<br/>\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570$ k $\uff0c\u8bbe\u5176\u4ece\u53f3\u5f80\u5de6\u6570\u7684\u7b2c$ i $\u4f4d\u4e3a$ k_i $\uff0c\u5219\u5f53$ k_i = 1 $\u65f6\uff0c$ k - 2^i $\u7684\u7b2c$ i $\u4f4d\u4e3a$ 0 $\u3002<br/>\u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e8c\u8fdb\u5236\u6570$ 110010_{(2)} $\uff0c\u7b2c$ 2 $\u4f4d\u4e3a$ 1 $\uff0c$ 2^2 = 10_{(2)} $\uff0c$ 110010_{(2)} - 10_{(2)} = 110000_{(2)} $\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u6570\u7684\u7b2c$ 2 $\u4f4d\u53d8\u6210\u4e86$ 1 $\u3002<br/>\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u9010\u4f4d\u5c06\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\u51cf\u6210$ 0 $\u3002<br/>\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u5c31\u8fd9\u6837\u9010\u6b65\u4e0a\u8c03\u8282\u70b9$ u $\uff0c\u5e76\u4f7f\u6700\u540e\u7684\u6df1\u5ea6\u5deedist\u53d8\u4e3a$ 0 $\u3002<br/>\u4e0b\u9762\u6709\u4e00\u5f20\u6837\u4f8b\uff1a<br/><br/>\u518d\u6765\u770bKEY #2\uff0c\u6b64\u65f6$ u $\u548c$ v $\u5904\u5728\u540c\u4e00\u6df1\u5ea6\u4e0a\uff0c$ j $\u4ece\u5927\u5230\u5c0f\u9010\u4e00\u6d4b\u8bd5\u3002<br/>\u6211\u4eec\u8bd5\u56fe\u4f7f$ u $\u548c$ v $\u5c3d\u53ef\u80fd\u9760\u8fd1LCA\uff0c\u4f46\u53c8\u4e0d\u76f4\u63a5\u5230\u8fbeLCA\u3002<br/>\u5982\u679c\u8bf4$ 2^j $\u7684\u8ddd\u79bb\u4e0a\uff0c$ u $\u548c$ v $\u7684\u7236\u8282\u70b9\u76f8\u540c\uff0c\u5219\u8fd9\u4e2a\u7236\u8282\u70b9\u662f\u5b83\u4eec\u7684\u516c\u5171\u7956\u5148\uff0c\u5982\u679c\u8df3\u4e0a\u53bb\u5c31\u6709\u53ef\u80fd\u8d85\u8fc7LCA\u4e86\uff0c\u56e0\u6b64\u5ffd\u7565\u3002<br/>\u5982\u679c\u8bf4$ 2^j $\u7684\u8ddd\u79bb\u4e0a\uff0c$ u $\u548c$ v $\u7684\u7236\u8282\u70b9\u4e0d\u540c\uff0c\u5219$ f[u, j] $\u548c$ f[v, j] $\u7684LCA\u4e5f\u662f$ u $\u548c$ v $\u7684LCA\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06$ u $\u548c$ v $\u4e0a\u79fb\u81f3\u8be5\u4f4d\u7f6e\uff0c\u4e0d\u5f71\u54cd\u7ed3\u679c\u3002<br/>\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u8282\u70b9\u5230LCA\u7684\u6df1\u5ea6\u5dee\u53ef\u4ee5\u88ab\u5206\u89e3\u6210\u591a\u4e2a$ 2 $\u7684\u5e42\u4e4b\u548c\uff0c\u56e0\u6b64\u6211\u4eec\u6709\u529e\u6cd5\u9010\u6b65\u5c06\u5b83\u4eec\u4e0a\u79fb\u81f3LCA\u7684\u4f4d\u7f6e\u3002<br/>\u4f46\u662f\u4e3a\u4e86\u65b9\u4fbf\u5224\u65ad\u662f\u5426\u8df3\u7684\u592a\u8fdc\uff0c\u6211\u4eec\u4e0d\u8ba9\u5b83\u4eec\u6700\u540e\u8df3\u5230LCA\u7684\u4f4d\u7f6e\uff0c\u800c\u662f\u8df3\u5230LCA\u7684\u513f\u5b50\u8282\u70b9\u5904\u3002<br/>\u6b64\u65f6\u5176\u7236\u8282\u70b9\u5c31\u662fLCA\u3002<br/>\u4e0b\u9762\u6709\u4e00\u5f20\u6837\u4f8b\uff1a<br/><br/>\u81f3\u6b64\uff0c\u500d\u589e\u6cd5\u5c31\u7ed3\u675f\u4e86\u3002<br/>\u4ee5\u4e0a\u4e09\u79cd\u7b97\u6cd5\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\u6c42LCA\u7684\u7b97\u6cd5\u3002\u4f3c\u4e4e\u4e8c\u53c9\u6811\u8fd8\u6709\u4e00\u79cd\u5206\u6cbb\u7684LCA\u7b97\u6cd5\uff0c\u6211\u6ca1\u6709\u505a\u8fc7\u591a\u4e86\u89e3\u4e86\u3002",
"url": "blog/2016-2-1/lca.html"
},
"\u6709\u5173\u591a\u9879\u5f0f\u7684\u7b97\u6cd5": {
"tags": "\u591a\u9879\u5f0f FFT",
"text": "\u6709\u5173\u591a\u9879\u5f0f\u7684\u7b97\u6cd5<br/>\u591a\u9879\u5f0f<br/>\u4e00\u4e2a\u5ea6\u6570\u4e3a $n$ \u7684\u591a\u9879\u5f0f\u4e3a\u6700\u9ad8\u9879\u7684\u6b21\u6570\u4e3a $n - 1$ \u7684\u591a\u4e2a $x$ \u7684\u5e42\u6b21\u4e0e\u5bf9\u5e94\u7cfb\u6570\u4e4b\u79ef\u7684\u548c\uff0c\u901a\u5e38\u7528\u5927\u5199\u5b57\u6bcd\u8868\u793a\u591a\u9879\u5f0f\u3002<br/>\u5982\uff0c\u4e0b\u5f0f\u662f\u4e00\u4e2a\u5ea6\u6570\u4e3a $4$ \u7684\u591a\u9879\u5f0f\u3002\u5c06 $x^2$ \u7684\u7cfb\u6570\u8bbe\u4e3a $0$ \u5c31\u53ef\u6d88\u9664\u8fd9\u4e00\u9879\u3002<br/>$$ A(x) = 3x^3 + 2x + 1 $$<br/>\u7528 $\\\\text{degree}(A)$ \u6765\u8868\u793a\u4e00\u4e2a\u591a\u9879\u5f0f\u7684\u5ea6\u6570\u3002\u4e00\u4e2a\u591a\u9879\u5f0f\u4e2d\u4f1a\u542b\u6709 $\\\\text{degree}(A)$ \u9879\u3002<br/>\u901a\u5e38\u6709\u4e24\u79cd\u8868\u793a\u591a\u9879\u5f0f\u7684\u65b9\u6cd5\uff1a\u7cfb\u6570\u8868\u8fbe\u548c\u70b9\u503c\u8868\u8fbe\u3002<br/>\u7cfb\u6570\u8868\u8fbe\u5373\u6309\u7167\u4ece\u4f4e\u6b21\u9879\u5230\u9ad8\u6b21\u98791\u7684\u987a\u5e8f\u5c06\u6bcf\u4e2a\u9879\u7684\u7cfb\u6570\u653e\u5165\u4e00\u4e2a\u5411\u91cf\u4e2d\u3002\u5982\u4e0a\u9762\u7684\u591a\u9879\u5f0f $A(x)$ \u8fd8\u53ef\u4ee5\u8868\u793a\u6210\u8fd9\u6837\uff1a<br/>$$ \\\\hat A(x) = (1,\\\\;0,\\\\;2,\\\\;3) $$<br/>\u70b9\u503c\u8868\u8fbe\uff0c\u987e\u540d\u601d\u4e49\u5c31\u662f\u7ed9\u5b9a\u4e00\u4e9b\u70b9\uff0c\u8ba1\u7b97\u51fa\u591a\u9879\u5f0f\u5728\u8fd9\u4e9b\u70b9\u7684\u503c\u3002<br/>\u8ba1\u7b97\u591a\u9879\u5f0f\u5728\u4e00\u4e2a\u70b9 $x_0$ \u5904\u7684\u503c\u53ef\u4ee5\u7528\u79e6\u4e5d\u97f6\u7b97\u6cd52:<br/>$$ A(x_0) = a_0 + x_0(a_1 + x_0(a_2 + \\\\dots + x_0(a_{n-2} + x_0a_{n-1})\\\\dots)) \\\\tag{1.1}$$<br/>\u8fd9\u6837\u53ef\u4ee5\u5728 $\\\\Theta(\\\\text{degree}(A))$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u4e00\u4e2a\u70b9\u5904\u7684\u503c\u3002<br/>\u8ba1\u7b97 $n$ \u4e2a\u4e0d\u540c\u7684\u70b9 $x_0,\\\\;x_1,\\\\dots,\\\\;x_{n-1}$ \u5904\u7684\u503c $y_0,\\\\;y_1,\\\\dots,\\\\;y_{n-1}$\uff0c\u4e8e\u662f\u53ef\u4ee5\u5c06\u591a\u9879\u5f0f\u8868\u793a\u6210 $n$ \u4e2a\u4e8c\u5143\u7ec4\uff0c\u4e8c\u5143\u7ec4\u7684\u7b2c\u4e00\u9879\u662f\u9009\u53d6\u7684\u70b9 $x_i$\uff0c\u7b2c\u4e8c\u9879\u662f\u8be5\u70b9\u8ba1\u7b97\u51fa\u7684\u503c $y_i$\u3002<br/>\u56e0\u6b64\u4e4b\u524d\u7684\u591a\u9879\u5f0f\u53ef\u4ee5\u8868\u793a\u6210\u4ee5\u4e0b\u7684\u5f62\u5f0f\uff1a<br/>$$ \\\\hat A(x) = \\\\{(0,\\\\;1),\\\\;(1,\\\\;6),\\\\;(2,\\\\;29),\\\\;(3,\\\\;88)\\\\} $$<br/>\u53ef\u4ee5\u8bc1\u660e\uff0c\u5982\u679c\u9009\u62e9\u7684\u6c42\u503c\u70b9\u4e92\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48\u4e00\u4e2a\u542b\u6709 $n$ \u4e2a\u5143\u7d20\u70b9\u503c\u8868\u8fbe\u4f1a\u6709\u552f\u4e00\u7684\u5ea6\u6570\u4e3a $n$ \u7684\u591a\u9879\u5f0f\u3002<br/>\u56e0\u4e3a\u70b9\u503c\u8868\u8fbe\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u77e9\u9635\u65b9\u7a0b\u8868\u793a\u51fa\u6765\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & x_0 & x_0^2 & \\\\cdots & x_0^{n-1} \\\\\\\\<br/>1 & x_1 & x_1^2 & \\\\cdots & x_1^{n-1} \\\\\\\\<br/>\\\\vdots & \\\\vdots & \\\\vdots & \\\\ddots & \\\\vdots\\\\\\\\<br/>1 & x_{n-1} & x_{n-1}^2 & \\\\cdots & x_{n-1}^{n-1} \\\\\\\\<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\left(<br/>\\\\begin{matrix}<br/>a_0 \\\\\\\\<br/>a_1 \\\\\\\\<br/>\\\\vdots \\\\\\\\<br/>a_{n-1}<br/>\\\\end{matrix}<br/>\\\\right)<br/>=\\\\left(<br/>\\\\begin{matrix}<br/>y_0 \\\\\\\\<br/>y_1 \\\\\\\\<br/>\\\\vdots \\\\\\\\<br/>y_{n-1}<br/>\\\\end{matrix}<br/>\\\\right)<br/>\\\\tag{1.2}<br/>$$<br/>\u65b9\u7a0b\u5de6\u8fb9\u7684\u77e9\u9635\u662f\u4e00\u4e2a\u8303\u5fb7\u8499\u5fb7\u77e9\u9635\uff0c\u5176\u884c\u5217\u5f0f\u7684\u503c\u4e3a\uff1a<br/>$$<br/>\\\\prod_{0 \\\\le i < j < n} (x_j - x_i)<br/>$$<br/>\u56e0\u6b64\u53ea\u8981 $x_0,\\\\;x_1,\\\\;\\\\dots,\\\\;x_{n-1}$ \u4e2d\u6ca1\u6709\u76f8\u540c\u7684\u503c\uff0c\u8be5\u77e9\u9635\u7684\u884c\u5217\u5f0f\u5c31\u4e0d\u4f1a\u4e3a $0$\u3002<br/>\u8fd9\u610f\u5473\u7740\u5b83\u4e00\u5b9a\u4f1a\u6709\u4e00\u4e2a\u9006\u77e9\u9635\uff0c\u4ece\u800c\u53ef\u4ee5\u5c06\u65b9\u7a0b\u53f3\u8fb9\u7684\u5217\u5411\u91cf\u4e58\u4ee5\u9006\u77e9\u9635\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u5411\u91cf\u3002<br/>\u591a\u9879\u5f0f\u52a0\u6cd5<br/>\u591a\u9879\u5f0f\u52a0\u6cd5\u662f\u5f88\u7b80\u5355\u7684\uff0c\u53ea\u9700\u8981\u5c06\u5bf9\u5e94\u6b21\u6570\u7684\u9879\u7684\u7cfb\u6570\u76f8\u52a0\u5373\u53ef\u3002<br/>\u5982\u679c\u662f\u70b9\u503c\u8868\u8fbe\uff0c\u5219\u9700\u8981\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u91c7\u6837\u70b9\u662f\u4e00\u6837\u7684\uff0c\u7136\u540e\u5bf9\u5e94\u70b9\u7684\u503c\u624d\u53ef\u4ee5\u76f4\u63a5\u76f8\u52a0\u51cf\uff0c\u6700\u540e\u5f97\u5230\u7684\u662f\u65b0\u7684\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u8fbe\u3002<br/>\u4e24\u4e2a\u591a\u9879\u5f0f $A(x)$ \u548c $B(x)$ \u7684\u52a0\u6cd5\u53ef\u4ee5\u5728 $\\\\Theta(\\\\max\\\\{\\\\text{degree}(A),\\\\;\\\\text{degree}(B)\\\\})$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u3002<br/>\u591a\u9879\u5f0f\u4e58\u6cd5<br/>\u5982\u679c\u91c7\u7528\u7cfb\u6570\u8868\u8fbe\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u5730\u5c06\u591a\u9879\u5f0f\u4e58\u5f00\u7136\u540e\u5408\u5e76\u540c\u7c7b\u9879\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728 $O(\\\\text{degree}(A) \\\\cdot \\\\text{degree}(B))$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u3002\u7136\u800c\u8fd9\u4e2a\u590d\u6742\u5ea6\u5e76\u4e0d\u5999\u3002<br/>\u76f8\u53cd\uff0c\u5982\u679c\u91c7\u7528\u70b9\u503c\u8868\u8fbe\uff0c\u5219\u53ea\u9700\u8981 $\\\\Theta(\\\\max\\\\{\\\\text{degree}(A),\\\\;\\\\text{degree}(B)\\\\})$ \u7684\u65f6\u95f4\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u8981\u5c06\u5bf9\u5e94\u91c7\u6837\u70b9\u7684\u503c\u76f8\u4e58\u5c31\u4f1a\u5f97\u5230\u65b0\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u8fbe\u3002<br/>\u7136\u800c\uff0c\u70b9\u503c\u8868\u8fbe\u65b9\u5f0f\u5e76\u6ca1\u6709\u7cfb\u6570\u8868\u8fbe\u66f4\u6709\u7528\u3002\u8003\u8651\u80fd\u5426\u5229\u7528\u70b9\u503c\u8868\u8fbe\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u7ebf\u6027\u65f6\u95f4\u6765\u52a0\u5feb\u7cfb\u6570\u8868\u8fbe\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u3002<br/>\u4e00\u4e2a\u76f4\u63a5\u7684\u65b9\u6cd5\u5c31\u662f\u5148\u5bf9\u539f\u591a\u9879\u5f0f\u5728 $\\\\text{degree}(A) + \\\\text{degree}(B)$ \u4e2a\u70b93\u5904\u91c7\u6837\uff0c\u7136\u540e\u505a\u5b8c\u70b9\u503c\u8868\u8fbe\u7684\u4e58\u6cd5\u4e4b\u540e\uff0c\u53c8\u8fdb\u884c\u63d2\u503c\u64cd\u4f5c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u7cfb\u6570\u8868\u8fbe\u7684\u7ed3\u679c\u4e86\u3002<br/>\u7136\u800c\u5e76\u6ca1\u6709\u4ec0\u4e48\u5f88\u5feb\u7684\u91c7\u6837/\u63d2\u503c\u7b97\u6cd5\uff0c\u4f46\u662f\u4f7f\u7528\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\u53ef\u4ee5\u5728 $\\\\Theta(n\\\\log n)$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u91c7\u6837\u548c\u63d2\u503c\u3002<br/>\u590d\u6570<br/>\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\u662f\u7528\u4e8e\u5feb\u901f\u8ba1\u7b97\u79bb\u6563\u5085\u7acb\u53f6\u53d8\u6362 (DFT)\u7684\u7ed3\u679c\u7684\u7b97\u6cd5\u3002\u7531\u4e8e DFT \u6d89\u53ca\u5230\u590d\u6570\u7684\u8fd0\u7b97\uff0c\u56e0\u6b64\u8fd9\u91cc\u5148\u626f\u4e00\u70b9\u590d\u6570\u7684\u57fa\u672c\u77e5\u8bc6\u3002<br/>\u9996\u5148\u5b9a\u4e49\u5355\u4f4d\u590d\u6570\u6839 $i = \\\\sqrt{-1}$\uff0c\u53ef\u4ee5\u5c06\u5176\u60f3\u8c61\u6210\u662f\u5782\u76f4\u4e8e\u5b9e\u6570\u8f74\u7684\u4e00\u4e2a\u5355\u4f4d\u5411\u91cf\uff0c\u56e0\u6b64\u6240\u6709\u7684\u590d\u6570\u90fd\u662f\u7531 $a + bi$\u8fd9 \u79cd\u5f62\u5f0f\u7ed9\u51fa\u7684\uff0c\u5176\u4e2d $a$ \u662f\u5b9e\u90e8\uff0c$b$ \u662f\u865a\u90e8\u3002<br/>\u5355\u4f4d\u590d\u6570\u6839\u4e0e\u81ea\u7136\u5bf9\u6570\u7684\u5e95\u6570 $\\\\text{e}$ \u6709\u7740\u76f8\u5f53\u5bc6\u5207\u7684\u5173\u7cfb\uff0c\u5b83\u4eec\u4e4b\u95f4\u901a\u8fc7\u6b27\u62c9\u516c\u5f0f\u8054\u7cfb\u5728\u4e00\u8d77\uff1a<br/>$$ \\\\text{e}^{xi} = \\\\cos x + i\\\\sin x \\\\tag{3.1.1}$$<br/>\u4e3a\u4e86\u8bc1\u660e\u8fd9\u4e2a\u7b49\u5f0f\uff0c\u9996\u5148\u8003\u8651\u4e00\u4e0b $i$ \u7684\u5e42\u6b21\u7684\u89c4\u5f8b\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>& i^0 = 1,\\\\; i^1 = i,\\\\; i^2 = -1,\\\\; i^3 = -i \\\\\\\\<br/>& i^4 = 1,\\\\; i^5 = i,\\\\; i^6 = -1,\\\\; i^7 = -i \\\\\\\\<br/>& \\\\dots<br/>\\\\end{aligned}<br/>$$<br/>\u6211\u4eec\u6ce8\u610f\u5230 $i$ \u7684\u5e42\u6b21\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a $4$ \u7684\u5faa\u73af\u8282\u3002\u8003\u8651 $\\\\text{e}$ \u7684\u6cf0\u52d2\u5c55\u5f00\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\text{e}^{xi} & = \\\\sum_{n=0}^{\\\\infty} {x^ni^n \\\\over n!} \\\\\\\\<br/>& = 1 + xi - \\\\frac{x^2}{2} - \\\\frac{x^3}{6}i + \\\\dots \\\\\\\\<br/>& = \\\\sum_{n = 2k,\\\\;k \\\\in \\\\mathbf{N}}^{\\\\infty} (-1)^k{x^n \\\\over n!} + i\\\\sum_{n = 2k + 1,\\\\;k \\\\in \\\\mathbf{N}}^{\\\\infty} (-1)^k{x^n \\\\over n!}<br/>\\\\end{aligned}<br/>$$<br/>\u548c\u5f0f\u5de6\u8fb9\u5c31\u662f $\\\\cos x$ \u7684\u6cf0\u52d2\u5c55\u5f00\uff0c\u800c\u53f3\u8fb9\u5c31\u662f $\\\\sin x$ \u7684\u6cf0\u52d2\u5c55\u5f00\u3002<br/>\u56e0\u6b64\uff1a<br/>$$ \\\\text{e}^{xi} = \\\\cos x + i\\\\sin x $$<br/>\u4e3a\u4e86\u65b9\u4fbf\u4e4b\u540e\u7684\u516c\u5f0f\u4e66\u5199\uff0c\u8fd9\u91cc\u5b9a\u4e49 $n$ \u6b21\u5355\u4f4d\u590d\u6570\u6839\u4e3a\uff1a<br/>$$<br/>\\\\omega_n = \\\\text{e}^{2\\\\pi i/n}<br/>\\\\tag{3.1.2}<br/>$$<br/>\u4ece\u51e0\u4f55\u7684\u89d2\u5ea6\u6765\u8bb2\uff0c\u76f8\u5f53\u4e8e\u5c06\u4e00\u4e2a\u5468\u89d2\u5747\u5206\u6210 $n$ \u4efd\uff0c\u4ece\u6bcf\u4e00\u4e2a\u89d2\u5ea6\u53d1\u51fa\u4e00\u4e2a\u5355\u4f4d\u957f\u5ea6\u7684\u5411\u91cf\u3002<br/>$\\\\omega_8$ \u7684\u6bcf\u4e00\u4e2a\u5e42\u6b21\u5728\u5e73\u9762\u4e0a\u7684\u60c5\u51b5\u5982\u4e0b\u56fe\uff0c\u6ce8\u610f $\\\\omega_8^0 = 1$\u3002<br/><br/>DFT<br/>\u63a5\u4e0b\u6765\u4ecb\u7ecd DFT\u3002\u6807\u51c6\u7684 DFT \u662f\u4f5c\u7528\u5728\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u590d\u6570\u5e8f\u5217 $\\\\{x_0,\\\\;x_1,\\\\;x_2,\\\\;\\\\dots,\\\\;x_{n-1}\\\\}$\uff0c\u5c06\u5176\u53d8\u6362\u4e3a\u53e6\u4e00\u4e2a\u590d\u6570\u5e8f\u5217 $\\\\{X_0,\\\\;X_1,\\\\;X_2,\\\\;\\\\dots,\\\\;X_{n-1}\\\\}$\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\uff1a<br/>$$<br/>X_k = \\\\sum_{j=0}^{n-1} x_j\\\\omega_n^{-jk}<br/>\\\\tag{3.2.1}<br/>$$<br/>\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u4ece $\\\\{X_0,\\\\;X_1,\\\\;X_2,\\\\;\\\\dots,\\\\;X_{n-1}\\\\}$ \u5f97\u5230 $\\\\{x_0,\\\\;x_1,\\\\;x_2,\\\\;\\\\dots,\\\\;x_{n-1}\\\\}$\uff0c\u5373\u9006 DFT\uff1a<br/>$$<br/>x_k = \\\\frac1n\\\\sum_{j=0}^{n-1}X_j\\\\omega_n^{jk}<br/>\\\\tag{3.2.2}<br/>$$<br/>\u5982\u4f55\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u9006 DFT \u516c\u5f0f\u5462\uff1f\u53ef\u4ee5\u5c06 DFT \u7684\u8fc7\u7a0b\u89c6\u4e3a\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\uff1a<br/>$$<br/>\\\\left[<br/>\\\\begin{matrix}<br/>1 & 1 & 1 & \\\\cdots & 1 \\\\\\\\<br/>1 & \\\\omega_n & \\\\omega_n^2 & \\\\cdots & \\\\omega_n^{n-1} \\\\\\\\<br/>1 & \\\\omega_n^2 & \\\\omega_n^4 & \\\\cdots & \\\\omega_n^{2(n-1)} \\\\\\\\<br/>\\\\vdots & \\\\vdots & \\\\vdots & \\\\ddots & \\\\vdots \\\\\\\\<br/>1 & \\\\omega_n^{n-1} & \\\\omega_n^{2(n-1)} & \\\\cdots & \\\\omega_n^{(n-1)(n-1)}<br/>\\\\end{matrix}<br/>\\\\right]<br/>\\\\left(<br/>\\\\begin{matrix}<br/>x_0 \\\\\\\\<br/>x_1 \\\\\\\\<br/>x_2 \\\\\\\\<br/>\\\\vdots \\\\\\\\<br/>x_{n-1}<br/>\\\\end{matrix}<br/>\\\\right)<br/>= \\\\left(<br/>\\\\begin{matrix}<br/>X_0 \\\\\\\\<br/>X_1 \\\\\\\\<br/>X_2 \\\\\\\\<br/>\\\\vdots \\\\\\\\<br/>X_{n-1}<br/>\\\\end{matrix}<br/>\\\\right)<br/>\\\\tag{3.2.3}<br/>$$<br/>\u8bbe\u7b49\u5f0f\u5de6\u8fb9\u7684\u77e9\u9635\u4e3a $V$\uff0c\u4e0b\u9762\u5c06\u8bc1\u660e\u5176\u9006\u77e9\u9635 $V^{-1}$ \u7684\u5143\u7d20 $[V^{-1}]_{jk} = \\\\omega_n^{-jk} / n$\uff1a<br/>\u56e0\u4e3a<br/>$$<br/>[VV^{-1}]_{jk} = \\\\sum_{c=0}^{n-1}(\\\\omega_n^{jc})({\\\\omega_n^{-ck} \\\\over n}) = \\\\frac1n\\\\sum_{c=0}^{n-1}(\\\\omega_n^{j-k})^c<br/>\\\\tag{3.2.4}<br/>$$<br/>\u7531\u4e8e\u51e0\u4f55\u7ea7\u6570\u7684\u6c42\u548c\u5bf9\u590d\u6570\u4e5f\u9002\u7528\uff0c\u6240\u4ee5\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{j=0}^{n-1}(\\\\omega_n^k)^j & = {(\\\\omega_n^k)^n - 1 \\\\over \\\\omega_n^k - 1} \\\\\\\\<br/>& = {(\\\\omega_n^n)^k - 1 \\\\over \\\\omega_n^k - 1} \\\\\\\\<br/>& = 0<br/>\\\\end{aligned}<br/>$$<br/>\u6ce8\u610f\uff0c\u53ea\u6709\u5728 $n \\\\not\\\\mid k$ \u65f6\u4e0a\u5f0f\u6210\u7acb\u3002\u5f53 $n \\\\mid k$ \u65f6\uff0c$\\\\omega_n^k = 1$\u3002<br/>\u4e8e\u662f $V \\\\cdot V^{-1}$ \u4e2d\u53ea\u6709 $j = k$ \u7684\u4f4d\u7f6e\u4e3a $1$\uff0c\u5176\u4f59\u5143\u7d20\u5747\u4e3a $0$\uff0c\u5373\u5355\u4f4d\u77e9\u9635\u3002\u6240\u4ee5 $V^{-1}$ \u786e\u5b9e\u662f $V$ \u7684\u9006\u77e9\u9635\u3002<br/>FFT<br/>\u5982\u679c\u6839\u636e DFT \u7684\u5b9a\u4e49\u6765\u8ba1\u7b97\uff0c\u9700\u8981 $\\\\Theta(n^2)$ \u7684\u65f6\u95f4\u3002\u53ef\u4ee5\u5229\u7528\u590d\u6570\u7684\u4e00\u4e9b\u7279\u6b8a\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 $\\\\Theta(n\\\\log n)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97 DFT \u53ca\u9006 DFT\uff0c\u8fd9\u5c31\u662f\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362 (FFT)\u3002<br/>\u4e0b\u9762\u4e3a\u4e86\u8ba8\u8bba\u65b9\u4fbf\uff0c\u5047\u8bbe\u6240\u6709\u7684\u7ed9 FFT \u5904\u7406\u7684\u5e8f\u5217\u957f\u5ea6\u90fd\u662f $2$ \u7684\u67d0\u6b21\u5e42\u3002<br/>\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\u662f\u57fa\u4e8e\u5206\u6cbb\u601d\u60f3\u7684\u3002\u7b97\u6cd5\u9996\u5148\u5c06\u5e8f\u5217\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u7684\u5143\u7d20\u7684\u4e0b\u6807\u4e3a\u5076\u6570\uff0c\u53e6\u4e00\u90e8\u5206\u4e3a\u5947\u6570\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>A \\\\ \\\\ \\\\ & = \\\\{x_0,\\\\;x_1,\\\\;x_2,\\\\;x_3,\\\\;x_4,\\\\;x_5,\\\\;x_6,\\\\;x_7\\\\} \\\\\\\\<br/>A^{[0]} & = \\\\{x_0,\\\\;x_2,\\\\;x_4,\\\\;x_6\\\\} \\\\\\\\<br/>A^{[1]} & = \\\\{x_1,\\\\;x_3,\\\\;x_5,\\\\;x_7\\\\}<br/>\\\\end{aligned}<br/>$$<br/>\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u4e0b\u6807\u4e3a\u5076\u6570\u5c31\u662f\u4e0b\u6807\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u7684\u6700\u540e\u4e00\u4f4d\u4e3a $0$ (\u5b83\u4eec\u653e\u5165 $A^{[0]}$)\uff0c\u5947\u6570\u5c31\u662f\u4e3a $1$ (\u653e\u5165 $A^{[1]}$)\u3002<br/>\u5206\u6210\u4e24\u90e8\u5206\u540e\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u90e8\u5206\u9012\u5f52\u6c42\u89e3\u3002\u7136\u540e\u5c1d\u8bd5\u5c06\u8fd9\u4e24\u90e8\u5206\u5408\u5e76\uff0c\u5f97\u5230\u539f\u5e8f\u5217\u7684 DFT\u3002<br/>\u8003\u8651\u5047\u8bbe\u6211\u4eec\u83b7\u5f97\u4e86\u53d8\u6362\u540e\u7684 $A^{\\\\prime[0]}$ \u548c $A^{\\\\prime[1]}$\u3002<br/>$$<br/>\\\\begin{aligned}<br/>A^{\\\\prime[0]}(x) &= \\\\sum_{j=0}^{n/2-1}A^{[0]}_jx^j \\\\\\\\<br/>A^{\\\\prime[1]}(x) &= \\\\sum_{j=0}^{n/2-1}A^{[1]}_jx^j<br/>\\\\end{aligned}<br/>$$<br/>\u56e0\u6b64\uff1a<br/>$$<br/>A(x) = A^{\\\\prime[0]}(x^2) + xA^{\\\\prime[1]}(x^2) \\\\tag{4.3.1}<br/>$$<br/>\u5c06\u5355\u4f4d\u590d\u6570\u6839\u5e26\u5165\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>A^{\\\\prime[0]}(\\\\omega_n^{2k}) + \\\\omega_n^kA^{\\\\prime[1]}(\\\\omega_n^{2k}) &= A(\\\\omega_n^k) \\\\\\\\<br/>A^{\\\\prime[0]}(\\\\omega_n^{2k}) - \\\\omega_n^kA^{\\\\prime[1]}(\\\\omega_n^{2k}) &= A^{\\\\prime[0]}(\\\\omega_n^{2k}) + \\\\omega_n^{k + n/2}A^{\\\\prime[1]}(\\\\omega_n^{2k}) \\\\\\\\<br/>&= A^{\\\\prime[0]}(\\\\omega_n^{2k + n}) + \\\\omega_n^{k + n/2}A^{\\\\prime[1]}(\\\\omega_n^{2k + n}) \\\\\\\\<br/>&= A(\\\\omega_n^{k+(n/2)})<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u6b64\u6211\u4eec\u83b7\u5f97\u4e86\u5982\u4f55\u5c06\u4e24\u90e8\u5206\u5408\u5e76\u4e3a\u4e00\u90e8\u5206\u7684\u65b9\u6cd5\u3002<br/>\u5bf9\u4e8e\u9006\u53d8\u6362\uff0c\u53ef\u4ee5\u4f7f\u7528\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u53ea\u662f\u5355\u4f4d\u590d\u6570\u6839\u7684\u6b21\u6570\u7684\u7b26\u53f7\u6070\u597d\u76f8\u53cd\uff0c\u5e76\u4e14\u6700\u540e\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a\u6570\u9664\u4ee5 $n$\u3002<br/>FFT \u5b9e\u73b0<br/>\u9012\u5f52\u5f0f FFT<br/>\u9012\u5f52\u5b9e\u73b0 FFT \u7684\u8fc7\u7a0b\u975e\u5e38\u7b80\u5355\uff0c\u9996\u5148\u5224\u65ad\u5e8f\u5217\u957f\u5ea6\u662f\u5426\u4e3a $1$\uff0c\u5982\u679c\u4e3a $1$ \u5219\u76f4\u63a5\u8fd4\u56de\u3002<br/>\u5426\u5219\u6309\u7167\u4e0b\u6807\u7684\u5947\u5076\u6027\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u7136\u540e\u9012\u5f52\u6c42\u89e3\u3002<br/>\u6700\u540e\u5408\u5e76\u8fd9\u4e24\u90e8\u5206\u7684\u7ed3\u679c\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21function RECURSIVE-FFT(x, reverse = false):<br/>    if x.length == 1:  # \u5982\u679c\u957f\u5ea6\u4e3a1<br/>        return x<br/><br/>    \u5c06\u5e8f\u5217\u5206\u4e3aa[0]\u548ca[1]<br/>    a'[0] = RECURSIVE-FFT(a[0])<br/>    a'[1] = RECURSIVE-FFT(a[1])<br/><br/>    X = [0..x.length - 1]<br/>    if reverse:  # \u5982\u679c\u662f\u9006\u53d8\u6362<br/>        w_n = exp(0 + (-2 * pi / n)i)<br/>    else:<br/>        w_n = exp(0 + (2 * pi / n)i)<br/>    w = 1<br/>    for k in [0, x.length / 2 - 1]:<br/>        t = w * a'[1][k]<br/>        X[k] = a'[0] + t<br/>        X[x.length / 2 + k] = a'[0] - t<br/>        w *= w_n<br/><br/>    return X<br/><br/><br/>\u8fed\u4ee3\u5f0f FFT<br/>\u4e0e\u9012\u5f52\u5f0f FFT \u76f8\u6bd4\uff0c\u6548\u7387\u66f4\u9ad8\u7684\u662f\u65e0\u9700\u9012\u5f52\u7684\u8fed\u4ee3\u5f0f\u3002<br/>\u9996\u5148\u8003\u8651\u6c42\u503c\u7684\u987a\u5e8f\u3002\u5bf9\u4e8e\u4e00\u4e2a\u4e0b\u6807\u800c\u8a00\uff0c\u5b83\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u5b9e\u9645\u4e0a\u5df2\u7ecf\u51b3\u5b9a\u4e86\u5b83\u5c06\u8981\u79fb\u52a8\u7684\u8def\u5f84\u3002<br/>\u5373\u4ece\u4f4e\u4f4d\u5f00\u59cb\uff0c\u5982\u679c\u662f $0$ \u5219\u5411\u5de6\u8fd0\u52a8\uff0c\u5426\u5219\u5411\u53f3\u8fd0\u52a8\uff0c\u7136\u540e\u68c0\u67e5\u5176\u9ad8\u4f4d\u3002<br/>\u66f4\u8fdb\u4e00\u6b65\uff0c\u89c2\u5bdf\u5212\u5206\u5b8c\u4e4b\u540e\u7684\u5e8f\u5217\uff0c\u628a\u6bcf\u4e00\u4e2a\u4e0b\u6807\u6240\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u8fc7\u6765\uff0c\u8fd9\u6070\u597d\u662f\u9012\u589e\u7684\u987a\u5e8f\u3002<br/>\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u7684\u52a0\u6cd5\u5668\uff0c\u6765\u8ba1\u7b97\u4e0b\u4e00\u4e2a\u5143\u7d20\u8be5\u662f\u8c01\u3002\u5229\u7528\u4f4d\u8fd0\u7b97\u4e0d\u96be\u5b9e\u73b0\u8fd9\u4e2a\u52a0\u6cd5\u5668\u3002<br/>\u8fd9\u4e2a\u7b97\u6cd5\u88ab\u79f0\u4f5c\u96f7\u5fb7\u7b97\u6cd5 (Rader\u2019s algorithm)\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14function RADER(x):<br/>    n = x.length<br/><br/>    X = [0..n - 1]<br/>    k = 0<br/>    for i in [0..n - 1]:<br/>        X[i] = x[k]<br/>        y = n >> 1  # n \u662f 2 \u7684\u5e42\u6b21<br/>        while k & y:<br/>            k ^= y<br/>            y >>= 1<br/>        k |= y<br/><br/>    return X<br/><br/><br/>\u8fd9\u6837\u5c31\u53ef\u4ee5\u6309\u7167\u987a\u5e8f\u8fdb\u884c\u5408\u5e76\uff0c\u7b2c\u4e00\u6b21\u6bcf $2$ \u4e2a\u8fdb\u884c\u5408\u5e76\uff0c\u7136\u540e\u6bcf $4$ \u4e2a\u8fdb\u884c\u5408\u5e76\uff0c \u2026\uff0c\u6700\u540e\u5c31\u662f\u6574\u4f53\u8fdb\u884c\u5408\u5e76\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23function ITERATIVE-FFT(x, reverse = false):<br/>    x = RADER(x)<br/><br/>    n = x.length<br/>    s = 2<br/>    while s <= n:<br/>        if reverse:  # \u5982\u679c\u662f\u9006\u53d8\u6362<br/>            w_n = exp(0 + (-2 * pi / n)i)<br/>        else:<br/>            w_n = exp(0 + (2 * pi / n)i)<br/>        for i in [0, n] by s:<br/>            left = i<br/>            right = i + s - 1<br/>            mid = (left + right) / 2<br/>            w = 1<br/>            for k in [0, mid - 1]:<br/>                t = w * x[mid + k]<br/>                x[mid + k] = x[left + k] - t<br/>                x[left + k] = x[left + k] + t<br/>                w *= w_n<br/>        s *= 2<br/><br/>    return x<br/><br/><br/>\u591a\u9879\u5f0f\u4e58\u6cd5<br/>\u524d\u9762\u8bb2\u4e86\u90a3\u4e48\u591a DFT\uff0c\u90a3\u591a\u9879\u5f0f\u4e58\u6cd5\u4e0e DFT \u6709\u4ec0\u4e48\u5173\u7cfb\u5462\uff1f<br/>\u4e8b\u5b9e\u4e0a\uff0cDFT \u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u6b21\u5728\u591a\u9879\u5f0f\u4e0a\u91c7\u6837\u7684\u8fc7\u7a0b\u3002<br/>\u83b7\u5f97\u4e86\u70b9\u503c\u8868\u8fbe\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5728 $\\\\Theta(n)$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u4e58\u6cd5\u3002<br/>\u6700\u540e\u8fdb\u884c\u4e00\u904d\u9006 DFT \u53ef\u4ee5\u5f97\u5230\u7ed3\u679c\uff01<br/>\u65f6\u95f4\u590d\u6742\u662f $\\\\Theta(n\\\\log n)$\u7684\uff0c$n$ \u662f\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u5ea6\u6570\u548c\u3002<br/>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0a\u9762\u7684 FFT \u9700\u8981\u5e8f\u5217\u957f\u5ea6\u4e3a $2$ \u7684\u5e42\uff0c\u89e3\u51b3\u65b9\u5f0f\u5c31\u662f\u5c06\u8865 $0$ \u6765\u5b8c\u6210\u3002<br/>\u5b9e\u9645\u5b9e\u73b0\u4e2d\uff0c\u9700\u8981\u6ce8\u610f $\\\\text{e}$ \u7684\u590d\u6570\u5e42\uff0c\u5355\u4f4d\u590d\u6570\u6839\u7684\u8ba1\u7b97\u5341\u5206\u7f13\u6162\uff0c\u56e0\u6b64\u5bf9\u4e8e\u9012\u5f52\u5f0f\u7684 FFT\uff0c\u9700\u8981\u5148\u9884\u5904\u7406\u6bcf\u4e00\u5c42\u7684\u5355\u4f4d\u590d\u6570\u6839\u3002<br/><br/><br/><br/><br/>\u5f53\u7136\u4e5f\u53ef\u4ee5\u4ece\u9ad8\u6b21\u5230\u4f4e\u6b21\uff0c\u89c6\u60c5\u51b5\u9009\u62e9\u65b9\u4fbf\u7684\u8868\u793a\u65b9\u6cd5\u3002\u00a0\u21a9<br/><br/><br/>\u4e5f\u79f0\u4f5c\u970d\u7eb3\u6cd5\u5219\u3002\u00a0\u21a9<br/><br/><br/>\u56e0\u4e3a\u65b0\u7684\u591a\u9879\u5f0f\u7684\u5ea6\u6570\u4e3a $\\\\text{degree}(A) + \\\\text{degree}(B)$\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-7-21/fft.html"
},
"\u675c\u6559\u7b5b\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790": {
"tags": "\u65f6\u7a7a\u590d\u6742\u5ea6 \u675c\u6559\u7b5b \u6570\u8bba",
"text": "\u675c\u6559\u7b5b\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790<br/>\u80cc\u666f<br/>\u675c\u6559\u7b5b\u662f OI \u754c\u4e2d\u4e00\u79cd\u5e38\u7528\u7684\u8ba1\u7b97\u79ef\u6027\u51fd\u6570\u524d\u7f00\u548c\u7684\u6280\u5de7\uff1a\u5bf9\u4e8e\u79ef\u6027\u51fd\u6570 $f(n)$\uff0c\u8bbe\u5176\u524d\u7f00\u548c\u4e3a $F(n) = \\\\sum_{k = 1}^n f(k)$\u3002\u9009\u5b9a\u8f85\u52a9\u51fd\u6570 $g(n)$\uff0c\u5c1d\u8bd5\u8ba1\u7b97 $f \\\\times g$ \u7684\u524d\u7f00\u548c\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{k = 1}^n (f \\\\times g)(k) &= \\\\sum_{k = 1}^n \\\\sum_{d \\\\mid k} f\\\\left({k \\\\over d}\\\\right)g(d) \\\\\\\\<br/>&= \\\\sum_{d = 1}^n g(d) \\\\sum_{k = 1}^{\\\\lfloor n / d \\\\rfloor} f(k) = \\\\sum_{k = 1}^n g(k)F\\\\left(\\\\left\\\\lfloor{n \\\\over k}\\\\right\\\\rfloor\\\\right)<br/>\\\\end{aligned}<br/>$$<br/>\u5c06 $g(1)F(n)$ \u79fb\u51fa\u6765\uff0c\u5f97\u5230\uff1a<br/>$$<br/>F(n) = \\\\frac1{g(1)}\\\\left(\\\\sum_{k = 1}^n(f \\\\times g)(k) - \\\\sum_{k = 2}^ng(k)F\\\\left(\\\\left\\\\lfloor{n \\\\over k}\\\\right\\\\rfloor\\\\right)\\\\right)<br/>$$<br/>\u5173\u952e\u5728\u4e8e $\\\\lfloor n / k \\\\rfloor$ \u7684\u4e0d\u540c\u53d6\u503c\u53ea\u6709 $\\\\Theta(\\\\sqrt n)$ \u4e2a\u3002\u5982\u679c\u6211\u4eec\u53ef\u4ee5\uff1a<br/><br/>\u5feb\u901f\u8ba1\u7b97 $\\\\sum_{k = 1}^n (f \\\\times g)(k)$\u3002<br/>\u5feb\u901f\u8ba1\u7b97 $\\\\sum_{k = 1}^n g(k)$\u3002<br/><br/>\u90a3\u4e48\u5229\u7528\u54c8\u5e0c\u8868\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u6bd4\u8f83\u4f4e\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\u8ba1\u7b97 $F(n)$\u3002<br/>\u5177\u4f53\u5206\u6790<br/>\u8003\u8651\u4e00\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff1a\u8ba1\u7b97\u6b27\u62c9\u51fd\u6570 $\\\\varphi(n)$ \u7684\u524d\u7f00\u548c\u3002\u56e0\u4e3a $\\\\sum_{d \\\\mid n} \\\\varphi(d) = n$\uff0c\u6240\u4ee5\u9009\u53d6 $g(n) = 1$ \u4f5c\u4e3a\u8f85\u52a9\u51fd\u6570\u3002\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230 $\\\\varphi(n)$ \u7684\u524d\u7f00\u548c $\\\\Phi(n) = \\\\sum_{k = 1}^n \\\\varphi(k)$ \u4e3a\uff1a<br/>$$<br/>\\\\Phi(n) = {n(n + 1) \\\\over 2} - \\\\sum_{k = 2}^n \\\\Phi\\\\left(\\\\left\\\\lfloor {n \\\\over k} \\\\right\\\\rfloor\\\\right)<br/>$$<br/>\u5b9a\u4e49 $R(n) = \\\\{\\\\lfloor n / k \\\\rfloor: 2 \\\\leqslant k \\\\leqslant n,\\\\,k \\\\in \\\\mathbf N\\\\}$\uff0c\u5373\u5bf9\u4e8e $x \\\\in R(n)$\uff0c$\\\\Phi(x)$ \u662f\u9700\u8981\u9012\u5f52\u8ba1\u7b97\u7684\u524d\u7f00\u548c\u3002<br/>\u5f15\u7406 1\u3000$\\\\forall n,\\\\,m \\\\in \\\\mathbf N \\\\geqslant 1$\uff0c\u82e5 $m \\\\leqslant \\\\sqrt n$\uff0c\u5219 $\\\\lfloor n / \\\\lfloor n / m \\\\rfloor \\\\rfloor = m$\u3002<br/>\u8bc1\u660e\u3000\u4ee4 $k = \\\\lfloor n / m \\\\rfloor$\uff0c\u5219 $mk \\\\leqslant n < m(k + 1)$\uff0c\u90a3\u4e48 $m \\\\leqslant n / k < m(k + 1) / k$\uff0c\u82e5\u8981 $\\\\lfloor n / k \\\\rfloor = m$\uff0c\u5219\u9700\u8981 $m(k + 1) / k \\\\leqslant m + 1$\uff0c\u56e0\u6b64 $m + m / k \\\\leqslant m + 1$ \u5373 $m \\\\leqslant \\\\lfloor n / m \\\\rfloor$\uff0c\u8fd9\u7b49\u4ef7\u4e8e $m^2 \\\\leqslant n$\uff0c\u5373 $m \\\\leqslant \\\\sqrt n$\u3002$\\\\blacksquare$<br/>\u5f15\u7406 2\u3000\u5bf9\u4e8e\u4efb\u610f\u8fde\u7eed\u5355\u589e\u51fd\u6570 $f(x)$\uff0c\u5e76\u4e14\u6ee1\u8db3\uff1a<br/>$$<br/>f(x) \\\\in \\\\mathbf Z \\\\Longrightarrow x \\\\in \\\\mathbf Z<br/>$$<br/>\u5219 $\\\\lfloor f(x) \\\\rfloor = \\\\lfloor f(\\\\lfloor x \\\\rfloor) \\\\rfloor$\uff0c\u4ee5\u53ca $\\\\lceil f(x) \\\\rceil$ = $\\\\lceil f(\\\\lceil x \\\\rceil) \\\\rceil$\u3002<br/>\u8fd9\u4e2a\u5f15\u7406\u6765\u81ea Concrete Mathematics [1] \u7684 (3.10)\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u8bc1\u660e\u3002<br/>\u5f15\u7406 3\u3000\u4ee4\u6b63\u6574\u6570 $a,\\\\,b$ \u4e3a\u5e38\u6570\uff0c\u5219\u5bf9\u4e8e\u6b63\u6574\u6570 $x$\uff0c\u6709 $\\\\lfloor\\\\lfloor x / a \\\\rfloor / b \\\\rfloor = \\\\lfloor x / ab \\\\rfloor$\u3002<br/>\u8bc1\u660e\u3000\u4ee4 $f(x) = \\\\lfloor x / b \\\\rfloor$\uff0c\u8fd0\u7528\u5f15\u7406 2 \u5373\u53ef\u3002$\\\\blacksquare$<br/>\u5b9a\u7406 1\u3000$\\\\forall n \\\\in \\\\mathbf N \\\\geqslant 1$\uff0c\u8bb0 $s = \\\\lfloor \\\\sqrt n \\\\rfloor$\uff0c$A = \\\\{1,\\\\,2,\\\\,3,\\\\,...,\\\\,s\\\\}$\uff0c$B = \\\\{\\\\lfloor n / 2 \\\\rfloor,\\\\,...,\\\\,\\\\lfloor n / s \\\\rfloor\\\\}$\uff0c\u5219 $R(n) = A \\\\cup B$ \u5e76\u4e14 $|R(n)| = 2\\\\sqrt n + \\\\Theta(1)$\u3002<br/>\u8bc1\u660e\u3000\u5bf9\u4e8e $x \\\\in A$\uff0c\u6839\u636e\u5f15\u7406 1\uff0c$\\\\lfloor n / \\\\lfloor n / x \\\\rfloor \\\\rfloor = x$\uff0c\u6240\u4ee5 $x \\\\in R(n)$\u3002<br/>\u5bf9\u4e8e $x \\\\in R(n)$ \u5e76\u4e14 $x > s$\uff0c$n / x \\\\leqslant s$\uff0c\u610f\u601d\u662f\u5728 $R(n)$ \u7684\u5b9a\u4e49\u4e2d\u80fd\u591f\u5f97\u5230 $x$ \u7684 $k \\\\in [2,\\\\,s]$\uff0c\u6240\u4ee5 $S \\\\ \\\\backslash\\\\ A \\\\subseteq B$\u3002\u6839\u636e $B$ \u7684\u5b9a\u4e49\uff0c$B \\\\subseteq S$\uff0c\u7531\u6b64\u53ef\u5f97\u51fa $S = A \\\\cup B$\u3002<br/>\u5bf9\u4e8e $1 \\\\leqslant x < y \\\\leqslant s$\uff0c$n / x - n / y \\\\geqslant n/(y - 1) - n / y > 1$\uff0c\u6240\u4ee5 $\\\\lfloor n / x \\\\rfloor \\\\neq \\\\lfloor n / y \\\\rfloor$\uff0c\u6240\u4ee5 $|R(n)| = 2\\\\sqrt n + \\\\Theta(1)$\u3002$\\\\blacksquare$<br/>\u5b9a\u7406 2\u3000\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570 $n$\uff0c$\\\\forall m \\\\in R(n)$\uff0c\u6709 $R(m) \\\\subseteq R(n)$\u3002<br/>\u8bc1\u660e\u3000\u56e0\u4e3a $m \\\\in R(n)$\uff0c\u6240\u4ee5\u53ef\u8bbe $m = \\\\lfloor n / a \\\\rfloor$\u3002\u5bf9\u4e8e $z \\\\in R(m)$\uff0c\u6709 $z = \\\\lfloor m / b \\\\rfloor$\uff0c\u6839\u636e\u5f15\u7406 3\uff0c\u53ef\u77e5 $z = \\\\lfloor  n / ab \\\\rfloor$\u3002\u56e0\u4e3a $a,\\\\,b > 1$\uff0c\u4e14 $a \\\\leqslant n$\uff0c$b \\\\leqslant n / a$\uff0c\u6240\u4ee5 $1 < ab \\\\leqslant n$\uff0c\u6240\u4ee5 $z \\\\in R(n)$\u3002$\\\\blacksquare$<br/>\u5b9a\u7406 2 \u63ed\u793a\u4e86\u8fd9\u4e2a\u6280\u5de7\u7684\u5de7\u5999\u6240\u5728\uff1a\u53ea\u9700\u8981\u5bf9\u6bcf\u4e2a $m \\\\in R(n)$ \u548c $m = n$ \u8ba1\u7b97 $\\\\Phi(m)$ \u5373\u53ef\u3002\u6b64\u5916\uff0c\u8ba1\u7b97 $\\\\Phi(n)$ \u65f6\u5355\u72ec\u8fd8\u9700\u8981 $\\\\Theta(\\\\sqrt n)$ \u7684\u679a\u4e3e\uff0c\u56e0\u6b64\u603b\u7684\u679a\u4e3e\u6b21\u6570\u4e3a\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{k = 1}^{\\\\lfloor \\\\sqrt n \\\\rfloor} \\\\sqrt k + \\\\sum_{k = 1}^{\\\\lfloor \\\\sqrt n \\\\rfloor} \\\\sqrt{n \\\\over k} = \\\\Theta\\\\left( \\\\int_1^{\\\\sqrt n} \\\\left(\\\\sqrt x + \\\\sqrt{n \\\\over x}\\\\right) \\\\mathrm dx \\\\right) = \\\\Theta(n^{3/4})<br/>\\\\end{aligned}<br/>$$<br/>\u5f53\u7136\u7a7a\u95f4\u590d\u6742\u5ea6\u662f $\\\\Theta(\\\\sqrt n)$\u3002\u4e00\u822c\u90fd\u8fd8\u4f1a\u91c7\u53d6\u9884\u5904\u7406\u7684\u65b9\u6cd5\u6765\u7ee7\u7eed\u4f18\u5316\u8fd9\u4e2a\u7b97\u6cd5\uff1a\u5229\u7528\u7ebf\u6027\u7b5b\u7b97\u51fa\u524d $S > \\\\sqrt n$ \u4e2a\u524d\u7f00\u548c\uff0c\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u4e3a\uff1a<br/>$$<br/>S + \\\\sum_{k = 1}^{\\\\lfloor n / S\\\\rfloor} \\\\sqrt{n \\\\over k} = \\\\Theta\\\\left( S + \\\\int_1^{n/S} \\\\sqrt{n \\\\over x} \\\\mathrm{d}x \\\\right) = \\\\Theta\\\\left(S + {n \\\\over \\\\sqrt S}\\\\right)<br/>$$<br/>\u53d6 $S = n^{2/3}$ \u53ef\u4ee5\u5f97\u5230\u6700\u4f18\u65f6\u95f4\u590d\u6742\u5ea6 $\\\\Theta(n^{2/3})$\u3002\u6ce8\u610f\u6b64\u65f6\u7a7a\u590d\u6742\u5ea6\u76f8\u540c\u3002<br/>\u540e\u8bb0<br/>\u4e4b\u6240\u4ee5\u4f1a\u5199\u8fd9\u7bc7\u535a\u5ba2\uff0c\u4e3b\u8981\u662f\u6211\u7b2c\u4e8c\u6b21\u770b\u675c\u6559\u7b5b\u7684\u8d44\u6599\u7684\u65f6\u5019\uff0c\u7ec8\u4e8e\u60f3\u901a\u4e86\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\uff0c\u4e5f\u5c31\u4e0a\u9762\u8fd9\u4e00\u5806\u4e1c\u897f\u3002\u4f46\u5b9e\u9645\u4e0a\u548c\u4efb\u4e4b\u6d32\u7684\u96c6\u8bad\u961f\u8bba\u6587 [2] \u76f8\u6bd4\uff0c\u53ea\u591a\u51fa\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u5b9a\u7406 2\u3002\u6ca1\u6709\u610f\u8bc6\u5230\u8fd9\u4e00\u70b9\u4e4b\u524d\uff0c\u6211\u4e00\u76f4\u65e0\u6cd5\u7406\u89e3\u4e3a\u4ec0\u4e48\u90a3\u4e24\u4e2a\u548c\u5f0f\u5c31\u53ef\u4ee5\u4ee3\u8868\u675c\u6559\u7b5b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u53e6\u5916\uff0c\u66f4\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\u770b\u5230\u4e86 tangjz \u7684\u300a\u6d45\u8c08\u4e00\u7c7b\u79ef\u6027\u51fd\u6570\u7684\u524d\u7f00\u548c\u300b\u4e2d\u7684\u5206\u6790\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u90a3\u662f\u5728\u81ea\u6b3a\u6b3a\u4eba\uff0c\u7a0d\u6709\u7528\u5fc3\u7684\u4eba\u5c31\u4f1a\u53d1\u73b0\u5176\u4e2d\u63cf\u8ff0\u65f6\u95f4\u590d\u6742\u5ea6\u7684 $T(n)$ \u5ffd\u7565\u4e86\u8bb0\u5fc6\u5316\u8fd9\u4e2a\u64cd\u4f5c\u3002\u6240\u4ee5\u6211\u624d\u60f3\u5199\u4e00\u4e2a\u8be6\u7ec6\u4e00\u70b9\u7684\u5206\u6790\uff0c\u5e0c\u671b\u5bf9\u5927\u5bb6\u6709\u5e2e\u52a9\u3002<br/>\u53c2\u8003\u8d44\u6599<br/>[1]. Ronald L. Graham, Donald E. Kunth, Oren Patashnik, 2002, Concrete Mathematics (2th edition), 978-7-111-10576-3<br/>[2]. \u4efb\u4e4b\u6d32\uff0c2016\uff0c\u300a\u79ef\u6027\u51fd\u6570\u6c42\u548c\u7684\u51e0\u79cd\u65b9\u6cd5\u300b\uff0c2016 \u5e74\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u4e2d\u56fd\u56fd\u5bb6\u961f\u5019\u9009\u961f\u5458\u8bba\u6587",
"url": "blog/2018-9-11/time-space-complexity-dyh-algo.html"
},
"\u6781\u9650\u4e0e\u5bfc\u6570": {
"tags": "\u6570\u5b66 \u6781\u9650 \u5bfc\u6570",
"text": "\u6781\u9650\u4e0e\u5bfc\u6570<br/>\u6700\u8fd1\u5b66\u4e86\u4e00\u4e9b\u57fa\u7840\u5fae\u79ef\u5206\uff0c\u8fd9\u91cc\u7a0d\u5fae\u8bb0\u5f55\u4e00\u4e0b\u3002<br/>\u6781\u9650<br/>\u6781\u9650\u53ef\u4ee5\u5f53\u505a\u662f\u4e00\u4e2a\u51fd\u6570$f(x)$\u7684$x$\u65e0\u9650\u8d8b\u8fd1\u4e8e\u67d0\u4e00\u4e2a\u5e38\u6570\u6216\u65e0\u7a77\u8fdc\u5904\u65f6\uff0c\u51fd\u6570\u6570\u503c\u6240\u903c\u8fd1\u7684\u4e00\u4e2a\u503c\u3002<br/>\u4f8b\u5982\uff0c\u5bf9\u4e8e\u51fd\u6570$f(x) = {2x \\\\over x + 1}$\uff0c\u5f53$x$\u8d8b\u8fd1\u4e8e\u65e0\u7a77\u5927\u65f6\uff0c$f(x)$\u65e0\u9650\u8d8b\u8fd1\u4e8e$2$\u3002\u6211\u4eec\u5c06\u6b64\u8bb0\u6210\u8fd9\u6837\u5b50\uff1a<br/>$$<br/>\\\\lim_{x \\\\rightarrow \\\\infty} f(x) = <br/>\\\\lim_{x \\\\rightarrow \\\\infty} {2x \\\\over x + 1} = <br/>2<br/>$$<br/>\u6c42\u6781\u9650\u9700\u8981\u4f1a\u4e00\u70b9\u4ee3\u6570\u6280\u5de7\uff0c\u6211\u53cd\u6b63\u662f\u8001\u662f\u6c42\u4e0d\u51fa......<br/>\u6781\u9650\u6709\u4e00\u4e9b\u65b9\u4fbf\u7684\u6027\u8d28\uff1a<br/>\u5f53\u7136\uff0c\u8fd9\u4e9b\u7b49\u5f0f\u7684\u5de6\u8fb9\u90fd\u662f\u5b58\u5728\u6781\u9650\u7684\u3002<br/>$$ \\\\lim_{x \\\\rightarrow c} a \\\\cdot f(x) = a \\\\cdot \\\\lim_{x \\\\rightarrow c} f(x) $$<br/>\u5bf9\u4e8e\u4e24\u4e2a\u51fd\u6570$f(x)$\u548c$g(x)$\u4e4b\u95f4\u6781\u9650\u7684\u5173\u7cfb\uff1a\uff08\u5f53\u7136$f(x)$\u548c$g(x)$\u90fd\u8981\u5b58\u5728\u6781\u9650\uff09<br/>$$ \\\\lim_{x \\\\rightarrow c} [f(x) + g(x)] = \\\\lim_{x \\\\rightarrow c} f(x) + \\\\lim_{x \\\\rightarrow c} g(x) $$<br/>$$ \\\\lim_{x \\\\rightarrow c} [f(x) - g(x)] = \\\\lim_{x \\\\rightarrow c} f(x) - \\\\lim_{x \\\\rightarrow c} g(x) $$<br/>$$ \\\\lim_{x \\\\rightarrow c} f(x) \\\\cdot g(x) = \\\\lim_{x \\\\rightarrow c} f(x) \\\\cdot \\\\lim_{x \\\\rightarrow c} g(x) $$<br/>$$ \\\\lim_{x \\\\rightarrow c} {f(x) \\\\over g(x)} = {\\\\lim_{x \\\\rightarrow c} f(x) \\\\over \\\\lim_{x \\\\rightarrow c} g(x)} \\\\; (\\\\lim_{x \\\\rightarrow c} g(x) \\\\neq 0)$$<br/>\u7b80\u800c\u8a00\u4e4b\uff0c\u6781\u9650\u8fd9\u4e1c\u897f\u53ef\u4ee5\u52a0\u51cf\u4e58\u9664\u3002<br/>\u5bfc\u6570<br/>\u5bf9\u4e8e\u51fd\u6570$f(x)$\u800c\u8a00\uff0c\u5b83\u5728$x_0$\u5904\u7684\u5bfc\u6570\u662f\u8fd9\u4e48\u5b9a\u4e49\u7684\uff1a<br/>$$ \\\\lim_{\\\\Delta x \\\\rightarrow 0} {f(x_0 + \\\\Delta x) - f(x_0) \\\\over \\\\Delta x} $$<br/>\u4ece\u51e0\u4f55\u610f\u4e49\u4e0a\u8bb2\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u89c6\u4e3a\u662f$f(x)$\u7684\u56fe\u50cf\u5728$x_0$\u5904\u7684\u5207\u7ebf\u7684\u659c\u7387\u3002<br/>\u5f53\u7136\u4e0d\u662f\u6240\u6709\u7684\u51fd\u6570\u90fd\u662f\u53ef\u4ee5\u6c42\u5bfc\u6570\u7684\uff0c\u53ea\u6709\u5728\u90a3\u4e00\u6bb5\u4e0a\u662f\u8fde\u7eed\u7684\u51fd\u6570\u65f6\uff0c\u624d\u4f1a\u6709\u5bfc\u6570\u3002<br/>\u8fde\u7eed\u7684\u51fd\u6570$f(x)$\u5728\u5176\u5b9a\u4e49\u57df\u5185\u7684\u6bcf\u4e00\u70b9\u4e0a\u90fd\u53ef\u4ee5\u8ba1\u7b97\u5bfc\u6570\uff0c\u610f\u5473\u7740\u6bcf\u4e00\u4e2a$x$\u90fd\u4f1a\u5bf9\u5e94\u4e00\u4e2a\u5bfc\u6570\uff0c\u8fd9\u6837\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u51fd\u6570\u5173\u7cfb\u3002\u6211\u4eec\u5c06\u8fd9\u4e2a\u51fd\u6570\u53eb\u4f5c\u5bfc\u51fd\u6570\uff0c\u8bb0\u4f5c$f^\\\\prime(x)$\u3002<br/>\u5982\u4f55\u6c42\u5bfc\u51fd\u6570\u5462\uff1f\u6839\u636e\u5bfc\u6570\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u5c06$x_0$\u6362\u4e3a$x$\uff0c\u7136\u540e\u6c42\u6781\u9650\u5c31\u597d\u4e86\u3002\u7136\u800c\u8bf4\u7684\u8f7b\u5de7\uff0c\u5b9e\u9645\u4e0a\u5f88\u591a\u90fd\u6bd4\u8f83\u96be\u4ee5\u6c42\u51fa\uff0c\u56e0\u6b64\u65e9\u6709\u5148\u4eba\u4e3a\u6211\u4eec\u628a\u5404\u79cd\u5bfc\u51fd\u6570\u7b97\u597d\u4e86\u3002<br/>\u4e3e\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50$f(x) = x^2$\u3002\u6309\u7167\u6c42\u5bfc\u6570\u7684\u65b9\u6cd5\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f^\\\\prime(x) &= \\\\lim_{\\\\Delta x \\\\rightarrow 0} {f(x + \\\\Delta x) - f(x) \\\\over \\\\Delta x} \\\\\\\\<br/>&= \\\\lim_{\\\\Delta x \\\\rightarrow 0} {(x + \\\\Delta x)^2 - x^2 \\\\over \\\\Delta x} \\\\\\\\<br/>&= \\\\lim_{\\\\Delta x \\\\rightarrow 0} {\\\\Delta x^2 + 2x\\\\Delta x \\\\over \\\\Delta x} \\\\\\\\<br/>&= \\\\lim_{\\\\Delta x \\\\rightarrow 0} (\\\\Delta x + 2x) \\\\\\\\<br/>&= 2x<br/>\\\\end{aligned}<br/>$$<br/>\u4e8b\u5b9e\u4e0a\uff0c\u5bf9\u4e8e\u5e42\u51fd\u6570$f(x) = x^\\\\alpha$\uff0c\u5176\u5bfc\u51fd\u6570\u4e3a$f^\\\\prime(x) = \\\\alpha x^{\\\\alpha - 1}$\u3002<br/>\u5bfc\u6570\u4e0e\u5bfc\u6570\u4e4b\u95f4\u5b58\u5728\u8fd0\u7b97\u5173\u7cfb\uff0c\u6709\u4e86\u8fd9\u4e9b\u8fd0\u7b97\u5173\u7cfb\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u65b9\u4fbf\u5730\u8fdb\u884c\u6c42\u5bfc\u3002<br/>\u7c7b\u4f3c\u4e8e\u7ebf\u6027\u7684\u6027\u8d28\uff1a<br/>$$ [a \\\\cdot f(x) + b \\\\cdot g(x)]^\\\\prime = a \\\\cdot f^\\\\prime(x) + b \\\\cdot g^\\\\prime(x) $$<br/>\u4e24\u4e2a\u5bfc\u6570\u76f8\u4e58\uff1a<br/>$$ [f(x)g(x)]^\\\\prime = f^\\\\prime(x)g(x) + f(x)g^\\\\prime(x) $$<br/>\u4e24\u4e2a\u5bfc\u6570\u76f8\u9664\uff1a<br/>$$ \\\\left[{f(x) \\\\over g(x)} \\\\right]^\\\\prime = {f^\\\\prime(x)g(x) - f(x)g^\\\\prime(x) \\\\over g^2(x)} \\\\; (g(x) \\\\neq 0) $$<br/>\u590d\u5408\u51fd\u6570\uff1a<br/>$$ [f(g(x))]^\\\\prime = f^\\\\prime(g(x)) \\\\cdot g^\\\\prime(x) $$<br/>\u4e00\u4e9b\u57fa\u672c\u51fd\u6570\u7684\u5bfc\u51fd\u6570\u5c31\u653e\u8fd9\u91cc\u4e86\uff0c\u5f53\u6211\u4eec\u8981\u6c42\u4e00\u4e2a\u7279\u5b9a\u51fd\u6570\u7684\u5bfc\u51fd\u6570\u65f6\uff0c\u53ef\u4ee5\u5229\u7528\u4e0a\u9762\u7684\u89c4\u5219\uff0c\u7136\u540e\u6839\u636e\u5bfc\u51fd\u6570\u8868\u6765\u8ba1\u7b97\u3002\u4e0b\u9762\u53ea\u6709$x$\u662f\u53d8\u91cf\u3002<br/>$$ c^\\\\prime = 0 $$<br/>$$ x^\\\\prime = 1 $$<br/>$$ (x^\\\\alpha)^\\\\prime = \\\\alpha x^{\\\\alpha - 1} $$<br/>$$ (\\\\text{e}^x)^\\\\prime = e^x $$<br/>$$ (a^x)^\\\\prime = a^x\\\\ln a $$<br/>$$ (\\\\ln x)^\\\\prime = \\\\frac1x $$<br/>$$ (\\\\log_a x)^\\\\prime = \\\\frac1{x\\\\ln a} $$<br/>$$ \\\\sin^\\\\prime x = \\\\cos x $$<br/>$$ \\\\cos^\\\\prime x = -\\\\sin x $$<br/>$$ \\\\tan^\\\\prime x = \\\\frac1{\\\\cos^2 x} $$<br/>$$ \\\\cot^\\\\prime x = -\\\\frac1{\\\\sin^2 x} $$<br/>\u5bf9\u6570\u6c42\u5bfc\u6cd5<br/>\u4e0a\u9762\u7684\u6c42\u5bfc\u516c\u5f0f\u5df2\u7ecf\u80fd\u591f\u5e94\u5bf9\u5927\u90e8\u5206\u57fa\u672c\u51fd\u6570\u7684\u6c42\u5bfc\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e0b\u9762\u7684\u51fd\u6570\uff1a<br/>$$ f(x) = x^{1/x} $$<br/>\u8be5\u5982\u4f55\u6c42\u5bfc\u5462\uff1f<br/>\u8fd9\u5c31\u8981\u7528\u5230\u5bf9\u6570\u6765\u8fdb\u884c\u6c42\u5bfc\u3002<br/>\u6211\u4eec\u77e5\u9053\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u51fd\u6570$f(x)$\uff1a<br/>$$ [\\\\ln f(x)]^\\\\prime = \\\\ln^\\\\prime f(x) \\\\cdot f^\\\\prime(x) $$<br/>\u6362\u8a00\u4e4b\uff1a<br/>$$ f^\\\\prime(x) = {[\\\\ln f(x)]^\\\\prime \\\\over \\\\ln^\\\\prime f(x)} \\\\tag{1}$$<br/>\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9$f(x) = x^{1/x}$\u6c42\u5bfc\u3002<br/>\u9996\u5148\uff0c\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u8bbe\uff1a<br/>$$ y = x^{1/x} $$<br/>\u7531\u4e8e\u4e24\u8005\u76f8\u7b49\uff0c\u6240\u4ee5\u4e24\u8005\u7684\u5bf9\u6570\u4e5f\u5e94\u76f8\u7b49\uff1a<br/>$$ \\\\ln y = \\\\ln x^{1/x} = \\\\frac1x\\\\ln x $$<br/>\u5c06\u4e24\u8fb9\u5bf9$x$\u6c42\u5bfc\u3002\u6ce8\u610f\u6309\u7167$(1)$\u5f0f\uff0c\u5de6\u5f0f\u9700\u8981\u4e58\u4e0a$y^\\\\prime$\u4e24\u8005\u624d\u80fd\u76f8\u7b49\u3002<br/>$$ {y^\\\\prime \\\\over y} = {1 - \\\\ln x \\\\over x^2} $$<br/>\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$ y^\\\\prime = {1 - \\\\ln x \\\\over x^2}y = {1 - \\\\ln x \\\\over x^2}x^{1/x} = f^\\\\prime(x) $$<br/>\u8fd9\u6837\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u6c42\u5bfc\u3002<br/>\u65e2\u7136\u90fd\u5bf9\u8fd9\u4e2a\u51fd\u6570\u6c42\u8fc7\u5bfc\u4e86\uff0c\u6211\u4eec\u6765\u9a8c\u8bc1\u4e00\u4e0b\u5b83\u7684\u4e00\u4e2a\u6027\u8d28\u3002<br/>\u5c06$\\\\text{e}$\u4ee3\u5165\u5bfc\u51fd\u6570\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f^\\\\prime(\\\\text{e}) & = {1 - \\\\ln \\\\text{e} \\\\over \\\\text{e}^2}\\\\text{e}^{1/\\\\text{e}} \\\\\\\\<br/>& = {1 - 1 \\\\over \\\\text{e}^2} \\\\\\\\<br/>& = 0<br/>\\\\end{aligned}<br/>$$<br/>\u56e0\u6b64\u6211\u4eec\u53d1\u73b0$x = \\\\text{e}$\u662f\u8fd9\u4e2a\u51fd\u6570\u7684\u6781\u503c\u70b9\u3002",
"url": "blog/2016-6-23/limit-and-derivative.html"
},
"\u67d3\u8272\u8ba1\u6570": {
"tags": "Burnside\u5b9a\u7406 \u7ec4\u5408\u6570\u5b66",
"text": "\u67d3\u8272\u8ba1\u6570<br/>\u7f6e\u6362<br/>\u7f6e\u6362\u662f\u4e00\u4e2a\u6ee1\u5c04\uff0c\u4f8b\u5982\uff1a<br/>$$<br/>f(1) = 2, f(2) = 4, f(3) = 3, f(4) = 1<br/>$$<br/>\u4e5f\u5199\u505a\uff1a<br/>$$<br/>f = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>2 & 4 & 3 & 1<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u7f6e\u6362\u53ef\u4ee5\u5408\u6210\u3002\u5047\u5982\u6211\u4eec\u6709\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>2 & 3 & 4 & 1<br/>\\\\end{matrix}<br/>\\\\right) \\\\\\\\<br/>g = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>4 & 1 & 2 & 3<br/>\\\\end{matrix}<br/>\\\\right)<br/>\\\\end{aligned}<br/>$$<br/>\u90a3\u4e48\u5b83\u4eec\u6309\u7167\u4e00\u5b9a\u987a\u5e8f\u52a0\u5408\u7684\u7ed3\u679c\u662f\uff1a<br/>$$<br/>g \\\\circ f = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>1 & 2 & 3 & 4<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u5373\u4ece\u53f3\u81f3\u5de6\u5730\u6267\u884c\u8fd9\u4e9b\u7f6e\u6362\u3002\u540c\u65f6\u4e0a\u9762\u8fd9\u4e2a\u7f6e\u6362\u662f\u4e0d\u53d8\u5143\uff0c\u65e0\u8bba\u4ec0\u4e48\u7f6e\u6362\u4e0e\u5b83\u52a0\u5408\u90fd\u4e0d\u4f1a\u53d8\u5316\u3002\u53e6\u5916\uff0c\u7f6e\u6362\u7684\u52a0\u5408\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u4f46\u4e0d\u4e00\u5b9a\u6ee1\u8db3\u4ea4\u6362\u5f8b\u3002\u7f6e\u6362\u7684\u53e6\u5916\u4e00\u79cd\u8868\u793a\u65b9\u5f0f\u5c31\u662f\u7f6e\u6362\u77e9\u9635\u3002\u8fd9\u4e5f\u53ef\u4ee5\u8bf4\u660e\u4e3a\u4ec0\u4e48\u7f6e\u6362\u4e0d\u6ee1\u8db3\u4ea4\u6362\u5f8b\u3002<br/>\u7531\u4e8e\u7f6e\u6362\u5177\u6709\u8fd9\u4e9b\u6027\u8d28\uff0c\u6240\u4ee5\u7f6e\u6362\u7684\u52a0\u5408\u8fd0\u7b97\u548c\u7f6e\u6362\u53ef\u4ee5\u6784\u6210\u7f6e\u6362\u7fa4\u3002<br/>\u67d3\u8272<br/>\u9996\u5148\u56de\u7b54\u4e00\u4e2a\u7b80\u5355\u7684\u95ee\u9898\uff1a\u7ed9\u6b63\u65b9\u5f62\u56db\u4e2a\u9876\u70b9\u5206\u522b\u67d3\u6210\u9ed1\u8272\u6216\u767d\u8272\u7684\u65b9\u6848\u6709\u591a\u5c11\u4e2a\uff1f\u663e\u7136\u6bcf\u4e2a\u9876\u70b9\u90fd\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u6240\u4ee5\u7b54\u6848\u4e3a$2^4 = 16$\u3002<br/>\u73b0\u5728\u505a\u51fa\u4e00\u70b9\u9650\u5236\uff0c\u5982\u679c\u4e00\u4e2a\u67d3\u8fc7\u8272\u7684\u6b63\u65b9\u5f62\u901a\u8fc7\u65cb\u8f6c\u6216\u8005\u8f74\u5bf9\u79f0\u540e\u4e0e\u53e6\u5916\u4e00\u4e2a\u67d3\u8fc7\u8272\u7684\u6b63\u65b9\u5f62\u76f8\u540c\uff0c\u5c31\u8bf4\u8fd9\u4e24\u79cd\u67d3\u8272\u662f\u672c\u8d28\u76f8\u540c\u7684\u3002\u90a3\u4e48\u95ee\u4f60\u6709\u591a\u5c11\u79cd\u672c\u8d28\u4e0d\u540c\u7684\u67d3\u8272\u65b9\u6848\u3002\u901a\u8fc7\u679a\u4e3e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u77e5\u9053\u7b54\u6848\u662f$6$\u3002\u8fd9$6$\u4e2d\u65b9\u6848\u5982\u4e0b (\u672c\u8d28\u76f8\u540c\u7684\u53ea\u753b\u4e86\u4e00\u79cd)\uff1a<br/><br/>\u5bf9\u6211\u4eec\u800c\u8a00\uff0c\u96be\u4ee5\u8003\u8651\u7684\u662f\u540c\u6784\u7684\u95ee\u9898\u3002\u5047\u5982\u6211\u4eec\u7ed9\u9876\u70b9\u6807\u53f7\uff0c\u5206\u522b\u4e3a$1$\u3001$2$\u3001$3$\u548c$4$\uff1a<br/><br/>\u90a3\u4e48\u4e0a\u9762\u8fd9\u4e2a\u56fe\u7684\u67d3\u8272\u4e3a\uff1a<br/>$$<br/>c_1 = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>\\\\mathrm{W} & \\\\mathrm{B} & \\\\mathrm{W} & \\\\mathrm{W}<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u7ecf\u8fc7\u5bf9\u79f0\uff0c\u4e0e\u4e4b\u540c\u8d28\u7684\u67d3\u8272\u662f\u8fd9\u6837\u7684\uff1a<br/>$$<br/>c_2 = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>\\\\mathrm{W} & \\\\mathrm{W} & \\\\mathrm{B} & \\\\mathrm{W}<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u53d8\u6362\u53ef\u4ee5\u770b\u505a\u662f\u5c06$2$\u548c$3$\u8c03\u6362\u4e86\u4e00\u4e0b\u3002\u4e8e\u662f\u6211\u4eec\u5c06\u8fd9\u4e2a\u5bf9\u79f0\u5b9a\u4e49\u6210\u8fd9\u6837\u4e00\u4e2a\u7f6e\u6362\uff1a<br/>$$<br/>f = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>1 & 3 & 2 & 4<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u7136\u540e\u5b9a\u4e49$\\\\times$\u8fd0\u7b97\uff0c\u8868\u793a\u4e00\u4e2a\u67d3\u8272\u7684\u9876\u70b9\u7ecf\u8fc7\u4e00\u4e2a\u7f6e\u6362\u540e\uff0c\u5f97\u5230\u7684\u65b0\u7684\u67d3\u8272\uff0c\u4e8e\u662f\u6709\uff1a<br/>$$<br/>f \\\\times c_1 = c_2<br/>$$<br/>\u53ef\u4ee5\u53d1\u73b0\uff0c\u7f6e\u6362\u7684\u52a0\u5408\u548c\u4e0a\u9762\u7684\u53d8\u6362\u5728\u4e00\u8d77\u65f6\u4e5f\u6ee1\u8db3\u7ed3\u5408\u5f8b\u3002<br/>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5c06\u989c\u8272\u7684\u540c\u6784\u7528\u7f6e\u6362\u8868\u793a\u51fa\u6765\u4e86\u3002\u6211\u4eec\u5b9a\u4e49\u6b63\u65b9\u5f62\u6240\u6709\u7684\u53d8\u6362\u4e3a\u4e00\u4e2a\u7f6e\u6362\uff0c\u5b83\u4eec\u6784\u6210\u4e00\u4e2a\u96c6\u5408\uff1a<br/>$$<br/>G = \\\\{e = p^0, p, p^2, p^3, f_1, f_2, f_3, f_4\\\\}<br/>$$<br/>\u5176\u4e2d$e$\u662f\u7f6e\u6362\u7684\u4e0d\u53d8\u5143\u3002$p$\u662f\u987a\u65f6\u9488\u65cb\u8f6c$90^\\\\circ$\u7684\u7f6e\u6362\uff1a<br/>$$<br/>p = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>4 & 1 & 2 & 3<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u800c$p$\u7684\u5e42\u6b21\u5c31\u662f\u591a\u6b21\u65cb\u8f6c\u3002$f_1$\u5230$f_4$\u662f\u6cbf\u7740\u6b63\u65b9\u5f62\u7684\u56db\u6761\u5bf9\u89d2\u7ebf\u7684\u7f6e\u6362\u3002\u53ef\u4ee5\u9a8c\u8bc1\u8fd9\u4e2a\u96c6\u5408\u548c\u7f6e\u6362\u7684\u52a0\u5408\u8fd0\u7b97\u6784\u6210\u4e86\u4e00\u4e2a\u7f6e\u6362\u7fa4\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u4e24\u79cd\u67d3\u8272$c_1$\u548c$c_2$\uff0c\u5b83\u4eec\u672c\u8d28\u76f8\u540c\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e00\u4e2a$f \\\\in G$\uff0c\u6ee1\u8db3$f \\\\times c_1 = c_2$\u3002<br/>\u53e6\u5916\uff0c\u8bbe\u56fe\u5f62\u7684\u6240\u6709\u67d3\u8272\u65b9\u6848\u4e3a$C$\uff0c\u5b9a\u4e49$G(c)$\u4e3a$\\\\{f : f \\\\times c = c, \\\\;\\\\forall f \\\\in G\\\\}$\uff0c\u5373\u4e0d\u6539\u53d8\u67d3\u8272$c$\u7684\u7f6e\u6362\u7684\u96c6\u5408\u3002\u4ee5\u53ca$C(f)$\u4e3a$\\\\{c : f \\\\times c = c, \\\\; \\\\forall c \\\\in C\\\\}$\uff0c\u5373\u7ecf\u8fc7\u7f6e\u6362\u540e\u4e0d\u53d8\u7684\u6240\u6709\u7684\u67d3\u8272\u65b9\u6848\u7684\u96c6\u5408\u3002\u4e4b\u540e\u7684\u8ba8\u8bba\u4e2d\u5c06\u4f1a\u7528\u5230\u5b83\u4eec\u3002<br/>Burnside\u5b9a\u7406<br/>\u9996\u5148\u6765\u8003\u8651\u4e0e$c$\u672c\u8d28\u76f8\u540c\u7684\u67d3\u8272\u7684\u4e2a\u6570\uff1a<br/><br/>\u5b9a\u7406\uff1a\u4e0e$c$\u672c\u8d28\u76f8\u540c\u7684\u67d3\u8272\u7684\u4e2a\u6570\u4e3a\uff1a<br/>$$ {|G| \\\\over |G(c)|} \\\\tag{3.1} $$<br/><br/>\u8bc1\u660e\uff1a\u8003\u8651\u6bcf\u4e2a$f \\\\times c, f \\\\in G$\uff0c$G(c)$\u4e2d\u90fd\u5b58\u5728$|G(c)|$\u4e2a$g$, \u6ee1\u8db3$(f \\\\circ g) \\\\times c = f \\\\times (g \\\\times c) = f \\\\times c$\u3002\u5373\u5bf9\u4e8e\u4efb\u610f\u67d3\u8272\u65b9\u6848\uff0c\u90fd\u6709$|G(c)|$\u79cd\u7f6e\u6362\u4f7f\u5f97\u67d3\u8272\u65b9\u6848\u4e0d\u53d8\u3002\u6240\u4ee5\u603b\u6570\u4e3a$|G| / |G(c)| $\u3002<br/>\u63a5\u4e0b\u6765\u5c06\u91c7\u7528\u53cc\u91cd\u8ba1\u6570\u6765\u8bc1\u660e\u4e0b\u9762\u7684Burnside\u5b9a\u7406\uff1a<br/><br/>(Burnside\u5b9a\u7406)<br/>\u8bbe\u5173\u4e8e\u67d3\u8272\u96c6$C$\u4e0e\u7f6e\u6362\u7fa4$G$\u4e0a\u672c\u8d28\u4e0d\u540c\u7684\u67d3\u8272\u65b9\u6848\u6570\u4e3a$N(G, C)$\uff0c\u90a3\u4e48\u6ee1\u8db3\uff1a<br/>$$ N(G, C) = \\\\frac1{|G|}\\\\sum_{f \\\\in G} |C(f)| \\\\tag{3.2} $$<br/><br/>\u8bc1\u660e\uff1a\u6211\u4eec\u73b0\u5728\u6765\u8003\u8651\u6ee1\u8db3$f \\\\times c = c$\u7684\u4e8c\u5143\u7ec4$(f, c)$\u7684\u4e2a\u6570\u3002\u9996\u5148\u6211\u4eec\u4ece$C(f)$\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u53ef\u4ee5\u77e5\u9053\u7b54\u6848\u4e3a\uff1a<br/>$$<br/>\\\\sum_{f \\\\in G} |C(f)|<br/>$$<br/>\u53e6\u5916\uff0c\u4ece$G(c)$\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u4e5f\u53ef\u4ee5\u77e5\u9053\u7b54\u6848\u4e3a\uff1a<br/>$$<br/>\\\\sum_{c \\\\in C} |G(c)|<br/>$$<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bbe$A(c) = \\\\{f \\\\times c, \\\\; \\\\forall f \\\\in G\\\\}$\uff0c\u5373\u4e0e$c$\u672c\u8d28\u76f8\u540c\u7684\u67d3\u8272\u7684\u96c6\u5408\u3002\u6839\u636e$(3.1)$\uff0c\u6211\u4eec\u77e5\u9053\uff1a<br/>$$<br/>|G(c)| = {|G| \\\\over |A(c)|}<br/>$$<br/>\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\sum_{f \\\\in G} |C(f)| = |G|\\\\sum_{c \\\\in C} \\\\frac1{|A(c)|}<br/>$$<br/>\u5bf9\u53f3\u8fb9\u7684\u548c\u5f0f\u505a\u5982\u4e0b\u7684\u8003\u8651\uff1a\u5047\u8bbe\u6bcf\u4e2a\u7b49\u4ef7\u7684\u96c6\u5408\u7684\u8d21\u732e\u662f$1$\uff0c\u90a3\u4e48\u6bcf\u4e2a\u67d3\u8272\u7684\u8d21\u732e\u5c31\u662f$1/|A(c)|$\uff0c\u6240\u4ee5\u4e0a\u5f0f\u53ef\u4ee5\u6539\u5199\u4e3a\uff1a<br/>$$<br/>\\\\sum_{f \\\\in G} |C(f)| = |G|N(G, C)<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$ N(G, C) = \\\\frac1{|G|}\\\\sum_{f \\\\in G} |C(f)| $$<br/>\u56de\u5230\u4e4b\u524d\u6b63\u65b9\u5f62\u67d3\u8272\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7f6e\u6362\u8fd9\u6837\u8003\u8651\uff1a<br/><br/>\u5bf9\u4e8e\u4e0d\u53d8\u5143$e$\uff0c\u603b\u5171\u6709$2^4 = 16$\u4e2d\u67d3\u8272\u4e0d\u53d8\u3002<br/>\u5bf9\u4e8e$2$\u4e2a\u987a\u65f6\u9488\u65cb\u8f6c (\u9664\u4e86\u65cb\u8f6c$180^\\\\circ$)\uff0c\u5b83\u4eec\u90fd\u53ea\u6709\u5168\u662f\u9ed1\u6216\u8005\u5168\u662f\u767d\u7684\u67d3\u8272\u4e0d\u53d8\uff0c\u8d21\u732e\u4e3a$2 \\\\times 2 = 4$\u3002<br/>\u5bf9\u4e8e\u65cb\u8f6c$180^\\\\circ$\uff0c\u53ea\u9700\u8981\u6ee1\u8db3\u4e24\u4e2a\u76f8\u90bb\u7684\u9876\u70b9\u989c\u8272\u76f8\u540c\u5373\u53ef\uff0c\u6240\u4ee5\u8d21\u732e\u4e3a$2^2 = 4$\u3002<br/>\u5bf9\u4e8e$2$\u4e2a\u5bf9\u89d2\u7ebf\u5bf9\u79f0\uff0c\u53ea\u8981\u6ee1\u8db3\u5bf9\u89d2\u989c\u8272\u76f8\u540c\u5373\u53ef\uff0c\u8d21\u732e\u4e3a$2^3 \\\\times 2 = 16$\u3002<br/>\u5bf9\u4e8e\u53e6\u5916$2$\u4e2a\u5bf9\u79f0\uff0c\u9700\u8981\u6ee1\u8db3\u4e24\u8fb9\u989c\u8272\u76f8\u540c\uff0c\u8d21\u732e\u4e3a$2^2 \\\\times 2 = 8$\u3002<br/><br/>\u6240\u4ee5\u7b54\u6848\u4e3a$(16 + 4 + 4 + 16 + 8) / 8 = 6$\u3002<br/>\u8fdb\u4e00\u6b65\u8003\u8651\u8ba1\u7b97$C(f)$\u3002\u5047\u5982\u6211\u4eec\u5c06\u7f6e\u6362\u5199\u6210\u7f6e\u6362\u73af\u7684\u5f62\u5f0f\uff0c\u4f8b\u5982\uff1a<br/>$$<br/>f = \\\\left(<br/>\\\\begin{matrix}<br/>1 & 2 & 3 & 4 \\\\\\\\<br/>2 & 1 & 4 & 3<br/>\\\\end{matrix}<br/>\\\\right)<br/>$$<br/>\u53ef\u4ee5\u5199\u6210\uff1a<br/>$$<br/>f = [2\\\\;1][4\\\\;3]<br/>$$<br/>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u8981\u6ee1\u8db3\u7ecf\u8fc7\u7f6e\u6362\u540e\u67d3\u8272\u4e0d\u53d8\uff0c\u90a3\u4e48\u6bcf\u4e00\u4e2a\u7f6e\u6362\u73af\u5185\u7684\u989c\u8272\u5fc5\u987b\u76f8\u540c\u3002\u4e8e\u662f\uff0c\u5bf9\u4e8e\u8fd9\u4e00\u4e2a\u7f6e\u6362\u73af\u800c\u8a00\uff0c\u8ba1\u7b97\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b80\u4fbf\u4e3a$2^2 = 4$\uff0c\u800c\u4e0d\u9700\u8981\u53bb\u505a\u8ba8\u8bba\u3002<br/>\u7b80\u5355\u56fe\u8ba1\u6570<br/>\u3010HNOI 2009\u3011\u56fe\u7684\u540c\u6784<br/>\u73b0\u5728\u6765\u8ba8\u8bba\u4e00\u4e2a\u66f4\u52a0\u590d\u6742\u7684\u95ee\u9898\uff0c\u5c31\u662f$n$\u4e2a\u70b9\u7684\u672c\u8d28\u4e0d\u540c\u7684\u7b80\u5355\u65e0\u5411\u56fe\u7684\u6570\u91cf12\u3002\u7b80\u5355\u56fe\u662f\u6ca1\u6709\u91cd\u8fb9\u548c\u81ea\u73af\u7684\u56fe\u3002\u8bb0\u4e3a$a(n)$\u3002<br/>\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5217\u4e3e\u53ef\u4ee5\u5f97\u77e5\uff1a<br/>$$<br/>a(0) = 1, a(1) = 1, a(2) = 2, a(3) = 4<br/>$$<br/>\u66f4\u5927\u7684$n$\u5982\u679c\u91c7\u7528\u5217\u4e3e\u7684\u65b9\u6cd5\u5b9e\u5728\u65e0\u6cd5\u60f3\u8c61\u3002\u4e3a\u4e86\u80fd\u591f\u5229\u7528Burnside\u5b9a\u7406\uff0c\u6211\u4eec\u8003\u8651\u5c06\u5176\u8f6c\u4e3a\u4e00\u4e2a\u67d3\u8272\u95ee\u9898\u3002\u6ce8\u610f\u5230\u5927\u5c0f\u4e3a$n$\u7684\u7b80\u5355\u56fe\u7684\u8fb9\u5df2\u7ecf\u5168\u90e8\u786e\u5b9a\uff0c\u53ea\u662f\u5b58\u5728\u9009\u6216\u4e0d\u9009\u7684\u95ee\u9898\u3002\u6240\u4ee5\u53ef\u4ee5\u89c6\u4e3a\u662f\u8fd9\u4e9b\u8fb9\u662f\u67d3\u6210\u9ed1\u8272\u8fd8\u662f\u67d3\u6210\u767d\u8272\u7684\u95ee\u9898\u3002\u6b64\u5916\u6211\u4eec\u8981\u5c06\u672c\u8d28\u76f8\u540c\u7684\u8ba1\u6570\u53bb\u6389\u3002\u5982\u679c\u4e24\u4e2a\u56fe\u76f8\u540c\uff0c\u90a3\u4e48\u5b58\u5728\u4e00\u4e2a\u4e0e\u70b9\u7f16\u53f7\u76f8\u5173\u7684\u7f6e\u6362\uff0c\u4f7f\u5f97\u4e24\u5f20\u56fe\u7684\u8fb9\u96c6\u662f\u4e00\u6837\u7684\u3002\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6240\u6709\u7684\u70b9\u7684\u7f6e\u6362\uff0c\u603b\u6570\u4e3a$n!$\u4e2a\uff0c\u6bcf\u4e00\u4e2a\u5c06\u4f1a\u5bf9\u5e94\u5230\u4e00\u4e2a\u8fb9\u7684\u7f6e\u6362\uff0c\u5373\u7528\u4e8e\u5224\u5b9a\u540c\u6784\u7684\u7f6e\u6362\u3002\u53ef\u4ee5\u8bc1\u660e\u4ece\u70b9\u7684\u7f6e\u6362\u8f6c\u6765\u7684\u8fb9\u7684\u7f6e\u6362\u662f\u4e00\u4e2a\u7f6e\u6362\u7fa4\u3002<br/>\u73b0\u5728\u6765\u8003\u8651\u70b9\u7684\u7f6e\u6362\u662f\u5982\u4f55\u8f6c\u6210\u8fb9\u7684\u7f6e\u6362\u7684\u3002\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u6839\u636e\u7f6e\u6362\u73af\u7684\u6570\u91cf\u6765\u8ba1\u7b97$C(f)$\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981\u5173\u6ce8\u7f6e\u6362\u5230\u5e95\u957f\u4ec0\u4e48\u6837\uff0c\u53ea\u9700\u8981\u77e5\u9053\u6709\u591a\u5c11\u4e2a\u7f6e\u6362\u73af\u5373\u53ef\u3002\u5bf9\u4e8e\u4e00\u4e2a\u8fb9\u7684\u7f6e\u6362\uff0c\u91cc\u9762\u7684\u6bcf\u4e00\u6761\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u8981\u4e48\u5728\u70b9\u7f6e\u6362\u7684\u4e00\u4e2a\u7f6e\u6362\u73af\u5185\uff0c\u8981\u4e48\u5728\u4e0d\u540c\u7684\u7f6e\u6362\u73af\u5185\u3002<br/>\u9996\u5148\u89c2\u5bdf\u4e00\u4e0b\u5728\u540c\u4e00\u4e2a\u7f6e\u6362\u73af\u5185\u7684\u60c5\u51b5\uff1a<br/><br/>\u9ec4\u8272\u7684\u8fb9\u662f\u7f6e\u6362\u73af\u4e0a\u7684\u8fb9\uff0c\u800c\u7ea2\u8272\u7684\u5c31\u662f\u8fb9\u7f6e\u6362\u4e2d\u7684\u8fb9\u3002\u7531\u4e8e\u5c06\u6574\u6761\u8fb9\u968f\u7740\u7f6e\u6362\u73af\u65cb\u8f6c\uff0c\u4f1a\u5f97\u5230\u8bb8\u591a\u4e00\u6837\u7684\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4e00\u4e2a\u70b9\u56fa\u5b9a\uff0c\u6765\u8003\u8651\u53e6\u5916\u4e00\u4e2a\u70b9\u3002\u53ef\u4ee5\u53d1\u73b0\u5b9e\u7ebf\u7684\u8fb9\u662f\u4e0d\u540c\u7684\uff0c\u800c\u865a\u7ebf\u7684\u8fb9\u5219\u662f\u548c\u5b9e\u7ebf\u7684\u8fb9\u662f\u540c\u6784\u7684\u3002\u6240\u4ee5\uff0c\u5bf9\u4e8e\u957f\u5ea6\u4e3a$L$\u7684\u7f6e\u6362\u73af\uff0c\u5728\u8fb9\u7684\u7f6e\u6362\u4e2d\u5bf9\u5e94\u4e86$\\\\lfloor L / 2 \\\\rfloor$\u4e2a\u7f6e\u6362\u73af\u3002<br/>\u7136\u540e\u8003\u8651\u4e0d\u5728\u540c\u4e00\u4e2a\u7f6e\u6362\u73af\u7684\u60c5\u51b5\uff1a<br/><br/>\u8bbe\u4e24\u4e2a\u7f6e\u6362\u73af\u7684\u957f\u5ea6\u5206\u522b\u4e3a$A$\u548c$B$\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u4e00\u6761\u8fde\u63a5\u4e24\u4e2a\u7f6e\u6362\u73af\u7684\u8fb9\uff0c\u90fd\u4f1a\u6709$\\\\mathrm{lcm}(A, B)$\u6761\u8fb9\u4e0e\u5b83\u540c\u6784\u3002\u800c\u603b\u8fb9\u6570\u4e3a$AB$\uff0c\u6240\u4ee5\u8fd9\u4e2a\u70b9\u7f6e\u6362\u7684\u7f6e\u6362\u73af\u5c31\u5bf9\u5e94\u4e86\u8fb9\u7f6e\u6362\u4e2d\u7684$\\\\gcd(A, B)$\u4e2a\u7f6e\u6362\u73af\u3002<br/>\u8003\u8651\u5b8c\u70b9\u7f6e\u6362\u548c\u8fb9\u7f6e\u6362\u7684\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u540e\uff0c\u6211\u4eec\u8003\u8651\u6765\u8ba1\u6570\u70b9\u7f6e\u6362\u96c6\u4e2d\u6709\u591a\u5c11\u4e2a\u7f6e\u6362\u73af\u957f\u5ea6\u5206\u522b\u4e3a$L_1, L_2, L_3, \\\\dots$\u7684\u7f6e\u6362\u3002\u8bbe\u957f\u5ea6\u4e3a$i$\u7684\u7f6e\u6362\u73af\u7684\u4e2a\u6570\u4e3a$S_i$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u91cf\u662f\uff1a<br/>$$<br/>{n! \\\\over L_1 L_2 L_3 \\\\cdots S_1!S_2!S_3!\\\\cdots}<br/>$$<br/>\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a\u7f6e\u6362\u73af\uff0c\u968f\u610f\u5faa\u73af\u65cb\u8f6c\u90fd\u662f\u540c\u6784\u7684\uff0c\u800c\u5927\u5c0f\u76f8\u540c\u7684\u7f6e\u6362\u73af\u4e92\u76f8\u4e4b\u95f4\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u9700\u8981\u9664\u53bb\u4e0a\u9762\u90a3\u4e2a\u5206\u6bcd\u3002<br/>\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u7b97\u51fa\u6240\u6709\u7f6e\u6362\u7684\u8d21\u732e\uff0c\u7136\u540e\u9664\u4ee5\u7f6e\u6362\u7684\u603b\u4e2a\u6570$n!$\uff0c\u5c31\u662f\u6211\u4eec\u7684\u7b54\u6848\u3002<br/>\u6700\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u7f6e\u6362\u4e2d\u7f6e\u6362\u73af\u7684\u60c5\u51b5\uff0c\u8fd9\u4e2a\u5176\u5b9e\u5c31\u662f$n$\u7684\u5206\u62c6\u3002\u5229\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u66f4\u5927\u7684$n$\u7684\u65b9\u6848 (\u4f46\u662f\u8fd8\u662f\u96be\u4ee5\u8ba1\u7b97\u8fd1\u767e\u7684\u7ea7\u522b)\u3002<br/><br/><br/><br/><br/>\u8fd9\u4e2a\u6570\u5217\u5728OEIS\u4e0a\u6709\u3002\u00a0\u21a9<br/><br/><br/>\u6211\u7684\u53e6\u5916\u4e00\u7bc7\u535a\u5ba2\u7b80\u5355\u5206\u6790\u4e86\u4e0b\u672c\u8d28\u4e0d\u540c\u7684\u7b80\u5355\u65e0\u5411\u8fde\u901a/\u975e\u8fde\u901a\u56fe\u7684\u6570\u91cf\u7684\u8ba1\u7b97\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-12-19/burnside.html"
},
"\u6811\u72b6\u6570\u7ec4": {
"tags": "\u6811\u72b6\u6570\u7ec4 \u6570\u636e\u7ed3\u6784",
"text": "\u6811\u72b6\u6570\u7ec4<br/>\u6811\u72b6\u6570\u7ec4\u662f\u4e00\u79cd\u5feb\u901f\u7edf\u8ba1\u524d\u7f00\u548c\u7684\u7b80\u5355\u6570\u636e\u7ed3\u6784\u3002<br/>\u57fa\u672c\u95ee\u9898<br/>\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u67e5\u8be2\u533a\u95f4\u5185\u7684\u548c\uff0c\u901a\u5e38\u4e07\u80fd\u7684\u505a\u6cd5\u5c31\u662f\u7ebf\u6bb5\u3002\u5199\u8fc7\u7ebf\u6bb5\u6811\u7684\u90fd\u77e5\u9053\uff0c\u5b83\u5176\u5b9e\u5e76\u4e0d\u7b80\u5355\uff0c\u5f53\u7136\u4e5f\u4e0d\u592a\u96be\u3002\u800c\u6709\u4e86\u6811\u72b6\u6570\u7ec4\u540e\uff0c\u5c31\u53ef\u4ee5\u4ee5\u6bd4\u7ebf\u6bb5\u6811\u5c11\u5f88\u591a\u4ee3\u7801\uff0c\u6765\u7edf\u8ba1\u533a\u95f4\u548c\u3002<br/>\u533a\u95f4\u6c42\u548c\u7684\u95ee\u9898\u4e00\u822c\u662f\u8fd9\u6837\u7684\uff1a<br/><br/>\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u6570\u5217\uff0c\u7136\u540e\u6bcf\u6b21\u7ed9\u4f60\u4e00\u4e2a\u533a\u95f4\u8be2\u95ee\uff0c\u8be2\u95ee\u8fd9\u6bb5\u533a\u95f4\u5185\u6570\u7684\u603b\u548c\u3002<br/><br/>\u6c42\u533a\u95f4\u548c\u53ef\u4ee5\u901a\u8fc7\u6c42\u524d\u7f00\u548c\u800c\u5f97\u3002\u5373\u67e5\u8be2$S[l, r]$\u53ef\u4ee5\u8f6c\u53d8\u4e3a$S[1, R] - S[1, L - 1]$\u3002\u5176\u4e2d$S$\u8868\u793a\u533a\u95f4\u548c\u3002<br/>\u70b9\u4fee\u6539\u533a\u95f4\u67e5\u8be2<br/>\u6211\u4eec\u5c06\u5148\u770b\u5230\u51e0\u4e2a\u7279\u5316\u8fc7\u7684\u533a\u95f4\u6c42\u548c\u95ee\u9898\u3002\u6811\u72b6\u6570\u7ec4\u7684\u6700\u57fa\u672c\u7528\u573a\u5c31\u662f\u70b9\u4fee\u6539 + \u533a\u95f4\u67e5\u8be2\u4e86\u3002\u5b83\u8981\u6c42\u652f\u6301\u4e24\u4e2a\u64cd\u4f5c\uff1a<br/><br/><br/>\u4fee\u6539\u67d0\u4e00\u4f4d\u7f6e\u4e0a\u7684\u6570<br/>\u67e5\u8be2\u67d0\u4e00\u4f4d\u7f6e\u524d\u7f00\u548c<br/><br/><br/><br/>\u6811\u72b6\u6570\u7ec4\u662f\u5957\u5728\u539f\u6570\u7ec4\u4e0a\u7684\u4e00\u5c422\uff0c\u7528\u6765\u8fdb\u884c\u4e00\u4e9b\u7ef4\u62a4\u3002\u4e0a\u56fe\u4e2d\u7684\u6811\u72b6\u6570\u7ec4\u88ab\u753b\u6210\u4e86\u5b83\u8be5\u6709\u7684\u6837\u5b50\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u6570\u7ec4\u3002<br/>\u5bf9\u4e8e\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u5176\u7bad\u5934\u6240\u6307\u5411\u7684\u5143\u7d20(\u5305\u62ec\u4ed6\u81ea\u5df1)\u90fd\u88ab\u5b83\u6240\u7ef4\u62a4\u3002<br/>\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5143\u7d20\uff0c\u5176\u5f80\u524d\u7684\u4e00\u4e2a\u533a\u95f4\u8ddd\u79bb\u548c\u5230\u5b83\u7236\u4eb2\u7684\u8ddd\u79bb\u662f\u76f8\u540c\u7684\uff0c\u5373\u4e00\u4e2a\u88ab\u79f0\u4e3a$\\\\text{lowbit}$\u7684\u4e1c\u897f\u3002\u8fd9\u4e2a\u4e1c\u897f\u5b9a\u4e49\u5982\u4e0b\uff1a<br/>1<br/>2function LOWBIT(x):<br/>    return x & (-x)<br/><br/><br/>\u8fd9\u91cc\u9762\u7528\u5230\u4e00\u4e2a\u5f88\u7384\u4e4e\u7684\u4f4d\u8fd0\u7b97\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u662f\u8fd9\u6837\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002<br/>\u5bf9\u4e8eLOWBIT\u6709\u4e00\u4e2a\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff0c\u5c31\u662fLOWBIT(0) = 0\u3002\u5373\u6811\u72b6\u6570\u7ec4\u4e0d\u80fd\u5904\u7406\u4e0b\u6807\u4e3a$0$\u7684\u60c5\u51b51\u3002\u5982\u679c\u4e0d\u6ce8\u610f\uff0c\u5c31\u5f88\u5bb9\u6613\u51fa\u73b0\u6b7b\u5faa\u73af\u3002<br/>\u5bf9\u4e8e\u6bcf\u6b21\u5355\u70b9\u7684\u66f4\u65b0\uff0c\u6211\u4eec\u90fd\u8981\u5c06\u5b83\u7684\u7236\u4eb2\u7ed9\u66f4\u65b0\uff0c\u56e0\u4e3a\u5b83\u662f\u88ab\u5176\u7236\u4eb2\u6240\u7ba1\u8f96\u7684\u3002<br/>\u800c\u67e5\u8be2\u53ef\u4ee5\u5411\u524d\u8fdb\u884c\u7edf\u8ba1\uff0c\u8fd9\u6837\u5c31\u53ef\u7edf\u8ba1\u524d\u7f00\u548c\u3002<br/>\u4e0b\u9762\u7528fenwick\u8868\u793a\u6811\u72b6\u6570\u7ec4\uff0cn\u8868\u793a\u5176\u957f\u5ea6\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18// \u4fee\u6539\u5355\u70b9<br/>function MODIFY(x, delta):<br/>    if x < 1:<br/>        return<br/><br/>    while x <= n:<br/>        fenwick[x] += delta<br/>        x += LOWBIT(x)<br/><br/>// \u67e5\u8be2\u524d\u7f00\u548c<br/>function QUERY(right):<br/>    answer = 0<br/><br/>    while right > 0:<br/>        answer += fenwick[right]<br/>        right -= LOWBIT(right)<br/><br/>    return answer<br/><br/><br/>\u5bf9\u4e8e\u6bcf\u4e2a\u64cd\u4f5c\uff0c\u5176\u4e2d\u7684\u5faa\u73af\u53ea\u8981\u8fdb\u884c$\\\\Theta(\\\\log n)$\u6b21\uff0c\u6545\u5b83\u4eec\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(\\\\log n)$\u7684\u3002<br/>\u533a\u95f4\u4fee\u6539\u70b9\u67e5\u8be2<br/>\u5bf9\u4e8e\u533a\u95f4\u4fee\u6539 + \u70b9\u67e5\u8be2\u7684\u95ee\u9898\u901a\u5e38\u8981\u652f\u6301\u4e00\u4e0b\u4e24\u79cd\u64cd\u4f5c\uff1a<br/><br/><br/>\u4fee\u6539\u4e00\u6bb5\u524d\u7f00\u548c<br/>\u67e5\u8be2\u67d0\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u6570\u7684\u5927\u5c0f<br/><br/><br/><br/>\u8003\u8651\u5230\u80fd\u591f\u5f71\u54cd\u5230\u4e00\u4e2a\u70b9\u7684\u503c\u7684\uff0c\u53ea\u6709\u5176\u7236\u4eb2\u3002\u56e0\u6b64\u6bcf\u6b21\u4fee\u6539\u524d\u7f00\u548c\u65f6\uff0c\u53ea\u9700\u8981\u4fee\u6539\u5b83\u4eec\u7684\u67d0\u4e00\u4e2a\u7236\u4eb2\u5373\u53ef\u3002\u67e5\u8be2\u5355\u70b9\u65f6\uff0c\u4e5f\u53ea\u9700\u8981\u8bbf\u95ee\u5176\u6bcf\u4e00\u4e2a\u7236\u4eb2\uff0c\u4ece\u800c\u53ef\u4ee5\u5f97\u77e5\u81ea\u5df1\u88ab\u52a0\u4e0a\u4e86\u591a\u5c11\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18// \u4fee\u6539<br/>function MODIFY(right, delta):<br/>    while right > 0:<br/>        fenwick[right] += delta<br/>        right -= LOWBIT(right)<br/><br/>// \u67e5\u8be2<br/>function QUERY(x):<br/>    if x < 1:<br/>        return 0<br/><br/>    answer = 0<br/><br/>    while x <= n:<br/>        answer += fenwick[x]<br/>        x += LOWBIT(x)<br/><br/>    return answer<br/><br/><br/>\u4e0e\u524d\u9762\u4e00\u6837\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f$\\\\Theta(\\\\log n)$\u3002<br/>\u533a\u95f4\u4fee\u6539\u533a\u95f4\u67e5\u8be2<br/>\u4e8b\u5b9e\u4e0a\uff0c\u4e0a\u9762\u4e24\u79cd\u7279\u5316\u7248\u672c\u5e76\u4e0d\u662f\u592a\u5e38\u89c1\uff0c\u6700\u5e38\u89c1\u7684\u56e0\u8be5\u662f\u5b8c\u6574\u7684\u533a\u95f4\u548c\u95ee\u9898\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ea\u8981\u5b9e\u73b0\u4e00\u4e0b\u4e24\u79cd\u64cd\u4f5c\uff1a<br/><br/><br/>\u4fee\u6539\u4e00\u6bb5\u524d\u7f00\u548c<br/>\u67e5\u8be2\u4e00\u6bb5\u524d\u7f00\u548c<br/><br/><br/>\u7531\u4e8e\u6811\u72b6\u6570\u7ec4\u7684\u4e00\u4e9b\u7279\u6b8a\u6027\uff0c\u5b83\u7684\u67e5\u8be2\u4e0d\u662f\u4ece\u6240\u8c13\u7684\u6839\u8282\u70b9\u5f00\u59cb\u7684\uff0c\u56e0\u6b64\u5728\u7236\u4eb2\u4fe1\u606f\u90fd\u4f1a\u4e22\u5931\u6389\u3002\u7136\u800c\u8981\u5c06\u4ed6\u4eec\u7edf\u8ba1\u56de\u6765\u65f6\uff0c\u5374\u9700\u8981\u5f88\u9ad8\u7684\u4ee3\u4ef7\u3002\u56e0\u6b64\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u4e0d\u597d\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002<br/>\u6240\u4ee5\u6211\u4eec\u540c\u65f6\u4f7f\u7528\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4\uff0c\u4e00\u4e2a\u7528\u4e8e\u67e5\u8be2\u5176\u513f\u5b50\u4eec\u7684\u4fe1\u606f\uff0c\u53e6\u5916\u4e00\u4e2a\u5219\u7528\u4e8e\u67e5\u8be2\u7236\u4eb2\u7684\u4fe1\u606f\u3002<br/>\u5177\u4f53\u5b9e\u73b0\u65f6\uff0c\u6211\u4eec\u4f7f\u7528fenwick1\u6765\u8bb0\u5f55\u5176\u7236\u4eb2\u7684\u4fe1\u606f\uff0cfenwick1[x]\u8868\u793a\u7684\u662f\u524dx\u4e2a\u6570\u6bcf\u4e2a\u90fd\u88ab\u52a0\u4e0a\u7684\u6570\u3002\u4f7f\u7528fenwick2\u6765\u8bb0\u5f55\u513f\u5b50\u7684\u4fe1\u606f\uff0cfenwick2[x]\u8868\u793a\u7684\u662f\u7b2cx\u4e2a\u5143\u7d20\u6240\u7ba1\u8f96\u7684\u8303\u56f4\u5185\u7684\u5143\u7d20\u4e4b\u548c\u3002\u8fd9\u6837\u5bf9\u4e24\u4e2a\u6570\u7ec4\u90fd\u67e5\u8be2\u4e00\u6b21\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5b8c\u6574\u7684\u4fe1\u606f\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32// \u4fee\u6539<br/>function MODIFY(right, delta):<br/>    if right < 1:<br/>        return<br/><br/>    i = right<br/>    while i > 0:<br/>        fenwick1[i] += delta<br/>        i -= LOWBIT(i)<br/>    i = right<br/>    while i <= n:<br/>        fenwick2[i] += delta * right  // \u6ce8\u610f\u662f\u533a\u95f4\u6bcf\u4e00\u4e2a\u6570\u90fd\u52a0\u4e0a\u4e86delta<br/>        i += LOWBIT(i)<br/><br/>function QUERY(right):<br/>    if right < 1:<br/>        return 0<br/><br/>    answer = 0<br/><br/>    i = right<br/>    while i <= n:  // \u7edf\u8ba1\u7236\u4eb2\u4e0a\u7684\u4fe1\u606f<br/>        answer += fenwick1[i]<br/>        i += LOWBIT(i)<br/>    answer *= right  // \u56e0\u4e3a\u662f\u6bcf\u4e2a\u6570\u6240\u52a0\u4e0a\u7684\u6570\uff0c\u6240\u4ee5\u8981\u4e58\u4ee5\u4e2a\u6570<br/><br/>    i = right - 1<br/>    while i > 0:  // \u7edf\u8ba1\u513f\u5b50\u4fe1\u606f<br/>        answer += fenwick2[i]<br/>        i -= LOWBIT(i)<br/><br/>    return answer<br/><br/><br/>\u6309\u7167\u56fd\u9645\u60ef\u4f8b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u4fdd\u6301\u5728$\\\\Theta(\\\\log n)$\u3002<br/>\u66f4\u9ad8\u7ef4\u5ea6<br/>\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u5bf9\u4e8c\u7ef4\u6216\u4e09\u7ef4\u4e0a\u8fdb\u884c\u6c42\u548c\uff0c\u7ebf\u6bb5\u6811\u5f53\u7136\u53ef\u4ee5\u505a\uff0c\u53ea\u662f\u4ee3\u7801\u91cf\u5c06\u4ee5$O(2^k)$\u7684\u590d\u6742\u5ea6\u66b4\u6da8\uff0c\u5e76\u4e14\u5de8\u5927\u7684\u5e38\u6570\u4e5f\u96be\u4ee5\u63a5\u53d7\u3002\u4f46\u6b64\u65f6\u6811\u72b6\u6570\u7ec4\u5374\u53ef\u4ee5\u5f88\u597d\u7684\u56e0\u5bf9\u3002<br/>\u90a3\u662f\u56e0\u4e3a\u6bcf\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u7684\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u5b9e\u9645\u7ba1\u8f96\u7684\u662f\u6574\u4e2a\u6570\u5217\u7684\u548c\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u5355\u72ec\u6311\u51fa\u6765\u4ee3\u8868\u8fd9\u4e00\u4e2a\u6570\u5217\u3002\u5f53\u6211\u4eec\u6709\u5f88\u591a\u4e2a\u6570\u5217\u65f6\uff0c\u6211\u4eec\u5c06\u8fd9\u4e9b\u4ee3\u8868\u4e5f\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\u3002\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u6811\u72b6\u6570\u7ec4\u5411\u9ad8\u7ef4\u5ea6\u7684\u6269\u5c55\u3002<br/>\u5177\u4f53\u5b9e\u73b0\u65b9\u9762\u5c31\u662f\u5728\u6bcf\u4e2a\u64cd\u4f5c\u4e2d\u591a\u4e86\u51e0\u5c42\u5faa\u73af\uff0c\u7528\u4e8e\u5728\u6bcf\u4e00\u4e2a\u7ef4\u5ea6\u4e2d\u7684\u7edf\u8ba1\u3002\u6700\u540e\u8981\u5f97\u77e5\u4e00\u6bb5\u533a\u95f4\u4e2d\u7684\u548c\u65f6\uff0c\u5229\u7528\u5bb9\u65a5\u539f\u7406\u5373\u53ef\u3002<br/>\u7531\u4e8e\u5728\u6bcf\u4e00\u7ef4\u4e0a\u90fd\u9700\u8981\u82b1\u8d39$\\\\Theta(\\\\log n)$\u7684\u65f6\u95f4\uff0c\u56e0\u6b64\u5bf9\u4e8e$k$\u4e3a\u7a7a\u95f4\u7684\u64cd\u4f5c\u7684\u590d\u6742\u5ea6\u4e00\u822c\u90fd\u662f$\\\\Theta(\\\\log^k n)$\u3002<br/>\u4f18\u52bf\u4e0e\u7f3a\u70b9<br/>\u6811\u72b6\u6570\u7ec4\u6709\u7740\u5f88\u591a\u7684\u4f18\u70b9\uff1a<br/><br/>\u4ee3\u7801\u77ed\u5c0f\uff0c\u5e38\u6570\u5c0f<br/>\u6613\u4e8e\u8c03\u8bd5<br/>\u5bb9\u6613\u6269\u5c55\u5230\u9ad8\u7ef4\u5ea6\u7684\u6570\u636e<br/><br/>\u4e5f\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u6811\u72b6\u6570\u7ec4\u4e5f\u6709\u7740\u8bb8\u591a\u7684\u5c40\u9650\u6027\uff1a<br/><br/>\u53ea\u80fd\u7528\u4e8e\u6c42\u548c3\uff0c\u4e0d\u80fd\u6c42\u6700\u5927/\u5c0f\u503c<br/>\u4e0d\u80fd\u52a8\u6001\u63d2\u5165\uff0c\u9762\u591a\u591a\u7ef4\u6570\u636e\u65f6\u7a7a\u95f4\u538b\u529b\u5927<br/>\u4e0d\u80fd\u53ef\u6301\u4e45\u5316<br/><br/>\u56e0\u6b64\uff0c\u5728\u6811\u72b6\u6570\u7ec4\u4e0e\u7ebf\u6bb5\u6811\u4e2d\u8fdb\u884c\u6289\u62e9\u65f6\uff0c\u662f\u9700\u8981\u5c0f\u5fc3\u7684\u3002\u6811\u72b6\u6570\u7ec4\u867d\u597d\uff0c\u4f46\u4e0d\u662f\u4e07\u80fd\u7684\u3002\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u786e\u5b9a\u3002<br/><br/><br/><br/><br/>\u5982\u679c\u4e0b\u6807\u4e00\u5b9a\u8981\u4e3a$0$\uff0c\u53ef\u4ee5\u8003\u8651\u5c06\u5176\u5168\u90e8\u52a0$1$\u3002\u00a0\u21a9<br/><br/><br/>\u5f53\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u66ff\u4ee3\u539f\u6570\u7ec4\u3002\u00a0\u21a9<br/><br/><br/>\u6216\u8005\u8bf4\u5177\u6709\u533a\u95f4\u51cf\u6cd5\u6027\u8d28\u7684\u6570\u636e\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-6-3/fenwick.html"
},
"\u6811\u94fe\u5256\u5206": {
"tags": "\u6570\u636e\u7ed3\u6784 \u6811\u94fe\u5256\u5206 LCA",
"text": "\u6811\u94fe\u5256\u5206<br/>\u7528\u9014<br/>\u95ee\u9898: \u7ed9\u4f60\u4e00\u68f5\u65e0\u6839\u6811\uff0c\u6bcf\u6761\u8fb9\u6709\u8fb9\u6743\uff0c\u8bf7\u4f60\u5b9e\u73b0\u4ee5\u4e0b\u64cd\u4f5c\uff1a<br/><br/>\u67e5\u8be2$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u8fb9\u6743\u4e4b\u548c\u3002<br/>\u67e5\u8be2$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u8fb9\u6743\u6700\u5927\u503c\u3002<br/>\u4fee\u6539$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u3002<br/>\u2026<br/><br/>\u8fd9\u4e9b\u64cd\u4f5c\u5229\u7528\u6811\u94fe\u5256\u5206\uff0c\u90fd\u53ef\u4ee5\u5728$O(\\\\log n)$\u7684\u65f6\u95f4\u5185\u89e3\u51b3\u3002<br/>\u65e0\u6839\u6811\u4e0e\u6709\u6839\u6811<br/>\u4e00\u822c\u6765\u8bf4\uff0c\u65e0\u6839\u6811\u662f\u5f88\u4e0d\u597d\u5904\u7406\u7684\uff0c\u56e0\u6b64\u5c06\u5176\u8f6c\u4e3a\u6709\u6839\u6811\u5c31\u4f1a\u597d\u5904\u7406\u4e9b\u3002<br/>\u6211\u4eec\u53ea\u8981\u9009\u5b9a\u4e00\u4e2a\u8282\u70b9\u4e3a\u6839\uff0c\u7136\u540e\u8fdb\u884cDFS\u5373\u53ef\u8f6c\u5316\u4e3a\u6709\u6839\u6811\u3002<br/>\u8f6c\u6362\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u989d\u5916\u8bb0\u5f55\u4ee5\u4e0b\u4fe1\u606f\uff1a<br/><br/>$x.\\\\text{father}$: $x$\u7684\u7236\u4eb2\u8282\u70b9\u3002<br/>$x.\\\\text{children}$: $x$\u7684\u6240\u6709\u5b69\u5b50\u3002<br/>$x.\\\\text{size}$: \u4ee5$x$\u4e3a\u6839\u7684\u8fd9\u4e00\u68f5\u5b50\u6811\u7684\u5927\u5c0f\u3002<br/>$x.\\\\text{depth}$: $x$\u5728\u6811\u4e2d\u7684\u6df1\u5ea6\uff0c\u5373$x$\u5230\u6811\u6839\u7684\u8ddd\u79bb$+1$\u3002<br/><br/><br/>\u8fd9\u662f\u4e00\u68f5\u4ee5$1$\u4e3a\u6839\u7684\u6811\u3002\u4e3a\u4e86\u89e3\u91ca\u66f4\u52a0\u6e05\u695a\uff0c\u8fd9\u91cc\u4e3e\u51e0\u4e2a\u4f8b\u5b50\uff1a<br/><br/>$10.\\\\text{father} = 5,\\\\; 1.\\\\text{father} = nil$<br/>$1.\\\\text{children} = \\\\{2, 5, 6\\\\},\\\\;7.\\\\text{children} = \\\\varnothing$<br/>$1.\\\\text{size} = 17,\\\\;6.\\\\text{size} = 8,\\\\;3.\\\\text{size} = 1$<br/>$1.\\\\text{depth} = 1,\\\\;10.\\\\text{depth} = 3,\\\\;14.\\\\text{depth} = 4$<br/><br/>\u4e3a\u4e86\u8fdb\u884c\u6811\u94fe\u5256\u5206\uff0c\u6211\u4eec\u5728\u7acb\u6811\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981\u8ba1\u7b97\u4e00\u4e2a\u91cd\u513f\u5b50\uff0c\u8bb0\u4f5c$x.\\\\text{next}$\uff1a<br/>$$ x.\\\\text{next} = u: u \\\\in x.\\\\text{children},\\\\;u.\\\\text{size}\\\\text{\u6700\u5927} $$<br/>\u5373\u6240\u6709\u513f\u5b50\u4e2d\u5927\u5c0f\u6700\u5927\u7684\u4e00\u4e2a\uff0c\u5c31\u8bb0\u4e3a\u91cd\u513f\u5b50\uff0c\u5176\u5b83\u7684\u513f\u5b50\u5c31\u662f\u8f7b\u513f\u5b50\u3002\u540c\u65f6\u79f0\u4e0e\u91cd\u513f\u5b50\u76f8\u8fde\u7684\u8fb9\u4e3a\u91cd\u8fb9\uff0c\u4e0e\u8f7b\u513f\u5b50\u76f8\u8fde\u7684\u8fb9\u4e3a\u8f7b\u8fb9\u3002<br/>\u4e0b\u9762\u7684\u4f2a\u4ee3\u7801\u662f\u5efa\u7acb\u6709\u6839\u6811\u7684\u8fc7\u7a0b(\u5047\u8bbe\u6211\u4eec\u8f93\u5165\u7684\u662f\u65e0\u6839\u6811$G$\uff0c\u8fd9\u662f\u4e00\u5f20\u65e0\u5411\u56fe\uff0c\u5176\u4e2d\u4e0e$u$\u76f8\u8fde\u7684\u9876\u70b9\u96c6\u5408\u4e3a$G[u].\\\\text{neighbors}$)\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24function MAKE-ROOT(G, u):  // \u4ee5u\u4e3a\u6811\u6839<br/>    u.visited = true  // u\u5df2\u7ecf\u8bbf\u95ee\u8fc7\u4e86<br/>    u.father = nil // u\u6ca1\u6709\u7236\u4eb2<br/>    u.depth = 1<br/><br/>    REAL-MAKE-ROOT(G, u)<br/><br/>function REAL-MAKE-ROOT(G, u):  // DFS\u8fc7\u7a0b<br/>    u.size = 1<br/>    u.next = nil<br/><br/>    foreach v in G[u].neighbors:<br/>        if not v.visited:  // \u5982\u679c\u8fd8\u672a\u8bbf\u95ee<br/>            v.visited = true<br/>            u.children += v  // \u6dfb\u52a0\u513f\u5b50\u8282\u70b9<br/>            v.father = u<br/>            v.depth = u.depth + 1<br/><br/>            REAL-MAKE-ROOT(G, v)  // \u9012\u5f52\u5411\u4e0b<br/><br/>            u.size += v.size  // \u66f4\u65b0\u5b50\u6811\u5927\u5c0f<br/><br/>            if u.next = nil || v.size > u.next.size:  // \u66f4\u65b0\u91cd\u513f\u5b50<br/>                u.next = v<br/><br/><br/>\u5256\u5206<br/>\u5728\u4ecb\u7ecd\u6811\u94fe\u5256\u5206\u7684\u7b97\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u770b\u770b\u5256\u5206\u540e\u7684\u6811\u662f\u4e2a\u4ec0\u4e48\u6837\u5b50\uff1a<br/><br/>\u5256\u5206\u540e\u7684\u6811\u4fe1\u606f\u91cf\u4e00\u4e0b\u5b50\u5927\u4e86\u5f88\u591a\u3002\u6211\u5c06\u4f1a\u9010\u6761\u89e3\u91ca\u4e0a\u9762\u90fd\u753b\u4e86\u4e9b\u4ec0\u4e48\u3002<br/><br/>\u6811\u94fe(\u91cd\u94fe): \u6240\u6709\u7ea2\u8272\u7684\u8fb9\u6240\u8fde\u6210\u7684\u4e00\u6761\u94fe\u90fd\u662f\u5256\u5206\u540e\u7684\u7ed3\u679c\u3002\u67d0\u4e9b\u6811\u94fe\u6ca1\u6709\u8fb9\uff0c\u5c31\u53ea\u6709\u4e00\u4e2a\u8282\u70b9\uff0c\u8fd9\u4e2a\u8282\u70b9\u662f\u7ea2\u8272\u7684\u3002\u5728\u4e0a\u9762\uff0c1-6-8-11-13-17\u662f\u5256\u5206\u51fa\u6765\u7684\u6700\u957f\u7684\u6811\u94fe\uff0c\u800c3\u72ec\u81ea\u4e00\u4e2a\u8282\u70b9\u5f62\u6210\u4e86\u6811\u94fe\u3002<br/>\u6811\u94fe\u8d77\u70b9: \u7ea2\u8272\u7684\u8282\u70b9\u662f\u6bcf\u4e00\u6761\u6811\u94fe\u7684\u8d77\u70b9\u3002<br/>\u91cd\u513f\u5b50: \u84dd\u8272\u7684\u8282\u70b9\u662f\u91cd\u513f\u5b50\u3002<br/>\u7f16\u53f7: \u6bcf\u4e00\u6761\u8fb9\u4e0a\u7684\u6570\u5b57\u4e3a\u5256\u5206\u540e\u7684\u7f16\u53f7\u3002<br/><br/>\u53ef\u4ee5\u770b\u51fa\uff0c\u6811\u4e2d\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u4f1a\u5728\u4e00\u6761\u6811\u94fe\u4e2d\u3002\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5bf9\u6811\u94fe\u4e5f\u8fdb\u884c\u7f16\u53f7\u3002\u6211\u4eec\u4ee5\u6811\u94fe\u9876\u7aef\u7684\u8282\u70b9\u4f5c\u4e3a\u6811\u94fe\u7684\u7f16\u53f7\uff0c\u5e76\u8bb0\u4e3a$x.\\\\text{top}$\u3002\u4f8b\u5982\uff0c$8.\\\\text{top} = 1,\\\\;16.\\\\text{top} = 16$\u3002<br/>\u5982\u679c\u4e24\u4e2a\u8282\u70b9$u$\u548c$v$\u5728\u540c\u4e00\u6811\u94fe\u4e2d\uff0c\u5f53\u4e14\u4ec5\u5f53$u.\\\\text{top} = v.\\\\text{top}$\u3002<br/>\u5bf9\u4e8e\u8fb9$u \\\\rightarrow v$\u7684\u7f16\u53f7\uff0c\u6211\u4eec\u8bb0\u8fb9\u4e3a\u4e8c\u5143\u7ec4$(u, v)$\uff0c\u90a3\u4e48\u8bb0\u7f16\u53f7\u4e3a$(u,v).\\\\text{id}$\u3002<br/>\u4f46\u662f\u8fd9\u6837\u4e0d\u65b9\u4fbf\u5728\u7a0b\u5e8f\u4e2d\u50a8\u5b58\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u8fb9\u7684\u7f16\u53f7\u653e\u5230\u8282\u70b9\u91cc\u9762\u3002\u5728\u4e0a\u9762\u7684\u5199\u6cd5\u4e2d\uff0c\u5982\u679c$u$\u662f$v$\u7684\u7236\u4eb2\uff0c\u90a3\u4e48\u6211\u4eec\u5c06\u8fb9$(u,v)$\u7684\u7f16\u53f7\u653e\u5230$v$\u4e2d\uff0c\u5373$v.\\\\text{id}$\u3002\u8fd9\u6837\u8868\u793a$v$\u4e0e\u5176\u7236\u4eb2\u76f8\u8fde\u7684\u8fb9$(u,v)$\u7684\u7f16\u53f7\u4e3a$v.\\\\text{id}$\u3002<br/>\u8fb9\u7684\u7f16\u53f7\u662f\u6811\u5256\u7684\u5173\u952e\uff0c\u7ed9\u8fb9\u8d4b\u4e88\u7f16\u53f7\u540e\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u5f88\u591a\u64cd\u4f5c\u4e86\u3002<br/>\u6211\u4eec\u9996\u5148\u6765\u770b\u8fd9\u4e9b\u7f16\u53f7\u6709\u4ec0\u4e48\u7279\u70b9\uff1a<br/><br/>\u6bcf\u4e2a\u8fb9\u7684\u7f16\u53f7\u90fd\u4e0d\u4e00\u6837\u3002<br/>\u540c\u4e00\u6761\u7684\u6811\u94fe\u7684\u8fb9\u7684\u7f16\u53f7\u4ece\u9ad8\u5904\u5411\u4f4e\u5904\u7f16\u53f7\u9012\u589e\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u5c31\u662f\u540c\u4e00\u6761\u94fe\u4e0a\u9762\u7684\u6570\u636e\u53ef\u4ee5\u7528\u4e00\u4e9b\u6570\u636e\u7ed3\u6784(\u5982\u7ebf\u6bb5\u6811\u3001Splay\u7b49)\u6765\u7ef4\u62a4\u3002<br/>\u5bf9\u4e8e\u8282\u70b9$u$\uff0c\u5176\u91cd\u8fb9\u7684\u7f16\u53f7\u662f$u$\u4e0e\u6240\u6709\u513f\u5b50\u7684\u8fde\u8fb9\u4e2d\u6700\u5c0f\u7684\u3002<br/><br/>\u4f30\u8ba1\u4f60\u5df2\u7ecf\u731c\u5230\u8ba1\u7b97$\\\\text{top}$\u548c$\\\\text{id}$\u7684\u7528\u5904\u4e86\u3002\u4f46\u4e0d\u8981\u7740\u6025\uff0c\u4e0b\u9762\u5c31\u5c06\u8ba1\u7b97\u8fd9\u4e9b\u503c\u3002<br/>\u8ba1\u7b97\u7684\u8fc7\u7a0b\u4e5f\u662f\u4e00\u904dDFS\u3002\u8fd9\u6b21\u7684DFS\u662f\u5728\u7b2c\u4e00\u6b21\u5efa\u7acb\u597d\u7684\u6709\u6839\u6811\u4e0a\u8fdb\u884c\u7684\u3002<br/>\u5f53\u6211\u4eec\u5904\u7406\u5230\u8282\u70b9$u$\u65f6\uff0c\u6211\u4eec\u5c06$u$\u548c$u.\\\\text{next}$\u76f8\u8fde\u6765\u5f62\u6210\u6811\u94fe\u3002\u4e4b\u6240\u4ee5\u9009\u53d6\u91cd\u513f\u5b50\uff0c\u662f\u56e0\u4e3a\u91cd\u513f\u5b50\u7684\u5927\u5c0f\u6700\u5927\uff0c\u56e0\u6b64\u6240\u751f\u6210\u7684\u6811\u94fe\u5c06\u5c3d\u53ef\u80fd\u957f1\u3002\u90a3\u4e48\u5176\u5b83\u7684\u513f\u5b50\u5c06\u81ea\u5df1\u6210\u4e3a\u65b0\u7684\u6811\u94fe\u3002<br/>\u6b64\u65f6\u6765\u8003\u8651\u7f16\u53f7\u3002\u56e0\u4e3a\u540c\u4e00\u6761\u6811\u94fe\u4e0a\u7684\u8fb9\u7684\u7f16\u53f7\u662f\u9012\u589e\u7684\uff0c\u56e0\u6b64\u8981\u4f18\u5148\u5bf9\u91cd\u513f\u5b50\u8fdb\u884cDFS\u3002\u7531\u4e8e\u8f7b\u513f\u5b50\u662f\u65b0\u521b\u5efa\u7684\u6811\u94fe\uff0c\u56e0\u6b64DFS\u7684\u987a\u5e8f\u5e76\u4e0d\u91cd\u8981\u3002<br/>\u81f3\u6b64\uff0c\u6811\u94fe\u5256\u5206\u7684\u7b97\u6cd5\u5c31\u7ed3\u675f\u4e86\u3002\u5f53\u7b97\u6cd5\u5b8c\u6210\u65f6\uff0c\u6bcf\u4e2a\u8282\u70b9\u5c31\u4f1a\u6709\u6b63\u786e\u7684$\\\\text{top}$\u548c$\\\\text{id}$\u3002<br/>\u4e0b\u9762\u662f\u6811\u94fe\u5256\u5206\u7684\u4f2a\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23count = 0  // \u5df2\u7f16\u53f7\u7684\u6570\u91cf<br/><br/>function TREE-SPLIT(x):  // \u5256\u5206\u5b50\u6811u<br/>    x.id = 0  // \u6839\u8282\u70b9\u6ca1\u6709\u7236\u4eb2<br/>    x.top = x  // \u6839\u8282\u70b9\u662f\u7b2c\u4e00\u6761\u94fe<br/><br/>    REAL-TREE-SPLIT(x)<br/><br/>function REAL-TREE-SPLIT(x):  // DFS\u8fc7\u7a0b<br/>    if x.next != nil:  // \u5982\u679c\u6709\u91cd\u513f\u5b50<br/>        count += 1<br/>        x.next.id = count<br/>        x.next.top = x.top<br/><br/>        REAL-TREE-SPLIT(x.next)  // \u4f18\u5148\u91cd\u513f\u5b50<br/><br/>    foreach v in x.children:  // \u5bf9\u4e8e\u8f7b\u513f\u5b50\u5219\u65b0\u521b\u4e00\u6761\u94fe<br/>        if v != x.next:  // \u68c0\u67e5\u662f\u4e0d\u662f\u91cd\u513f\u5b50<br/>            count += 1<br/>            v.id = count<br/>            v.top = v<br/><br/>            REAL-TREE-SPLIT(v)<br/><br/><br/>\u57fa\u7840\u64cd\u4f5c<br/>\u6811\u94fe\u5256\u5206\u5b8c\u6709\u4ec0\u4e48\u7528\u5462\uff1f<br/>\u5c31\u50cf\u4e00\u5f00\u573a\u6240\u8bf4\u7684\uff1a<br/><br/><br/>\u67e5\u8be2$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u8fb9\u6743\u4e4b\u548c\u3002<br/>\u67e5\u8be2$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u8fb9\u6743\u6700\u5927\u503c\u3002<br/>\u4fee\u6539$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u3002<br/>\u2026<br/><br/><br/>\u4e0b\u9762\u5c06\u4ecb\u7ecd\u5982\u4f55\u8fdb\u884c\u8def\u5f84\u8fb9\u6743\u4e4b\u548c\u7684\u67e5\u8be2\u548c\u4fee\u6539\u8def\u5f84\u8fb9\u6743\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u3002\u5176\u5b83\u7684\u64cd\u4f5c\u53ef\u4ee5\u5728\u6b64\u601d\u60f3\u4e0a\u6269\u5c55\u3002<br/>\u67e5\u8be2<br/>\u5047\u5982\u6211\u4eec\u8981\u67e5\u8be2$u$\u5230$v$\u7684\u8def\u5f84\u4e0a\u7684\u6743\u503c\u4e4b\u548c\uff0c\u90a3\u4e48\u5c31\u4f1a\u6709\u4e24\u79cd\u60c5\u51b5\uff1a<br/><br/>$u$\u548c$v$\u5728\u540c\u4e00\u6761\u6811\u94fe\u4e0a\u3002<br/>$u$\u548c$v$\u4e0d\u5728\u540c\u4e00\u6761\u6811\u94fe\u4e0a\u3002<br/><br/>\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u975e\u5e38\u597d\u89e3\u51b3\u3002\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u6bcf\u4e00\u6761\u8fb9\u7684\u6743\u503c\uff0c\u76f4\u63a5\u6309\u7167\u7f16\u53f7\u6765\u6392\u5217\u3002\u7531\u4e8e\u540c\u4e00\u6761\u94fe\u4e0a\u7684\u7f16\u53f7\u662f\u9012\u589e\u7684\uff0c\u5982\u679c$u.\\\\text{depth} < v.\\\\text{depth}$\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2$[u.\\\\text{next}.\\\\text{id}, v.\\\\text{id}]$\u7684\u548c\u3002\u5982\u679c$u.\\\\text{depth} = v.\\\\text{depth}$\uff0c\u7531\u4e8e$u$\u548c$v$\u662f\u5728\u540c\u4e00\u6761\u6811\u94fe\u4e0a\u7684\uff0c\u4e5f\u5c31\u662f\u610f\u5473\u7740$u = v$\uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u7edf\u8ba1\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u5b83\u4eec\u4e0d\u65ad\u903c\u8fd1\u5230\u540c\u4e00\u6761\u94fe\u4e0a\u6765\uff0c\u4ece\u800c\u5c31\u8f6c\u4e3a\u4e86\u7b2c\u4e00\u79cd\u60c5\u51b5\u3002\u4f46\u662f\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u53d8\u5316\u5230\u53e6\u4e00\u6761\u6811\u94fe\u4e0a\u65f6\uff0c\u8981\u5c06\u7ecf\u8fc7\u7684\u6811\u94fe\u7684\u503c\u8fdb\u884c\u7edf\u8ba1\u3002<br/>\u6211\u4eec\u6309\u7167\u4e00\u4e0b\u6b65\u9aa4\u6765\u5904\u7406\uff1a<br/><br/>\u5982\u679c$u.\\\\text{top}.\\\\text{depth} < v.\\\\text{top}.\\\\text{depth}$\uff0c\u90a3\u4e48\u4ea4\u6362$u$\u548c$v$\uff0c\u4f7f$u$\u6240\u5728\u7684\u6811\u94fe\u4e3a\u6240\u5904\u4f4d\u7f6e\u8f83\u6df1\u7684\u4e00\u4e2a\u3002<br/>\u8ba1\u7b97$[u.\\\\text{top}.\\\\text{id},u.\\\\text{id}]$\u7684\u503c\u5e76\u7d2f\u52a0\u3002<br/>\u4ee4$u = u.\\\\text{top}.\\\\text{father}$\u3002<br/>\u5982\u679c$u.\\\\text{top} = v.\\\\text{top}$\uff0c\u5219\u8f6c\u5316\u4e3a\u7b2c\u4e00\u79cd\u60c5\u51b5\u3002\u5426\u5219\u8df3\u8f6c\u7b2c\u4e00\u6b65\u3002<br/><br/>\u4e0a\u9762\u6b65\u9aa4\u7684\u601d\u60f3\u5c31\u662f\u5c06\u4e0a\u5347\u671f\u95f4\u7684\u6bcf\u4e00\u6761\u6811\u94fe\u7684\u548c\u7edf\u8ba1\u51fa\u6765\uff0c\u8fd9\u6837\u5b9e\u5219\u5c31\u662f\u7edf\u8ba1\u4e86\u8fd9\u6761\u8def\u5f84\u4e0a\u7684\u548c\u3002<br/>\u7b2c\u4e00\u6b65\u7684\u64cd\u4f5c\u662f\u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u7684\u5904\u7406\u3002\u7b2c\u4e8c\u6b65\u662f\u8ba1\u7b97\u8fd9\u4e00\u6761\u94fe\u4e0a\u7684\u548c\uff0c\u5305\u62ec\u8fd9\u6761\u94fe\u4e0a\u9762\u7684\u4e00\u6761\u8f7b\u8fb9\uff0c\u56e0\u4e3a\u5728\u7b2c\u4e09\u6b65\u4e2d\u8981\u8d70\u8fd9\u6761\u8f7b\u8fb9\u5230\u8fbe\u4e0a\u9762\u4e00\u6761\u6811\u94fe\u3002\u6700\u540e\u4e00\u6b65\u662f\u68c0\u67e5\u662f\u5426\u6210\u4e3a\u4e86\u7b2c\u4e00\u79cd\u60c5\u51b5\u3002<br/>\u4e0b\u9762\u662f\u4e0a\u9762\u6b65\u9aa4\u7684\u53c2\u8003\u4f2a\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18function QUERY-SUM(u, v):<br/>    sum = 0<br/><br/>    // \u5982\u679c\u4e0d\u5728\u540c\u4e00\u6761\u6811\u94fe<br/>    while u.top != v.top:<br/>        if u.top.depth < v.top.depth:<br/>            SWAP(u, v)  // \u4ea4\u6362u\u548cv<br/><br/>        sum += QUERY(u.top.id, u.id)  // \u5229\u7528\u7ebf\u6bb5\u6811\u7b49\u6570\u636e\u7ed3\u6784\u6765\u6c42\u548c<br/>        u = u.top.father  // \u8d70\u8f7b\u8fb9\u8fdb\u5165\u4e0a\u9762\u7684\u6811\u94fe<br/><br/>    if u == v:  // \u5982\u679c\u5904\u5728\u76f8\u540c\u4f4d\u7f6e<br/>        return sum<br/><br/>    if u.depth > v.depth:  // \u4f7fu\u6210\u4e3a\u6df1\u5ea6\u8f83\u5c0f\u7684\u8282\u70b9<br/>        SWAP(u, v)<br/><br/>    return QUERY(u.next.id, v.id) + sum<br/><br/><br/>\u5982\u679c\u4e0d\u80fd\u7406\u89e3\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a<br/><br/>\u5047\u8bbe\u6211\u4eec\u67e5\u8be2$16$\u5230$17$\uff1a<br/>\u9996\u5148\u4f1a\u53d1\u73b0\u5b83\u4eec\u4e0d\u5728\u540c\u4e00\u6761\u94fe\u4e0a\uff0c\u7531\u4e8e$16$\u6240\u5904\u7684\u94fe\u7684\u6df1\u5ea6\u8f83\u5927\uff0c\u4e3a$5$\uff0c\u56e0\u6b64\u5c06$16$\u8fdb\u884c\u4e0a\u79fb\uff0c\u4e0a\u79fb\u81f3$14$\uff0c\u5e76\u7edf\u8ba1$[13, 13]$\u7684\u548c\u3002<br/>\u7136\u540e$14$\u548c$17$\u4f9d\u7136\u4e0d\u5728\u540c\u4e00\u6761\u94fe\u4e2d\uff0c\u7531\u4e8e$14$\u6240\u5904\u7684\u94fe\u7684\u6df1\u5ea6\u4e3a$2$\uff0c\u56e0\u6b64\u5c06$14$\u4e0a\u79fb\u3002\u4e0a\u79fb\u81f3$1$\uff0c\u5e76\u7edf\u8ba1$[9, 11]$\u7684\u548c\u3002<br/>\u6700\u540e\u53d1\u73b0$1$\u548c$17$\u5df2\u7ecf\u5728\u540c\u4e00\u6761\u94fe\u4e2d\u4e86\uff0c\u76f4\u63a5\u7edf\u8ba1$[1, 5]$\u7684\u548c\u5373\u53ef\u3002<br/>\u4fee\u6539<br/>\u4e8b\u5b9e\u4e0a\uff0c\u4fee\u6539\u64cd\u4f5c\u548c\u67e5\u8be2\u51e0\u4e4e\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u53ea\u662f\u5c06\u6c42\u548c\u7684\u5730\u65b9\u53d8\u6210\u4e86\u76f8\u5e94\u7684\u6570\u636e\u7ed3\u6784\u7684\u4fee\u6539\u64cd\u4f5c\u3002\u8fd9\u91cc\u5c31\u4e0d\u518d\u591a\u8bf4\u4e86\u3002<br/>\u65f6\u95f4\u590d\u6742\u5ea6<br/>\u6bcf\u5f53\u5b66\u4e60\u4e86\u4e00\u4e2a\u65b0\u7b97\u6cd5\uff0c\u6211\u4eec\u6700\u5173\u5207\u7684\u5c31\u662f\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e86\u3002<br/>\u5982\u679c\u6811\u94fe\u5256\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u9ad8\u5230\u7206\uff0c\u6211\u4eec\u5199\u7684\u65f6\u5019\u4f30\u8ba1\u5f97\u865a\u6b7b\u3002<br/>\u4f46\u662f\u53ef\u4ee5\u8bc1\u660e\uff0c\u6811\u94fe\u5256\u5206\u540e\u7684\u6811\uff0c\u4ece\u6839\u8282\u70b9\u5230\u4efb\u610f\u4e00\u4e2a\u53f6\u8282\u70b9\u7684\u8def\u5f84\u53ea\u4f1a\u4e0e$O(\\\\log n)$\u6761\u6811\u94fe\u76f8\u4ea4\u3002\u8fd9\u610f\u5473\u7740\u5c06\u4e24\u4e2a\u8282\u70b9\u903c\u8fd1\u5230\u540c\u4e00\u6761\u94fe\u4e0a\u65f6\uff0c\u53ea\u9700\u7ecf\u8fc7$O(\\\\log n)$\u6b21\u8df3\u8f6c\u3002<br/>\u5373\u57fa\u4e8e\u6811\u5256\u7684\u5176\u5b83\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Omega(\\\\log n)$(\u6ce8\u610f\u662f\u4e0b\u754c\uff0c\u5177\u4f53\u7684\u4e0a\u754c\u53d6\u51b3\u4e8e\u64cd\u4f5c\u672c\u8eab\u7684\u9644\u52a0\u7684\u590d\u6742\u5ea6)\u3002<br/>\u4e3a\u4ec0\u4e48\u4f1a\u53ea\u6709$O(\\\\log n)$\u6761\u5462\uff1f<br/>\u6211\u4eec\u6765\u8003\u8651\u6811\u94fe\u5256\u5206\u65f6\u6700\u574f\u7684\u60c5\u51b5\uff1a<br/><br/>\u60f3\u8c61\u8fd9\u662f\u6811\u5256\u662f\u6700\u574f\u7684\u60c5\u51b5(\u56e0\u4e3a\u5b9e\u9645\u4e0a\u5e76\u4e0d\u4f1a\u8fd9\u6837)\u3002\u56e0\u4e3a\u6811\u5256\u603b\u662f\u5c1d\u8bd5\u5c06\u6700\u957f\u7684\u5256\u5206\u51fa\u6765\uff0c\u56e0\u6b64\u6811\u94fe\u90fd\u662f\u5411\u53f3\u7684\u3002\u5982\u679c\u6700\u5de6\u94fe\u518d\u52a0\u4e00\u4e2a\u8282\u70b9\uff0c\u6811\u94fe\u5c31\u4f1a\u5411\u5de6\u5256\u5206\u4e86\u3002<br/>\u4e3a\u4e86\u8fbe\u5230\u8fd9\u6837\u7684\u6548\u679c\uff0c\u8fd9\u68f5\u6709\u6839\u6811\u662f\u63a5\u8fd1\u5e73\u8861\u7684\uff0c\u5373\u6811\u9ad8\u4e3a$\\\\Theta(\\\\log n)$\u3002<br/>\u56e0\u6b64\u6700\u574f\u7684\u60c5\u51b5\u4e0b\uff0c\u5f53\u67e5\u8be2\u6700\u5de6\u8fb9\u7684\u8282\u70b9\u65f6\uff0c\u53ea\u9700\u8981\u4f7f\u7528$O(\\\\log n)$\u6b21\u8df3\u8f6c\u5c31\u53ef\u5b8c\u6210\u3002<br/>\u5f53\u7136\u4e0a\u9762\u5e76\u4e0d\u662f\u4e25\u683c\u7684\u8bc1\u660e\uff0c\u53ea\u662f\u4e00\u4e2a\u5f62\u8c61\u7684\u8bf4\u660e\u7f62\u4e86\u3002\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u6811\u94fe\u5256\u5206\u80fd\u4fdd\u8bc1\u5f88\u597d\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5373\u53ef\u3002<br/>\u6b63\u786e\u7684\u8bc1\u660e\u601d\u8def\u56e0\u8be5\u662f\u8fd9\u6837\u7684\uff1a<br/>\u53ef\u4ee5\u8003\u8651\u4e00\u68f5\u6811\u4e2d\u8f7b\u8fb9\u7684\u6570\u91cf\u3002\u7531\u4e8e\u4ece\u67d0\u4e00\u4e2a\u8282\u70b9\u5f00\u59cb\uff0c\u6bcf\u8d70\u4e00\u6761\u8f7b\u8fb9\uff0c\u5b50\u6811\u7684\u5927\u5c0f\u90fd\u4f1a\u51cf\u5c0f\u4e00\u500d\u3002\u56e0\u6b64\u4efb\u610f\u4e00\u6761\u6811\u94fe\u4e0a\u53ea\u6709$O(\\\\log n)$\u6761\u8f7b\u8fb9\uff0c\u5373\u610f\u5473\u7740\u53ea\u6709$O(\\\\log n)$\u3002<br/>\u6811\u94fe\u5256\u5206\u8ba1\u7b97LCA<br/>LCA\u5373\u6700\u8fd1\u516c\u5171\u7956\u5148\u3002\u8ba1\u7b97LCA\u7684\u7b97\u6cd5\u53ef\u4ee5\u8bf4\u662f\u5404\u79cd\u5404\u6837\uff0c\u6709\u66b4\u529b\u7684\u722c\u5c71\u6cd5\uff0c\u70b8\u7a7a\u95f4\u7684Tarjan\u7b97\u6cd5\uff0c\u5f00\u6302\u7684\u500d\u589e\u6cd5\uff0c\u83ab\u540d\u9ad8\u5927\u4e0a\u7684ST\u8df3\u8868\u7684\u641e\u6cd5\uff0c\u8fd8\u6709\u4e0d\u77e5\u6240\u4e91\u7684\u8f6c\u6210RMQ\u95ee\u9898......\u5728\u4e0e\u6811\u76f8\u5173\u7684\u64cd\u4f5c\u4e2d\uff0c\u7ecf\u5e38\u9700\u8981\u4e00\u4e9b\u6c42LCA\u7684\u64cd\u4f5c\u3002\u5176\u4e2d\u6700\u5e38\u7528\u7684\u5c31\u662f\u500d\u589e\u6cd5\uff0c\u5b83\u80fd\u5728$O(\\\\log n)$\u7684\u65f6\u95f4\u5185\u6c42\u51faLCA\uff0c\u5e76\u4e14\u5176\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(n \\\\log n)$\u3002<br/>\u5f53\u6211\u4eec\u6811\u5256\u540e\u7684\u64cd\u4f5c\u9700\u8981\u501f\u52a9\u5230LCA\u65f6\uff0c\u662f\u4e0d\u662f\u5c31\u8981\u5199\u4e2aLCA\u7684\u7b97\u6cd5\u5462\uff1f<br/>\u5176\u5b9e\u5e76\u4e0d\u9700\u8981\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u6811\u5256\u7684\u7ed3\u679c\u6765\u8ba1\u7b97LCA\u3002<br/>\u7136\u800c\uff0c\u6c42LCA\u7684\u8fc7\u7a0b\u548c\u4e4b\u524d\u67e5\u8be2\u4e5f\u662f\u5dee\u4e0d\u591a\u7684\uff1a\u5728\u540c\u4e00\u6761\u94fe\u4e0a\u7684\u65f6\u5019\uff0c\u6df1\u5ea6\u503c\u8f83\u5c0f\u7684\u5c31\u662fLCA\u3002\u5982\u679c\u4e0d\u5728\u540c\u4e00\u6761\u94fe\u4e0a\uff0c\u5c31\u4e0d\u65ad\u5f80\u4e0a\u8df3\u5373\u53ef\u3002\u8fd9\u6837\u53ef\u4ee5\u5728$O(\\\\log n)$\u65f6\u95f4\u5185\u6c42\u51faLCA\u3002\u5e76\u4e14\u4ec5\u4f7f\u7528\u4e86$\\\\Theta(n)$\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u4f18\u52bf\u5341\u5206\u663e\u8457\u3002<br/>\u5f53\u7136\uff0c\u5355\u7eaf\u62ff\u6811\u94fe\u5256\u5206\u6765\u6c42LCA\u4e5f\u715e\u662f\u6d6a\u8d39\u3002\u65e2\u7136\u6811\u5256\u6709\u80fd\u6c42LCA\u7684\u80fd\u529b\uff0c\u56e0\u6b64\u5728\u9762\u5bf9\u9700\u8981LCA\u7684\u65f6\u5019\u5c31\u4e0d\u5fc5\u6c42\u52a9\u4e8e\u5176\u5b83\u7684\u7b97\u6cd5\u4e86\u3002<br/>\u6811\u94fe\u5256\u5206\u4e0eDFS\u5e8f<br/>\u3010NOI2015\u3011\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668<br/>\u5f53\u6211\u4eec\u65e2\u9700\u8981\u7ef4\u62a4\u94fe\u4e0a\u4fe1\u606f\uff0c\u53c8\u9700\u8981\u7ef4\u62a4\u5b50\u6811\u4fe1\u606f\u65f6\uff0c\u5c31\u6709\u70b9\u68d8\u624b\u4e86\u3002<br/>\u7ef4\u62a4\u5b50\u6811\u4fe1\u606f\u7684\u901a\u5e38\u505a\u6cd5\u662fDFS\u5e8f\u3002\u4e3a\u4e86\u80fd\u591f\u5c06\u6811\u94fe\u5256\u5206\u4e0eDFS\u5e8f\u7ed3\u5408\u8d77\u6765\uff0c\u76ee\u6807\u5c31\u662f\u5c06\u6811\u94fe\u5256\u5206\u7684\u7f16\u53f7\u4e0eDFS\u5e8f\u7edf\u4e00\u8d77\u6765\u3002<br/>\u8003\u8651\u5230DFS\u5e8f\u5b9e\u9645\u4e0a\u4e0d\u662f\u552f\u4e00\u7684\uff0c\u56e0\u6b64\u5728\u6811\u94fe\u5256\u5206\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u5148\u5bf9\u91cd\u513f\u5b50\u8fdb\u884cDFS\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u6761\u91cd\u94fe\u4e0a\u7684DFS\u5e8f\u4e5f\u662f\u9012\u589e\u7684\u4e86\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u6309\u7167DFS\u5e8f\u7ef4\u62a4\u5b50\u6811\u7684\u65b9\u6cd5\uff0c\u540c\u65f6\u6811\u94fe\u5256\u5206\u7684\u4fe1\u606f\u4e5f\u4f1a\u88ab\u540c\u65f6\u66f4\u65b0\u3002<br/><br/><br/><br/><br/>\u5b9e\u9645\u4e0a\uff0c\u6309\u7167\u5b50\u6811\u5927\u5c0f\u6765\u5256\u5206\u4e0d\u4e00\u5b9a\u80fd\u5256\u5206\u51fa\u6700\u957f\u7684\u6811\u94fe\uff0c\u4f46\u8fd9\u5e76\u4e0d\u5f71\u54cd\u6700\u7ec8\u7684\u64cd\u4f5c\u7684\u6548\u7387\u3002\u5982\u679c\u8981\u5256\u5206\u51fa\u7684\u94fe\u771f\u6b63\u6700\u957f\uff0c\u5e94\u5f53\u9009\u62e9\u79e9\u6700\u5927\u7684\u513f\u5b50\u4f5c\u4e3a\u91cd\u513f\u5b50\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-4-20/tree-split.html"
},
"\u6b27\u62c9\u56de\u8def": {
"tags": "\u6b27\u62c9\u56de\u8def \u56fe\u8bba",
"text": "\u6b27\u62c9\u56de\u8def<br/>\u5b9a\u4e49<br/>\u6b27\u62c9\u56de\u8def\u901a\u5e38\u7528\u6765\u89e3\u51b3\u201d\u4e00\u7b14\u753b\u201d\u95ee\u9898\u3002\u5177\u4f53\u800c\u8a00\u5c31\u662f\u8be2\u95ee\u4e00\u5f20\u56fe\u4e0a\u662f\u5426\u5b58\u5728\u4e00\u6761\u56de\u8def\u4f7f\u5f97\u5b83\u7ecf\u8fc7\u6240\u6709\u7684\u8fb9\u4e00\u6b21\u3002\u5982\u679c\u6709\uff0c\u90a3\u4e48\u6c42\u51fa\u8fd9\u6761\u56de\u8def\u3002<br/>\u4f8b\u5982\uff0c\u5728\u4e0b\u9762\u8fd9\u4e2a\u56fe\u91cc\u9762\uff1a<br/><br/>\u4e00\u6761\u6b27\u62c9\u56de\u8def\u662f1 - 4 - 2 - 3 - 4 - 5 - 2 - 1\u3002<br/>\u5b58\u5728\u6027<br/>\u65e0\u5411\u56fe<br/>\u8003\u8651\u5728\u8d70\u4e00\u6761\u6b27\u62c9\u56de\u8def\u7684\u65f6\u5019\uff0c\u5982\u679c\u4e0d\u662f\u8d77\u70b9\uff0c\u6211\u4eec\u6bcf\u8fdb\u5165\u4e00\u4e2a\u70b9\uff0c\u5c31\u4e00\u5b9a\u4f1a\u8d70\u51fa\u53bb\u3002\u5982\u679c\u662f\u8d77\u70b9\uff0c\u6bcf\u51fa\u53bb\u4e00\u6b21\uff0c\u5c31\u4e00\u5b9a\u53c8\u4f1a\u56de\u6765\u4e00\u6b21\u3002\u8fd9\u8bf4\u660e\u5982\u679c\u6709\u6b27\u62c9\u56de\u8def\uff0c\u90a3\u4e48\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u5e94\u5f53\u662f\u5076\u6570\u3002<br/>\u540c\u65f6\uff0c\u4ece\u53e6\u4e00\u65b9\u9762\u6765\u8bb2\uff0c\u5982\u679c\u67d0\u4e2a\u70b9\u7684\u5ea6\u6570\u662f\u5947\u6570\uff0c\u90a3\u4e48\u5728\u67d0\u4e00\u6b21\u8fdb\u5165\u8fd9\u4e2a\u70b9\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u51fa\u4e0d\u6765\u4e86\u3002\u5982\u679c\u8d77\u70b9\u7684\u5ea6\u6570\u662f\u5947\u6570\uff0c\u90a3\u4e48\u4e4b\u540e\u5fc5\u5b9a\u6709\u4e00\u6b21\u65e0\u6cd5\u56de\u5230\u8d77\u70b9\u3002<br/>\u603b\u800c\u8a00\u4e4b\uff0c\u5bf9\u4e8e\u65e0\u5411\u56fe\uff0c\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u5fc5\u987b\u662f\u5076\u6570\u3002<br/>\u6b64\u5916\u8003\u8651\u5f53\u56fe\u4e0d\u8fde\u901a\u65f6\uff0c\u4e00\u822c\u662f\u6ca1\u6709\u6b27\u62c9\u56de\u8def\u7684\u3002\u4f46\u662f\u5982\u679c\u6709\u8fde\u901a\u5757\u4e0a\u672c\u6765\u5c31\u6ca1\u6709\u8fb9\uff0c\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a<br/><br/>\u6b64\u65f61\u8fd9\u4e2a\u70b9\u662f\u4e0d\u9700\u8981\u8003\u8651\u7684\u3002\u4f46\u662f\u5e76\u4e0d\u610f\u5473\u7740\u5927\u5c0f\u4e3a$1$\u7684\u8fde\u901a\u5757\u5c31\u4e0d\u5fc5\u8003\u8651\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u80fd\u6709\u81ea\u73af\uff0c\u5982\u540c\u4e0b\u9762\u8fd9\u6837\uff1a<br/><br/>\u4f46\u662f\u5f88\u591a\u7684\u8fd9\u6837\u7684\u8fde\u901a\u5757\u4e0d\u884c\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u5728\u5224\u5b9a\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u8fd9\u4e9b\u7ec6\u8282\uff1a<br/><br/>\u6709\u5411\u56fe<br/>\u6709\u5411\u56fe\u4e0e\u65e0\u5411\u56fe\u662f\u7c7b\u4f3c\u7684\u3002\u540c\u6837\u6309\u7167\u4e4b\u524d\u7684\u65b9\u5f0f\u8003\u8651\uff0c\u8fdb\u5165\u4e00\u70b9\u5c31\u610f\u5473\u7740\u9700\u8981\u51fa\u6765\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u6bcf\u4e2a\u70b9\u7684\u5165\u5ea6\u4e0e\u51fa\u5ea6\u76f8\u540c\u3002<br/>\u6b64\u5916\u8003\u8651\u8fde\u901a\u6027\uff0c\u4e0e\u65e0\u5411\u56fe\u7c7b\u4f3c\uff0c\u6211\u4eec\u8981\u6c42\u8fd9\u4e2a\u56fe\u53ea\u5b58\u5728\u4e00\u4e2a\u6709\u8fb9\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u3002<br/>\u6784\u9020\u7b97\u6cd5<br/>\u5982\u679c\u6ee1\u8db3\u4e86\u5b58\u5728\u6027\u7684\u8981\u6c42\uff0c\u90a3\u4e48\u8fd9\u5f20\u56fe\u5c06\u88ab\u79f0\u4e3a\u6b27\u62c9\u56fe\u3002<br/>\u6784\u9020\u4e00\u6761\u6b27\u62c9\u56de\u8def\u770b\u4e0a\u53bb\u662f\u53ef\u4ee5\u968f\u610f\u8d70\u7684\uff0c\u56e0\u4e3a\u4f60\u6bcf\u8d70\u4e00\u4e2a\u70b9\u603b\u80fd\u4fdd\u8bc1\u4f60\u6709\u5730\u65b9\u51fa\u53bb\u3002\u4f46\u662f\u8fd9\u6837\u7684\u7b97\u6cd5\u5374\u4e0d\u80fd\u4fdd\u8bc1\u4f60\u8d70\u8fc7\u4e86\u6bcf\u4e00\u6761\u8fb9\u3002\u4e3e\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50\uff1a<br/><br/>\u5728\u8fd9\u5f20\u65e0\u5411\u56fe\u4e2d\uff0c\u4e00\u6761\u6b27\u62c9\u56de\u8def\u662f1 - 2 - 4 - 5 - 2 - 3 - 1\u3002\u5982\u679c\u91c7\u7528\u968f\u4fbf\u8d70\u7684\u7b56\u7565\uff0c\u90a3\u4e48\u6709\u53ef\u80fd\u8d70\u51fa1 - 2 - 3 - 1\u8fd9\u6837\u7684\u8def\u5f84\u5c31\u7ec8\u6b62\u4e86\u3002<br/>\u8fd9\u662f\u56e0\u4e3a\u6b27\u62c9\u56de\u8def\u5b9e\u9645\u4e0a\u662f\u7531\u4e00\u4e9b\u73af\u4ee5\u70b9\u76f8\u4ea4\u6784\u6210\u7684\u3002\u89c2\u5bdf\u4e0a\u9762\u6b63\u786e\u7684\u6b27\u62c9\u56de\u8def\uff0c\u53ef\u4ee5\u53d1\u73b0\u5b83\u662f\u75311 - 2 - 3 - 1\u548c2 - 4 - 5 - 2\u6784\u6210\u7684\u3002<br/>\u56e0\u6b64\u6b63\u786e\u7684\u65b9\u6cd5\u5e94\u5f53\u662f\u5b9e\u73b0\u4e00\u4e2aDFS\u641c\u7d22\uff0c\u6bcf\u641c\u5230\u4e00\u4e2a\u73af\u5c31\u5c06\u5176\u63d2\u5165\u4e4b\u524d\u7684\u6b27\u62c9\u56de\u8def\u4e2d\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u6b27\u62c9\u56de\u8def\u7684\u6784\u9020\u3002<br/>\u5b9e\u9645\u4e0a\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u663e\u5f0f\u5730\u5b9e\u73b0\u63d2\u5165\u73af\uff0c\u800c\u662f\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u8fd9\u4e2aDFS\u6765\u5b9e\u73b0\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9tour = []  # \u6b27\u62c9\u56de\u8def<br/><br/>def construct(x):<br/>    for e in x.adj:<br/>        x.adj.remove(e)  # \u8fb9\u88ab\u8bbf\u95ee<br/>        construct(e.either(x))  # \u6cbf\u7740\u8fb9\u8d70\u4e0b\u53bb<br/>        tour.append(e)<br/><br/># \u6700\u540e\u5c06tour\u4e2d\u7684\u8fb9\u5012\u5e8f\u8f93\u51fa\u5c31\u662f\u6b27\u62c9\u56de\u8def<br/><br/><br/>\u8fd9\u91cc\u5173\u952e\u662f\u4e3a\u4ec0\u4e48\u662f\u5148\u9012\u5f52\u540e\u5c06\u8fb9\u52a0\u5165\u6b27\u62c9\u56de\u8def\uff0c\u5e76\u4e14\u9700\u8981\u5012\u5e8f\u8f93\u51fa\u3002\u5047\u8bbe\u73b0\u5728\u6b63\u5728\u8003\u8651$u$\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u73af\u4f1a\u4ece$u$\u5f00\u59cb\u5e76\u4e14\u4ee5$u$\u7ed3\u675f\uff0c\u90a3\u4e48\u5b83\u4eec\u5728\u4e4b\u540e\u7684\u9012\u5f52\u4e2d\u53c8\u4f1a\u56de\u5230$u$\uff0c\u56e0\u6b64\u6211\u4eec\u5148\u5c06\u540e\u9762\u7684\u73af\u653e\u5165\u6b27\u62c9\u56de\u8def\u662f\u6ca1\u6709\u95ee\u9898\u7684\u3002\u5982\u679c\u4ece$u$\u51fa\u53d1\u540e\u5c31\u56de\u4e0d\u6765\u4e86\uff0c\u90a3\u4e48\u8fd9\u6761\u201d\u4e0d\u5f52\u8def\u5e94\u5f53\u5728\u90a3\u4e9b\u4f1a\u56de\u5230$u$\u7684\u73af\u4e4b\u540e\u63d2\u5165\u3002\u6240\u4ee5\u8fd9\u4e2aDFS\u5c31\u4fdd\u8bc1\u4e86\u8fd9\u4e00\u70b9\u3002<br/>\u6b64\u5916\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6761\u8bbf\u95ee\u8fc7\u7684\u8fb9\uff0c\u6211\u4eec\u5e94\u5f53\u5c06\u5176\u5220\u9664 (\u6216\u8005\u4f7f\u7528\u5176\u5b83\u65b9\u6cd5\u4fdd\u8bc1\u4e4b\u540e\u4e0d\u4f1a\u518d\u6b21\u904d\u5386)\u3002\u5426\u5219\u5f53\u6211\u4eec\u8fdb\u5165\u4e00\u4e2a\u70b9\u591a\u6b21\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u8fb9\u4e5f\u4f1a\u904d\u5386\u591a\u6b21\uff0c\u590d\u6742\u5ea6\u5c31\u4f1a\u53d8\u5f97\u5f88\u9ad8\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u65e0\u5411\u56fe\u7684\u6784\u9020\u7b97\u6cd5\u5bf9\u6709\u5411\u56fe\u4e5f\u901a\u7528\u3002<br/><br/>\u5224\u5b9a\u7b97\u6cd5<br/>\u4e3a\u4ec0\u4e48\u8981\u5148\u8bf4\u6784\u9020\u7b97\u6cd5\u7136\u540e\u518d\u8bf4\u5224\u5b9a\u7b97\u6cd5\u5462\uff1f\u4ee5\u4e3a\u6784\u9020\u7b97\u6cd5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5224\u5b9a\u56fe\u7684\u8fde\u901a\u6027\uff0c\u800c\u5728\u6784\u9020\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u57fa\u7840\u7684\u5ea6\u6570\u9650\u5236\u662f\u6ee1\u8db3\u7684\u3002<br/>\u5982\u679c\u5ea6\u6570\u9650\u5236\u6ee1\u8db3\u4ee5\u540e\uff0c\u90a3\u4e48\u56fe\u4e2d\u7684\u6bcf\u4e00\u4e2a\u8fde\u901a\u5757 (\u6216\u8005\u5f3a\u8fde\u901a\u5206\u91cf) \u90fd\u53ef\u4ee5\u4f7f\u7528\u4e4b\u524d\u7684\u6784\u9020\u7b97\u6cd5\u6784\u9020\u51fa\u6b27\u62c9\u56de\u8def\u3002\u56e0\u6b64\u6211\u4eec\u53ea\u7528\u627e\u5230\u4e00\u4e2a\u6709\u8fb9\u7684\u8fde\u901a\u5757 (\u6216\u5f3a\u8fde\u901a\u5206\u91cf) \u5c31\u53ef\u5f00\u59cb\u6784\u9020\u3002\u5982\u679c\u6784\u9020\u5b8c\u4e4b\u540e\u56fe\u4e2d\u4f9d\u7136\u6709\u8fb9\u5269\u4f59\uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u5f20\u56fe\u6ca1\u6709\u6b27\u62c9\u56de\u8def\u3002<br/>\u5b8c\u6574\u7684\u5224\u5b9a\u7b97\u6cd5\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16def evaluate(G):<br/>    if G is directed:<br/>        for v in G:<br/>            if v.indegree != v.outdegree:<br/>                return False<br/>    else:<br/>        for v in G:<br/>            if v.degree %  2 > 0:<br/>                return False<br/><br/>    for v in G:<br/>        if len(v.adj) > 0:<br/>            construct(v)<br/>            break<br/><br/>    return len(tour) == len(G.E)<br/><br/><br/>\u5176\u4ed6<br/>\u6b27\u62c9\u8def\u5f84<br/>\u4e0e\u6b27\u62c9\u56de\u8def\u76f8\u4f3c\uff0c\u6b27\u62c9\u8def\u5f84\u662f\u4e00\u6761\u7ecf\u8fc7\u6240\u6709\u8fb9\u7684\u8def\u5f84\u3002\u7531\u4e8e\u6b27\u62c9\u8def\u5f84\u6bd4\u6b27\u62c9\u56de\u8def\u5c11\u4e00\u6761\u8fb9\uff0c\u6240\u4ee5\u5728\u65e0\u5411\u56fe\u4e0a\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e24\u4e2a\u70b9\u7684\u5ea6\u6570\u662f\u5947\u6570\u3002\u800c\u5728\u6709\u5411\u56fe\u4e0a\uff0c\u5219\u5fc5\u987b\u5b58\u5728\u4e00\u4e2a\u70b9\u5165\u5ea6\u6bd4\u51fa\u5ea6\u5927$1$\uff0c\u4ee5\u53ca\u53e6\u4e00\u4e2a\u70b9\u51fa\u5ea6\u6bd4\u5165\u5ea6\u5927$1$\u3002\u5bf9\u4e8e\u6709\u5411\u56fe\uff0c\u53ea\u8981\u6ee1\u8db3\u5355\u8054\u901a\u5373\u53ef\u3002<br/>\u4e2d\u56fd\u90ae\u9012\u5458\u95ee\u9898<br/><br/>\u5047\u8bbe\u73b0\u5728\u6709\u4e00\u5f20\u8054\u901a\u7684\u65e0\u5411\u56fe\uff0c\u4fdd\u8bc1\u5ea6\u6570\u4e3a\u5947\u6570\u7684\u70b9\u7684\u4e2a\u6570\u662f\u5076\u6570\uff0c\u95ee\u4f60\u6700\u77ed\u7684\u7ecf\u8fc7\u6240\u6709\u8fb9\u81f3\u5c11\u4e00\u6b21\u7684\u73af\u7684\u957f\u5ea6\u3002<br/><br/>\u4e4b\u6240\u4ee5\u79f0\u5176\u4e3a\u90ae\u9012\u5458\u95ee\u9898\uff0c\u56e0\u4e3a\u539f\u95ee\u9898\u662f\u5728\u90ae\u9012\u5458\u9001\u4fe1\u7684\u80cc\u666f\u4e0b\u63d0\u51fa\u7684\u3002<br/>\u5047\u8bbe\u56fe\u7684\u8fb9\u6570\u4e3a$m$\uff0c\u90a3\u4e48\u6b27\u62c9\u56de\u8def\u53ef\u4ee5\u7ed9\u51fa\u4e00\u4e2a$2m$\u6761\u8fb9\u7684\u65b9\u6848\u3002\u56e0\u4e3a\u6211\u4eec\u5c06\u539f\u56fe\u4e2d\u6bcf\u4e00\u6761\u8fb9\u90fd\u590d\u5236\u4e00\u904d\uff0c\u6211\u4eec\u5c06\u5f97\u5230\u4e00\u5f20$n$\u4e2a\u70b9$2m$\u6761\u8fb9\u7684\u56fe\uff0c\u5e76\u4e14\u7531\u4e8e\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u90fd\u88ab\u4e58\u4ee5$2$\uff0c\u90a3\u4e48\u8fd9\u5f20\u65b0\u56fe\u5fc5\u5b9a\u5b58\u5728\u6b27\u62c9\u8def\u5f84\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u7ed9\u51fa\u4e0a\u8ff0\u95ee\u9898\u7684\u4e00\u4e2a\u7b54\u6848\u3002",
"url": "blog/2016-12-13/eular-tour.html"
},
"\u6b63\u5f0f\u5f00\u59cb\u7f16\u5199ne2d": {
"tags": "C/C++ ne2d \u56fe\u5f62",
"text": "\u6b63\u5f0f\u5f00\u59cb\u7f16\u5199ne2d<br/><br/>\u4e00\u76f4\u60f3\u627e\u4e2a\u597d\u70b9\u76842D\u6e32\u67d3\u5f15\u64ce\uff0c\u4f46\u770b\u4e86\u5f88\u591a\u4f3c\u4e4e\u90fd\u4e0d\u5408\u80c3\u53e3\uff0c\u4e5f\u8bb8\u6709\u70b9\u6311\u5254\u3002\u4e4b\u524d\u770b\u5230\u7684bgfx\u4f3c\u4e4e\u4e5f\u6709\u70b9\u64cd\u86cb\uff0c\u6bd5\u7adf\u64cd\u4f5c\u4e0a\u8fd8\u662f\u9ebb\u70e6\u4e86\u70b9\u3002<br/>\u56e0\u6b64\uff0c\u8d81\u7740\u65f6\u95f4\u8fd8\u591a\uff0c\u591a\u9020\u70b9\u8f6e\u5b50\uff0c\u5b66\u70b9\u4e1c\u897f\u3002\u7d22\u6027\u5f00\u59cb\u81ea\u5df1\u505a\u4e2a\u9002\u5408\u76842D\u6e32\u67d3\u5f15\u64ce\u3002<br/>\u4e4b\u524d\u8fd9\u4e2a\u81ea\u5236\u7684\u6e32\u67d3\u5f15\u64cene2d\u4e00\u76f4\u5904\u4e8e\u6781\u5176\u4e0d\u7a33\u5b9a\u72b6\u6001\uff0c\u52a8\u8f84\u51e0\u5343\u884c\u4ee3\u7801\u7684\u6539\u52a8\u3002<br/>\u4eca\u5929\u603b\u7b97\u6709\u4e2a\u5927\u81f4\u6846\u67b6\u4e86\u3002\u76ee\u524d\u8ba1\u5212\u505a\u6210\u4e00\u4e2a\u5355\u7eaf\u76842D\u6e32\u67d3\u5f15\u64ce\uff0c\u4e0d\u6253\u7b97\u7ba1\u5e73\u53f0\u76f8\u5173\u7684\u4ee3\u7801\u3002<br/>\u53ea\u8981\u80fd\u591f\u63d0\u4f9bOpenGL\u4e0a\u4e0b\u6587\u5c31\u80fd\u4f7f\u5176\u5de5\u4f5c\u3002<br/>\u76ee\u524d\u8fd9\u4e2a\u5de5\u7a0b\u624d\u521a\u521a\u8d77\u6b65\uff0c\u6682\u65f6\u8fd8\u6ca1\u6cd5\u4f7f\u7528\u3002<br/>\u8fd9\u91cc\u8bb0\u5f55\u4e0b\u76ee\u524d\u7684\u60f3\u6cd5\u548c\u8fdb\u5ea6\uff1a<br/>\u57fa\u672c\u529f\u80fd\uff1a  <br/><br/> OpenGL 3.3 core profile  <br/> Alpha\u652f\u6301<br/> Layer\u62bd\u8c61\uff0c\u652f\u6301\u56fe\u5c42\u6df1\u5ea6<br/> RenderObject\uff0c\u6240\u6709\u6e32\u67d3\u5bf9\u8c61\u5b9e\u4f8b\u5316<br/> Sprite\u7ed8\u5236\u6750\u8d28<br/> \u77e9\u9635\u53d8\u6362\uff08\u4f7f\u7528glm\uff09<br/> TrueType\u5b57\u4f53\uff08SDL_ttf or raw Freetype?\uff09<br/><br/>\u8ba1\u5212\u4e2d\u7684\u529f\u80fd\uff1a  <br/><br/> \u52a8\u753b<br/> *.layout\u6587\u4ef6\u8f7d\u5165\u56fe\u5c42\uff08JSON or XML?\uff09<br/> \u81ea\u5b9aShader<br/> \u7c92\u5b50\u7cfb\u7edf<br/><br/>\u81f3\u4e8e\u4e0d\u5904\u7406\u5e73\u53f0\u76f8\u5173\u7684\u4ee3\u7801\uff0c\u56e0\u4e3a\u6211\u89c9\u5f97SDL\u505a\u5f97\u6bd4\u6211\u597d\uff0c\u6211\u4e2a\u4eba\u4e5f\u662f\u5f88\u559c\u6b22SDL\u7684\u63a5\u53e3\u98ce\u683c\u7684\uff08\u53ea\u662fSDL\u5728\u6e32\u67d3\u65b9\u9762\u4f3c\u4e4e\u5e76\u4e0d\u600e\u4e48\u6837\u2026\uff09\u3002<br/>\u6240\u4ee5\u6240\u6709\u7684\u7a97\u53e3\u521b\u5efa\u3001OpenGL\u4e0a\u4e0b\u6587\u521b\u5efa\u3001\u4e8b\u4ef6\u7ba1\u7406......\u8fd9\u4e9b\u4e1c\u897f\u90fd\u4ea4\u7ed9SDL\u5427\uff01\u5f53\u7136\u4f60\u559c\u6b22glfw\u4e5f\u662f\u53ef\u4ee5\u7684\u3002<br/>\u6700\u540e\u628aGitHub repo\u653e\u4e00\u4e0b\u5427\uff1a<br/><br/>ne2d: \u7406\u8bba\u4e0a\u662f\u7a33\u5b9a\u7248  <br/>ne2d/develop: \u7406\u8bba\u4e0a\u662f\u6700\u65b0\u7248  <br/>ne2d/unstable: \u6fc0\u8fdb\u7248<br/><br/>\u53e6\u5916\uff0c\u6b22\u8fce\u6709\u5174\u8da3\u7684\u540c\u5fd7\u4e00\u8d77\u5f00\u53d1\uff01",
"url": "blog/2016-2-4/ne2d-1.html"
},
"\u6d4b\u8bd5": {
"tags": "test",
"text": "pagegen.py\u7684\u8bd5\u70bc<br/>\u5e0c\u671bpagegen.py\u80fd\u6b63\u786e\u5de5\u4f5c\u3002  <br/>\u5e38\u89c4Markdown\u6d4b\u8bd5<br/>h1<br/>h2<br/>h3<br/>h4<br/>h5<br/>h6<br/>\u4e0a\u9762\u662f\u516d\u7ea7\u6807\u9898\u3002  <br/><br/>\u4e0a\u9762\u662f\u516d\u7ea7\u6807\u9898\u3002<br/>\u8fd9\u662f\u4e00\u6bb5\u5f15\u7528  <br/><br/>\u5f88\u597d\uff0cinline-code\u548cHello, world\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9#include <iostream><br/><br/>using namespace std;<br/><br/>int main(int argc, char *argv[]) {<br/>    cout << \\ Hello, world!\\  << endl;<br/><br/>    return 0;<br/>}<br/><br/><br/>\u522b\u5fd8\u4e86Python\uff1a<br/>1<br/>2<br/>3<br/>4#!/usr/bin/env python3<br/><br/>if __name__ == \\ __main__\\ :<br/>    print(\\ Hello, world!\\ )<br/><br/><br/>1<br/>2Tab\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ee3\u7801<br/>Yeah!!!<br/><br/><br/>\u91cd\u8981\u7684\u8bdd\u8bf4\u4e09\u904d<br/>\u91cd\u8981\u7684\u8bdd\u8bf4\u4e09\u904d<br/>\u91cd\u8981\u7684\u8bdd\u8bf4\u4e09\u904d<br/>\u4e0b\u5212\u7ebf\u662f\u4ec0\u4e48\u9b3c<br/>\u6253\u8868A\u9898\uff1a<br/><br/><br/><br/>NOI<br/>A<br/>B<br/>A + B<br/><br/><br/><br/><br/>1<br/>1<br/>2<br/>3<br/><br/><br/>2<br/>2<br/>2<br/>4<br/><br/><br/>3<br/>5<br/>5<br/>10<br/><br/><br/>4<br/>3<br/>4<br/>7<br/><br/><br/><br/><br/><br/><br/>\u52171<br/>\u52172<br/>\u52173<br/><br/><br/><br/><br/>233333333333333<br/>23333333<br/>233<br/><br/><br/><br/>\u6211\u7684GitHub: https://github.com/riteme<br/>GitHub<br/>\u6211\u7684E-mail: riteme@qq.com<br/>\u811a\u6ce81\uff1f  <br/>GFM breaks!<br/>\u5e94\u8be5\u4e0d\u5728\u4e00\u884c!<br/>\u5e94\u8be5\u4e0d\u5728\u4e00\u884c!!<br/>\u5e94\u8be5\u4e0d\u5728\u4e00\u884c!!!!!<br/>deleted<br/>inserted<br/>\u2013smartpants\u2014<br/>\u201ca\u201c\u2018b\u2018\u201cc\u201c\u2018d\u2018\u201ce\u201d\u201c\u2019<br/>Mathjax\u6d4b\u8bd5: $e^{ix} = \\\\cos x + i\\\\sin x$<br/>\u8fd9\u4e2a\u5e94\u8be5\u4e0d\u5f97\u51fa\u95ee\u9898......<br/>$$ \\\\sum_{i = 1}^{\\\\infty} i = - {1 \\\\over 12} \\\\tag{1.1} $$<br/>$$ a^2 + b^2 = c^2 \\\\Rightarrow \\\\triangle ABC\\\\text{\u662f\u76f4\u89d2\u4e09\u89d2\u5f62} \\\\tag{1.2} $$<br/>$$<br/>\\\\begin{aligned}<br/>X_k & = \\\\sum^{n - 1}_{j = 0} x_ke^{-2\\\\pi ijk/n} \\\\\\\\<br/>    & = \\\\sum^{n - 1}_{j = 0} x_kw_n^{-jk}<br/>\\\\end{aligned}<br/>$$<br/>$$<br/>\\\\begin{aligned}<br/>x_k & = \\\\frac1n\\\\sum^{n - 1}_{j = 0} X_ke^{2\\\\pi ijk/n} \\\\\\\\<br/>    & = \\\\frac1n\\\\sum^{n - 1}_{j = 0} X_kw_n^{jk}<br/>\\\\end{aligned}<br/>$$<br/>$$ $$$$ $ $<br/>\u884c\u5185\u516c\u5f0finline-math\u5728\u6b64$ 233 \\\\neq 244 $233333<br/>\u7279\u6b8a\u8bed\u6cd5\u6d4b\u8bd5<br/>FBI Warning<br/>\u80af\u5b9a\u6709BUG<br/><br/>Markdown in it<br/>STRONG, inline-code.<br/><br/>\u4e2d\u6587<br/>Not Supported\u2026<br/>\u4e71\u641e<br/>233444<br/><br/>233<br/><br/>Goodbye!<br/><br/><br/><br/><br/>\u771f\u7684\u884c\u5417......\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-1-31/test.html"
},
"\u6d4b\u8bd5\u591a\u8bf4": {
"tags": "test",
"text": "\u6d4b\u8bd5\u591a\u8bf4<br/>\u6b22\u8fce\u5927\u5bb6\u5728\u4e0b\u9762\u6309\u7167\u57fa\u672c\u6cd5\u653e\u8086\u8bc4\u8bba\uff0c\u6211\u770b\u770b\u6211pagegen.py\u5199\u5bf9\u6ca1\u6709\u3002<br/>\u6253\u4e2a\u5e7f\u544a\u5427\uff1a \u591a\u8bf4",
"url": "blog/2016-2-4/comments.html"
},
"\u76d1\u542c\u8ba1\u5212": {
"tags": "Problems",
"text": "\u76d1\u542c\u8ba1\u5212 (HNSDFZ #7)<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u9ed1\u732b\u8b66\u957fLunk\u6700\u8fd1\u53d1\u73b0\u4e86$n$\u4e2aMHA\u96c6\u56e2\uff0c\u4ece$1$\u5230$n$\u7f16\u53f7\u3002\u9274\u4e8eMHA\u96c6\u56e2\u6570\u91cf\u5e9e\u5927\uff0cLunk\u9700\u8981\u5148\u5bf9\u4ed6\u4eec\u8fdb\u884c\u5168\u9762\u4e86\u89e3\u540e\u624d\u53ef\u4ee5\u52a8\u624b\u3002<br/>Lunk\u51b3\u5b9a\u6d3e\u9063\u95f4\u8c0d\u6e17\u5165MHA\u96c6\u56e2\u7684\u901a\u4fe1\u7f51\u7edc\u4e2d\u6765\u76d1\u542c\u4ed6\u4eec\u3002MHA\u96c6\u56e2\u7684\u901a\u4fe1\u7f51\u7edc\u662f\u4f9d\u9760\u4e24\u4e24\u96c6\u56e2\u4e4b\u95f4\u7684\u901a\u4fe1\u7ebf\u8def\u6784\u6210\u7684\u3002\u6d88\u606f\u53ef\u4ee5\u901a\u8fc7\u591a\u6761\u901a\u4fe1\u7ebf\u8def\u5230\u8fbe\u5176\u4ed6\u96c6\u56e2\u3002Lunk\u7684\u95f4\u8c0d\u5341\u5206\u5f3a\u5927\uff0c\u4ed6\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u901a\u4fe1\u7ebf\u8def\u6765\u76d1\u542c\u6bcf\u4e00\u4e2a\u80fd\u5230\u8fbe\u7684\u96c6\u56e2\u3002<br/>\u7136\u800cLunk\u662f\u8d44\u672c\u5bb6\uff0c\u4ed6\u4e0d\u5e0c\u671b\u82b1\u8d39\u592a\u591a\u8d44\u672c\u7528\u4e8e\u96c7\u4f63\u95f4\u8c0d\u3002\u4ed6\u53ea\u60f3\u7528\u6700\u5c11\u7684\u95f4\u8c0d\u6765\u76d1\u542c\u6240\u6709\u7684MHA\u96c6\u56e2\u3002\u5f88\u4e0d\u5e78\u7684\u662f\uff0c\u8fd9\u4e9b\u96c6\u56e2\u95f4\u7684\u901a\u4fe1\u7ebf\u8def\u8d28\u91cf\u4e0d\u597d\uff0c\u6709\u4e00\u5b9a\u7684\u5bff\u547d\uff0cMHA\u96c6\u56e2\u6bcf\u5929\u90fd\u4f1a\u6dfb\u52a0\u4e00\u4e9b\u65b0\u7684\u901a\u4fe1\u7ebf\u8def\u6765\u786e\u4fdd\u901a\u4fe1\u7545\u901a\u3002\u56e0\u6b64Lunk\u5e0c\u671b\u77e5\u9053\u6bcf\u5929\u901a\u4fe1\u7f51\u7edc\u7a33\u5b9a\u540e\uff0c\u6700\u5c11\u9700\u8981\u591a\u5c11\u4e2a\u95f4\u8c0d\u624d\u53ef\u4ee5\u76d1\u542c\u6240\u6709\u7684\u96c6\u56e2\u3002<br/>\u5b9e\u73b0<br/>\u672c\u9898\u91c7\u7528\u4ea4\u4e92\u5f0f\u6d4b\u8bc4\u3002\u8bf7\u5728\u4e0b\u8f7d\u4e00\u680f\u4e2d\u83b7\u53d6\u6837\u4f8b\u4ea4\u4e92\u5e93\u3002<br/>\u6837\u4f8b\u4ea4\u4e92\u5e93\u5305\u542bnetwork.h\u548cimplementer.cpp\u4e24\u4e2a\u6587\u4ef6\u3002\u9009\u624b\u6e90\u7a0b\u5e8f\u9700\u8981\u5305\u542bnetwork.h\u8fd9\u4e2a\u5934\u6587\u4ef6\u3002<br/>\u4f60\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u56db\u4e2a\u51fd\u6570\uff1a<br/><br/>$\\\\text{initialize}(n, \\\\;q)$\uff1a\u5728\u4ea4\u4e92\u5e93\u521d\u59cb\u5316\u65f6\u4f1a\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u7528\u4e8e\u521d\u59cb\u5316\u4f60\u7684\u7a0b\u5e8f\u3002<br/>$n$\u8868\u793aMHA\u96c6\u56e2\u7684\u6570\u91cf\u3002<br/>$q$\u8868\u793a\u5929\u6570\uff0c\u610f\u601d\u662fLunk\u5c06\u53ea\u5173\u6ce8\u7b2c$1$\u5230\u7b2c$q$\u5929\u7684\u60c5\u51b5\u3002<br/><br/><br/>$\\\\text{add-connection}(u, \\\\;v, \\\\;t)$\uff1a\u5355\u4e2a\u6570\u636e\u70b9\u4e2d\u5c06\u4f1a\u88ab\u8c03\u7528$q$\u6b21\uff0c\u8868\u793a\u6bcf\u5929MHA\u96c6\u56e2\u52a0\u5165\u7684\u65b0\u7684\u901a\u4fe1\u7ebf\u8def\u3002<br/>$u$\u3001$v$\u8868\u793a\u5728\u7f16\u53f7\u4e3a$u$\u548c$v$\u7684\u4e24\u4e2aMHA\u96c6\u56e2\u95f4\u67b6\u8bbe\u901a\u4fe1\u7ebf\u8def\u3002<br/>$t$\u8868\u793a\u901a\u4fe1\u7ebf\u8def\u7684\u5bff\u547d\u3002\u5982\u679c\u8be5\u7ebf\u8def\u662f\u7b2c$i$\u5929\u52a0\u5165\u7684\uff0c\u90a3\u4e48\u8fd9\u6761\u7ebf\u8def\u53ea\u4f1a\u5728$[i, \\\\;i + t)$\u8fd9\u6bb5\u65f6\u95f4\u5185\u6709\u6548\u3002<br/><br/><br/>$\\\\text{query}()$\uff1a\u6bcf\u6b21\u8c03\u7528\u5b8c$\\\\text{add-connection}$\u4e4b\u540e\u4f1a\u88ab\u8c03\u7528\uff0c\u7528\u4e8e\u56de\u7b54Lunk\u7684\u8be2\u95ee\u3002<br/>$\\\\text{finalize}()$\uff1a\u4ea4\u4e92\u5e93\u7ed3\u675f\u65f6\u5c06\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u7528\u4e8e\u91ca\u653e\u4f60\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u8d44\u6e90\u3002<br/><br/>network.h\u4e2d\u4e5f\u6709\u5bf9\u8fd9\u56db\u4e2a\u51fd\u6570\u7684\u6ce8\u91ca\u6587\u6863\u3002<br/>implementer.cpp\u662f\u6837\u4f8b\u4ea4\u4e92\u5e93\u3002\u5047\u8bbe\u4f60\u7f16\u5199\u7684\u6e90\u6587\u4ef6\u4e3anetwork.cpp\uff0c\u90a3\u4e48\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1\uff1a<br/>1g++ implementer.cpp network.cpp -o exec<br/><br/><br/>exec\u662f\u53ef\u6267\u884c\u6587\u4ef6\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570$n$\u3001$q$\uff0c\u8868\u793a\u96c6\u56e2\u7684\u4e2a\u6570\u548c\u603b\u5171\u7684\u5929\u6570\u3002<br/>\u63a5\u4e0b\u6765$q$\u884c\u6bcf\u884c\u8f93\u5165\u4e09\u4e2a\u6b63\u6574\u6570$u$\u3001$v$\u548c$t$\uff0c\u8868\u793a\u6bcf\u5929\u901a\u4fe1\u7f51\u7edc\u4e2d\u96c6\u56e2$u$\u548c\u96c6\u56e2$v$\u4e4b\u95f4\u6dfb\u52a0\u4e86\u4e00\u6761\u5bff\u547d\u4e3a$t$\u7684\u901a\u4fe1\u7f51\u7edc\u3002<br/>\u6700\u5f00\u59cbMHA\u96c6\u56e2\u4e4b\u95f4\u6ca1\u6709\u901a\u4fe1\u7ebf\u8def\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u8f93\u51fa$q$\u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u8868\u793a\u6bcf\u5929\u901a\u4fe1\u7f51\u7edc\u53d8\u52a8\u5b8c\u6bd5\u540e\u6700\u5c11\u9700\u8981\u6d3e\u9063\u7684\u95f4\u8c0d\u7684\u4eba\u6570\u3002<br/>\u6837\u4f8b\u8f93\u5165<br/>1<br/>2<br/>3<br/>4<br/>54 4<br/>1 2 3<br/>2 3 2<br/>3 4 1<br/>4 4 10086<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa<br/>1<br/>2<br/>3<br/>43<br/>2<br/>1<br/>4<br/><br/><br/>\u9650\u5236<br/>\u672c\u9898\u5171$10$\u4e2a\u6d4b\u8bd5\u70b9\uff0c\u5176\u9650\u5236\u5982\u4e0b\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>$n$<br/>$q$<br/><br/><br/><br/><br/>1<br/>$10$<br/>$40$<br/><br/><br/>2<br/>$2 \\\\times 10^3$<br/>$7 \\\\times 10^3$<br/><br/><br/>3<br/>$3 \\\\times 10^3$<br/>$7 \\\\times 10^3$<br/><br/><br/>4<br/>$5 \\\\times 10^3$<br/>$2 \\\\times 10^4$<br/><br/><br/>5<br/>$5 \\\\times 10^3$<br/>$10^5$<br/><br/><br/>6<br/>$5 \\\\times 10^3$<br/>$2 \\\\times 10^5$<br/><br/><br/>7<br/>$5 \\\\times 10^3$<br/>$2 \\\\times 10^5$<br/><br/><br/>8<br/>$10^5$<br/>$10^5$<br/><br/><br/>9<br/>$10^5$<br/>$2 \\\\times 10^5$<br/><br/><br/>10<br/>$10^5$<br/>$2 \\\\times 10^5$<br/><br/><br/><br/>\u5bf9\u4e8e\u6240\u6709\u6570\u636e\uff0c\u6ee1\u8db3$1 \\\\leqslant t \\\\leqslant 2 \\\\times 10^5$\u3002<br/>\u65f6\u95f4\u9650\u5236\uff1a$1\\\\mathrm{s}$<br/>\u7a7a\u95f4\u9650\u5236\uff1a$512\\\\mathrm{MB}$<br/>\u6ce8\u610f\uff1a\u4ea4\u4e92\u5e93\u672c\u8eab\u7684\u8fd0\u884c\u6240\u7528\u65f6\u95f4\u4e0d\u4f1a\u8d85\u8fc7$0.1\\\\mathrm{s}$\uff0c\u6240\u7528\u5185\u5b58\u4e0d\u4f1a\u591a\u4e8e$32\\\\mathrm{MB}$\u3002",
"url": "blog/2017-1-3/network.html"
},
"\u780d\u6728\u68cd\u95ee\u9898": {
"tags": "\u6982\u7387\u8bba",
"text": "\u780d\u6728\u68cd\u95ee\u9898<br/>\u95ee\u9898\u63cf\u8ff0<br/>\u521d\u59cb\u65f6\u6709\u4e00\u6839\u957f\u4e3a $a$ \u7684\u6728\u68cd\uff0c\u6bcf\u6b21\u4f1a\u968f\u673a\u780d\u6389\u6728\u68cd\u7684\u4e00\u6bb5\uff0c\u95ee\u671f\u671b\u591a\u5c11\u6b21\u540e\u6728\u68cd\u7684\u957f\u5ea6\u5c0f\u4e8e $b$ \uff1f<br/>\u8fd8\u6709\u4e00\u79cd\u79bb\u6563\u7684\u7248\u672c\uff1a\u521d\u59cb\u65f6\u6709\u4e00\u4e2a\u6570\u5b57 $n$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u968f\u673a\u51cf\u53bb\u4e00\u4e2a $[0, n]$ \u5185\u7684\u6574\u6570\uff0c\u95ee\u671f\u671b\u591a\u5c11\u6b21\u540e\u53d8\u4e3a $0$ \uff1f<br/>\u79bb\u6563\u7248\u672c<br/>\u9996\u5148\u8003\u8651\u4e00\u4e0b\u6211\u4eec\u53ef\u4ee5\u624b\u7b97\u7684\u95ee\u9898\uff0c\u8bb0 $F(n)$ \u8868\u793a\u521d\u59cb\u65f6\u4e3a $n$ \u7684\u671f\u671b\u6b21\u6570\uff0c\u4e0d\u96be\u5f97\u5230\u4e0b\u9762\u7684\u9012\u63a8\u5f0f\uff1a<br/>$$<br/>\\\\begin{cases}<br/>F(0) = 0 \\\\\\\\<br/>F(n) = {n + 1 \\\\over n} + \\\\frac1n\\\\sum_{k = 0}^{n - 1} F(k) & (n > 0)<br/>\\\\end{cases}<br/>$$<br/>\u4e0a\u9762\u7684 $(n + 1) / n$ \u662f\u505c\u7559\u5728 $n$ \u7684\u671f\u671b\u6b21\u6570\uff0c\u4e5f\u5c31\u662f $\\\\sum_{k = 0}^\\\\infty (1/(n + 1))^k$\uff0c\u56e0\u4e3a\u6bcf\u6b21\u90fd\u6709 $1/(n + 1)$ \u7684\u6982\u7387\u4e0d\u51cf\u5c0f\u3002\u901a\u8fc7\u5dee\u5206\u4e0d\u96be\u89e3\u5f97\uff1a<br/>$$<br/>F(n) = 1 + H_n = 1 + \\\\ln n + \\\\mathrm{O}(1)<br/>$$<br/>\u5176\u4e2d $H_n$ \u8868\u793a\u8c03\u548c\u7ea7\u6570\u3002<br/>\u539f\u59cb\u95ee\u9898<br/>\u4ece\u79bb\u6563\u7248\u672c\u4e2d\u6211\u4eec\u53ef\u4ee5\u4f30\u8ba1\u51fa\u7b54\u6848\u5e94\u8be5\u662f\u5bf9\u6570\u7ea7\u522b\u7684\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u9996\u5148\u5c06\u6a21\u578b\u8f6c\u5316\u4e00\u4e0b\uff1a\u6bcf\u6b21\u780d\u6389\u968f\u673a\u7684\u957f\u5ea6\uff0c\u53ef\u4ee5\u89c6\u4e3a\u968f\u673a\u4e00\u4e2a $X \\\\in (0, 1)$\uff0c\u5c06\u539f\u957f\u5ea6 $a$ \u53d8\u4e3a $Xa$\uff0c\u95ee\u671f\u671b\u591a\u5c11\u6b21\u540e\u5c0f\u4e8e $b$\u3002\u5047\u8bbe\u662f $k$ \u6b21\u540e\u6ee1\u8db3\u8981\u6c42\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230 $k$ \u4e2a\u72ec\u7acb\u968f\u673a\u53d8\u91cf $X_1, X_2, ..., X_k$ \u4e0e $a$ \u548c $b$ \u7684\u5173\u7cfb\uff1a<br/>$$<br/>a \\\\prod_{j = 1}^k X_j < b<br/>$$<br/>\u4e5f\u5c31\u662f\uff1a<br/>$$<br/>\\\\prod_{j = 1}^k X_j < \\\\frac{b}a<br/>$$<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee4 $n = a / b$\uff0c\u90a3\u4e48\u4e0a\u5f0f\u53f3\u8fb9\u53d8\u4e3a $< 1/n$\u3002\u73b0\u5728\u6765\u8003\u8651\u5de6\u8fb9\u90a3\u4e2a\u4e58\u79ef\uff0c\u5904\u7406\u4e58\u79ef\u7684\u4e00\u4e2a\u597d\u65b9\u6cd5\u5c31\u662f\u53d6\u5bf9\u6570\uff0c\u5373\uff1a<br/>$$<br/>\\\\ln \\\\prod_{j=1}^k X_j = \\\\sum_{j=1}^k \\\\ln Xj < -\\\\ln n<br/>$$<br/>\u4e0d\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u7b97\u671f\u671b\uff1a<br/>$$<br/>\\\\mathbf{E}\\\\left[\\\\sum_{j=1}^k \\\\ln X_j\\\\right] = \\\\sum_{j = 1}^k \\\\mathbf{E}[\\\\ln X_j] < - \\\\ln n<br/>$$<br/>\u800c $E[X_j] = \\\\lim_{y \\\\rightarrow 0}\\\\int_y^1 \\\\ln x \\\\ \\\\mathrm{d}x = \\\\int_{-\\\\infty}^0 e^x \\\\ \\\\mathrm{d}x = -1$\uff0c\u6240\u4ee5\u53ef\u77e5\u671f\u671b $\\\\ln n$ \u6b21\u540e\u6ee1\u8db3\u4e0d\u7b49\u5f0f\u3002\u56e0\u6b64\u539f\u95ee\u9898\u7684\u7b54\u6848\u5c31\u662f $\\\\ln a/b$\u3002<br/>\u76f8\u5173\u7684\u6982\u7387\u95ee\u9898<br/>\u73b0\u5728\u6765\u8003\u8651\u4e00\u4e2a\u6269\u5c55\u7684\u95ee\u9898\uff1a$n$ \u4e2a\u72ec\u7acb\u968f\u673a\u53d8\u91cf $X_1, X_2, ..., X_n \\\\in [0, 1]$ \u7684\u4e58\u79ef $X = \\\\prod_{k = 1}^n X_k$ \u5c0f\u4e8e\u4e00\u4e2a\u5e38\u6570 $a \\\\in (0, 1]$ \u7684\u6982\u7387\uff1f<br/>\u9996\u5148\u8003\u8651\u4e00\u4e9b\u7279\u6b8a\u7684\u60c5\u51b5\uff1a<br/><br/>$n = 1$ \u65f6\uff0c\u663e\u7136\u6982\u7387\u5c31\u662f $a$\u3002<br/>$n = 2$ \u65f6\uff0c\u8bbe\u8fd9\u4e24\u4e2a\u968f\u673a\u53d8\u91cf\u5206\u522b\u4e3a $x$ \u548c $y$\uff0c\u90a3\u4e48\u53ef\u4ee5\u770b\u505a\u5728\u4ee5\u539f\u70b9\u4e3a\u5de6\u4e0b\u89d2\uff0c\u5750\u6807 $(1, 1)$ \u4e3a\u53f3\u4e0a\u89d2\u7684\u6b63\u65b9\u5f62\u4e2d\u968f\u673a\u6295\u70b9\uff0c\u95ee\u8fd9\u4e2a\u70b9\u5904\u4e8e $xy = a$ \u7684\u56fe\u50cf\uff08\u5373\u53cd\u6bd4\u4f8b\u51fd\u6570\uff09\u7684\u5de6\u4e0b\u65b9\u7684\u6982\u7387\u3002\u7531\u4e8e\u8fd9\u4e2a\u6b63\u65b9\u5f62\u7684\u9762\u79ef\u4e3a $1$\uff0c\u6240\u4ee5\u6982\u7387\u5c31\u662f\u56f4\u51fa\u7684\u9762\u79ef\uff0c\u5173\u4e8e $x$ \u79ef\u5206\uff0c\u5373 $a + \\\\int_a^1 a / x \\\\ \\\\mathrm{d}x = a - a\\\\ln a$\u3002<br/><br/>\u5f53 $n \\\\geqslant 3$ \u65f6\u6ca1\u6709\u90a3\u4e48\u597d\u60f3\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u9012\u63a8\uff1a\u8bbe $P(n, a)$ \u8868\u793a\u8fd9\u4e2a\u6982\u7387\uff08\u53ef\u4ee5\u662f\u5173\u4e8e $a$ \u7684\u51fd\u6570\uff09\uff0c\u4eff\u7167 $n = 2$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f\u51fd\u6570 $X = a$ \u5728\u8d85\u7acb\u65b9\u4f53\u5185\u56f4\u51fa\u7684\u8d85\u4f53\u79ef\u3002\u8bbe\u8fd9 $n$ \u4e2a\u53d8\u91cf\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u4e3a $z$\uff0c\u8003\u8651\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\uff1a<br/><br/>\u82e5 $z < a$\uff0c\u90a3\u4e48 $X$ \u4e00\u5b9a\u5c0f\u4e8e $a$\uff0c\u8fd9\u79cd\u60c5\u51b5\u53d1\u751f\u7684\u6982\u7387\u4e3a $a$\u3002<br/>\u82e5 $z \\\\geqslant a$\uff0c\u90a3\u4e48 $X < a \\\\Leftrightarrow X/z < a/z$\uff0c\u6ce8\u610f\u8fd9\u91cc $a \\\\leqslant a/z \\\\leqslant 1$\uff0c\u5e76\u4e14 $X/z$ \u662f $n - 1$ \u4e2a\u72ec\u7acb\u968f\u673a\u53d8\u91cf\u7684\u4e58\u79ef\u3002\u4f9d\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u95ee\u9898\u89c4\u6a21\u7f29\u51cf\u3002\u901a\u8fc7\u5173\u4e8e $z$ \u6c42\u79ef\u5206\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u8fd9\u79cd\u60c5\u51b5\u7684\u6982\u7387\u4e3a $\\\\int_a^1 P(n - 1, a/z) \\\\ \\\\mathrm{d}z$\u3002<br/><br/>\u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u53ef\u4ee5\u5f52\u7eb3\u51fa $P(n, a)$ \u7684\u9012\u63a8\u5f0f\uff08\u5047\u8bbe $0$ \u4e2a\u5143\u7d20\u7684\u4e58\u79ef\u4e3a $1$\uff09\uff1a<br/>$$<br/>\\\\begin{cases}<br/>P(0, a) = 0 \\\\\\\\<br/>P(n, a) = a + \\\\int_a^1 P(n - 1, a / z) \\\\ \\\\mathrm{d} z & (n > 0)<br/>\\\\end{cases}<br/>$$<br/>\u770b\u4e0a\u53bb\u5e76\u4e0d\u597d\u76f4\u63a5\u5f97\u51fa $P(n, a)$ \u7684\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u6211\u5c1d\u8bd5\u7528 Mathematica \u7b97\u4e86\u4e00\u4e0b $n \\\\leqslant 6$ \u7684\u60c5\u51b51\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9In[1]:= P[0, a_] := 0<br/>        P[n_, a_] := a + Integrate[P[n - 1, a/Subscript[z, n]], {Subscript[z, n], a, 1}, Assumptions -> 0 < a < 1]<br/>        Table[Expand[P[i, a]], {i, 6}]<br/>Out[1]:= {a,<br/>          a - a Log[a],<br/>          a - a Log[a] + 1/2 a Log[a]^2,<br/>          a - a Log[a] + 1/2 a Log[a]^2 - 1/6 a Log[a]^3,<br/>          a - a Log[a] + 1/2 a Log[a]^2 - 1/6 a Log[a]^3 + 1/24 a Log[a]^4,<br/>          a - a Log[a] + 1/2 a Log[a]^2 - 1/6 a Log[a]^3 + 1/24 a Log[a]^4 - 1/120 a Log[a]^5}<br/><br/><br/>Wow! $P(n, a)$ \u770b\u4e0a\u53bb\u53ef\u4ee5\u8868\u793a\u6210 $a \\\\cdot Q(\\\\ln a)$ \u7684\u5f62\u5f0f\uff0c\u5e76\u4e14 $Q(x)$ \u662f\u4e2a\u591a\u9879\u5f0f\u3002\u8fdb\u4e00\u6b65\u7684\uff0c\u6211\u4eec\u628a\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u5199\u51fa\u6765\uff1a<br/>$$<br/>+1, -1, +\\\\frac12, -\\\\frac16,+\\\\frac1{24},-\\\\frac1{120},...<br/>$$<br/>\u5982\u679c\u5bf9\u9636\u4e58\u6bd4\u8f83\u719f\u6089\uff0c\u4e0d\u96be\u53d1\u73b0 $Q(x)$ \u4e2d $x^k$ \u7684\u7cfb\u6570\u5c31\u662f $(-1)^k / k!$\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u731c\u60f3\uff1a<br/>$$<br/>P(n, a) = a\\\\sum_{k = 0}^{n - 1} \\\\frac{(-1)^k}{k!} \\\\ln^k a \\\\:\\\\:\\\\:\\\\: (n > 0) \\\\tag{1}<br/>$$<br/>\u4e3a\u4e86\u786e\u8ba4\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u6570\u5b66\u5f52\u7eb3\u6cd5\u5e94\u8be5\u662f\u4e2a\u6bd4\u8f83\u597d\u7684\u9009\u62e9\uff1a\u4e0a\u9762\u5df2\u7ecf\u9a8c\u8bc1\u4e86 $1 \\\\leqslant n \\\\leqslant 6$ \u7684\u60c5\u51b5\u3002\u73b0\u5728\u5047\u8bbe\u5bf9\u4e8e\u4efb\u610f\u7684 $1 \\\\leqslant k \\\\leqslant n - 1$\uff0c$P(k, a)$ \u5747\u6ee1\u8db3 $(1)$ \u5f0f\uff0c\u73b0\u5728\u8bc1\u660e $P(n, a)$ \u4e5f\u6ee1\u8db3 $(1)$ \u5f0f\u3002\u9996\u5148\u5229\u7528 $P(n, a)$ \u7684\u9012\u63a8\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>P(n, a) & = a + \\\\int_a^1 P(n - 1, a / x) \\\\ \\\\mathrm{d}x \\\\\\\\<br/>& = a + \\\\int_a^1 \\\\frac{a}x\\\\sum_{k = 0}^{n - 2} {(-1)^k \\\\over k!} \\\\ln^k \\\\frac{a}x \\\\ \\\\mathrm{d} x \\\\\\\\<br/>& = {a + \\\\sum_{k = 0}^{n - 2} {(-1)^k \\\\over k!} \\\\int_a^1 \\\\frac{a}x\\\\ln^k \\\\frac{a}x \\\\ \\\\mathrm{d}x \\\\:\\\\:\\\\:\\\\:\\\\:\\\\:\\\\:\\\\: (2)}<br/>\\\\end{aligned}<br/>$$<br/>\u5355\u72ec\u8003\u8651\u79ef\u5206\uff1a<br/>$$<br/>\\\\int \\\\frac{a}x \\\\ln^k \\\\frac{a}x \\\\ \\\\mathrm{d} x<br/>$$<br/>\u8fdb\u884c\u6362\u5143\uff1a\u4ee4 $u = \\\\ln(a/x)$\uff0c\u90a3\u4e48\u53ef\u77e5 $\\\\mathrm{d}u = \\\\mathrm{d}\\\\ln(a/x) = {\\\\mathrm{d}(a/x) \\\\over a/x} = -{\\\\mathrm{d}x \\\\over x}$\uff0c\u5373 $-x\\\\mathrm{d} u = \\\\mathrm{d}x$\uff0c\u6240\u4ee5\u4e0a\u8ff0\u79ef\u5206\u4e3a\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\int \\\\frac{a}x \\\\ln^k \\\\frac{a}x \\\\ \\\\mathrm{d} x & = a\\\\int\\\\frac1x u^k (-x \\\\mathrm{d}u) \\\\\\\\<br/>& = -a \\\\int u^k \\\\ \\\\mathrm{d}u \\\\\\\\<br/>& = -{au^{k + 1} \\\\over k + 1} + C \\\\\\\\<br/>& = -{a\\\\ln^{k  + 1} (a/x) \\\\over k + 1} + C<br/>\\\\end{aligned}<br/>$$<br/>\u5c06\u7ed3\u679c\u4ee3\u56de\u5230 $(2)$ \u4e2d\uff0c\u5f97\u5230\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>P(n, a) & = a + \\\\sum_{k = 0}^{n - 2} {(-1)^k \\\\over k!} \\\\left(- {a \\\\ln^{k + 1} a \\\\over k + 1}\\\\right) \\\\\\\\<br/>& = a + a\\\\sum_{k = 0}^{n - 2} {(-1)^{k + 1} \\\\over (k + 1)!} \\\\ln^{k  + 1}a \\\\\\\\<br/>& = a\\\\sum_{k = 0}^{n - 1} {(-1)^k \\\\over k!} \\\\ln^k a<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5\u5f52\u7eb3\u5047\u8bbe\u6210\u7acb\u3002$\\\\blacksquare$<br/>\u975e\u5e38\u6709\u8da3\u7684\u4e8b\u60c5\u662f\uff0c\u8fd9\u4e2a\u591a\u9879\u5f0f $Q(x)$ \u5b9e\u9645\u4e0a\u5c31\u662f $\\\\mathrm{e}^{-x}$ \u7684\u524d $n$ \u9879\u6cf0\u52d2\u5c55\u5f00\u3002\u8fd9\u91cc\u6211\u4eec\u56de\u5fc6\u4e00\u4e0b\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\mathrm{e}^x & = \\\\sum_{k = 0}^\\\\infty {x^k \\\\over k!} \\\\\\\\<br/>\\\\mathrm{e}^{-x} & = \\\\sum_{k = 0}^\\\\infty {(-1)^k x^k \\\\over k!}<br/>\\\\end{aligned}<br/>$$<br/>\u53c8\u4e00\u6b21\u4e0e\u81ea\u7136\u5e38\u6570\u7f8e\u5999\u7684\u9082\u9005\uff0c\u4e5f\u96be\u602a\u5b83\u503c\u5f97\u914d\u4e0a\u4e00\u4e2a\u4e13\u7528\u7b26\u53f7\u5728\u5404\u79cd\u573a\u5408\u5927\u663e\u8eab\u624b\u3002<br/><br/><br/><br/><br/>\u4ee3\u7801\u91cc\u9762\u7684\u5b9a\u79ef\u5206\u7684\u79ef\u5206\u53d8\u91cf\u7528\u7684\u662f Subscript[z, n]\uff0c\u4e3b\u8981\u539f\u56e0\u662f Mathematica \u662f\u76f4\u63a5\u5c55\u5f00\u51fd\u6570\u6765\u8ba1\u7b97\u7684\uff0c\u5982\u679c\u4f7f\u7528 z \u8ba1\u7b97\uff0c\u79ef\u5206\u53d8\u91cf\u4f1a\u4e0d\u5bf9\uff0c\u56e0\u800c\u51fa\u6765\u7684\u7ed3\u679c\u4e5f\u4f1a\u4e0d\u5bf9\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2018-3-2/cut-the-stick.html"
},
"\u79e9\u5e73\u8861\u6811(Rank Balanced Tree)": {
"tags": "\u6570\u636e\u7ed3\u6784 \u5e73\u8861\u4e8c\u53c9\u6811 Rank-Tree Treap Splay \u5e76\u67e5\u96c6 \u8d3c\u7237\u6211\u771f\u7684\u9519\u4e86",
"text": "\u79e9\u5e73\u8861\u6811(Rank Balanced Tree)<br/><br/>riteme: \u201c\u8fd9\u662f\u5e76\u67e5\u96c6\u548cTreap\u7684\u6742\u4ea4\u54c1\u79cd\u3002\u201d<br/>tplink: \u201c\u8d3c\u5f0f\u4e8c\u53c9\u6811\uff01\u201d<br/>ruanxz: \u201cZY\uff01\u201d<br/><br/>1 \u79e9<br/>1.1 \u6811\u7684\u79e9\u9ad8<br/>\u8fd9\u91cc\u5148\u4ecb\u7ecd\u201c\u79e9\u201d\u7684\u6982\u5ff5\u3002\u6211\u4eec\u5b9a\u4e49\u4e00\u68f5\u4e8c\u53c9\u6811\u7684\u79e9\u4e3a\u4ece\u4e3a\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u5230\u5176\u53f6\u8282\u70b9\u4e2d\u6700\u957f\u7684\u4e00\u6761\u6811\u94fe\u4e0a\u7ed3\u70b9\u7684\u4e2a\u6570\u3002<br/>\u5bf9\u4e8e\u7a7a\u7ed3\u70b9$nil$\uff0c\u5b83\u7684\u79e9\u4e3a$0$\u3002<br/>$$ nil.\\\\text{rank} = 0 \\\\tag{1.1} $$<br/>\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u975e\u7a7a\u8282\u70b9$x$\uff0c\u5b83\u7684\u79e9\u53ef\u4ee5\u5982\u4e0b\u5b9a\u4e49\uff1a<br/>$$ x.\\\\text{rank} = \\\\max\\\\{x.\\\\text{left}.\\\\text{rank}, x.\\\\text{right}.\\\\text{rank}\\\\} + 1 \\\\tag{1.2}$$<br/>\u6811\u7684\u79e9\u6211\u4eec\u4f7f\u7528UPDATE\u51fd\u6570\u6765\u7ef4\u62a4\uff1a<br/>1<br/>2function UPDATE(h):<br/>    h.rank = max(h.left.rank, h.right.rank) + 1<br/><br/><br/>\u73b0\u5728\u6211\u4eec\u6765\u770b\u4e00\u68f5\u4e8c\u53c9\u641c\u7d22\u6811\u3002<br/><br/>\u4e0a\u56fe\u4e2d\uff0ca\u7684\u79e9\u4e3a$1$\uff0ce\u7684\u79e9\u4e3a$2$\uff0cc\u7684\u79e9\u4e3a$3$\uff0c\u6839\u8282\u70b9j\u7684\u79e9\u4e3a$6$\u3002<br/>1.2 \u6309\u79e9\u5408\u5e76<br/>\u5728\u5e76\u67e5\u96c6\u7684\u4f18\u5316\u65b9\u6cd5\u4e2d\u6709\u4e00\u4e2a\u662f\u542f\u53d1\u5f0f\u6309\u79e9\u5408\u5e76\u3002\u505a\u6cd5\u662f\u5c06\u79e9\u5c0f\u7684\u6811\u63a5\u5728\u79e9\u5927\u7684\u6811\u4e0b\u9762\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c3d\u53ef\u80fd\u907f\u514d\u6811\u7684\u9ad8\u5ea6\u7684\u66b4\u6da8\u3002\u540c\u6837\uff0c\u5728\u79e9\u5e73\u8861\u6811\u4e2d\uff0c\u4e5f\u8981\u5229\u7528\u5230\u8fd9\u79cd\u601d\u60f3\u3002<br/>2 \u65cb\u8f6c<br/>\u4f17\u6240\u5468\u77e5\uff0c\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u65cb\u8f6c\u64cd\u4f5c\u53ef\u4ee5\u4fdd\u6301\u6811\u7684\u6709\u5e8f\u6027\uff0c\u540c\u65f6\u53ef\u4ee5\u901a\u8fc7\u65cb\u8f6c\u7684\u7ec4\u5408\u6765\u5b9e\u73b0\u8bb8\u591a\u64cd\u4f5c\u3002\u56e0\u6b64\u6211\u4eec\u5148\u5b9e\u73b0\u5de6\u65cb(LEFT-ROATE)\u548c\u53f3\u65cb(RIGHT-ROTATE)\u3002<br/>\u5de6\u65cb\u662f\u5c06\u5de6\u5b50\u6811\u65cb\u8f6c\u4e0a\u6765\u9876\u66ff\u81ea\u5df1\u7684\u4f4d\u7f6e\uff0c\u53f3\u65cb\u7c7b\u4f3c\u3002<br/>\u65cb\u8f6c\u65f6\u8981\u786e\u4fdd\u5de6\u5b50\u6811\u6216\u53f3\u5b50\u6811\u4e0d\u662f$nil$\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23function LEFT-ROTATE(h):<br/>    ASSERT h.left != nil<br/><br/>    x = h.left<br/>    h.left = x.right<br/>    x.right = h<br/><br/>    UPDATE(h)<br/>    UPDATE(x)<br/><br/>    return x  // \u4f7f\u7528\u5de6\u5b50\u6811\u6765\u66ff\u4ee3\u539f\u6765\u7684\u8282\u70b9<br/><br/>function RIGHT-ROTATE(h):<br/>    ASSERT h.right != nil<br/><br/>    x = h.right<br/>    h.right = x.left<br/>    x.left = h<br/><br/>    UPDATE(h)<br/>    UPDATE(x)<br/><br/>    return x  // \u4f7f\u7528\u53f3\u5b50\u6811\u6765\u66ff\u4ee3\u539f\u6765\u7684\u8282\u70b9<br/><br/><br/>\u4f8b\u5982\uff0c\u8981\u5bf9\u8282\u70b9x\u8fdb\u884c\u5de6\u65cb\u8f6c\u65f6\uff0c\u6211\u4eec\u8fd9\u6837\u8c03\u7528\uff1a<br/>1x = LEFT-ROTATE(x)<br/><br/><br/>3 \u666e\u901a\u79e9\u5e73\u8861\u6811<br/><br/>P: \u5e76\u67e5\u96c6 x Treap<br/>-> F1: \u201c\u8d3c\u5f0f\u4e8c\u53c9\u6811\u201d<br/><br/>\u79e9\u5e73\u8861\u6811\u7684\u6837\u5b50\u4e0e\u4e8c\u53c9\u641c\u7d22\u6811\u5e76\u6ca1\u6709\u4ec0\u4e48\u533a\u522b\u3002<br/>\u666e\u901a\u7684\u79e9\u5e73\u8861\u6811\u7684\u5b9e\u73b0\u975e\u5e38\u7b80\u5355\u3002\u5b83\u5c06\u5229\u7528\u79e9\u7684\u4fe1\u606f\u6765\u4f7f\u6811\u4fdd\u6301\u5e73\u8861\u3002<br/>3.1 \u67e5\u8be2<br/>\u67e5\u8be2\u4e2d\u6ca1\u6709\u5bf9\u6811\u7684\u5f62\u72b6\u7684\u4fee\u6539\uff0c\u56e0\u6b64\u4ec0\u4e48\u7279\u6b8a\u7684\u64cd\u4f5c\u90fd\u4e0d\u8981\u3002<br/>\u6545\u67e5\u8be2\u64cd\u4f5c\u548c\u666e\u901a\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u662f\u4e00\u6837\u7684\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function QUERY(h, key):<br/>    if h = nil:<br/>        return nil  // \u6ca1\u6709\u67e5\u627e\u5230<br/><br/>    if key < h.key:<br/>        return QUERY(h.left, key)  // \u7ed3\u679c\u5728\u5de6\u5b50\u6811\u4e2d<br/>    else if key > h.key:<br/>        return QUERY(h.right, key)  // \u7ed3\u679c\u5728\u53f3\u5b50\u6811\u4e2d<br/>    else:<br/>        return h  // \u547d\u4e2d\u8282\u70b9<br/><br/><br/>3.2 \u5e73\u8861<br/>\u51c6\u786e\u7684\u8bf4\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5e76\u4e0d\u80fd\u7ef4\u62a4\u5e73\u8861\uff0c\u800c\u53ea\u662f\u80fd\u4f7f\u6811\u5411\u5e73\u8861\u7684\u65b9\u5411\u53d1\u5c55\u3002<br/>\u8fdb\u884c\u5e73\u8861\u7684\u4f9d\u636e\u5c31\u662f\u6811\u7684\u79e9\u3002\u5f53\u5de6\u53f3\u5b50\u6811\u7684\u79e9\u5dee\u8ddd\u592a\u5927\uff0c\u6211\u4eec\u5c31\u8981\u91c7\u53d6\u884c\u52a8\u6765\u4f7f\u5176\u51cf\u5c0f\u5dee\u8ddd\u3002<br/>\u9996\u5148\u6211\u4eec\u8bbe\u5b9a\u4e00\u4e2a\u79e9\u7684\u5dee\u8ddd\u7684\u6700\u5927\u5bb9\u5fcd\u503c$t$\u3002\u8fd9\u4e2a\u503c\u662f\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u5e76\u4e14\u503c\u9009\u53d6\u7684\u6108\u5c0f\u6811\u5c31\u4f1a\u53d8\u5f97\u6108\u5e73\u8861\u3002\u5f53$t=1$\u65f6\uff0c\u79e9\u5e73\u8861\u6811\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5c31\u662f\u5b8c\u5168\u5e73\u8861\u7684\u4e8c\u53c9\u6811\u3002<br/>\u5728\u666e\u901a\u7684\u79e9\u5e73\u8861\u6811\u4e2d\uff0c\u6211\u4eec\u4e00\u822c\u9009\u5b9a\u4e3a$1$\uff1a<br/>1TOLERANCE = 1<br/><br/><br/>\u8bbe\u5b9a\u8fd9\u4e2a\u503c\u7684\u610f\u4e49\u5728\u4e8e\u5b9a\u4e49\u4e86\u5e73\u8861\u7684\u89e6\u53d1\u6807\u51c6\u3002\u5982\u679c\u5de6\u53f3\u5b50\u6811\u7684\u79e9\u7684\u5dee\u8ddd\u5927\u4e8e$t$\uff0c\u90a3\u4e48\u5c31\u8981\u51cf\u5c0f\u5dee\u8ddd\u3002<br/>\u51cf\u5c0f\u5dee\u8ddd\u7684\u65b9\u6cd5\u5c31\u662f\u5c06\u6811\u6839\u901a\u8fc7\u65cb\u8f6c\u7684\u65b9\u5f0f\u8fdb\u5165\u79e9\u8f83\u5c0f\u7684\u5b50\u6811\u4e2d\uff0c\u8fd9\u6837\u4f7f\u5f97\u79e9\u8f83\u5c0f\u7684\u5b50\u6811\u7684\u79e9\u589e\u52a0\uff0c\u79e9\u8f83\u5927\u7684\u5b50\u6811\u7684\u79e9\u51cf\u5c0f\u3002<br/>\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u5927\u81f4\u7684\u5e73\u8861\u4ee3\u7801\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function BALANCE(h):<br/>    if h.left.rank > h.right.rank and<br/>       h.left.rank - h.right.rank > TOLERANCE:   // \u5de6\u5b50\u6811\u7684\u79e9\u8fc7\u5927<br/>        h = LEFT-ROTATE(h)<br/>    else if h.left.rank < h.right.rank and<br/>            h.right.rank - h.left.rank > TOLERANCE:   // \u53f3\u5b50\u6811\u7684\u79e9\u8fc7\u5927<br/>        h = RIGHT-ROTATE(h)<br/><br/>    UPDATE(h)  // \u66f4\u65b0\u8282\u70b9<br/>    return h  // \u8fd4\u56de\u8c03\u6574\u540e\u7684\u8282\u70b9<br/><br/><br/>\u5b9e\u9645\u4e0a\uff0c\u8fd9\u6837\u8fd8\u4e0d\u8db3\u591f\u3002<br/>\u8003\u8651\u4e0b\u9762\u7684\u60c5\u51b5\uff1a<br/><br/>\u73b0\u5728\u6211\u4eec\u8981\u5e73\u8861b\u8282\u70b9\u3002\u5de6\u5b50\u6811\u7684\u79e9\u6bd4\u53f3\u5b50\u6811\u5927\u3002\u5018\u82e5\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\u8fdb\u884c\u8c03\u6574\uff0c\u5c06\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\uff1a<br/><br/>\u5443\u2026\u4f60\u4f1a\u53d1\u73b0\u5e76\u6ca1\u6709\u4ec0\u4e48\u53d8\u5316\u3002<br/>\u5176\u539f\u56e0\u5728\u4e8e\u5de6\u5b50\u6811\u7684\u53f3\u513f\u5b50\u7684\u79e9\u592a\u5927\uff0c\u5bfc\u81f4\u65cb\u8f6c\u8fc7\u53bb\u4e4b\u540e\u6ca1\u6709\u592a\u5927\u6548\u679c\u3002<br/>\u8fd9\u6837\u5bfc\u81f4\u4e2d\u95f4\u7684\u5b50\u6811\u7684\u6df1\u5ea6\u4e0b\u79fb\u4e00\u4f4d\u3002\u52a0\u4e4b\u5b83\u672c\u6765\u5c31\u79e9\u6bd4\u8f83\u5927\uff0c\u5982\u6b64\u4e00\u6765\u8fd9\u4e2a\u5e73\u8861\u5c31\u6beb\u65e0\u4f5c\u7528\u3002<br/>\u7136\u800c\uff0c\u5982\u679c\u5de6\u5b50\u6811\u7684\u8fde\u4e2a\u513f\u5b50\u5982\u679c\u79e9\u662f\u4e00\u6837\u7684\uff0c\u5c31\u4e0d\u4f1a\u6709\u592a\u5927\u7684\u5f71\u54cd\uff0c\u56e0\u4e3a\u8fd9\u6837\u5c31\u53ea\u4f1a\u5bfc\u81f4\u79e9\u7684\u5dee\u8ddd\u4e3a$1$\u3002\u5018\u82e5\u53f3\u513f\u5b50\u7684\u79e9\u66f4\u5c0f\uff0c\u5c31\u4e0d\u4f1a\u6709\u8fd9\u6837\u7684\u95ee\u9898\u3002<br/>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u5de6\u5b50\u6811\u53f3\u513f\u5b50\u7684\u79e9\u51cf\u5c0f\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u56e0\u4e3a\u4e2d\u95f4\u7684\u5b50\u6811\u800c\u5bfc\u81f4\u65e0\u7528\u7684\u5e73\u8861\u3002<br/>\u9996\u5148\u6211\u4eec\u5c06\u5de6\u5b50\u6811\u7684\u53f3\u513f\u5b50\u901a\u8fc7\u53f3\u65cb\u4e0a\u79fb\uff0c\u8fd9\u6837\u4f7f\u5f97\u53f3\u513f\u5b50\u7684\u79e9\u51cf\u5c0f\uff1a<br/><br/>\u7136\u540e\u518d\u8fdb\u884c\u5de6\u65cb\u64cd\u4f5c\uff0c\u5b8c\u6210\u5e73\u8861\uff1a<br/><br/>\u8fd9\u65f6\u5de6\u53f3\u5b50\u6811\u7684\u79e9\u7684\u5dee\u8ddd\u5c31\u51cf\u5c0f\u4e86\u3002<br/>\u540c\u6837\uff0c\u5bf9\u4e8e\u53f3\u5b50\u6811\u7684\u5e73\u8861\u64cd\u4f5c\u4e5f\u662f\u7c7b\u4f3c\u7684\u5904\u7406\u65b9\u6cd5\u3002\u8fd9\u91cc\u5c31\u4e0d\u518d\u591a\u8bf4\u3002\u5177\u4f53\u7684\u53ef\u4ee5\u53c2\u8003\u5b9e\u73b0\u4f2a\u4ee3\u7801\u3002<br/>\u5b8c\u6574\u7684\u5e73\u8861\u4ee3\u7801\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17function BALANCE(h):<br/>    if h.left.rank > h.right.rank and<br/>       h.left.rank - h.right.rank > TOLERANCE:   // \u5de6\u5b50\u6811\u7684\u79e9\u8f83\u5927<br/>        if h.left.right.rank > h.left.left.rank:  // \u5982\u679c\u5de6\u5b50\u6811\u7684\u53f3\u513f\u5b50\u7684\u79e9\u8f83\u5927<br/>            h.left = RIGHT-ROTATE(h.left)<br/><br/>        h = LEFT-ROTATE(h)<br/>    else<br/>    if h.left.rank < h.right.rank and<br/>       h.right.rank - h.left.rank > TOLERANCE:   // \u53f3\u5b50\u6811\u7684\u79e9\u8f83\u5927<br/>        if h.right.left.rank > h.right.right.rank:  // \u5982\u679c\u53f3\u5b50\u6811\u7684\u5de6\u513f\u5b50\u7684\u79e9\u8f83\u5927<br/>            h.right = LEFT-ROTATE(h.right)<br/><br/>        h = RIGHT-ROTATE(h)<br/><br/>    UPDATE(h)  // \u66f4\u65b0\u8282\u70b9<br/>    return h  // \u8fd4\u56de\u8c03\u6574\u540e\u7684\u8282\u70b9<br/><br/><br/>\u8fd9\u4e2a\u5e73\u8861\u64cd\u4f5c\u8fd0\u7528\u5230\u4e86\u7c7b\u4f3c\u4e8e\u5e76\u67e5\u96c6\u4e2d\u201c\u8def\u5f84\u538b\u7f29\u201d\u7684\u601d\u60f3\u3002\u5728\u5e76\u67e5\u96c6\u4e2d\u53ef\u4ee5\u76f4\u63a5\u5168\u90e8\u63a5\u5728\u6839\u8282\u70b9\u5904\uff0c\u4ece\u800c\u6781\u5927\u7684\u63d0\u9ad8\u4e86\u6548\u7387\u3002\u4f46\u9650\u4e8e\u4e8c\u53c9\u6811\u7684\u6027\u8d28\uff0c\u5e73\u8861\u64cd\u4f5c\u53ea\u80fd\u4f7f\u6bcf\u4e2a\u8282\u70b9\u7684\u79e9\u5c3d\u53ef\u80fd\u7684\u5c0f\u3002<br/>3.3 \u63d2\u5165<br/>\u63d2\u5165\u4e0e\u666e\u901a\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u5dee\u4e0d\u591a\uff0c\u53ea\u662f\u5728\u6700\u540e\u56de\u6eaf\u7684\u65f6\u5019\u7ef4\u62a4\u6811\u7684\u5e73\u8861\u3002<br/>\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5f88\u5feb\u7684\u5199\u51fa\u63d2\u5165\u64cd\u4f5c\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function INSERT(h, key):<br/>    if h = nil:<br/>        return new node with key<br/><br/>    if key < h.key:<br/>        h.left = INSERT(h.left, key)<br/>    else if key > h.key:<br/>        h.right = INSERT(h.right, key)<br/><br/>    return BALANCE(h)  // \u6700\u540e\u8981\u8fdb\u884c\u5e73\u8861<br/><br/><br/>3.4 \u5220\u9664<br/>\u4e0e\u63d2\u5165\u7c7b\u4f3c\uff0c\u5220\u9664\u7684\u4ee3\u7801\u548c\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u4fdd\u6301\u4e00\u81f4\uff0c\u53ea\u8981\u6700\u540e\u8bb0\u5f97\u8fdb\u884c\u5e73\u8861\u5373\u53ef\u3002<br/>\u8fd9\u91cc\u6211\u4eec\u91c7\u7528\u5c06\u88ab\u5220\u9664\u8282\u70b9\u4e0b\u6c89\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u5220\u9664\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34function REAL-REMOVE(h):  // \u5220\u9664\u6307\u5b9a\u7684\u8282\u70b9<br/>    if h.left != nil and h.right != nil:<br/>        // \u5982\u679c\u6709\u4e24\u4e2a\u975e\u7a7a\u5b50\u6811\u5c31\u7ee7\u7eed\u4e0b\u6c89<br/>        // \u5c3d\u91cf\u5f80\u79e9\u5c0f\u7684\u5b50\u6811\u4e2d\u4e0b\u6c89\uff0c\u540c\u65f6\u5c06\u53e6\u4e00\u68f5\u5b50\u6811\u7684\u79e9\u5c3d\u91cf\u51cf\u5c0f<br/>        // \u4ece\u800c\u8fbe\u5230\u5e73\u8861\u7684\u76ee\u7684<br/>        if h.left.rank > h.right.rank:<br/>            h = LEFT-ROTATE(h)<br/>            h.right = REAL-REMOVE(h->right)<br/>        else:<br/>            h = RIGHT-ROTATE(h)<br/>            h.left = REAL-REMOVE(h->left)<br/>    else:<br/>        // \u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5b50\u6811\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\uff0c\u5c06\u552f\u4e00\u7684\u5b50\u6811\u9876\u66ff\u81ea\u5df1\u7684\u4f4d\u7f6e<br/>        // \u5982\u679c\u6ca1\u6709\u5b50\u6811\uff0c\u8bf4\u660e\u662f\u53f6\u8282\u70b9\uff0c\u8fd4\u56denil<br/>        next = nil<br/>        if h.left != nil:<br/>            next = h.left<br/>        else:<br/>            next = h.right<br/><br/>        delete h  // \u5220\u9664<br/>        return next<br/><br/>    return BALANCE(h)<br/><br/>function REMOVE(h, key):<br/>    if key < h.key:<br/>        h.left = REMOVE(h.left, key)<br/>    else if key > h.key:<br/>        h.right = REMOVE(h.right, key)<br/>    else:<br/>        return REAL-REMOVE(h)  // \u627e\u5230\u6307\u5b9a\u7684\u8282\u70b9\u540e\u8fdb\u884c\u5220\u9664<br/><br/>    return BALANCE(h)<br/><br/><br/>3.5 \u65f6\u95f4\u590d\u6742\u5ea6<br/>\u5982\u679c$t$\u9009\u53d6\u5f97\u5f53\uff0c\u79e9\u5e73\u8861\u6811\u5c06\u662f\u975e\u5e38\u5e73\u8861\u7684\u3002\u56e0\u6b64\u64cd\u4f5c\u90fd\u662f$O(\\\\log n)$\u7684\uff1a<br/><br/><br/><br/>\u64cd\u4f5c<br/>\u65f6\u95f4\u590d\u6742\u5ea6<br/><br/><br/><br/><br/>\u5e73\u8861<br/>$\\\\Theta(1)$<br/><br/><br/>\u67e5\u8be2<br/>$O(\\\\log n)$<br/><br/><br/>\u63d2\u5165<br/>$O(\\\\log n)$<br/><br/><br/>\u5220\u9664<br/>$O(\\\\log n)$<br/><br/><br/><br/>\u5728\u5b9e\u9645\u6548\u7387\u4e0a\uff0c\u79e9\u5e73\u8861\u6811\u6bd4Treap\u7565\u5feb\uff0c\u4e0e\u4f38\u5c55\u6811\u76f8\u6bd4\u5e38\u6570\u7a0d\u5927\u4e00\u4e9b\u3002\u5728\u67e5\u8be2\u64cd\u4f5c\u5f88\u591a\u7684\u65f6\u5019\uff0c\u79e9\u5e73\u8861\u6811\u6bd4\u8f83\u5360\u4f18\u52bf\u3002<br/>4 \u53ef\u5408\u5e76\u79e9\u5e73\u8861\u6811<br/><br/>F1: \u201c\u8d3c\u5f0f\u4e8c\u53c9\u6811\u201d x \u53ef\u6301\u4e45\u5316Treap<br/>-> F2: \u201c\u53ef\u5408\u5e76\u79e9\u5e73\u8861\u6811\u201d<br/><br/>\u5982\u679c\u53ea\u662f\u4e00\u68f5\u5355\u7eafBST\uff0c\u672a\u514d\u592a\u8fc7\u65e0\u804a......<br/>\u73b0\u5728\u5404\u79cdBST\u90fd\u73a9\u51fa\u82b1\u51fa\u6765\u4e86\uff0c\u7136\u800c\u5728\u8fd9\u4e4b\u4e2d\u652f\u6301\u533a\u95f4\u64cd\u4f5c\u7684BST\u5374\u975e\u5e38\u5c11\u3002\u636e\u6211\u6240\u77e5\u8fd8\u53ea\u6709\u53ef\u6301\u4e45\u5316Treap\u548c\u4f38\u5c55\u6811\u3002<br/>\u90a3\u79e9\u5e73\u8861\u6811\u80fd\u4e0d\u80fd\u4e5f\u652f\u6301\u533a\u95f4\u64cd\u4f5c\u5462\uff1f<br/>\u4e00\u79cd\u601d\u8def\u662f\u7c7b\u4f3c\u4e8e\u4f38\u5c55\u6811\u7684\u505a\u6cd5\uff1a\u5c06\u533a\u95f4\u53d8\u4e3a\u5f00\u533a\u95f4\uff0c\u7136\u540e\u5c06\u533a\u95f4\u7684\u4e24\u4e2a\u7aef\u70b9\u4e0a\u6d6e\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u622a\u53d6\u533a\u95f4\u4e86\u3002\u79e9\u5e73\u8861\u6811\u53ef\u4ee5\u8fdb\u884c\u4e0a\u6d6e\uff0c\u4e0a\u6d6e\u65f6\u4e0d\u8003\u8651\u6811\u7684\u5e73\u8861\u3002\u5f53\u533a\u95f4\u7528\u5b8c\u540e\uff0c\u518d\u5c06\u4e0a\u6d6e\u7684\u9876\u70b9\u4f9d\u6b21\u4e0b\u6c89\uff0c\u540c\u65f6\u7ef4\u62a4\u5e73\u8861\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u533a\u95f4\u64cd\u4f5c\u3002<br/>\u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u8fd9\u6837\u8fdb\u884c\u5904\u7406\uff0c\u6709\u7740\u8bf8\u591a\u7684\u7f3a\u70b9\uff1a<br/><br/>\u53c8\u8981\u589e\u52a0\u4e0a\u6d6e\u548c\u4e0b\u6c89\u64cd\u4f5c\uff0c\u5e76\u4e14\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u5e76\u4e0d\u7b80\u5355\uff0c\u4ee3\u7801\u91cf\u6025\u5267\u589e\u957f\u3002  <br/>\u5982\u679c\u6709\u61d2\u60f0\u6807\u8bb0\u4e4b\u7c7b\u7684\u4e1c\u897f\uff0c\u96be\u4ee5\u6b63\u786e\u5904\u7406\u3002  <br/>\u5e38\u6570\u53d8\u5927\uff0c\u5c3d\u7ba1\u7406\u8bba\u4e0a\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f$O(\\\\log n)$\u3002<br/><br/>\u4f46\u662f\u2026\u53c8\u4e0d\u662f\u4e0d\u80fd\u5199\uff0c\u6bd5\u7adf\u6211\u662f\u5199\u8fc7\u7684\uff0c\u6240\u4ee5\u6211\u624d\u4f1a\u77e5\u9053\u8fd9\u4e9b\u3002<br/>\u8fd9\u6837\u5199\u51fa\u6765\u7684\u79e9\u5e73\u8861\u6811\u80fd\u6bd4\u53ef\u6301\u4e45\u5316Treap\u5feb\uff0c\u4f46\u4e0e\u4f38\u5c55\u6811\u76f8\u6bd4\u5dee\u8ddd\u8f83\u5927\u3002<br/>\u53e6\u4e00\u79cd\u601d\u8def\u5c31\u662f\u7c7b\u4f3c\u4e8e\u53ef\u6301\u4e45\u5316Treap\u7684\u505a\u6cd5\uff1a\u5c06\u6811\u4ece\u7b2c$k$\u5c0f\u7684\u4f4d\u7f6e\u62c6\u5f00\uff0c\u7136\u540e\u53c8\u5408\u5e76......<br/>\u53ef\u5408\u5e76\u79e9\u5e73\u8861\u6811\u5c31\u662f\u8fd9\u79cd\u505a\u6cd5\u3002<br/>\u63a5\u4e0b\u6765\u6211\u4eec\u4f1a\u7ee7\u7eed\u7528\u5230\u79e9\u5e73\u8861\u6811\u7684BALANCE\u64cd\u4f5c\uff0c\u540c\u65f6\u5c06\u589e\u52a0\u4e24\u4e2a\u57fa\u672c\u64cd\u4f5c\uff1aSPLIT\u548cMERGE\uff0c\u8868\u793a\u62c6\u5206\u548c\u5408\u5e76\u3002\u4ee5\u53ca\u4e00\u4e2a\u8f85\u52a9\u64cd\u4f5cRANK1\u6765\u67e5\u627e\u7b2c$k$\u5c0f\u7684\u8282\u70b9\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u64cd\u4f5c\u6765\u5b9e\u73b0\u5404\u79cd\u5404\u6837\u7684\u64cd\u4f5c\u3002<br/>4.1 \u62c6\u5206<br/>\u62c6\u5206\u64cd\u4f5c\u662f\u5c06\u6811\u4ece\u7b2c$k$\u5c0f\u7684\u8282\u70b9\u5904\u62c6\u6210$[1, k]$\u548c$[k+1, n]$\u7684\u4e24\u68f5\u5b50\u6811\u3002<br/>\u56e0\u4e3a\u9700\u8981\u8ba1\u7b97\u6392\u540d\uff0c\u6240\u4ee5\u6bcf\u4e2a\u8282\u70b9\u90fd\u8981\u8bb0\u5f55\u4e00\u4e2a$\\\\text{size}$\uff0c\u8868\u793a\u5b50\u6811\u4e2d\u8282\u70b9\u7684\u4e2a\u6570\uff0c\u5373\u5b50\u6811\u7684\u5927\u5c0f\u3002\u540c\u6837\uff0c\u7a7a\u8282\u70b9\u7684\u5927\u5c0f\u4e3a$0$\uff1a<br/>$$ nil.\\\\text{size} = 0 \\\\tag{4.1} $$<br/>\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9$x$\uff0c\u5b83\u7684\u5927\u5c0f\u5b9a\u4e49\u5982\u4e0b\uff1a<br/>$$ x.\\\\text{size} = x.\\\\text{left}.\\\\text{size} + x.\\\\text{right}.\\\\text{size} + 1 \\\\tag{4.2} $$<br/>\u6b64\u65f6\u6211\u4eec\u5c06\u5728UPDATE\u51fd\u6570\u4e2d\u7ef4\u62a4\u6811\u7684\u5927\u5c0f\uff1a<br/>1<br/>2<br/>3function UPDATE(h):<br/>    h.size = h.left.size + h.right.size + 1<br/>    h.rank = max(h.left.rank, h.right.rank) + 1<br/><br/><br/>\u62c6\u5206\u64cd\u4f5c\u65f6\u5148\u6cbf\u7740\u5bfb\u627e\u7b2c$k$\u5c0f\u7684\u6811\u94fe\u4e0d\u65ad\u7684\u5c06\u6811\u5207\u5f00\uff0c\u7136\u540e\u5728\u56de\u6eaf\u7684\u65f6\u5019\u8fdb\u884c\u62fc\u88c5\u3002\u8fd9\u662f\u4e00\u4e2a\u9012\u5f52\u7684\u8fc7\u7a0b\u3002<br/>\u5047\u8bbe\u6211\u4eec\u5728\u5bf9\u5b50\u6811$x$\u8fdb\u884c\u62c6\u5206\uff0c\u6211\u4eec\u8003\u8651\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\uff1a<br/><br/>\u5982\u679c$k \\\\le x.\\\\text{left}.\\\\text{size}$\uff0c\u90a3\u4e48\u8bf4\u660e\u7b2c$k$\u5c0f\u7684\u8282\u70b9\u5728\u5de6\u5b50\u6811\u4e2d\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u5c06\u5de6\u5b50\u6811\u62c6\u5f00\uff0c\u62c6\u5f00\u540e\u7684\u5de6\u8fb9\u662f$[1, k]$\u7684\u5b50\u6811\uff0c\u53f3\u8fb9\u662f\u5927\u4e8e$k$\u7684\u5b50\u6811\u3002  <br/>\u5982\u679c$k \\\\ge x.\\\\text{left}.\\\\text{size}$\uff0c\u90a3\u4e48\u8bf4\u660e\u5de6\u5b50\u6811\u5b8c\u5168\u5c0f\u4e8e$k$\uff0c\u5b50\u6811\u7684\u6839\u5fc5\u5b9a\u4e0d\u5927\u4e8e$k$\uff0c\u56e0\u6b64\u53ef\u4ee5\u786e\u5b9a\u5de6\u5b50\u6811\u548c\u6811\u6839\u90fd\u5728$[1,k]$\u7684\u8303\u56f4\u5185\u3002\u4f46\u6211\u4eec\u4e0d\u786e\u5b9a\u53f3\u5b50\u6811\u4e2d\u662f\u5426\u6709\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\u7684\u3002\u5982\u679c\u6709\uff0c\u5219\u5b83\u5728\u53f3\u5b50\u6811\u4e2d\u7684\u6392\u540d\u4e3a$k-x.\\\\text{left}.\\\\text{size} - 1$\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u53f3\u5b50\u6811\u6309\u7167\u8fd9\u4e2a\u503c\u8fdb\u884c\u62c6\u5206\uff0c\u90a3\u4e48\u62c6\u5f00\u7684\u5de6\u8fb9\u5c5e\u4e8e$[1,k]$\u3002<br/><br/>\u8fd9\u4e2a\u8fc7\u7a0b\u975e\u5e38\u7b80\u5355\uff0c\u4ee3\u7801\u5b9e\u73b0\u4e5f\u662f\u5982\u6b64\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16function SPLIT(h, k):<br/>    if h = nil:<br/>        return (nil, nil)  // \u5982\u679c\u662f\u7a7a\u6811\uff0c\u90a3\u4e48\u4e0d\u9700\u8981\u62c6\u5206<br/><br/>    if k <= h.left.size:  // \u60c5\u51b51<br/>        a, b = SPLIT(h.left, k)  // \u62c6\u5206\u5de6\u5b50\u6811<br/>        h.left = b               // b\u4e0d\u5c5e\u4e8e[1, k]<br/>        UPDATE(h)<br/><br/>        return (a, h)<br/>    else:                 // \u60c5\u51b52<br/>        a, b = SPLIT(h.right, k - h.left.size - 1)  // \u62c6\u5206\u53f3\u5b50\u6811<br/>        h.right = a                                 // a\u5c5e\u4e8e[1, k]<br/>        UPDATE(h)<br/><br/>        return (h, b)<br/><br/><br/>4.2 \u5408\u5e76<br/>\u4e4b\u524d\u6211\u4eec\u628a\u6811\u7ed9\u62c6\u5f00\u4e86\uff0c\u7528\u5b8c\u4e86\u5f53\u7136\u8fd8\u8981\u8fd8\u56de\u53bb\uff0c\u56e0\u6b64\u6211\u4eec\u5fc5\u7136\u9700\u8981\u5408\u5e76\u64cd\u4f5c\u3002<br/>\u540c\u65f6\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u62c6\u5206\u65f6\u6211\u4eec\u5e76\u6ca1\u6709\u7ef4\u62a4\u5e73\u8861\uff0c\u56e0\u6b64\u5e73\u8861\u7684\u91cd\u4efb\u5c31\u4ea4\u7ed9\u4e86\u5408\u5e76\u3002<br/>\u8fdb\u884c\u5408\u5e76\u65f6\uff0c\u6211\u4eec\u5fc5\u987b\u4fdd\u8bc1\u5408\u5e76\u7684\u5de6\u5b50\u6811\u5fc5\u987b\u5b8c\u5168\u5c0f\u4e8e\u5408\u5e76\u7684\u53f3\u5b50\u6811\uff0c\u5373\u5de6\u5b50\u6811\u7684\u6700\u5927\u503c\u5fc5\u987b\u5c0f\u4e8e\u53f3\u5b50\u6811\u7684\u6700\u5c0f\u503c\u3002<br/>\u5408\u5e76\u65f6\u8981\u9075\u5faa\u6309\u79e9\u5408\u5e76\u7684\u601d\u60f3\uff0c\u59cb\u7ec8\u9009\u53d6\u79e9\u8f83\u5927\u7684\u5b50\u6811\u4f5c\u4e3a\u6811\u6839\u3002\u7136\u540e\u5c06\u53e6\u4e00\u68f5\u5b50\u6811\u4e0e\u6811\u6839\u7684\u5bf9\u5e94\u513f\u5b50\u7ee7\u7eed\u8fdb\u884c\u5408\u5e76\u3002<br/>\u8fd9\u662f\u4e00\u4e2a\u9012\u5f52\u5411\u4e0b\u7684\u8fc7\u7a0b\u3002\u5728\u56de\u6eaf\u7684\u65f6\u5019\uff0c\u4f7f\u7528BALANCE\u64cd\u4f5c\u8fdb\u884c\u5e73\u8861\u3002<br/>\u5982\u679c\u6211\u4eec\u5728\u5408\u5e76\u4e24\u68f5\u5b50\u6811$a$\u548c$b$\uff0c\u5176\u4e2d$a$\u5b8c\u5168\u5c0f\u4e8e$b$\u3002\u7531\u4e8e\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6709\u5e8f\u6027\uff0c\u5408\u5e76\u53ea\u4f1a\u51fa\u73b0\u4e24\u79cd\u60c5\u51b5\uff1a<br/><br/>$a$\u4f5c\u4e3a\u6811\u6839\uff0c$a.\\\\text{right}$\u4e0e$b$\u7ee7\u7eed\u5408\u5e76\u3002  <br/>$b$\u4f5c\u4e3a\u6811\u6839\uff0c$a$\u548c$b.\\\\text{left}$\u7ee7\u7eed\u5408\u5e76\u3002<br/><br/>\u4f5c\u4e3a\u7279\u4f8b\uff0c\u5982\u679c$a$\u548c$b$\u4e2d\u6709\u4e00\u4e2a\u662f\u7a7a\u6811\uff0c\u90a3\u4e48\u5c31\u6ca1\u6709\u5fc5\u8981\u5408\u5e76\u4e86\u3002<br/>\u5408\u5e76\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17function MERGE(a, b):<br/>    if a = nil:<br/>        return b<br/>    if b = nil:<br/>        return a<br/><br/>    ASSERT max(a) < min(b)  // a < b<br/>    if a.rank > b.rank:  // \u6309\u79e9\u5408\u5e76<br/>        a.right = MERGE(a.right, b)<br/>        UPDATE(a)<br/><br/>        return BALANCE(a)  // \u6700\u540e\u8fdb\u884c\u5e73\u8861<br/>    else:<br/>        b.left = MERGE(a, b.left)<br/>        UPDATE(b)<br/><br/>        return BALANCE(b)<br/><br/><br/>4.3 \u6392\u540d<br/>\u7531\u4e8eSPLIT\u64cd\u4f5c\u9700\u8981\u6392\u540d$k$\uff0c\u800c\u4e00\u822c\u7684\u8c03\u7528\u662f\u7ed9\u5b9a\u8282\u70b9\u7684\u952e\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u80fd\u5c06\u8282\u70b9\u5728\u6811\u4e2d\u7684\u6392\u540d\u8ba1\u7b97\u51fa\u6765\u7684\u7b97\u6cd5\u3002<br/>\u56e0\u6b64RANK\u64cd\u4f5c\u4e5f\u6210\u4e3a\u4e86\u975e\u5e38\u91cd\u8981\u7684\u64cd\u4f5c\u4e4b\u4e00\u3002<br/>\u5229\u7528\u8282\u70b9\u50a8\u5b58\u7684\u5b50\u6811\u5927\u5c0f\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u7b97\u51fa\u4e00\u4e2a\u8282\u70b9\u7684\u6392\u540d\u3002<br/>\u8fd9\u4e2a\u64cd\u4f5c\u4e5f\u662f\u4e00\u4e2a\u9012\u5f52\u64cd\u4f5c\u7684\u8fc7\u7a0b\uff1a<br/><br/>\u5982\u679c\u6307\u5b9a\u7684\u8282\u70b9\u5728\u5de6\u5b50\u6811\uff0c\u6211\u4eec\u76f4\u63a5\u5728\u5de6\u5b50\u6811\u4e2d\u7ee7\u7eed\u67e5\u8be2\u3002  <br/>\u5982\u679c\u6307\u5b9a\u7684\u8282\u70b9\u5728\u53f3\u5b50\u6811\uff0c\u6211\u4eec\u67e5\u8be2\u5b83\u5728\u53f3\u5b50\u6811\u4e2d\u7684\u6392\u540d\uff0c\u7136\u540e\u52a0\u4e0a\u5de6\u5b50\u6811\u548c\u6811\u6839\u7684\u5927\u5c0f\u3002  <br/>\u5982\u679c\u76f4\u63a5\u547d\u4e2d\uff0c\u90a3\u4e48\u76f4\u63a5\u8ba1\u7b97\u6392\u540d\uff0c\u5176\u6392\u540d\u4e3a\u5de6\u5b50\u6811\u7684\u5927\u5c0f\u52a0$1$\u3002  <br/>\u5bf9\u4e8e\u6ca1\u6709\u547d\u4e2d\u7684\u7a7a\u8282\u70b9\uff0c\u6392\u540d\u7684\u610f\u4e49\u5728\u4e8e\u67e5\u8be2\u4e00\u4e2a\u65b0\u8282\u70b9\u63d2\u5165\u6811\u540e\u7684\u6392\u540d\u3002\u4e3a\u6b64\uff0c\u5bf9\u4e8e\u7a7a\u8282\u70b9\uff0c\u6211\u4eec\u89c6\u4e3a\u5b83\u7684\u6392\u540d\u4e3a$1$\u3002<br/><br/>\u6839\u636e\u4e0a\u9762\u7684\u8ba8\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u67e5\u8be2\u6392\u540d\u7684\u64cd\u4f5c\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function RANK(h, key):<br/>    if h = nil:<br/>        return 1<br/><br/>    if key < h.key:<br/>        return RANK(h.left, key)<br/>    else if key > h.key:<br/>        return RANK(h.right, key) + h.left.size + 1<br/>    else:<br/>        return h.left.size + 1<br/><br/><br/>\u5f53\u7136\uff0c\u6211\u4eec\u5e0c\u671b\u8fd9\u4e2a\u64cd\u4f5c\u8d8a\u5feb\u8d8a\u597d\u3002\u73b0\u4ee3\u7edd\u5927\u90e8\u5206\u7684\u8bed\u8a00\u7684\u7f16\u8bd1\u5668/\u89e3\u91ca\u5668\u2026\u90fd\u80fd\u591f\u5bf9\u5c3e\u9012\u5f52\u8fdb\u884c\u4f18\u5316\u3002\u4e0a\u9762\u7684RANK\u64cd\u4f5c\u53ef\u4ee5\u88ab\u6211\u4eec\u6539\u4e3a\u5c3e\u9012\u5f52\uff0c\u4ece\u800c\u5145\u5206\u5229\u7528\u4f18\u5316\u7684\u4f18\u52bf\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function RANK(h, key, offest = 0):  // \u5229\u7528offest\u8fdb\u884c\u5c3e\u9012\u5f52\u4f18\u5316<br/>    if h = nil:<br/>        return 1 + offest<br/><br/>    if key < h.key:<br/>        return RANK(h.left, key, offest)<br/>    else if key > h.key:<br/>        return RANK(h.right, key, offest + h.left.size + 1)<br/>    else:<br/>        return h.left.size + 1 + offest<br/><br/><br/>\u5982\u679c\u6ca1\u6709\u4f18\u5316\uff0c\u4e5f\u6ca1\u6709\u5173\u7cfb\uff0c\u56e0\u4e3a\u80fd\u5c3e\u9012\u5f52\u7684\u51fd\u6570\uff0c\u57fa\u672c\u4e0a\u90fd\u53ef\u4ee5\u5199\u6210\u8fed\u4ee3\u7684\u5f62\u5f0f\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13function RANK(h, key):<br/>    offest = 0<br/><br/>    while h != nil:                          // \u5411\u5de6\u8d70<br/>        if key < h.key:<br/>            h = h.left<br/>        else if key > h.key:                 // \u5411\u53f3\u8d70<br/>            offest += h.left.size + 1<br/>            h = h.right<br/>        else:<br/>            return h.left.size + 1 + offest  // \u76f4\u63a5\u547d\u4e2d<br/><br/>    return offest + 1  // \u6700\u540e\u6ca1\u6709\u547d\u4e2d<br/><br/><br/>4.4 \u65f6\u95f4\u590d\u6742\u5ea6<br/>\u663e\u7136\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u6211\u4eec\u6700\u5173\u5fc3\u7684\u3002\u901a\u8fc7BALANCE\u64cd\u4f5c\uff0c\u79e9\u5e73\u8861\u6811\u5728\u5408\u5e76\u8fc7\u7a0b\u4e2d\u80fd\u591f\u7ef4\u6301\u5f88\u597d\u7684\u5e73\u8861\u3002<br/>\u56e0\u6b64\u5bf9\u4e8e\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u9012\u5f52\u6df1\u5ea6\u4e0d\u4f1a\u8d85\u8fc7$O(\\\\log n)$\u3002\u56e0\u6b64\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f$O(\\\\log n)$\u7684\u3002<br/><br/><br/><br/>\u64cd\u4f5c<br/>\u65f6\u95f4\u590d\u6742\u5ea6<br/><br/><br/><br/><br/>\u62c6\u5206<br/>$O(\\\\log n)$<br/><br/><br/>\u5408\u5e76<br/>$O(\\\\log n)$<br/><br/><br/>\u6392\u540d<br/>$O(\\\\log n)$<br/><br/><br/><br/>4.5 \u884d\u751f\u64cd\u4f5c<br/>\u6709\u4e86SPLIT\u3001MERGE\u548cRANK\u4e09\u5927\u5229\u5668\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u968f\u5fc3\u6240\u6b32\u7684\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\u4e86\u3002\u4e0b\u9762\u5c06\u5bf9\u4e00\u4e9b\u64cd\u4f5c\u8fdb\u884c\u8bf4\u660e\uff0c\u5927\u5bb6\u53ef\u4ee5\u5728\u6b64\u57fa\u7840\u4e0a\u5f00\u53d1\u66f4\u591a\u64cd\u4f5c\u3002<br/>4.5.1 \u67e5\u8be2<br/>\u8fd9\u4e2a\u5b9e\u9645\u4e0a\u6ca1\u6709\u5fc5\u8981\u52a8\u7528\u62c6\u5206\u548c\u5408\u5e76\uff0c\u76f4\u63a5\u67e5\u5c31\u597d\u3002<br/>4.5.2 \u63d2\u5165<br/>\u8bbe\u8981\u63d2\u5165\u7684\u8282\u70b9\u7684\u6392\u540d\u4e3a$k$\uff0c\u90a3\u4e48\u5148\u5c06\u6811\u62c6\u5206\u4e3a$[1, k-1]$\u548c$[k, n]$\u4e24\u90e8\u5206\uff0c\u7136\u540e\u4f9d\u6b21\u5408\u5e76\u3002<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7function INSERT(h, key):<br/>    x = new node with key<br/><br/>    k = RANK(h, key)<br/>    a, b = SPLIT(h, k - 1)<br/><br/>    return MERGE(MERGE(a, x), b)<br/><br/><br/>4.5.3 \u5220\u9664<br/>\u8bbe\u8981\u5220\u9664\u7684\u8282\u70b9\u7684\u6392\u540d\u4e3a$k$\uff0c\u90a3\u4e48\u5c06\u6811\u62c6\u5206\u4e3a$[1,k-1]$\u3001$[k+1,n]$\u548c\u88ab\u5220\u9664\u7684\u8282\u70b9\u4e09\u90e8\u5206\uff0c\u7136\u540e\u53ea\u5c06\u5de6\u53f3\u5408\u5e76\u5373\u53ef\u3002<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8function REMOVE(h, key):<br/>    k = RANK(h, key)<br/>    a1, a2 = SPLIT(h, k - 1)<br/>    b1, b2 = SPLIT(a2, 1)<br/><br/>    delete b1  // \u5220\u9664\u8282\u70b9<br/><br/>    return MERGE(a1, b2)<br/><br/><br/>4.5.4 \u7b2ck\u5c0f<br/>\u76f4\u63a5\u62c6\u5c31\u597d\u4e86\u3002<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6function KTH(h, k):<br/>    a1, a2 = SPLIT(h, k - 1)<br/>    b1, b2 = SPLIT(a2, 1)<br/><br/>    MERGE(a1, MERGE(b1, b2))<br/>    return b1<br/><br/><br/>4.5.5 \u622a\u53d6\u533a\u95f4<br/>\u8fd9\u624d\u662f\u533a\u95f4\u64cd\u4f5c\u7684\u5173\u952e\u5427\u2026<br/>\u4f46\u662f\u6211\u4eec\u53ea\u8981\u62c6\u62c6\u5408\u5408\u5c31\u641e\u5b9a\u4e86\u2026<br/>\u6700\u540e\u8981\u8bb0\u5f97\u5408\u5e76\u5c31\u597d\u4e86\u3002<br/>1<br/>2<br/>3<br/>4<br/>5function SLICE(h, left, right):<br/>    a1, a2 = SPLIT(h, left - 1)<br/>    b1, b2 = SPLIT(a2, right - left + 1)<br/><br/>    return b1<br/><br/><br/>4.6 \u603b\u7ed3<br/>\u5728\u5b9e\u9645\u7684\u6d4b\u8bd5\u4e2d\uff0c\u79e9\u5e73\u8861\u6811\u7684\u8868\u73b0\u975e\u5e38\u4e0d\u9519\uff0c\u6bd4\u53ef\u6301\u4e45\u5316Treap\u5feb\u4e86\u5f88\u591a\uff0c\u5e76\u4e14\u5728\u533a\u95f4\u64cd\u4f5c\u4e0a\u80fd\u548c\u4f38\u5c55\u6811\u4e0d\u76f8\u4e0a\u4e0b\u3002<br/>\u4f46\u662f\uff0c\u4e0e\u53ef\u6301\u4e45\u5316Treap\u76f8\u6bd4\uff0c\u56e0\u4e3a\u4f9d\u8d56\u4e8eBALANCE\u64cd\u4f5c\uff0c\u6240\u4ee5\u5c31\u65e0\u6cd5\u8fdb\u884c\u53ef\u6301\u4e45\u5316\u4e86\u3002<br/>\u6700\u540e\u6211\u4eec\u91cd\u65b0\u6765\u8003\u8651$t$\u8fd9\u4e2a\u5bb9\u5fcd\u503c\u7684\u9009\u53d6\u3002\u5728\u4e4b\u524d\u666e\u901a\u7684\u79e9\u5e73\u8861\u6811\u4e2d\uff0c\u6211\u4eec\u8ba4\u4e3a$1$\u662f\u6700\u597d\u7684\u3002\u800c\u73b0\u5728\u5c31\u672a\u5fc5\u3002\u5982\u679c\u6570\u636e\u5b8c\u5168\u968f\u673a\uff0c\u6211\u4eec\u5176\u5b9e\u5e76\u4e0d\u9700\u8981\u5e73\u8861\u3002\u4f46\u8fd9\u6837\u5728\u6781\u7aef\u6570\u636e\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5e73\u8861\u5bb9\u6613\u9000\u5316\u4e3a\u4e00\u6761\u94fe\u3002\u4f46\u662f\u8fc7\u591a\u7684\u5e73\u8861\u4f1a\u5f71\u54cd\u5e38\u6570\u3002\u56e0\u6b64\uff0c$t$\u53ef\u4ee5\u7a0d\u5fae\u53d6\u5927\u4e00\u70b9\uff0c\u4f46\u4e0d\u80fd\u592a\u5927\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6700\u597d\u9009\u62e9$2$\u5230$6$\u4e2d\u7684\u503c\u3002<br/><br/><br/><br/><br/>\u8fd9\u91cc\u7684\u82f1\u6587\u89e3\u91ca\u4e3a\u201c\u6392\u540d\u201d\uff0c\u4e0d\u662f\u79e9\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-4-10/rank-tree.html"
},
"\u7a7a\u88ad": {
"tags": "Problems",
"text": "\u7a7a\u88ad (airstrike.c/cpp)<br/>\u65f6\u95f4\u9650\u5236\uff1aN/A / \u5185\u5b58\u9650\u5236\uff1a1024 MB / \u6253\u5f00-O2\u4f18\u5316 / \u652f\u6301C11\\\\C++11<br/>\u9898\u76ee\u63cf\u8ff0<br/>\u8fd9\u662f\u4e00\u9053\u4ea4\u4e92\u9898\u3002<br/>\u6ce8\u610f\u672c\u4ea4\u4e92\u5e93\u4e0d\u63d0\u4f9bPascal\u652f\u6301\u3002\u53ea\u652f\u6301C\\\\C++\u3002<br/>\u7edf\u8ba1\u5b66\u5bb6Lunk\u6240\u5c45\u4f4f\u7684\u57ce\u5e02\u906d\u5230\u7684\u8f6f\u65af\u5170\u56fd\u7684\u7a7a\u88ad\uff0c\u5f04\u5f97Lunk\u5fc3\u795e\u4e0d\u5b9a\u3002<br/>\u7136\u800c\u4f1f\u5927\u7684\u7edf\u8ba1\u5b66\u5bb6\u600e\u4e48\u4f1a\u5c31\u56e0\u4e3a\u7a7a\u88ad\u800c\u56db\u5904\u907f\u96be\u5462\uff1fLunk\u51b3\u5b9a\u5f04\u51fa\u4e2a\u5927\u65b0\u95fb\u3002<br/>\u7531\u4e8e\u5404\u79cd\u539f\u56e0\uff0cLunk\u6240\u5c45\u4f4f\u7684\u57ce\u5e02\u7684\u5e02\u533a\u7684\u5f62\u72b6\u5341\u5206\u5947\u602a\u3002Lunk\u5c06\u5176\u5927\u81f4\u7684\u8f6e\u5ed3\u753b\u5728\u5730\u56fe\u4e0a\uff0c\u5f62\u6210\u4e86\u4e00\u4e2a\u591a\u8fb9\u5f62\u7684\u5f62\u72b6\u3002\u8f6f\u65af\u5170\u56fd\u7684\u98de\u673a\u6bcf\u4e22\u4e0b\u4e00\u679a\u70b8\u5f39\uff0cLunk\u5c31\u4f1a\u9a6c\u4e0a\u89c2\u6d4b\u5230\u70b8\u5f39\u7684\u4f4d\u7f6e\uff0c\u5e76\u5c06\u5176\u753b\u5728\u5730\u56fe\u4e0a\u3002\u4f46\u662f\uff0c\u4ed6\u6240\u60f3\u8981\u7edf\u8ba1\u7684\u53ea\u662f\u667a\u969c\u7684\u8f6f\u65af\u5170\u56fd\u6709\u591a\u5c11\u679a\u70b8\u5f39\u653b\u51fb\u5230\u4e86\u5e02\u533a\u3002<br/>\u4e8e\u662fLunk\u653e\u5f03\u4e86\u5728\u5730\u56fe\u4e0a\u753b\u4e0b\u6bcf\u4e00\u4e2a\u70b8\u5f39\u7684\u4f4d\u7f6e\uff0c\u800c\u662f\u8f6c\u800c\u5728\u5730\u4e0b\u5ba4\u91cc\u76f4\u63a5\u7edf\u8ba1\u3002<br/>\u73b0\u5728\u5b83\u6240\u9700\u8981\u7684\u5c31\u662f\u4e00\u4e2a\u80fd\u5e2e\u4ed6\u7edf\u8ba1\u7684\u7a0b\u5e8f\u3002\u4ed6\u5e0c\u671b\u80fd\u5728\u4f60\u4eec\u5199\u7684\u7a0b\u5e8f\u4e2d\u9009\u51fa\u4e00\u4e2a\u7cbe\u786e\u5ea6\u9ad8\u5e76\u4e14\u8dd1\u5f97\u6bd4\u9999\u6e2f\u8bb0\u8005\u8fd8\u5feb\u7684\u7a0b\u5e8f\u6765\u5e2e\u52a9\u5b83\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\u3002<br/>\u6211\u8be5\u5982\u4f55\u7f16\u5199\u8fd9\u4e2a\u7a0b\u5e8f<br/>\u9009\u624b\u76ee\u5f55\u4e0b\u5c06\u4f1a\u4e0b\u53d1interface.h\u8fd9\u4e2a\u6587\u4ef6\u3002<br/>\u4f60\u9700\u8981\u5b9e\u73b0interface.h\u4e2d\u7684\u63a5\u53e3\u3002<br/>\u4f60\u9700\u8981\u5728\u540c\u4e00\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6airstrike.cpp\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a<br/>1<br/>2<br/>3#include \\ interface.h\\ <br/><br/>// \u5b9e\u73b0\u90e8\u5206<br/><br/><br/>\u4f60\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\u5728\u5934\u6587\u4ef6\u4e2d\u6709\u7b80\u8981\u8bf4\u660e\u3002\u8fd9\u91cc\u505a\u8be6\u7ec6\u8bf4\u660e\u3002<br/>1void initialize(const double *x, const double *y, const size_t n, const int id);<br/><br/><br/>\u662f\u8f7d\u5165\u7a0b\u5e8f\u7684\u5165\u53e3\u3002\u5728\u8fdb\u884c\u67e5\u8be2\u4e4b\u524d\uff0c\u4f1a\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u3002<br/>\u8f7d\u5165\u6240\u7528\u7684\u65f6\u95f4\u4e0d\u4f1a\u8ba1\u5165\u4f60\u7684\u7a0b\u5e8f\u7528\u65f6\u3002\u4f46\u662f\u8f7d\u5165\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc7$3\\\\text{s}$\u3002<br/>x\u548cy\u662f\u4e24\u4e2a\u6570\u7ec4\uff0c\u7ed9\u51fa\u7684\u662f\u5e02\u533a\u7684\u8f6e\u5ed3\uff0c\u5373Lunk\u7ed8\u5236\u7684\u591a\u8fb9\u5f62\u7684\u9876\u70b9\uff0c\u6309\u7167\u9006\u65f6\u9488\u987a\u5e8f\u7ed9\u51fa\u3002<br/>n\u662f\u591a\u8fb9\u5f62\u7684\u9876\u70b9\u6570\u91cf\u3002<br/>id\u662f\u5f53\u524d\u6570\u636e\u70b9\u7684\u6807\u53f7\uff0c\u5728\u4e0b\u6587\u4f1a\u6709\u89e3\u91ca\u3002<br/>1bool query(const double dx, const double dy);<br/><br/><br/>\u662fLunk\u7684\u64cd\u4f5c\uff0c\u6bcf\u6b21\u8c03\u7528\u5373\u67e5\u8be2\u70b8\u5f39\u662f\u5426\u70b8\u5728\u5e02\u533a\u5185\u3002\u5982\u679c\u70b8\u5728\u5e02\u533a\u5185\u5219\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002<br/>dx\u548cdy\u662f\u70b8\u5f39\u70b8\u5230\u7684\u5750\u6807\u3002<br/>\u8be5\u51fd\u6570\u7684\u7528\u65f6\u4f1a\u88ab\u8ba1\u5165\u7a0b\u5e8f\u7528\u65f6\u3002<br/>1void finalize();<br/><br/><br/>\u662f\u7ed3\u675f\u7a0b\u5e8f\u3002\u8fd9\u4e2a\u51fd\u6570\u5c06\u5728\u6240\u6709\u67e5\u8be2\u4efb\u52a1\u5b8c\u6210\u540e\u8c03\u7528\u3002<br/>\u7528\u4e8e\u91ca\u653e\u4f60\u7684\u7a0b\u5e8f\u6240\u7528\u7684\u8d44\u6e90\u3002<br/>\u8be5\u51fd\u6570\u7684\u7528\u65f6\u4e0d\u4f1a\u8ba1\u5165\u7a0b\u5e8f\u7528\u65f6\uff0c\u4f46\u662f\u5176\u8fd0\u884c\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc7$3\\\\text{s}$\u3002<br/>\u6ce8\u610f\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528delete[]\u5220\u9664\u6389\u4e4b\u524dinitialize\u53c2\u6570\u4e2d\u7ed9\u4f60\u7684\u9876\u70b9\u6570\u7ec4\uff0c\u5426\u5219\u540e\u679c\u81ea\u8d1f\u3002<br/>\u6211\u8be5\u5982\u4f55\u6d4b\u8bd5\u8fd9\u4e2a\u7a0b\u5e8f<br/>\u9009\u624b\u76ee\u5f55\u4e0b\u5c06\u4f1a\u4e0b\u53d1main.cpp\u8fd9\u4e2a\u6587\u4ef6\u3002<br/>\u9996\u5148\u4f60\u9700\u8981\u6709\u8f93\u5165\u7684\u6570\u636e\uff0c\u5176\u683c\u5f0f\u5c06\u5728\u4e0b\u6587\u7ed9\u51fa\u3002<br/>\u5047\u8bbe\u4f60\u7684\u7a0b\u5e8f\u6587\u4ef6\u662fairstrike.cpp\uff0c\u90a3\u4e48\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u7f16\u8bd1\uff1a<br/>1g++ main.cpp airstrike.cpp -std=c++11 -o main<br/><br/><br/>\u6216\u8005\u4f60\u9700\u8981\u8c03\u8bd5\uff1a<br/>1g++ main.cpp airstrike.cpp -std=c++11 -o main -g<br/><br/><br/>\u6253\u5f00-O2\u4f18\u5316\uff1a<br/>1g++ main.cpp airstrike.cpp -std=c++11 -o main -O2<br/><br/><br/>\u5bf9\u4e8eC\u8bed\u8a00\uff0c\u5c06main.cpp\u6539\u540d\u4e3amain.c\uff0c\u4f7f\u7528gcc\uff0c\u5e76\u4e14\u5c06-std=c++11\u6539\u4e3a-std=c11\u5373\u53ef\u3002<br/>\u7136\u540e\u4f7f\u7528\uff1a<br/>1./main<br/><br/><br/>\u6765\u8fd0\u884c\u7a0b\u5e8f\u3002<br/>\u5982\u679c\u9700\u8981\u4f7f\u7528\u6587\u4ef6\u8f93\u5165\u8f93\u51fa\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\uff0c\u4e5f\u53ef\u4ee5\u4fee\u6539main.cpp\uff0c\u5c06\u5176\u4e2d\u7684\u4e24\u884c\u5e26\u6709\u6ce8\u91ca\u7684freopen\u53d6\u6d88\u6ce8\u91ca\uff0c\u7136\u540e\u91cd\u65b0\u7f16\u8bd1\u5373\u53ef\u3002<br/>\u6ce8\u610f\uff0c\u8be5\u7a0b\u5e8f\u4e0d\u4f1a\u6d4b\u8bd5\u4f60\u7684\u7528\u65f6\u5e76\u7ed9\u4f60\u8bc4\u5206\u3002\u5e76\u4e14\u4e0e\u6700\u7ec8\u8bc4\u6d4b\u65f6\u7684\u8fd0\u884c\u7a0b\u5e8f\u4e0d\u540c\u3002<br/>\u8f93\u5165\u683c\u5f0f<br/>\u6b64\u5904\u7684\u8f93\u5165\u683c\u5f0f\u662f\u6839\u636e\u4e0a\u9762\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u6240\u8bf4\u7684\u3002<br/>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6574\u6570$n$\u548c$d$\uff0c\u8868\u793a\u9876\u70b9\u6570\u91cf\u548c\u6570\u636e\u7f16\u53f7\u3002<br/>\u4e0b\u9762$n$\u884c\u63cf\u8ff0\u5e02\u533a\uff0c\u6bcf\u4e00\u884c\u7ed9\u51fa\u4e00\u4e2a\u6574\u70b9$(x,\\\\;y)$\uff0c\u8868\u793a\u4e00\u4e2a\u9876\u70b9\u3002<br/>\u4e4b\u540e\u7ed9\u51fa\u82e5\u5e72\u884c\uff0c\u4e00\u76f4\u5230\u6587\u4ef6\u5c3e\uff0c\u6bcf\u884c\u7ed9\u51fa\u4e00\u4e2a\u6574\u70b9$(x_q,\\\\;y_q)$\uff0c\u8868\u793a\u70b8\u5f39\u7684\u4f4d\u7f6e\u3002<br/>\u8f93\u51fa\u683c\u5f0f<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2aLunk\u7684\u8be2\u95ee\uff0c\u8f93\u51fa\u5bf9\u5e94\u7684\u4fe1\u606f (YES\u6216NO)\u3002<br/>\u6837\u4f8b\u8f93\u51651<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>93 1<br/>0 0<br/>6 1<br/>8 7<br/><br/>6 5<br/>2 7<br/>8 1<br/>3 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa1<br/>1<br/>2<br/>3<br/>4YES<br/>NO<br/>NO<br/>YES<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca1<br/>\u6837\u4f8b\u8f93\u51651\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u6837\u4f8b\u8f93\u51652<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>157 1<br/>1 1<br/>7 1<br/>4 2<br/>3 4<br/>7 5<br/>5 6<br/>1 6<br/><br/>0 4<br/>2 4<br/>4 4<br/>5 3<br/>5 5<br/>3 1<br/><br/><br/>\u6837\u4f8b\u8f93\u51fa2<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6NO<br/>YES<br/>NO<br/>NO<br/>YES<br/>YES<br/><br/><br/>\u6837\u4f8b\u89e3\u91ca2<br/>\u6837\u4f8b\u8f93\u51652\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u6570\u636e\u9650\u5236<br/>\u5171$7$\u4e2a\u6570\u636e\u6d4b\u8bd5\u70b9\uff0c\u9650\u5236\u5982\u4e0b\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>$n$\u7684\u89c4\u6a21<br/>\u7279\u6b8a\u9650\u5236<br/><br/><br/><br/><br/>$1$<br/>$\\\\le 10$<br/>\u65e0<br/><br/><br/>$2$<br/>$\\\\le 10^3$<br/>\u65e0<br/><br/><br/>$3$<br/>$\\\\le 10^5$<br/>\u65e0<br/><br/><br/>$4$<br/>$\\\\le 2 \\\\times 10^5$<br/>\u65e0<br/><br/><br/>$5$<br/>$\\\\le 10^6$<br/>\u5de6\u53f3\u7684\u8fb9\u4e0e$y$\u8f74\u5e73\u884c\uff0c\u4e0b\u8fb9\u4e0e$x$\u8f74\u5e73\u884c\uff0c\u4e0a\u8fb9\u9876\u70b9$x$\u9012\u589e\uff0c\u5747\u9ad8\u4e8e\u4e0b\u8fb9\uff0c\u8f93\u5165\u6570\u636e\u4ece\u5de6\u4e0b\u89d2\u5f00\u59cb\u3002<br/><br/><br/>$6$<br/>$\\\\le 10^6$<br/>\u51f8\u591a\u8fb9\u5f62<br/><br/><br/>$7$<br/>$\\\\le 10^3$<br/>$0 \\\\le x,\\\\;y \\\\le 10^3$<br/><br/><br/><br/>\u5bf9\u4e8e$100\\\\% $\u7684\u6570\u636e\uff0c\u6ee1\u8db3$3 \\\\le n \\\\le 10^6,\\\\;|x|,\\\\;|y|,\\\\;|x_q|,\\\\;|y_q| \\\\le 10^9$\u3002<br/>\u9876\u70b9\u6309\u7167\u9006\u65f6\u9488\u987a\u5e8f\u8f93\u5165\uff0c\u6ca1\u6709\u4e24\u4e2a\u9876\u70b9\u4e00\u6837\uff0c\u5e76\u4e14\u4e3a\u7b80\u5355\u591a\u8fb9\u5f62\u3002<br/>\u8bc4\u5206\u6807\u51c6<br/>\u5bf9\u4e8e\u4e0d\u540c\u7684\u6570\u636e\u70b9\uff0c\u5206\u503c\u548c\u65f6\u95f4\u9650\u5236\u5982\u4e0b\u8868\u6240\u793a\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>\u5206\u503c<br/>\u65f6\u95f4\u9650\u5236<br/><br/><br/><br/><br/>$1$<br/>$5$<br/>$0.1\\\\text{s}$<br/><br/><br/>$2$<br/>$10$<br/>$1\\\\text{s}$<br/><br/><br/>$3$<br/>$15$<br/>$1\\\\text{s}$<br/><br/><br/>$4$<br/>$30$<br/>$1\\\\text{s}$<br/><br/><br/>$5$<br/>$10$<br/>$1\\\\text{s}$<br/><br/><br/>$6$<br/>$15$<br/>$1\\\\text{s}$<br/><br/><br/>$7$<br/>$15$<br/>$1\\\\text{s}$<br/><br/><br/><br/>\u5728\u65f6\u95f4\u9650\u5236\u5185\uff0c\u5982\u679c\u7a0b\u5e8f\u4e0d\u51fa\u610f\u5916 (\u5982\u8fd0\u884c\u65f6\u9519\u8bef)\uff0c\u5c06\u4f1a\u4e0d\u65ad\u7684\u7ed9\u51fa\u8be2\u95ee\u3002\u8bbe\u4f60\u7684\u7a0b\u5e8f\u5b8c\u6210\u7684\u8be2\u95ee\u4e2a\u6570\u4e3a$x$\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u7684\u8bc4\u5206\u6807\u51c6\u5982\u4e0b\uff1a<br/><br/><br/><br/>\u6570\u636e\u7f16\u53f7<br/>$20\\\\% $<br/>$40\\\\% $<br/>$60\\\\% $<br/>$80\\\\% $<br/>$100\\\\% $<br/><br/><br/><br/><br/>$1$<br/>$\\\\ge 10^5$<br/>$\\\\ge 2\\\\times 10^5$<br/>$\\\\ge 3 \\\\times 10^5$<br/>$\\\\ge 4 \\\\times 10^5$<br/>$\\\\ge 5 \\\\times 10^5$<br/><br/><br/>$2$<br/>$\\\\ge 5 \\\\times 10^4$<br/>$\\\\ge 10^5$<br/>$\\\\ge 2 \\\\times 10^6$<br/>$\\\\ge 3 \\\\times 10^6$<br/>$\\\\ge 4 \\\\times 10^6$<br/><br/><br/>$3$<br/>$\\\\ge 5 \\\\times 10^2$<br/>$\\\\ge 10^3$<br/>$\\\\ge 2 \\\\times 10^5$<br/>$\\\\ge 4 \\\\times 10^5$<br/>$\\\\ge  5 \\\\times 10^5$<br/><br/><br/>$4$<br/>$\\\\ge 10^3$<br/>$\\\\ge 1 \\\\times 10^5$<br/>$\\\\ge 2 \\\\times 10^5$<br/>$\\\\ge 3 \\\\times 10^5$<br/>$\\\\ge 4 \\\\times 10^5$<br/><br/><br/>$5$<br/>$\\\\ge 10^3$<br/>$\\\\ge 8 \\\\times 10^5$<br/>$\\\\ge 10^6$<br/>$\\\\ge 1.2 \\\\times 10^6$<br/>$\\\\ge 1.4 \\\\times 10^6$<br/><br/><br/>$6$<br/>$\\\\ge 5 \\\\times 10^2$<br/>$\\\\ge 8 \\\\times 10^5$<br/>$\\\\ge 10^6$<br/>$\\\\ge 1.2 \\\\times 10^6$<br/>$\\\\ge 1.4 \\\\times 10^6$<br/><br/><br/>$7$<br/>$\\\\ge 10^6$<br/>$\\\\ge 2 \\\\times 10^6$<br/>$\\\\ge 3 \\\\times 10^6$<br/>$\\\\ge 4 \\\\times 10^6$<br/>$\\\\ge 10^7$<br/><br/><br/><br/>\u4f60\u7684$x$\u9700\u8981\u8fbe\u5230\u5bf9\u5e94\u7684\u8981\u6c42\u624d\u80fd\u5f97\u5230\u5bf9\u5e94\u7684\u767e\u5206\u6bd4\u3002\u8bc4\u6d4b\u7a0b\u5e8f\u5c06\u9009\u53d6\u4f60\u80fd\u8fbe\u5230\u7684\u6700\u9ad8\u7684\u767e\u5206\u6bd4\u3002<br/>\u5176\u4e2d\u767e\u5206\u6bd4\u662f\u5c06\u8be5\u70b9\u603b\u5206\u4e58\u4e0a\u8be5\u767e\u5206\u6bd4\u5e76\u5411\u4e0b\u53d6\u6574\uff0c\u4f5c\u4e3a\u4f60\u8be5\u70b9\u7684\u5206\u6570\u3002<br/>\u5982\u679c\u8be2\u95ee\u56de\u7b54\u9519\u8bef\uff0c\u5c06\u6bcf\u56de\u7b54\u9519\u8bef\u4e00\u6b21\u6263\u9664$1$\u5206\uff0c\u6263\u5206\u5230$0$\u5206\u4e3a\u6b62\uff0c\u5206\u6570\u4e0d\u4f1a\u53d8\u4e3a\u8d1f\u6570\u3002<br/>\u5982\u679c\u53d1\u751f\u8fd0\u884c\u65f6\u9519\u8bef\uff0c\u6216\u8005\u8fd0\u884c\u4e25\u91cd\u8d85\u65f6\uff0c\u5c06\u5bfc\u81f4\u8be5\u70b9\u5f97$0$\u5206\u3002<br/>\u5982\u679c\u4f60\u7684initialize\u6216finalize\u8d85\u65f6\uff0c\u8be5\u70b9\u5f97$0$\u5206\u3002<br/>\u5173\u4e8e\u8bc4\u6d4b\u673a<br/>\u51fa\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0cGCC\u7f16\u8bd1\u51fa\u6765\u7684\u8bc4\u6d4b\u5668\u5e76\u4e0d\u662f\u5f88\u7a33\u5b9a\uff0c\u53ef\u80fd\u51fa\u73b0\u6210\u7ee9\u6ce2\u52a8\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8bc4\u6d4b\u65f6\u6700\u597d\u91c7\u7528Clang\u8fdb\u884c\u7f16\u8bd1\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4f1a\u7a33\u5b9a\u4e00\u4e9b\u3002<br/>\u5982\u679c\u4f60\u5bf9\u4f60\u7684\u7b97\u6cd5\u5341\u5206\u81ea\u4fe1\uff0c\u7136\u800c\u5728\u8bc4\u6d4b\u65f6\u5374\u6ca1\u6709\u5f97\u5230\u6ee1\u5206\uff0c\u53ef\u4ee5\u8fdb\u884c\u91cd\u6d4b\u3002<br/>\u6e29\u99a8\u63d0\u793a<br/>\u8bc4\u6d4b\u65f6\u9650\u5f88\u957f\uff0c\u8bf7\u4e0d\u8981\u6076\u610f\u5361\u8bc4\u6d4b\uff0c\u8c22\u8c22\u5408\u4f5c\uff01<br/>\u540e\u8bb0<br/>Lunk\u7684\u5b59\u5b50Lnk\u5b8c\u6210\u4e86\u8fd9\u4e2a\u5927\u65b0\u95fb\u3002<br/>\u65e0\u5956\u7ade\u731c\uff1aLnk\u662f\u8c01\uff1f<br/><br/>\u7b2c\u4e00\u6b21\u51fa\u4ea4\u4e92\u9898\uff0c\u795d\u4f60\u4eec\u65e9\u65e5AC\u8fd9\u4e2a\u667a\u969c\u9898\uff01QAQ<br/>",
"url": "blog/2016-8-25/airstrike.html"
},
"\u7f16\u8bd1\u5e76\u4f7f\u7528bgfx": {
"tags": "C/C++ \u56fe\u5f62 \u5f15\u64ce bgfx",
"text": "\u7f16\u8bd1\u5e76\u4f7f\u7528bgfx<br/>\u6700\u8fd1\u53d1\u73b0\u4e86\u4e00\u4e2a\u4f3c\u4e4e\u5f88\u597d\u7684\u56fe\u5f62\u5f15\u64cebgfx\u3002<br/>\u5b83\u662f\u4f7f\u7528C++\u8fdb\u884c\u7f16\u5199\u7684\uff0c\u4e5f\u6709C99\u7684\u63a5\u53e3\uff0c\u529f\u80fd\u8fd8\u6bd4\u8f83\u4e30\u5bcc\uff0c\u652f\u6301DirectX 9/11\u548cOpenGL 2.1+\u3002<br/>\u8fd9\u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u5e93\uff0c\u6211\u5728Ubuntu 14.04\u4e0a\u7f16\u8bd1\u4e86\u6210\u529f\u4e86\u3002<br/>\u7f16\u8bd1\u8fc7\u7a0b\u5341\u5206\u7b80\u5355\u3002\u672c\u6587\u5c31\u4ecb\u7ecdLinux\u4e0b\u7684\u7f16\u8bd1\u8fc7\u7a0b\u3002<br/>\u7f16\u8bd1<br/>\u8fd9\u91cc\u6211\u53ea\u5199\u4e86Linux\u7684\u7f16\u8bd1\u8fc7\u7a0b\uff0c\u5176\u4ed6\u5e73\u53f0\u6211\u8fd8\u6ca1\u8bd5\u8fc7\uff0c\u5177\u4f53\u53c2\u89c1bgfx\u2019s document\u3002<br/>\u9996\u5148\u9700\u8981\u7f16\u8bd1\u5668\u652f\u6301\uff0c\u786e\u4fdd\u4f60\u7684\u7f16\u8bd1\u5668\u6ee1\u8db3\u4e0b\u5217\u8981\u6c42\uff1a<br/><br/>Clang 3.3\u53ca\u4ee5\u4e0a  <br/>GCC 4.6\u53ca\u4ee5\u4e0a<br/><br/>\u540c\u65f6\u51c6\u5907\u4f9d\u8d56\u5e93\uff1a<br/>1sudo apt-get install libgl1-mesa-dev x11proto-core-dev libx11-dev<br/><br/><br/>\u7136\u540e\u4eceGitHub\u4e0a\u4e0b\u8f7d\u6e90\u7801\u3002\u56e0\u4e3abgfx\u4f9d\u8d56\u4e8ebx\uff0c\u56e0\u6b64\u6211\u4eec\u8fd8\u8981\u4e0b\u8f7dbx\uff1a<br/>1<br/>2<br/>3<br/>4cd ~/Downloads  # \u4e0b\u8f7d\u5230Downloads\u76ee\u5f55<br/>git clone git://github.com/bkaradzic/bx.git<br/>git clone git://github.com/bkaradzic/bgfx.git<br/>cd bgfx  # \u8fdb\u5165\u6e90\u7801\u76ee\u5f55\uff0c\u51c6\u5907\u7f16\u8bd1<br/><br/><br/>\u4f7f\u7528make\u751f\u6210\u5de5\u7a0b\uff1a<br/>1make<br/><br/><br/>\u63a5\u4e0b\u6765\u8fdb\u884c\u7f16\u8bd1\uff1a<br/>1make linux-release64<br/><br/><br/>\u63d0\u793a<br/>\u4f7f\u7528make\u8fd8\u53ef\u4ee5\u751f\u6210\u5176\u4ed6\u7248\u672c\u7684\uff0c\u5176\u683c\u5f0f\u662f\uff1a<br/><br/>wzxhzdk:4<br/><br/>\u4f8b\u5982\uff0c\u5982\u679c\u8981\u751f\u621032\u4f4d\u7684bgfx\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a<br/><br/>wzxhzdk:5<br/><br/><br/>\u5982\u679c\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u62a5\u9519\uff0c\u90a3\u4e48\u5728.build/\u6587\u4ef6\u5939\u4e0b\u4f1a\u6709\u5bf9\u5e94\u7684\u7f16\u8bd1\u540e\u7684\u6587\u4ef6\u3002<br/>\u8fd0\u884c\u6837\u4f8b<br/>bgfx\u63d0\u4f9b\u4e86\u5f88\u591a\u6837\u4f8b\uff0c\u7f16\u8bd1\u540e\u7684\u6837\u4f8b\u5728.build/\u5bf9\u5e94\u7684\u6587\u4ef6\u5939\u4e0b(\u6211\u7684\u5c31\u5728.build/linux64_gcc/bin/\u4e0b\uff09\uff0c\u5728\u76ee\u524dbgfx\u6ca1\u6709\u4ec0\u4e48\u6559\u7a0b\u7684\u60c5\u51b5\u4e0b\u662f\u5f88\u597d\u7684\u5b66\u4e60\u8d44\u6599\u3002<br/>\u7531\u4e8e\u6837\u4f8b\u9700\u8981\u5f88\u591a\u8d44\u6e90\u6587\u4ef6\uff08\u5982\u7740\u8272\u5668\u3001\u6750\u8d28\u4e4b\u7c7b\u7684\uff09\uff0c\u800c\u5b83\u4eec\u90fd\u5728exmaples/runtime\u76ee\u5f55\u4e0b\uff0c<br/>\u56e0\u6b64\u9700\u8981\u5728exmaples/runtime\u76ee\u5f55\u4e0b\u7528\u76f8\u5bf9\u8def\u5f84\u6765\u8fd0\u884c\u3002<br/>\u9996\u5148\u6211\u4eec\u5207\u6362\u5230\u6837\u4f8b\u7684\u76ee\u5f55\u3002\u5bf9\u6211\u800c\u8a00\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a<br/>1cd .build/linux64_gcc/bin/<br/><br/><br/>\u5982\u679c\u4f60\u7f16\u8bd1\u7684\u662f32\u4f4d\uff0c\u5c06\u4e0a\u9762\u768464\u6539\u621032\u5373\u53ef\u3002<br/>\u7136\u540e\u4f7f\u7528ls\u547d\u4ee4\u67e5\u770b\u6837\u4f8b\uff0c\u53ef\u4ee5\u770b\u5230\u76ee\u524d\u670928\u4e2a\u6837\u4f8b\uff08\u5305\u62ecHello, world!\uff09\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17example-00-helloworldRelease         example-17-drawstressRelease<br/>example-01-cubesRelease              example-18-iblRelease<br/>example-02-metaballsRelease          example-19-oitRelease<br/>example-03-raymarchRelease           example-20-nanovgRelease<br/>example-04-meshRelease               example-21-deferredRelease<br/>example-05-instancingRelease         example-22-windowsRelease<br/>example-06-bumpRelease               example-23-vectordisplayRelease<br/>example-07-callbackRelease           example-24-nbodyRelease<br/>example-08-updateRelease             example-25-c99Release<br/>example-09-hdrRelease                example-26-occlusionRelease<br/>example-10-fontRelease               example-27-terrainRelease<br/>example-11-fontsdfRelease            geometrycRelease<br/>example-12-lodRelease                libbgfxRelease.a<br/>example-13-stencilRelease            libbgfx-shared-libRelease.so<br/>example-14-shadowvolumesRelease      libexample-commonRelease.a<br/>example-15-shadowmaps-simpleRelease  shadercRelease<br/>example-16-shadowmapsRelease         texturecRelease<br/><br/><br/>\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u6837\u4f8b\u90fd\u5341\u5206\u5177\u6709\u4ee3\u8868\u6027\uff0c\u4eca\u540e\u7684\u5b66\u4e60\u5c31\u4ece\u5b83\u4eec\u5f00\u59cb\u3002<br/>\u540c\u65f6\u6ce8\u610f\u5230\uff0c\u6709\u4e24\u4e2a.a\u7684\u9759\u6001\u5e93\u548c\u4e00\u4e2a.so\u7684\u52a8\u6001\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u4eec\u6765\u7f16\u8bd1\u7a0b\u5e8f\u3002<br/>\u7136\u800c\u5e76\u4e0d\u662f\u5728\u8fd9\u91cc\u8fd0\u884c\u6837\u4f8b\uff0c\u6211\u4eec\u8981\u56de\u5230runtime\u76ee\u5f55\u6765\u8fd0\u884c\uff1a<br/>1cd ../../../examples/runtime<br/><br/><br/>\u5047\u5982\u8981\u8fd0\u884c00-helloworld\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a<br/>1../../.build/linux64_gcc/bin/example-00-helloworldRelease<br/><br/><br/>\u5982\u679c\u4e0d\u51fa\u610f\u5916\uff0c\u80fd\u770b\u5230\u4ee5\u4e0b\u7a97\u53e3\uff08\u56fe\u7247\u6765\u81eabgfx document\uff09\uff1a<br/><br/>bgfx\u7684\u6587\u6863\u4e5f\u7ed9\u51fa\u4e86\u6837\u4f8b\u7684\u5217\u8868\u3002<br/>\u7f16\u8bd1\u6211\u4eec\u81ea\u5df1\u7684bgfx\u7a0b\u5e8f<br/>\u4e3a\u4e86\u901a\u7528\u6027\uff0c\u8fd9\u91cc\u4f7f\u7528\u6700\u57fa\u7840\u7684\u7ec8\u7aef\u7f16\u8bd1\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u76f4\u63a5\u7528g++\u8fdb\u884c\u7f16\u8bd1\u3002<br/>\u9996\u5148\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u6765\u5b58\u653e\u6211\u4eec\u7684\u7a0b\u5e8f\uff1a<br/>1<br/>2mkdir my-first-bgfx<br/>cd my-first-bgfx<br/><br/><br/>\u7136\u540e\u5c06bgfx\u7684\u9759\u6001\u5e93\u590d\u5236\u8fc7\u6765\uff1a<br/>1cp [bgfx\u7684\u76ee\u5f55]/.build/linux64_gcc/bin/*.a .<br/><br/><br/>\u8fd9\u65f6\u76ee\u5f55\u4e0b\u4f1a\u591a\u51fa\u4e24\u4e2a.a\u6587\u4ef6\uff1a libbgfxRelease.a\u548clibexample-commonRelease.a<br/>\u9759\u6001\u5e93 vs \u52a8\u6001\u5e93<br/>\u6211\u4eec\u5728\u8fd9\u91cc\u9009\u7528\u4e86\u9759\u6001\u5e93\uff0c\u800c\u4e0d\u662f\u52a8\u6001\u5e93\uff0c\u662f\u8003\u8651\u4e86\u7528\u6237\u7684\u539f\u56e0\u3002<br/>\u56e0\u4e3abgfx\u6ca1\u6709\u4ec0\u4e48\u5f88\u65b9\u4fbf\u7684\u5b89\u88c5\u65b9\u6cd5\uff0c\u4f7f\u7528\u9759\u6001\u5e93\u5c31\u53ef\u4ee5\u907f\u514d\u5b89\u88c5\u7684\u8fc7\u7a0b\uff0c\u5c3d\u53ef\u80fd\u5c11\u7684\u5bf9\u7528\u6237\u7684\u7cfb\u7edf\u8fdb\u884c\u4fee\u6539\u3002<br/>\u5f53\u7136\uff0c\u4f7f\u7528\u9759\u6001\u5e93\u4f1a\u589e\u5927\u7a0b\u5e8f\u4f53\u79ef\u3002\u9759\u6001\u94fe\u63a5\u540e\uff0c\u6211\u4eec\u7684bgfx\u7a0b\u5e8f\u4f1a\u67093MB\u591a\u2026<br/><br/>\u7136\u540e\u9700\u8981\u5c06bgfx\u53ca\u5176\u4f9d\u8d56\u5e93\u7684bx\u7684\u5934\u6587\u4ef6\u7ed9\u590d\u5236\u8fdb\u6765\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8fd8\u5c06bgfx\u7528\u4e8e\u6837\u4f8b\u7684common\u5e93\u4e5f\u590d\u5236\u8fdb\u6765\uff1a<br/>1<br/>2<br/>3cp -rf [bgfx\u7684\u76ee\u5f55]/include/* .         # bgfx<br/>cp -rf [bgfx\u7684\u76ee\u5f55]/examples/common/ .  # bgfx-common<br/>cp -rf [bx\u7684\u76ee\u5f55]/include/* .           # bx<br/><br/><br/>\u4e0b\u9762\u6211\u4eec\u6765\u7167\u7740bgfx\u7684hello, world\u6765\u5199\u7b2c\u4e00\u4e2a\u7a0b\u5e8f\u3002\u6211\u4eec\u5c06\u4f1a\u5728\u7a97\u53e3\u7684\u5de6\u4e0a\u89d2\u6253\u51faHello, world!\u7684\u5b57\u6837\uff1a<br/>\u521b\u5efa\u7a0b\u5e8fmain.cpp\uff1a<br/>1<br/>2touch main.cpp<br/>[\u4f7f\u7528\u4f60\u7684\u7f16\u8f91\u5668] main.cpp<br/><br/><br/>\u9996\u5148\u6dfb\u52a0\u5934\u6587\u4ef6\uff1a<br/>1<br/>2<br/>3<br/>4#include <cstdint>  // uint32_t<br/><br/>#include \\ bgfx/bgfx.h\\       // bgfx<br/>#include \\ common/common.h\\   // bgfx-common<br/><br/><br/>\u7136\u540e\u6dfb\u52a0_main_\u51fd\u6570\u3002\u6ce8\u610f\u4e4b\u6240\u4ee5\u662f_main_\u800c\u4e0d\u662fmain\uff0c\u662f\u56e0\u4e3abgfx\u7684common\u5e93\u4e3a\u4e86\u66f4\u597d\u7684\u5904\u7406\u4ee5\u5df2\u7ecf\u5c06main\u5b9e\u73b0\u4e86\uff0c<br/>\u4e8e\u662f\u8bbe\u7f6e_main_\u4f5c\u4e3a\u7a0b\u5e8f\u5165\u53e3\u3002<br/>1<br/>2<br/>3int _main_(int argc, char *argv[]) {<br/>    /* \u4ee3\u7801 */<br/>}<br/><br/><br/>\u5728_main_\u51fd\u6570\u5185\uff0c\u6211\u4eec\u5148\u505a\u4e00\u4e9b\u8bbe\u5b9a\uff1a<br/>1<br/>2<br/>3<br/>4uint32_t width  = 1280;              // \u7a97\u53e3\u5bbd\u5ea6<br/>uint32_t height = 720;               // \u7a97\u53e3\u9ad8\u5ea6<br/>uint32_t debug  = BGFX_DEBUG_TEXT;   // debug\u6a21\u5f0f\u5f00\u542f\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u7a97\u53e3\u8f93\u51fa\u6587\u5b57<br/>uint32_t reset  = BGFX_RESET_VSYNC;  // \u8bbe\u7f6e\u5782\u76f4\u540c\u6b65<br/><br/><br/>\u6ce8\u610f<br/>\u4f3c\u4e4ewidth\u548cheight\u7684\u8bbe\u7f6e\u662f\u6ca1\u6709\u7528\u7684\uff0c\u4f3c\u4e4e\u65e0\u8bba\u8bbe\u4e3a\u591a\u5c11\uff0c\u6253\u5f00\u540e\u90fd\u4f1a\u53d8\u62101280x720\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u662f\u4e3a\u4ec0\u4e48...<br/>\u5982\u679c\u4f60\u4e5f\u51fa\u73b0\u4e86\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e0d\u8981\u60ca\u614c\uff0c\u4e0d\u8981\u5bb3\u6015...<br/><br/>\u4e0b\u9762\u662f\u52a0\u8f7dbgfx\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10bgfx::init();                             // \u8f7d\u5165<br/>bgfx::reset(width, height, reset);        // \u8bbe\u7f6e<br/>bgfx::setDebug(debug);                    // \u542f\u7528\u8c03\u8bd5<br/>bgfx::setViewClear(                       // \u8bbe\u7f6e\u6e05\u7a7a\u7684\u72b6\u6001<br/>    0,                                    // bgfx\u4e2d\u6709View\u7684\u6982\u5ff5\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662fView 0<br/>    BGFX_CLEAR_COLOR | BGFX_CLEAR_DEPTH,  // \u8868\u793a\u8981\u6e05\u7a7a\u989c\u8272\u7f13\u51b2\u548c\u6df1\u5ea6\u7f13\u51b2<br/>    0xFFFFFFFF,                           // \u989c\u8272\u7f13\u51b2\u7684\u6e05\u7a7a\u503c\uff0c0xFFFFFFFF\u662f\u767d\u8272<br/>    1.0f,                                 // \u6df1\u5ea6\u7f13\u51b2\u7684\u6e05\u7a7a\u503c\uff0c\u9ed8\u8ba4\u4e3a1.0f<br/>    0                                     // \u6a21\u677f\u7f13\u51b2\u7684\u6e05\u7a7a\u503c\uff0c\u9ed8\u8ba4\u4e3a0<br/>);<br/><br/><br/>\u63a5\u4e0b\u6765\u5c31\u662f\u6e32\u67d3\u4e86\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u5faa\u73af\u540c\u65f6\u5904\u7406\u4e8b\u4ef6\u548c\u6e32\u67d3\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15// entry::processEvents\u662fcommon\u5e93\u4e00\u4e2a\u5f88\u65b9\u4fbf\u7684\u51fd\u6570<br/>// \u5b83\u80fd\u5e2e\u6211\u4eec\u5904\u7406\u51e0\u4e4e\u6240\u6709\u7684\u7a97\u53e3\u4e8b\u4ef6\u3002<br/>// \u5982\u679c\u7a97\u53e3\u5927\u5c0f\u6709\u53d8\u5316\uff0cwidth\u548cheight\u7684\u503c\u5c31\u4f1a\u53d8\u5316<br/>// \u5982\u679c\u7a97\u53e3\u88ab\u5173\u95ed\uff0c\u5c31\u4f1a\u8fd4\u56detrue<br/>while (not entry::processEvents(width, height, debug, reset)) {<br/>    bgfx::setViewRect(0, 0, 0, width, height);  // \u7531\u4e8e\u7a97\u53e3\u5927\u5c0f\u4f1a\u53d8\u5316\uff0c\u56e0\u6b64\u8fd9\u91cc\u8981\u91cd\u65b0\u8bbe\u7f6e<br/><br/>    bgfx::touch(0);  // \u5207\u6362\u5230View 0<br/><br/>    bgfx::dbgTextClear();                                                      // \u6e05\u7a7a\u8c03\u8bd5\u8f93\u51fa\u7684\u6587\u5b57<br/>    bgfx::dbgTextPrintf(0, 0, 0x4F, \\ Hello, world!\\ );                          // \u6253\u5370\\ Hello, world!\\ <br/>    bgfx::dbgTextPrintf(0, 1, 0x4F, \\ width = % d, height = % d\\ , width, height); // \u8f93\u51fa\u7a97\u53e3\u5927\u5c0f<br/><br/>    bgfx::frame();  // \u63d0\u4ea4\u6240\u6709\u7684\u6e32\u67d3\u64cd\u4f5c\uff0c\u51c6\u5907\u5207\u6362\u5230\u4e0b\u4e00\u5e27<br/>}<br/><br/><br/>\u6ce8\u610f<br/>\u5728\u51fd\u6570bgfx::dbgTextPrintf\u4e2d\uff0c\u7b2c\u4e09\u4e2a\u53c2\u6570\u662f\u8bbe\u7f6e\u6587\u5b57\u7684\u524d\u666f\u8272\u548c\u80cc\u666f\u8272\u3002<br/>\u5176\u4e2d\uff0cbgfx\u75280-F\u4f5c\u4e3a\u989c\u8272\u7684\u6807\u8bb0\u3002\u5728\u4e0a\u9762\u4e24\u4f4d\u7684\u5341\u516d\u8fdb\u5236\u6570\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u6307\u5b9a\u80cc\u666f\u8272\uff0c\u7b2c\u4e8c\u4e2a\u5236\u5b9a\u524d\u666f\u8272\u3002<br/>\u8fd9\u91cc\u5c06\u8fd9\u4e9b\u989c\u8272\u6807\u8bb0\u5217\u51fa\u6765\uff1a<br/>0: \u65e0\u8272<br/>1: \u6697\u7ea2\u8272  2: \u6697\u7eff\u8272  3: \u9ec4\u8272\uff0c<br/>4: \u84dd\u8272\uff0c  5: \u7d2b\u8272\uff0c  6: \u6df1\u84dd\u8272<br/>7: \u7070\u8272\uff0c  8: \u6df1\u7070\u8272  9: \u7ea2\u8272\uff0c<br/>A: \u5ae9\u7eff\u8272  B: \u7c73\u9ec4\u8272  C: \u6d45\u84dd\u8272<br/>D: \u6d45\u7d2b\u8272  E: \u5929\u84dd\u8272  F: \u767d\u8272<br/><br/>\u6700\u540e\uff0c\u5f53\u7a97\u53e3\u5173\u95ed\u65f6\uff0centry::processEvents\u5c31\u4f1a\u8fd4\u56detrue\uff0c\u4e8e\u662f\u9000\u51fa\u5faa\u73af\uff0c\u6700\u540e\u8981\u9000\u51fabgfx\uff1a<br/>1bgfx::shutdown();<br/><br/><br/>\u73b0\u5728\u6765\u7f16\u8bd1main.cpp\uff1a<br/>1g++ -std=c++11 main.cpp -o exec -L. -lbgfxRelease -lexample-commonRelease -lpthread -lGL -lX11<br/><br/><br/>\u6ce8\u610f\u7f16\u8bd1\u5668\u8981\u6253\u5f00C++11\u652f\u6301\uff0c\u5982\u679c\u4f60\u7684\u7f16\u8bd1\u5668\u4e0d\u652f\u6301C++11\uff0c\u90a3\u6211\u5f88\u597d\u5947\u4f60\u662f\u600e\u4e48\u628abgfx\u7f16\u8bd1\u6210\u529f\u7684\u3002<br/>-lpthread\u3001-lGL\u548c-lX11\u662fbgfx\u4f9d\u8d56\u7684\u5e93\uff0c\u5206\u522b\u662fPOSIX\u7ebf\u7a0b\u5e93\u3001OpenGL\u5e93\u548cX11\u5e93\u3002<br/>\u5982\u679c\u6ca1\u6709\u9519\u8bef\u62a5\u51fa\uff0c\u8fd0\u884cexec\u5c31\u80fd\u770b\u5230\u4ee5\u4e0b\u7a97\u53e3\uff1a<br/>1./exec<br/><br/><br/><br/>\u5982\u679c\u4f60\u51fa\u73b0\u4e86\u4ec0\u4e48\u610f\u5916\uff0c\u4e0b\u9762\u8d34\u51fa\u4e86\u5b8c\u6574\u7684\u7a0b\u5e8f\u7528\u4e8e\u5bf9\u7167\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36#include <cstdint>  // uint32_t<br/><br/>#include \\ bgfx/bgfx.h\\ <br/>#include \\ common/common.h\\ <br/><br/>int _main_(int argc, char *argv[]) {<br/>    uint32_t width = 1280;<br/>    uint32_t height = 720;<br/>    uint32_t debug = BGFX_DEBUG_TEXT;<br/>    uint32_t reset = BGFX_RESET_VSYNC;<br/><br/>    bgfx::init();<br/>    bgfx::reset(width, height, reset);<br/>    bgfx::setDebug(debug);<br/>    bgfx::setViewClear(<br/>        0,<br/>        BGFX_CLEAR_COLOR | BGFX_CLEAR_DEPTH,<br/>        0xFFFFFFFF,<br/>        1.0f,<br/>        0<br/>    );<br/><br/>    while (not entry::processEvents(width, height, debug, reset)) {<br/>        bgfx::setViewRect(0, 0, 0, width, height);<br/><br/>        bgfx::touch(0);<br/><br/>        bgfx::dbgTextClear();<br/>        bgfx::dbgTextPrintf(0, 0, 0x4F, \\ Hello, world!\\ );<br/>        bgfx::dbgTextPrintf(0, 1, 0x4F, \\ width = % d, height = % d\\ , width, height);<br/><br/>        bgfx::frame();<br/>    }<br/><br/>    bgfx::shutdown();<br/>}<br/><br/><br/>\u81f3\u6b64\uff0c\u6211\u4eec\u7684\u7b2c\u4e00\u4e2abgfx\u7a0b\u5e8f\u5c31\u5b8c\u6210\u4e86\u3002\u89e3\u51b3\u4e86\u7f16\u8bd1\u7684\u95ee\u9898\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5b66\u4e60\u4f7f\u7528bgfx\u4e86\u3002",
"url": "blog/2016-2-3/learn-bgfx-1.html"
},
"\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14": {
"tags": "\u6570\u5b66 \u7ec4\u5408\u6570\u5b66 \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14",
"text": "\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14<br/><br/>\u6211\u628a\u300a\u7ec4\u5408\u6570\u5b66\u300b\u6284\u4e86\u4e00\u904d\uff0c\u514d\u5f97\u6211\u8bb0\u4e0d\u4f4f......<br/><br/>\u504f\u5e8f\u96c6<br/>\u8fd9\u91cc\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u662f\u4ece\u5173\u8054\u4ee3\u6570\u7684\u89d2\u5ea6\u6765\u4ecb\u7ecd\u7684\u3002\u9996\u5148\u4ecb\u7ecd\u4e00\u4e2a\u57fa\u7840\u7684\u6982\u5ff5\uff1a\u504f\u5e8f\u96c6\u3002<br/>\u5b83\u901a\u5e38\u5199\u4f5c$(X_n,\\\\;\\\\leqslant)$\uff0c\u5176\u4e2d$X_n$\u662f\u4e00\u4e2a\u6709\u9650\u6216\u8005\u65e0\u9650\u7684\u96c6\u5408\uff0c$\\\\leqslant$\u662f\u4ee3\u6307\u504f\u5e8f\u5173\u7cfb\uff0c\u800c\u4e0d\u662f\u7279\u6307\u5c0f\u4e8e\u7b49\u4e8e\u7b26\u53f7\u3002<br/>\u6240\u8c13\u504f\u5e8f\u5173\u7cfb\uff0c\u5c31\u662f\u6307$a,\\\\;b,\\\\;c \\\\in X_n$\u5e76\u4e14$a \\\\leqslant b,\\\\;b \\\\leqslant c$\uff0c\u6709$a \\\\leqslant c$\u7684\u6027\u8d28\u7684\u5173\u7cfb\u3002<br/>\u8fd9\u79cd\u504f\u5e8f\u5173\u7cfb\u4e00\u822c\u662f\u6bd4\u8f83\u7b26$\\\\leqslant$\u3001\u96c6\u5408\u7684$\\\\subseteq$\u7b26\u53f7\u548c\u6574\u9664$\\\\;\\\\mid\\\\;$\u3002<br/>\u5377\u79ef<br/>\u5bf9\u4e8e\u5b9a\u4e49\u5728\u504f\u5e8f\u96c6$(X_n,\\\\;\\\\leqslant)$\u4e0a\u7684\u4e8c\u5143\u51fd\u6570$f(x,\\\\;y)$\uff0c\u6211\u4eec\u5047\u5b9a\u5f53$x \\\\not\\\\leqslant y$\u65f6\uff0c$f(x,\\\\;y)$\u5747\u4e3a$0$\uff0c\u8fd9\u6837\u662f\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u4e4b\u540e\u7684\u8ba8\u8bba\u3002<br/>\u8003\u8651\u504f\u5e8f\u96c6$(X_n, \\\\leqslant)$\u4e0a\u7684\u4e8c\u5143\u51fd\u6570$f(x,\\\\;y)$\u548c$g(x,\\\\;y)$\uff0c\u5b9a\u4e49\u5b83\u4eec\u7684\u5377\u79ef\u4e3a\uff1a<br/>$$<br/>(f \\\\times g)(x,\\\\;y) = \\\\sum_{x \\\\leqslant z \\\\leqslant y} f(x,\\\\;z)g(z,\\\\;y) \\\\tag{2.1}<br/>$$<br/>\u8fd9\u4e2a\u5377\u79ef\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff1a<br/>$$<br/>(f \\\\times g) \\\\times h = f \\\\times (g \\\\times h) \\\\tag{2.2}<br/>$$<br/>\u6ce8\u610f\uff0c\u8fd9\u4e2a\u5377\u79ef\u4e0d\u4e00\u5b9a1\u6ee1\u8db3\u4ea4\u6362\u5f8b\u3002<br/>\u4ee5\u53ca\u4e09\u79cd\u5f3a\u884c\u5b9a\u4e49\u7684\u83ab\u540d\u5176\u5999\u7684\u51fd\u6570\uff1a<br/>$\\\\delta$ (delta) \u51fd\u6570\uff1a<br/>$$<br/>\\\\delta(x,\\\\;y) = [x = y] \\\\tag{2.3}<br/>$$<br/>\u4efb\u610f\u51fd\u6570\u5377$\\\\delta$\u51fd\u6570\u5747\u4f1a\u5f97\u5230\u539f\u51fd\u6570\u3002<br/>$\\\\zeta$ (zeta) \u51fd\u6570\uff1a<br/>$$<br/>\\\\zeta(x,\\\\;y) = [x \\\\leqslant y] \\\\tag{2.4}<br/>$$<br/>\u4ee5\u53ca\u83ab\u6bd4\u4e4c\u65af$\\\\mu$\u51fd\u6570\u662f\u5b9a\u4e49\u4e3a$\\\\zeta$\u51fd\u6570\u7684\u9006\u51fd\u6570\uff0c\u5373\uff1a<br/>$$<br/>\\\\mu \\\\times \\\\zeta = \\\\zeta \\\\times \\\\mu = \\\\delta \\\\tag{2.5}<br/>$$<br/>\u5c55\u5f00\u5377\u79ef\u53ef\u5f97\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\delta = \\\\mu \\\\times \\\\zeta \\\\Longrightarrow \\\\delta(x,\\\\;y) & = \\\\sum_{x \\\\leqslant z \\\\leqslant y} \\\\mu(x,\\\\;z)\\\\zeta(z,\\\\;y) \\\\\\\\<br/>& = \\\\sum_{x \\\\leqslant z \\\\leqslant y} \\\\mu(x,\\\\;z)<br/>\\\\end{aligned}<br/>$$<br/>\u56e0\u6b64\uff0c\u5f53$x \\\\neq y$\u65f6\uff1a<br/>$$<br/>\\\\mu(x,\\\\;y) = - \\\\sum_{x \\\\leqslant z \\\\lt y} \\\\mu(x,\\\\;z) \\\\tag{2.6}<br/>$$<br/>\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f<br/><br/>(\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f)<br/>\u5bf9\u4e8e\u6709\u9650\u504f\u5e8f\u96c6$(X_n,\\\\;\\\\leqslant)$\u4e0a\u7684\u4e24\u4e2a\u51fd\u6570$F(x,\\\\;y)$\u548c$G(x,\\\\;y)$\uff0c\u5982\u679c\uff1a<br/>$$ G(x,\\\\;y) = \\\\sum_{x \\\\leqslant z \\\\leqslant y} F(x,\\\\;z) \\\\tag{3.1}$$<br/>\u90a3\u4e48\uff1a<br/>$$F(x,\\\\;y) = \\\\sum_{x \\\\leqslant z \\\\leqslant y} G(x,\\\\;z)\\\\mu(z,\\\\;y)  = (G \\\\times \\\\mu)(x,\\\\;y) \\\\tag{3.2}$$<br/><br/>\u8bc1\u660e \u9996\u5148\u5c06\u5f0f\u5b50\u5c55\u5f00\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>F(x,\\\\;y) & = \\\\sum_{x \\\\leqslant z \\\\leqslant y} G(x,\\\\;z)\\\\mu(z,\\\\;y) \\\\\\\\<br/>& = \\\\sum_{x \\\\leqslant z \\\\leqslant y} \\\\mu(z,\\\\;y) \\\\sum_{x \\\\leqslant m \\\\leqslant z} F(x,\\\\;m)<br/>\\\\end{aligned}<br/>$$<br/>\u6211\u4eec\u4f7f\u7528$\\\\zeta$\u51fd\u6570\u6765\u8868\u793a\u4e0a\u4e0b\u754c\uff0c\u4e8e\u662f\u5f0f\u5b50\u6539\u5199\u4e3a\u4ee5\u4e0b\u5f62\u5f0f\uff1a<br/>$$<br/>\\\\sum_{x \\\\leqslant z \\\\leqslant y} \\\\mu(z,\\\\;y) \\\\sum_{m \\\\in X_n} F(x,\\\\;m)\\\\zeta(x,\\\\;m)\\\\zeta(m,\\\\;z)<br/>$$<br/>\u6539\u53d8\u6c42\u548c\u7684\u679a\u4e3e\u987a\u5e8f\uff0c\u5148\u679a\u4e3e$m$\uff0c\u5176\u503c\u4f9d\u7136\u4e0d\u53d8\uff1a<br/>$$<br/>\\\\sum_{m \\\\in X_n} \\\\sum_{x \\\\leqslant z \\\\leqslant y} \\\\zeta(m,\\\\;z)\\\\mu(z,\\\\;y)\\\\zeta(x,\\\\;m)F(x,\\\\;m)<br/>$$<br/>\u7531\u4e8e\u5f53$m \\\\lt x$\u7684\u65f6\u5019$\\\\zeta(x,\\\\;m)$\u4e3a$0$\uff0c\u56e0\u6b64\u53ea\u7528\u8003\u8651$m \\\\geqslant x$\u3002<br/>\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa$z \\\\geqslant m$\u662f\u5fc5\u987b\u7684\u3002<br/>\u56e0\u6b64\u53ef\u4ee5\u6539\u5199\u4e0b\u754c\uff1a<br/>$$<br/>\\\\sum_{m \\\\in X_n} \\\\sum_{m \\\\leqslant z \\\\leqslant y} \\\\zeta(m,\\\\;z)\\\\mu(z,\\\\;y)F(x,\\\\;m)<br/>$$<br/>\u7136\u540e\u53d8\u6210\u4e86\u5377\u79ef\u7684\u5f62\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{m \\\\in X_n} F(x,\\\\;m) \\\\sum_{m \\\\leqslant z \\\\leqslant y} \\\\zeta(m,\\\\;z)\\\\mu(z,\\\\;y) & = \\\\sum_{m \\\\in X_n} F(x,\\\\;m) \\\\delta(m,\\\\;y) \\\\\\\\<br/>& = F(x,\\\\;y)<br/>\\\\end{aligned}<br/>$$<br/>\u5f53$m = y$\u65f6\uff0c$\\\\delta(m,\\\\;y)$\u624d\u4e3a$1$\uff0c\u6240\u4ee5\u7efc\u4e0a\u6240\u8ff0\uff1a<br/>$$<br/>F(x,\\\\;y) = \\\\sum_{x \\\\leqslant z \\\\leqslant y} G(x,\\\\;z)\\\\mu(z,\\\\;y) \\\\tag{3.2}<br/>$$<br/>\u504f\u5e8f\u96c6\u76f4\u79ef<br/>\u5bf9\u4e8e\u4e24\u4e2a\u504f\u5e8f\u96c6$(A,\\\\;\\\\leqslant_1)$\u548c$(B,\\\\;\\\\leqslant_2)$\uff0c\u5b83\u4eec\u7684\u76f4\u79ef$C = A \\\\times B = (A \\\\times B,\\\\;\\\\leqslant)$\u4e5f\u662f\u504f\u5e8f\u96c6\uff0c\u5176\u4e2d\u7684\u5143\u7d20\u4e3a$(x,\\\\;y)\\\\;\\\\;(x \\\\in A,\\\\;y \\\\in B)$\u3002\u5176\u5173\u7cfb$\\\\leqslant$\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a<br/>$$<br/>(x_1,\\\\;y_1) \\\\leqslant (x_2,\\\\;y_2) \\\\Longleftrightarrow x_1 \\\\leqslant_1 x_2 \\\\land y_1 \\\\leqslant_2 y_2<br/>$$<br/>\u5bf9\u4e8e\u504f\u5e8f\u96c6\u7684\u76f4\u79ef\uff0c\u6211\u4eec\u6709\u4ee5\u4e0b\u5b9a\u7406\uff1a<br/><br/>\u8bbe$A$\u548c$B$\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u5206\u522b\u4e3a$\\\\mu_1$\u548c$\\\\mu_2$\uff0c\u90a3\u4e48$C$\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6ee1\u8db3\uff1a<br/>$$\\\\mu((x_1,\\\\;y_1),\\\\;(x_2,\\\\;y_2)) = \\\\mu_1(x_1,\\\\;x_2)\\\\mu(y_1,\\\\;y_2) \\\\tag{4.1}$$<br/><br/>\u8bc1\u660e \u5bf9\u4e8e$(x_1,\\\\;y_1) \\\\not\\\\leqslant (x_2,\\\\;y_2)$\u548c$(x_1,\\\\;y_1) = (x_2,\\\\;y_2)$\u7684\u60c5\u51b5\uff0c\u4e0a\u5f0f\u663e\u7136\u6210\u7acb\u3002<br/>\u5047\u8bbe\u5bf9\u4e8e\u6ee1\u8db3$(x_1,\\\\;y_1) \\\\leqslant (u,\\\\;v) \\\\lt (x_2,\\\\;y_2)$\u7684\u4e8c\u5143\u7ec4\u5747\u6ee1\u8db3\uff0c\u90a3\u4e48\u6709\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\mu((x_1,\\\\;y_1),\\\\;(x_2,\\\\;y_2)) & = - \\\\sum_{(x_1,\\\\;y_1) \\\\leqslant (u,\\\\;v) \\\\lt (x_2,\\\\;y_2)} \\\\mu((x_1,\\\\;y_1),\\\\;(u,\\\\;v)) \\\\\\\\<br/>& = - \\\\sum_{(x_1,\\\\;y_1) \\\\leqslant (u,\\\\;v) \\\\lt (x_2,\\\\;y_2)} \\\\mu_1(x_1,\\\\;u)\\\\mu_2(y_1,\\\\;v) & (\\\\text{\u6839\u636e\u5f52\u7eb3\u5047\u8bbe}) \\\\\\\\<br/>& = - \\\\sum_{x_1 \\\\leqslant_1 u \\\\lt_1 x_2} \\\\sum_{y_1 \\\\leqslant_2 v \\\\lt_2 y_2} \\\\mu_1(x_1,\\\\;u)\\\\mu_2(y_1,\\\\;v) & (\\\\text{\u5206\u522b\u679a\u4e3e}) \\\\\\\\<br/>& =  - \\\\sum_{x_1 \\\\leqslant_1 u \\\\leqslant_1 x_2} \\\\sum_{y_1 \\\\leqslant_2 v \\\\leqslant_2 y_2} \\\\mu_1(x_1,\\\\;u)\\\\mu_2(y_1,\\\\;v) \\\\\\\\<br/>&\\\\;\\\\;\\\\;\\\\, + \\\\mu_1(x_1,\\\\;x_2)\\\\sum_{y_1 \\\\leqslant_2 v \\\\leqslant_2 y_2} \\\\mu_2(y_1,\\\\;v) \\\\\\\\<br/>&\\\\;\\\\;\\\\;\\\\, + \\\\mu_2(y_1,\\\\;y_2)\\\\sum_{x_1 \\\\leqslant_1 u \\\\leqslant_1 x_2} \\\\mu_1(x_1,\\\\;u) \\\\\\\\<br/>&\\\\;\\\\;\\\\;\\\\, \\\\color{red}{+} \\\\mu_1(x_1,\\\\;x_2)\\\\mu_2(y_1,\\\\;y_2) & (\\\\text{\u6269\u5c55\u4e0a\u754c})<br/>\\\\end{aligned}<br/>$$<br/>(2016.12.22: \u4e0a\u8ff0\u8bc1\u660e\u6700\u540e\u4e00\u6b65\u5c55\u5f00\u5b58\u5728\u95ee\u9898 (\u7ea2\u8272\u6b63\u53f7)\uff0c\u4f46\u662f\u300a\u7ec4\u5408\u6570\u5b66\u300b\u4e0a\u6ca1\u6709\u8fd9\u4e00\u6b65\u7684\u8be6\u7ec6\u63a8\u5bfc\uff0c\u6b63\u786e\u7684\u8bc1\u660e\u65b9\u5f0f\u8fd8\u8bf7\u5927\u795e\u4eec\u6307\u51fa)<br/>\u7531\u4e8e\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>0<br/>& = \\\\sum_{y_1 \\\\leqslant_2 v \\\\leqslant_2 y_2} \\\\mu_2(y_1,\\\\;v) \\\\\\\\<br/>& = \\\\sum_{x_1 \\\\leqslant_1 u \\\\leqslant_1 x_2} \\\\mu_1(x_1,\\\\;u)  \\\\\\\\<br/>& = \\\\sum_{x_1 \\\\leqslant_1 u \\\\leqslant_1 x_2} \\\\sum_{y_1 \\\\leqslant_2 v \\\\leqslant_2 y_2} \\\\mu_1(x_1,\\\\;u)\\\\mu_2(y_1,\\\\;v)<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5\u5b9a\u7406\u6210\u7acb\u3002<br/>\u5728$(X_n,\\\\;\\\\leqslant)$\u4e0a\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570<br/>\u6ce8\u610f\u8fd9\u91cc\u7684\u662f\u771f\u6b63\u7684\u5c0f\u4e8e\u7b49\u4e8e\u53f7\u4e86......<br/>\u8fd9\u4e2a\u6bd4\u8f83\u667a\u969c\uff0c\u5206\u6790\u4e00\u4e0b\u5c31\u597d\u4e86\uff1a<br/>\u5bf9\u4e8e$y = x$\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>\\\\mu(x,\\\\;y) = \\\\mu(x,\\\\;x) = 1<br/>$$<br/>\u5bf9\u4e8e$y = x + 1$\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>\\\\mu(x,\\\\;y) = \\\\mu(x,\\\\;x + 1) = -\\\\mu(x,\\\\;x) = -1<br/>$$<br/>\u5bf9\u4e8e$y = x + 2$\uff0c\u6211\u4eec\u6709\uff1a<br/>$$<br/>\\\\mu(x,\\\\;y) = \\\\mu(x,\\\\;x + 2) = -\\\\left[\\\\mu(x,\\\\;x) + \\\\mu(x,\\\\;x + 1)\\\\right] = 0<br/>$$<br/>\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e$y \\\\gt x + 1$\u7684\u51fd\u6570\u503c\u5c31\u5168\u90fd\u53d8\u4e3a$0$\u4e86\u3002<br/>\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\uff1a<br/>$$<br/>\\\\mu(x,\\\\;y) =<br/>\\\\begin{cases}<br/>1 & (y = x) \\\\\\\\<br/>-1 & (y = x + 1) \\\\\\\\<br/>0 & (\\\\text{otherwise})<br/>\\\\end{cases}<br/>\\\\tag{5.1}<br/>$$<br/>\u5728$(X_n,\\\\;\\\\subseteq)$\u4e0a\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570<br/><br/>\u8bd5\u8bc1\u660e\uff1a<br/>\u504f\u5e8f\u96c6$(X_n,\\\\;\\\\subseteq)$\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u662f\uff1a<br/>$$\\\\mu(A,\\\\;B) = (-1)^{|B| - |A|} \\\\tag{6.1}$$<br/><br/>\u8fd0\u7528\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff1a<br/>\u9996\u5148\u5bf9\u4e8e$A = B$\uff0c\u663e\u7136\u6210\u7acb\uff1a<br/>$$<br/>\\\\mu(A, B) = \\\\mu(A, A) = 1 = (-1)^0<br/>$$<br/>\u5047\u8bbe\u5bf9\u4e8e$|B| - |A| \\\\leqslant k$\u5747\u6210\u7acb\uff0c\u5c1d\u8bd5\u8bc1\u660e\u5bf9\u4e8e$|B| - |A| = k + 1$\u4e5f\u6210\u7acb\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\mu(A,\\\\;B) & = -\\\\sum_{A \\\\subseteq C \\\\subset B} \\\\mu(A,\\\\;C) \\\\\\\\<br/>& = -\\\\sum_{A \\\\subseteq C \\\\subset B} (-1)^{|C| - |A|} \\\\\\\\<br/>& = -\\\\sum_{i = 0}^{k} {k + 1 \\\\choose i}(-1)^i \\\\\\\\<br/>& = -\\\\left[(1 - 1)^{k + 1} - (-1)^{k + 1} \\\\right] \\\\\\\\<br/>& = (-1)^{k + 1} \\\\\\\\<br/>& = (-1)^{|B| - |A|}<br/>\\\\end{aligned}<br/>$$<br/>\u5728$(X_n,\\\\;\\\\mid)$\u4e0a\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570<br/>\u5bf9\u4e8e$(X_n, \\\\;\\\\mid)$\u8fd9\u4e2a\u504f\u5e8f\u96c6\uff0c\u6709\u5982\u4e0b\u5b9a\u7406\uff1a<br/>$$<br/>a \\\\mid b \\\\Longrightarrow \\\\mu(a,\\\\;b) = \\\\mu(1,\\\\;\\\\frac{b}a) \\\\tag{7.1}<br/>$$<br/>\u8bc1\u660e \u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528\u5f52\u7eb3\u6cd5\u8bc1\u660e\u3002\u9996\u5148\u5bf9\u4e8e$a = b$\u7684\u60c5\u51b5\u663e\u7136\u6210\u7acb\uff1a<br/>$$<br/>\\\\mu(a,\\\\;b) = \\\\mu(a,\\\\;a) = \\\\mu(1,\\\\;1) = 1<br/>$$<br/>\u5047\u8bbe\u5bf9\u4e8e$a \\\\leqslant c \\\\lt b$\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570$\\\\mu(a,\\\\;c)$\u5747\u6ee1\u8db3\u4e0a\u8ff0\u5b9a\u7406\uff0c\u4e0b\u9762\u8bc1\u660e\u5bf9\u4e8e$\\\\mu(a,\\\\;b)$\u4e5f\u6ee1\u8db3\u3002<br/>\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u6027\u8d28\u53ef\u5f97\uff1a<br/>$$<br/>\\\\mu(a,\\\\;b) = -\\\\sum_{a \\\\mid c \\\\mid b, \\\\;c \\\\neq b} \\\\mu(a,\\\\;c)<br/>$$<br/>\u7531\u4e8e$a \\\\mid b$\uff0c\u6240\u4ee5\uff1a<br/>$$<br/>-\\\\sum_{c \\\\mid (b / a), \\\\;c \\\\neq (b / a)} \\\\mu(a,\\\\;ac)<br/>$$<br/>\u6839\u636e\u5f52\u7eb3\u5047\u8bbe\uff0c\u53ef\u4ee5\u5c06\u4e0a\u5f0f\u53d8\u4e3a\uff1a<br/>$$<br/>-\\\\sum_{c \\\\mid (b / a), \\\\;c \\\\neq (b / a)} \\\\mu(1,\\\\;c) = \\\\mu(1,\\\\;\\\\frac{b}a)<br/>$$<br/>\u56e0\u6b64\u5b9a\u7406\u6210\u7acb\u3002<br/>\u7531\u4e8e\u6709\u4e0a\u9762\u7684\u5b9a\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u7528\u5173\u5fc3$\\\\mu(1,\\\\;n)$\u3002<br/>\u9996\u5148\u53ef\u4ee5\u9012\u5f52\u8ba1\u7b97\uff1a<br/>$$<br/>\\\\mu(1,\\\\;n) = -\\\\sum_{a \\\\mid n,\\\\;a\\\\neq n} \\\\mu(1,\\\\;a)<br/>$$<br/>\u8003\u8651\u5bf9$n$\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff1a<br/>$$<br/>n = p_1^{\\\\alpha_1}p_2^{\\\\alpha_2}\\\\cdots p_m^{\\\\alpha_m}<br/>$$<br/>\u5bf9\u4e8e$n$\u7684\u4efb\u610f\u4e00\u4e2a\u56e0\u5b50$d$\u90fd\u6709\uff1a<br/>$$<br/>d = p_1^{\\\\beta_1}p_2^{\\\\beta_2}\\\\cdots p_m^{\\\\beta_m} \\\\;\\\\;\\\\;\\\\; (0 \\\\leqslant \\\\beta_i \\\\leqslant \\\\alpha_i)<br/>$$<br/>\u76f8\u5f53\u4e8e\u53ef\u4ee5\u770b\u4f5c$m$\u4e2a\u5927\u5c0f\u4e3a$\\\\alpha_1 + 1,\\\\;\\\\alpha_2 + 1,\\\\;\\\\dots,\\\\;\\\\alpha_m + 1$\u7684\u504f\u5e8f\u96c6\u7684\u76f4\u79ef\u7684\u7ed3\u679c\u3002<br/>\u4e8e\u662f\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\mu(1,\\\\;n) = \\\\prod_{i=1}^m\\\\mu(1,\\\\;p_i^{\\\\alpha_i}) \\\\tag{7.2}<br/>$$<br/>\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e$\\\\varphi(p) = p - 1$\uff1a<br/>$$<br/>\\\\mu(1,\\\\;1) = 1 \\\\\\\\<br/>\\\\mu(1,\\\\;p) = -\\\\mu(1,\\\\;1) = -1 \\\\;\\\\; \\\\\\\\<br/>\\\\mu(1,\\\\;p^2) = -\\\\left[ \\\\mu(1,\\\\;1) + \\\\mu(1,\\\\;p) \\\\right] = 0 \\\\\\\\<br/>\\\\dots<br/>$$<br/>\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\uff1a<br/>$$<br/>\\\\mu(1,\\\\;p^k) =<br/>\\\\begin{cases}<br/>1 & (k = 0) \\\\\\\\<br/>-1 & (k = 1) \\\\\\\\<br/>0 & (\\\\text{otherwise})<br/>\\\\end{cases}<br/>\\\\tag{7.3}<br/>$$<br/>\u8fd0\u7528\u76f4\u79ef\uff0c\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>\\\\mu(1,\\\\;n) =<br/>\\\\begin{cases}<br/>1 & (n = 1) \\\\\\\\<br/>(-1)^k & (n = p_1p_2\\\\cdots p_k, \\\\;\\\\;\\\\varphi(p_i) = p_i - 1) \\\\\\\\<br/>0 & (\\\\text{otherwise})<br/>\\\\end{cases}<br/>\\\\tag{7.4}<br/>$$<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u901a\u5e38\u628a$\\\\mu(1,\\\\;n)$\u8bb0\u4f5c$\\\\mu(n)$\uff0c\u5c31\u53d8\u6210\u5e38\u89c1\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u4e86\u3002<br/>\u636e\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u662f\u79ef\u6027\u51fd\u6570\uff0c\u5373\uff1a<br/>$$<br/>a \\\\bot b \\\\Longrightarrow \\\\mu(ab) = \\\\mu(a)\\\\mu(b) \\\\tag{7.5}<br/>$$<br/>\u8bc1\u660e\uff1a<br/>1. \u5982\u679c$a$\u3001$b$\u4e2d\u6709\u4e00\u8005\u4e3a$1$\uff0c\u7ed3\u8bba\u663e\u7136\u6210\u7acb\u3002<br/>2. \u5982\u679c$a$\u3001$b$\u4e2d\u6709\u4e00\u8005\u4e0d\u4e3a\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c\u5b83\u4eec\u7684\u79ef\u4e5f\u4e00\u5b9a\u4e0d\u4f1a\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c\u6545\u7b49\u4e8e$0$\u3002<br/>3. \u6b64\u65f6\u5047\u8bbe$a$\u3001$b$\u90fd\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c\u53c8\u56e0\u4e3a$a$\u4e0e$b$\u4e92\u8d28\uff0c\u6240\u4ee5\u5b83\u4eec\u7684\u7d20\u56e0\u5b50\u4e2d\u6ca1\u6709\u76f8\u540c\u7684\u3002\u8bbe$a = p_1p_2\\\\cdots p_m$\u548c$b = q_1q_2\\\\cdots q_n$\u6240\u4ee5\u53ef\u4ee5\u77e5\u9053$\\\\mu(ab) = (-1)^{n + m} = \\\\mu(a)\\\\mu(b)$\u3002<br/>\u53cd\u6f14\u793a\u4f8b\uff1a\u5bb9\u65a5\u539f\u7406<br/>\u8bbe$S$\u4e3a\u6709\u9650\u96c6\uff0c$A_1,\\\\;A_2,\\\\;\\\\dots,\\\\;A_n$\u662f$S$\u7684\u5b50\u96c6\uff0c$K \\\\subseteq \\\\{1,\\\\;2,\\\\;\\\\dots,\\\\;n\\\\}$\u3002<br/>\u5b9a\u4e49\u51fd\u6570$F(K)$\u8ba1\u6570$s$\u540c\u65f6\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\uff1a<br/>$$<br/>s \\\\not\\\\in \\\\bigcup_{i \\\\in K} A_i \\\\\\\\<br/>s \\\\in \\\\bigcap_{i \\\\not\\\\in K} A_i<br/>$$<br/>\u5373\uff1a<br/>$$<br/>F(K) = \\\\left| \\\\bigcap_{i \\\\not\\\\in K} A_i - \\\\bigcup_{i \\\\in K} A_i \\\\right| \\\\tag{8.1}<br/>$$<br/>\u5982\u4f55\u8111\u8865\u8fd9\u4e2a\u51fd\u6570\uff1f\u53ef\u4ee5\u60f3\u8c61\u6210\u662f\u7528$K$\u628a$S$\u4e2d\u7684\u5f88\u591a\u4e1c\u897f\u6316\u8d70\u4e86\uff0c\u7136\u540e\u5269\u4e0b\u7684\u96c6\u5408\u518d\u6c42\u4ea4\u96c6\u3002<br/>\u5bf9\u4e8e\u6b64\uff0c\u518d\u5b9a\u4e49\u51fd\u6570$G(K)$\uff1a<br/>$$<br/>G(K) = \\\\sum_{L \\\\subseteq K} F(L) \\\\tag{8.2}<br/>$$<br/>\u8fd9\u8d27\u5c45\u7136\u8ba1\u6570\u7684\u662f\uff1a<br/>$$<br/>G(K) = \\\\left| \\\\bigcap_{i \\\\not\\\\in K} A_i \\\\right| \\\\tag{8.3}<br/>$$<br/>\u5982\u4f55\u8111\u8865\u5176\u6b63\u786e\u6027\uff1f\u53ef\u4ee5\u60f3\u8c61\u662f\u4e00\u4e2a\u667a\u969c\u7528$K$\u628a\u672c\u6765\u5c5e\u4e8e\u5b83\u4eec\u4ea4\u96c6\u7684\u4e1c\u897f\u6316\u53bb\u4e86\uff0c\u7136\u540e\u53c8\u4e00\u4e2a\u4e00\u4e2a\u5410\u51fa\u6765\uff0c\u4e8e\u662f\u5c31\u8fd8\u539f\u4e86\u539f\u672c\u7684\u4ea4\u96c6......<br/>\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>G(K) = \\\\sum_{L \\\\subseteq K} F(K) \\\\Longrightarrow F(K) = \\\\sum_{L \\\\subseteq K} (-1)^{|K| - |L|} G(L)<br/>$$<br/>\u6240\u4ee5\u53d6$K = \\\\{1,\\\\;2,\\\\;\\\\dots,\\\\;n\\\\}$\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>F(K) = \\\\sum_{L \\\\subseteq K} (-1)^{n - |L|} G(L) \\\\tag{8.4}<br/>$$<br/>\u8fd9\u4e2a\u65f6\u5019\u7684$F(K)$\u8ba1\u6570\u7684\u4e1c\u897f\u6709\u4e86\u65b0\u7684\u542b\u4e49\uff1a<br/>$$<br/>F(K) = \\\\left|\\\\bigcup_{i \\\\in K} A_i\\\\right| = \\\\left|\\\\bigcap_{i \\\\in K} \\\\overline{A}_i \\\\right| \\\\tag{8.5}<br/>$$<br/>\u7528$F(K)$\u548c$G(K)$\u672c\u8eab\u7684\u542b\u4e49\u6765\u66ff\u6362\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5bb9\u65a5\u539f\u7406 (\u611f\u89c9\u597d\u795e\u5947)\uff1a<br/>$$<br/>\\\\left|\\\\bigcap_{i = 1}^n \\\\overline{A}_i \\\\right| = \\\\sum_{K \\\\subseteq \\\\{1,\\\\;,2,\\\\;,\\\\dots,\\\\;n\\\\}} (-1)^{|K|} \\\\left| \\\\bigcap_{i \\\\in K} A_i \\\\right| \\\\tag{8.6}<br/>$$<br/>\u53cd\u6f14\u793a\u4f8b\uff1a$\\\\varphi(n)$\u901a\u9879\u516c\u5f0f<br/>\u6b27\u62c9$\\\\varphi(n)$\u51fd\u6570\u8ba1\u6570\u7684\u662f\u4e0d\u5927\u4e8e$n$\u7684\u4e0e$n$\u4e92\u8d28\u7684\u6b63\u6574\u6570\u4e2a\u6570\u3002<br/>\u5bf9\u4e8e\u6b27\u62c9$\\\\varphi$\u51fd\u6570\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u7684\u5b9a\u7406\uff1a<br/>$$<br/>n = \\\\sum_{d \\\\mid n} \\\\varphi(d) \\\\tag{9.1}<br/>$$<br/>\u6709\u4e24\u79cd\u8bc1\u660e\u65b9\u6cd5\uff1a<br/>\u7b2c\u4e00\u79cd\u8003\u8651\u4e0d\u4e0e$n$\u4e92\u8d28\u7684\u6570\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u6570$d$\u4e0e$n$\u4e0d\u4e92\u8d28\uff0c\u90a3\u4e48\u5fc5\u6709$\\\\gcd(d, n) = a \\\\gt 1$\uff0c\u6362\u8a00\u4e4b$\\\\gcd(d / a, n / a) = 1$\uff0c\u6240\u4ee5\u4e00\u4e2a\u6570\u4e0d\u4e0e$n$\u4e92\u8d28\uff0c\u90a3\u4e48\u5fc5\u5b9a\u4e0e$n$\u7684\u4e00\u4e2a\u56e0\u5b50\u4e92\u8d28\u3002\u6240\u4ee5\u4e0a\u5f0f\u6210\u7acb\u3002<br/>\u53e6\u4e00\u79cd\u662f\u4f7f\u7528\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff1a<br/>\u9996\u5148\u8003\u8651$1$\uff0c\u662f\u663e\u7136\u6210\u7acb\u7684\u3002<br/>\u7136\u540e\u8003\u8651\u8d28\u6570$p$\uff0c$\\\\varphi(1) + \\\\varphi(p) = p$\uff0c\u6240\u4ee5\u4e5f\u662f\u6210\u7acb\u7684\u3002<br/>\u8003\u8651\u8d28\u6570$p$\u7684\u5e42$p^k$\uff0c\u5b83\u7684\u56e0\u5b50\u6709$1,\\\\;p,\\\\;p^2,\\\\;\\\\dots,\\\\;p^k$\uff0c\u7531\u4e8e\uff1a<br/>$$<br/>\\\\varphi(p^k) = (p - 1)p^{k-1} \\\\;\\\\;\\\\;\\\\; (\\\\varphi(p) = p - 1)<br/>$$<br/>\u6240\u4ee5\u6211\u4eec\u5bf9\u5176\u8fdb\u884c\u7b49\u6bd4\u6570\u5217\u6c42\u548c\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{d \\\\mid n} \\\\varphi(d) & = 1 + (p - 1)\\\\sum_{i=0}^{k-1} p^i \\\\\\\\<br/>& = 1 + (p - 1) \\\\cdot {1 - p^k \\\\over 1 - p} \\\\\\\\<br/>& = 1 + p^k - 1 \\\\\\\\<br/>& = p^k<br/>\\\\end{aligned}<br/>$$<br/>\u6545\u5bf9\u8d28\u6570\u7684\u5e42\u4e5f\u6210\u7acb\u3002<br/>\u5047\u8bbe\u5bf9\u4e8e\u4e00\u4e2a\u6570$c$\uff0c\u6240\u6709\u5c0f\u4e8e$c$\u7684\u6570\u5747\u6210\u7acb\uff0c\u90a3\u4e48\u9009\u53d6$n$\u7684\u4e24\u4e2a\u4e92\u8d28\u7684\u56e0\u5b50$a$\u3001$b$\u4f7f\u5f97$ab = c$\uff0c\u90a3\u4e48\u6709\uff1a<br/>$$<br/>\\\\sum_{n \\\\mid a} \\\\varphi(n) \\\\sum_{m \\\\mid b} \\\\varphi(m) = a \\\\cdot b = c<br/>$$<br/>\u4e0b\u9762\u8bc1\u660e$\\\\sum_{n \\\\mid a} \\\\varphi(n) \\\\sum_{m \\\\mid b} \\\\varphi(m) = \\\\sum_{d \\\\mid c} \\\\varphi(d)$\uff0c\u5373\u53ef\u8bc1\u660e\u539f\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{n \\\\mid a} \\\\varphi(n) \\\\sum_{m \\\\mid b} \\\\varphi(m) & = \\\\sum_{n \\\\mid a}\\\\sum_{m \\\\mid b}\\\\varphi(n)\\\\varphi(m) & (\\\\text{\u6539\u53d8\u679a\u4e3e\u987a\u5e8f}) \\\\\\\\<br/>& = \\\\sum_{n \\\\mid a}\\\\sum_{m \\\\mid b} \\\\varphi(nm) & (\\\\text{\u7531\u4e8e}n \\\\bot m) \\\\\\\\<br/>& = \\\\sum_{nm \\\\mid ab} \\\\varphi(nm) & (\\\\text{\u7531\u4e8e}a \\\\bot b) \\\\\\\\<br/>& = \\\\sum_{d \\\\mid c} \\\\varphi(d) & (\\\\text{\u7b49\u4ef7\u4ee3\u6362}) \\\\\\\\<br/>& = c<br/>\\\\end{aligned}<br/>$$<br/>\u6ce8\u610f\u5230$(9.1)$\u5f0f\u662f\u4e00\u4e2a\u660e\u663e\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u5f62\u5f0f\u3002\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\varphi(n) & = \\\\sum_{d \\\\mid n} d \\\\cdot \\\\mu(d,\\\\;n) \\\\\\\\<br/>& = \\\\sum_{d \\\\mid n} d \\\\cdot \\\\mu(1,\\\\;n / d) \\\\\\\\<br/>& = \\\\sum_{d \\\\mid n} d \\\\cdot \\\\mu(n / d) \\\\\\\\<br/>& = \\\\sum_{d \\\\mid n} \\\\mu(d) \\\\cdot n/d<br/>\\\\end{aligned}<br/>$$<br/>\u8003\u8651\u4e00\u4e0b$\\\\mu$\u51fd\u6570\u7684\u53d6\u503c\uff0c\u5bf9\u4e8e\u56e0\u5b50$1$\uff0c\u548c\u5f0f\u4e2d\u7684\u7ed3\u679c\u4e3a$n$\u3002\u5bf9\u4e8e\u7531\u7d20\u6570\u76f8\u4e58\u7684\u56e0\u5b50\uff0c\u8fd9\u4e9b\u7d20\u56e0\u5b50\u5fc5\u5b9a\u6765\u81ea$n$\u3002\u800c\u5176\u5b83\u60c5\u51b5\u5c31\u90fd\u4e3a$0$\u3002<br/>\u8bbe$n = p_1^{k_1}p_2^{k_2}\\\\cdots p_m^{k_m}$\u3002<br/>\u56e0\u6b64\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a<br/>$$<br/>\\\\varphi(n) = n\\\\left[1 - \\\\sum \\\\frac1{p_i} + \\\\sum \\\\frac1{p_ip_j} - \\\\cdots + (-1)^{m}\\\\sum \\\\frac1{\\\\prod_{i=1}^m p_i} \\\\right] \\\\tag{9.2}<br/>$$<br/>\u8fd9\u6070\u597d\u662f\u4e0b\u9762\u7684\u5f0f\u5b50\u5c55\u5f00\u7684\u5f62\u5f0f\uff1a<br/>$$<br/>\\\\varphi(n) = n\\\\prod_{i=1}^m \\\\left( 1 - \\\\frac1{p_i} \\\\right) \\\\tag{9.3}<br/>$$<br/>\u56e0\u6b64\uff1a<br/>$$<br/>\\\\varphi(n) = n\\\\prod_{p \\\\mid n,\\\\;\\\\varphi(p) = p - 1} \\\\left( 1 - \\\\frac1p\\\\right) \\\\tag{9.4}<br/>$$<br/>\u53cd\u6f14\u793a\u4f8b\uff1a\u591a\u91cd\u96c6\u5408\u7684\u5faa\u73af\u6392\u5217<br/><br/>\u6211\u4eec\u6709\u4e00\u4e2a\u591a\u91cd\u96c6\u5408$\\\\{\\\\infty \\\\cdot 1,\\\\;\\\\infty \\\\cdot 2,\\\\;\\\\dots,\\\\;\\\\infty \\\\cdot k\\\\}$\u3002\u6613\u77e5\u957f\u5ea6\u4e3a$n$\u7684\u5168\u6392\u5217\u6570\u4e3a$k^n$\u3002<br/>\u73b0\u5728\u5bf9\u4e8e\u4e24\u4e2a\u6392\u5217$A$\u548c$B$\uff0c\u5982\u679c$A$\u901a\u8fc7\u201d\u65cb\u8f6c\u201d (\u5373\u5c06\u6700\u540e\u4e00\u4e2a\u53d8\u6210\u7b2c\u4e00\u4e2a\uff0c\u5e76\u4e14\u628a\u4e4b\u524d\u7684\u5168\u90e8\u540e\u79fb) \u80fd\u53d8\u6210$B$\uff0c\u90a3\u4e48$A$\u548c$B$\u662f\u7b49\u4ef7\u7684\u3002<br/>\u6362\u8a00\u4e4b\uff0c\u6700\u5c0f\u8868\u793a\u6cd5\u76f8\u540c\u7684\u6392\u5217\u662f\u7b49\u4ef7\u3002<br/>\u6c42\u4e0d\u540c\u7684\u957f\u5ea6\u4e3a$n$\u7684\u5faa\u73af\u6392\u5217\u6570\u91cf\u3002<br/><br/>\u5bf9\u4e8e\u8fd9\u4e2a\u8ba1\u6570\u95ee\u9898\uff0c\u6211\u4eec\u8bb0$h(n)$\u4e3a\u957f\u5ea6\u4e3a$n$\u65f6\u7684\u7b54\u6848\uff0c$f(n)$\u4e3a\u957f\u5ea6\u4e3a$n$\u5e76\u4e14\u65cb\u8f6c$n$\u6b21\u624d\u4f1a\u53d8\u4e3a\u539f\u6392\u5217 (\u5373\u5faa\u73af\u8282\u957f\u5ea6\u4e3a$n$) \u7684\u6392\u5217\u7684\u6570\u91cf\u3002\u663e\u7136\uff0c\u4e00\u4e2a\u6392\u5217\u7684\u5faa\u73af\u8282\u957f\u5ea6$m$\u5fc5\u987b\u6ee1\u8db3$m \\\\mid n$\u3002<br/>\u90a3\u4e48\u53ef\u4ee5\u77e5\u9053\uff1a<br/>$$<br/>h(n) = \\\\sum_{d \\\\mid n} \\\\frac{f(d)}d \\\\tag{10.1}<br/>$$<br/>\u7531\u4e8e\u5faa\u73af\u8282\u957f\u5ea6\u5c0f\u4e8e$n$\u7684\u6392\u5217\u90fd\u53ef\u4ee5\u7531\u5faa\u73af\u8282\u4e0d\u65ad\u91cd\u590d\u800c\u5f97\u6765\u3002\u56e0\u6b64\u6211\u4eec\u8bbe\uff1a<br/>$$<br/>g(n) = \\\\sum_{d \\\\mid n} f(d)<br/>$$<br/>$g(n)$\u5c31\u8ba1\u6570\u4e86\u6240\u6709\u957f\u5ea6\u4e3a$n$\u7684\u6392\u5217\u6570\u91cf\u3002<br/>\u6240\u4ee5\uff1a<br/>$$<br/>g(n) = k^n \\\\tag{10.2}<br/>$$<br/>\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f\u53ef\u5f97\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f(n) & = \\\\sum_{d \\\\mid n} g(d)\\\\mu(n/d) \\\\\\\\<br/>& = \\\\sum_{d \\\\mid n} k^d\\\\mu(n/d)<br/>\\\\end{aligned}<br/>\\\\tag{10.3}<br/>$$<br/>\u5e26\u5165$h(n)$\u7684\u8ba1\u7b97\u516c\u5f0f\u53ef\u5f97\uff1a<br/>$$<br/>h(n) = \\\\sum_{d \\\\mid n} \\\\frac1d \\\\sum_{e \\\\mid d} k^e\\\\mu(d/e) \\\\tag{10.4}<br/>$$<br/>\u7531\u4e8e$e \\\\mid d$\u5e76\u4e14$d \\\\mid n$\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe$n = rd,\\\\;d = me$\uff0c\u6240\u4ee5$n = rem$\uff0c\u8fd9\u6837\u5c06\u65b9\u4fbf\u6211\u4eec\u53d8\u6362\u516c\u5f0f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{d \\\\mid n} \\\\frac1d \\\\sum_{e \\\\mid d} k^e\\\\mu(d/e) & = \\\\sum_{e \\\\mid n} k^e \\\\sum_{m \\\\mid (n/e)} \\\\frac1{me}\\\\mu(m) \\\\\\\\<br/>& =\\\\sum_{e\\\\mid n} \\\\frac{k^e}n \\\\sum_{r \\\\mid (n/e)} r\\\\cdot\\\\mu(\\\\frac{n}e/r)<br/>\\\\end{aligned}<br/>$$<br/>\u7531\u4e8e\uff1a<br/>$$<br/>\\\\varphi(n) = \\\\sum_{d \\\\mid n} d \\\\cdot \\\\mu(n/d)<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$<br/>h(n) = \\\\frac1n \\\\sum_{d \\\\mid n} k^d \\\\varphi(n/d) \\\\tag{10.5}<br/>$$<br/>\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u793a\u4f8b\uff1a\u6700\u5927\u516c\u7ea6\u6570<br/>\u9664\u4e86\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f\uff0c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u672c\u8eab\u7684\u6027\u8d28\u4e5f\u662f\u5f88\u597d\u7684\u3002<br/>\u8003\u8651\u4e0b\u9762\u4e00\u4e2a\u95ee\u9898\uff1a<br/><br/>\u7ed9\u5b9a$n$\u548c$m$\uff0c\u6c42$\\\\gcd(x,\\\\;y)\\\\;\\\\;(1 \\\\leqslant x \\\\leqslant n,\\\\;1 \\\\leqslant y \\\\leqslant m)$\u4e3a\u7d20\u6570\u7684\u4e8c\u5143\u7ec4$(x,\\\\;y)$\u4e2a\u6570\u3002<br/><br/>\u6362\u8a00\u4e4b\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f\u8fd9\u4e2a\uff1a<br/>$$<br/>\\\\sum_{x=1}^n\\\\sum_{y=1}^m \\\\left[\\\\varphi(\\\\gcd(x,\\\\;y)) = \\\\gcd(x,\\\\;y) - 1\\\\right] \\\\tag{11.1}<br/>$$<br/>\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u6362\u4e2a\u601d\u8def\uff0c\u5c31\u662f\u679a\u4e3e\u6700\u5927\u516c\u7ea6\u6570\u7684\u7b54\u6848\uff1a<br/>$$<br/>\\\\sum_{\\\\varphi(p) = p - 1}^{\\\\min\\\\{n,\\\\;m\\\\}}\\\\sum_{x=1}^n\\\\sum_{y=1}^m \\\\left[ \\\\gcd(x,\\\\;y) = p \\\\right] \\\\tag{11.2}<br/>$$<br/>\u7531\u4e8e$\\\\gcd(x,\\\\;y) = p \\\\Longrightarrow \\\\gcd(x/p,\\\\;y/p) = 1$\uff0c\u6240\u4ee5\u5c31\u53d8\u6210\u4e86\u679a\u4e3e\u4e92\u8d28\u7684\u6570\u7684\u5bf9\u6570\uff1a<br/>$$<br/>\\\\sum_{\\\\varphi(p) = p - 1}^{\\\\min\\\\{n,\\\\;m\\\\}}\\\\sum_{x=1}^{\\\\left\\\\lfloor \\\\frac{n}p\\\\right\\\\rfloor}\\\\sum_{y=1}^{\\\\left\\\\lfloor \\\\frac{m}p \\\\right\\\\rfloor} \\\\left[ \\\\gcd(x,\\\\;y) = 1 \\\\right] \\\\tag{11.3}<br/>$$<br/>\u7531\u4e8e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6709\u8fd9\u6837\u7684\u6027\u8d28\uff1a<br/>$$<br/>\\\\sum_{d \\\\mid n} \\\\mu(d) = [n = 1] \\\\tag{11.4}<br/>$$<br/>\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6765\u6d4b\u8bd5\u4e00\u4e2a\u6570\u662f\u5426\u4e3a$1$\uff1a<br/>$$<br/>\\\\sum_{\\\\varphi(p) = p - 1}^{\\\\min\\\\{n,\\\\;m\\\\}}\\\\sum_{x=1}^{\\\\left\\\\lfloor \\\\frac{n}p\\\\right\\\\rfloor}\\\\sum_{y=1}^{\\\\left\\\\lfloor \\\\frac{m}p \\\\right\\\\rfloor} \\\\sum_{d \\\\mid \\\\gcd(x,\\\\;y)} \\\\mu(d) \\\\tag{11.5}<br/>$$<br/>\u56e0\u4e3a$d \\\\mid \\\\gcd(x,\\\\;y)$\u5f53\u4e14\u4ec5\u5f53$d \\\\mid x$\u5e76\u4e14$d \\\\mid y$\uff0c\u6240\u4ee5\u53ef\u4ee5\u53d8\u6210\u8fd9\u6837\uff1a<br/>$$<br/>\\\\sum_{\\\\varphi(p) = p - 1}^{\\\\min\\\\{n,\\\\;m\\\\}}\\\\sum_{x=1}^{\\\\left\\\\lfloor \\\\frac{n}p\\\\right\\\\rfloor}\\\\sum_{y=1}^{\\\\left\\\\lfloor \\\\frac{m}p \\\\right\\\\rfloor} \\\\sum_{d \\\\mid x \\\\,\\\\land\\\\, d \\\\mid y} \\\\mu(d) \\\\tag{11.6}<br/>$$<br/>\u73b0\u5728\u4e1c\u897f\u8d8a\u6765\u8d8a\u591a\u4e86\uff0c\u662f\u65f6\u5019\u8003\u8651\u7b80\u5316\u4e00\u4e0b\u4e86\u3002<br/>\u9996\u5148\u5bf9\u4e8e\u4e00\u5806\u548c\u5f0f\u7684\u4e00\u4e2a\u6280\u5de7\u5c31\u662f\u8c03\u6574\u679a\u4e3e\u987a\u5e8f\u3002<br/>\u5c1d\u8bd5\u5148\u679a\u4e3e$d$\uff0c\u8fd9\u6837\u5408\u6cd5\u7684$d$\u5c31\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u4e86\uff1a<br/>$$<br/>\\\\sum_{\\\\varphi(p) = p - 1}^{\\\\min\\\\{n,\\\\;m\\\\}} \\\\sum_{d=1}^{\\\\min\\\\{n,\\\\;m\\\\}} \\\\left\\\\lfloor \\\\frac{n}{dp} \\\\right\\\\rfloor \\\\left\\\\lfloor \\\\frac{m}{dp} \\\\right\\\\rfloor \\\\mu(d) \\\\tag{11.7}<br/>$$<br/>\u5176\u5b9e\u8fd9\u4e2a\u5f0f\u5b50\u5df2\u7ecf\u53ef\u4ee5\u7528\u6765\u8ba1\u7b97\u7b54\u6848\u4e86\u3002\u6ce8\u610f\u5230\u5bf9\u4e8e\u4e00\u4e2a\u6570$n$\uff0c$\\\\lfloor n / i \\\\rfloor$\u7684\u53d6\u503c\u6700\u591a\u6709$O(\\\\sqrt{n})$\u79cd\uff0c\u56e0\u4e3a\uff1a<br/><br/>\u5982\u679c$i \\\\leqslant \\\\sqrt{n}$\uff0c\u8fd9\u6837\u7684$i$\u53ea\u6709$O(\\\\sqrt{n})$\u79cd\u3002<br/>\u5982\u679c$i > \\\\sqrt{n}$\uff0c\u90a3\u4e48$\\\\lfloor n / i \\\\rfloor \\\\leqslant \\\\sqrt{n}$\uff0c\u8fd9\u6837\u7684\u53d6\u503c\u53ea\u6709$O(\\\\sqrt{n})$\u79cd\u3002<br/><br/>\u6240\u4ee5\u4e24\u4e2a\u5411\u4e0b\u53d6\u6574\u7684\u4e58\u79ef\u6700\u591a\u6709$O(\\\\sqrt{n} + \\\\sqrt{m})$\u4e2a\u4e0d\u540c\u7684\u53d6\u503c\uff0c\u5de6\u8fb9\u679a\u4e3e\u7684\u7d20\u6570\u7ea6\u4e3a$O({n \\\\over \\\\ln n})$\u4e2a\uff0c\u6545\u6839\u636e\u6b64\u516c\u5f0f\u8ba1\u7b97\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O({n (\\\\sqrt{n} + \\\\sqrt{m}) \\\\over \\\\ln n})$\u3002<br/>\u7136\u800c\u6211\u4eec\u53ef\u4ee5\u505a\u5f97\u66f4\u5feb\u4e00\u4e9b\u3002<br/>\u8bbe$T = dp$\uff0c\u73b0\u5728\u6539\u6210\u5148\u679a\u4e3e$T$\uff1a<br/>$$<br/>\\\\sum_{T = 1}^{\\\\min\\\\{n,\\\\;m\\\\}} \\\\left\\\\lfloor \\\\frac{n}T \\\\right\\\\rfloor \\\\left\\\\lfloor \\\\frac{m}T \\\\right\\\\rfloor \\\\sum_{p \\\\mid T,\\\\;\\\\varphi(p) = p - 1} \\\\mu(T / p) \\\\tag{11.8}<br/>$$<br/>\u8fd9\u6837\u5de6\u8fb9\u5c31\u53ef\u4ee5\u5728$O(\\\\sqrt{n} + \\\\sqrt{m})$\u7684\u65f6\u95f4\u5185\u8fdb\u884c\u679a\u4e3e\u3002<br/>\u679a\u4e3e\u5927\u6982\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u8fc7\u7a0b\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6lastpos = 0<br/>i = 1<br/>while i <= min(n, m):<br/>    lastpos = min(n / (n / i), m / (m / i))<br/>    # Do something...<br/>    i = lastpos + 1<br/><br/><br/>\u6211\u4eec\u4f01\u56fe\u80fd\u4f7f\u53f3\u8fb9\u5feb\u901f\u8ba1\u7b97\u3002\u56e0\u6b64\u6211\u4eec\u6765\u7814\u7a76\u4e00\u4e0b\u53f3\u8fb9\u8fd9\u4e2a\u73a9\u610f\u3002<br/>\u8bbe\uff1a<br/>$$<br/>g(x) = \\\\sum_{p \\\\mid x,\\\\;\\\\varphi(p) = p - 1} \\\\mu(x/p) \\\\tag{11.9}<br/>$$<br/>\u8003\u8651\u4f7f\u7528\u7ebf\u6027\u7b5b\u6765\u8ba1\u7b97$g(x)$\u3002<br/><br/>\u5f53$x = 1$\u65f6\uff0c$g(x) = 0$\u3002<br/>\u5f53$x$\u4e3a\u7d20\u6570\u65f6\uff0c$g(x) = 1$\u3002<br/>\u5728\u7ebf\u6027\u7b5b\u7684\u5904\u7406\u8fc7\u7a0b\u4e2d\uff0c\u8bbe\u5f53\u524d\u6570\u4e3a$i$\uff0c\u679a\u4e3e\u5230\u7684\u7d20\u6570\u4e3a$p$\uff0c\u6211\u4eec\u5c06\u8981\u8ba1\u7b97$g(ip)$\uff1a<br/>\u5f53$\\\\mu(i) = 0$\u65f6\uff0c\u8bf4\u660e$i$\u7684\u8d28\u56e0\u6570\u5206\u89e3\u4e2d\u81f3\u5c11\u5b58\u5728\u4e00\u4e2a\u4e00\u4e2a\u7d20\u56e0\u5b50\u7684\u6b21\u6570\u5927\u4e8e$1$\u3002<br/>   \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u9664\u975e\u53ea\u6709\u4e00\u4e2a\u7d20\u56e0\u5b50\u7684\u6b21\u6570\u4e3a$2$\uff0c\u5176\u5b83\u5747\u4e3a$1$\uff0c\u5426\u5219\u65e0\u8bba\u5982\u4f55$g$\u7684\u51fd\u6570\u503c\u90fd\u4e3a$0$\u3002<br/>   \u5047\u8bbe\u53ea\u5b58\u5728\u4e00\u4e2a\u7d20\u56e0\u5b50\u7684\u6b21\u6570\u4e3a$2$\uff0c\u8bb0\u8fd9\u4e2a\u7d20\u56e0\u5b50\u4e3a$f(i)$\u3002<br/>\u82e5$p \\\\mid i$\uff0c\u90a3\u4e48\u5c06\u4f1a\u5bfc\u81f4\u65e0\u8bba\u662f\u54ea\u4e2a\u7d20\u56e0\u5b50\uff0c$\\\\mu$\u51fd\u6570\u7684\u503c\u90fd\u4e3a$0$\u3002\u56e0\u6b64$g$\u51fd\u6570\u7684\u503c\u4e3a$0$\u3002<br/>\u82e5$p \\\\not\\\\mid i$\uff0c\u90a3\u4e48\u5c31\u53ea\u6709\u9664\u4ee5$f(i)$\u65f6\u4f1a\u6709\u503c\uff0c\u6b64\u65f6\u7684\u503c\u4e3a$\\\\mu(i / f(i) \\\\cdot p)$\u3002<br/><br/><br/>\u5f53$\\\\mu(i) \\\\neq 0$\u65f6\uff0c\u610f\u5473\u7740$i$\u5c06\u662f\u591a\u4e2a\u7d20\u6570\u4e4b\u79ef\u3002\u540c\u6837\u6211\u4eec\u6765\u8003\u8651\u4e24\u79cd\u60c5\u51b5\uff1a<br/>\u82e5$p \\\\mid i$\uff0c\u90a3\u4e48\u5c31\u53ea\u6709$p$\u7684\u6b21\u6570\u4e3a$2$\uff0c\u6b64\u65f6$g(ip) = \\\\mu(i)$\u3002<br/>\u82e5$p \\\\not\\\\mid i$\uff0c\u90a3\u4e48$\\\\mu(ip)$\u4f9d\u7136\u4e0d\u4e3a$0$\u3002\u5047\u8bbe$i$\u6709$r$\u4e2a\u7d20\u56e0\u5b50\uff0c\u90a3\u4e48$g(i) = r(-1)^{r-1}$\uff0c\u5e76\u4e14$g(ip) = (r + 1)(-1)^r = -r(-1)^{r-1} + (-1)^{r+1}$\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u7b26\u53f7\u76f8\u53cd\u4e14\u7edd\u5bf9\u503c\u5dee$1$\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u3002<br/><br/><br/><br/><br/><br/>\u7ecf\u8fc7\u4e00\u756a\u5206\u7c7b\u8ba8\u8bba\uff0c\u6211\u4eec\u603b\u7b97\u6210\u529f\u5730\u627e\u5230\u4e86\u9884\u5904\u7406$g(x)$\u7684\u65b9\u6cd5\u3002<br/>\u5728\u8fd9\u4e2d\u95f4\u6709\u4e00\u4e2a\u95ee\u9898\u8fd8\u4e9f\u5f85\u89e3\u51b3\uff0c\u5c31\u662f\u6211\u4eec\u9700\u8981\u8ba1\u7b97$f(x)$\uff0c\u4e8b\u5b9e\u4e0a\u5b83\u4e5f\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u8ba1\u7b97\u3002<br/>\u5047\u8bbe\u5b58\u5728\u8fd9\u6837\u7684\u7d20\u56e0\u5b50$p$\uff0c\u5c31\u8bb0$f(x) = p$\u3002\u5982\u679c$x$\u8fd8\u662f\u591a\u4e2a\u7d20\u6570\u76f8\u4e58\uff0c\u5c31\u8bb0$f(x) = 1$\u3002\u5426\u5219\u8bb0\u4f5c$0$\uff0c\u53c8\u79f0\u4e3a\u201d\u6ca1\u6551\u4e86\u201d\u3002\u8fd9\u6837\u5c31\u53ea\u6709$f(x) \\\\gt 1$\u65f6\u624d\u6709\u6211\u4eec\u9700\u8981\u7684\u7ed3\u679c\u3002<br/><br/>\u5f53$x = 1$\u6216$x$\u4e3a\u8d28\u6570\u65f6\uff0c$f(x) = 1$\u3002<br/>\u6bcf\u6b21\u5f80\u4e00\u4e2a\u6570$i$\u52a0\u5165\u4e00\u4e2a\u7d20\u6570$p$\u65f6\uff0c\u9700\u8981\u8003\u8651\u4e0b\u9762\u7684\u60c5\u51b5\uff1a<br/>\u82e5$f(i) = 0$\uff0c\u90a3\u4e48\u6ca1\u6551\u4e86\u3002<br/>\u82e5$p \\\\mid i$\uff0c\u5e76\u4e14$f(i) = 1$\uff0c\u90a3\u4e48$ip$\u5c06\u4e0d\u518d\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c\u6b64\u65f6\u53ef\u4ee5\u8bb0\u4e0b$f(ip) = p$\u3002\u5982\u679c$f(i) > 1$\uff0c\u90a3\u4e48\u5b83\u6ca1\u6551\u4e86\u3002<br/>\u82e5$p \\\\not\\\\mid i$\uff0c\u90a3\u4e48$f$\u51fd\u6570\u503c\u4e0d\u4f1a\u6539\u53d8\u3002<br/><br/><br/><br/>\u8fd9\u6837\u5c31\u53ef\u4ee5\u6b22\u5feb\u5730\u8ba1\u7b97$f$\u51fd\u6570\u5566~<br/>\u56de\u5230\u4e4b\u524d\u7684\u95ee\u9898\uff0c\u6211\u4eec\u80fd\u591f\u8ba1\u7b97$g(x)$\u51fd\u6570\u540e\uff0c\u9884\u5904\u7406\u51fa\u5b83\u7684\u524d\u7f00\u548c\uff0c\u5c31\u53ef\u4ee5\u5728\u524d\u9762\u4f2a\u4ee3\u7801\u4e2d\u5c55\u793a\u7684\u8fed\u4ee3\u8fc7\u7a0b\u8ba1\u7b97\u7b54\u6848\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(\\\\sqrt{n} + \\\\sqrt{m})$\u3002<br/>\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u793a\u4f8b\uff1aDIVCNT2<br/>SPOJ DIVCNT2<br/><br/>\u8981\u6c42\u6c42\u51fa\uff1a<br/>$$ \\\\sum_{a = 1}^n \\\\sigma(a^2) $$<br/>\u7684\u503c\u3002\u5176\u4e2d$\\\\sigma(n)$\u8868\u793a$n$\u7684\u56e0\u5b50\u4e2a\u6570\u3002<br/><br/>\u8003\u8651\u8fd9\u4e48\u51e0\u4e2a\u7b49\u5f0f\u5173\u7cfb\uff1a<br/>$$<br/>\\\\sigma(n^2) = \\\\sum_{d \\\\mid n} 2^{\\\\omega(d)}<br/>\\\\tag{12.1}<br/>$$<br/>\u5176\u4e2d$\\\\omega(n)$\u8868\u793a$n$\u7684\u8d28\u56e0\u5b50\u4e2a\u6570\u3002\u4e3a\u4ec0\u4e48\u8fd9\u662f\u6b63\u786e\u7684\u5462\uff1f\u8003\u8651\u6bcf\u4e2a$n$\u7684\u56e0\u5b50$d$\uff0c$d^2$\u90fd\u662f$n^2$\u7684\u56e0\u5b50\u3002\u53e6\u5916\uff0c\u5bf9\u4e8e\u4efb\u610f$n$\u7684\u4efb\u610f\u4e24\u4e2a\u4e0d\u540c\u7684\u56e0\u5b50\uff0c\u5b83\u4eec\u7684\u8d28\u56e0\u6570\u5206\u89e3\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u7d20\u6570\u7684\u6b21\u6570\u7684\u5dee\u4e0d\u5c0f\u4e8e$1$\uff0c\u90a3\u4e48\u7ecf\u8fc7\u5e73\u65b9\u540e\uff0c\u8fd9\u4e2a\u5dee\u503c\u5c06\u4e0d\u5c0f\u4e8e$2$\u3002\u4e8e\u662f\u5b83\u4eec\u7684\u5e73\u65b9\u4efb\u610f\u5220\u53bb\u4e00\u4e2a\u7d20\u6570\u540e\uff0c\u662f\u4e0d\u4f1a\u51b2\u7a81\u7684\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u53ea\u8981\u5bf9\u6bcf\u4e2a$d^2$\uff0c\u90fd\u679a\u4e3e\u4e00\u4e0b\u5220\u53bb\u7d20\u6570\u7684\u65b9\u6848\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230$n^2$\u7684\u6240\u6709\u56e0\u5b50\u3002\u7b54\u6848\u4e5f\u5c31\u662f\u4e0a\u5f0f\u3002<br/>$$<br/>2^{\\\\omega(n)} = \\\\sum_{d \\\\mid n} \\\\mu^2(d)<br/>\\\\tag{12.2}<br/>$$<br/>\u8003\u8651\u5230$\\\\mu$\u51fd\u6570\u7684\u53d6\u503c\uff1a<br/>$$<br/>\\\\mu(n) =<br/>\\\\begin{cases}<br/>1 & (n = 1) \\\\\\\\<br/>(-1)^k & (n = p_1p_2\\\\cdots p_k, \\\\;\\\\;\\\\varphi(p_i) = p_i - 1) \\\\\\\\<br/>0 & (\\\\text{otherwise})<br/>\\\\end{cases}<br/>$$<br/>\u56e0\u6b64\uff1a<br/>$$<br/>\\\\mu^2(n) =<br/>\\\\begin{cases}<br/>1 & (n = 1) \\\\\\\\<br/>1 & (n = p_1p_2\\\\cdots p_k, \\\\;\\\\;\\\\varphi(p_i) = p_i - 1) \\\\\\\\<br/>0 & (\\\\text{otherwise})<br/>\\\\end{cases}<br/>$$<br/>\u5373\u53ea\u8981\u662f$d$\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c\u5c31\u4f1a\u5bf9\u7b54\u6848\u8d21\u732e\u3002\u5426\u5219\u6ca1\u6709\u8d21\u732e\u3002\u8fd9\u4e5f\u6b63\u662f$2^{\\\\omega(n)}$\u60f3\u8981\u7edf\u8ba1\u7684\u3002<br/>\u5bf9\u4e8e\u7701\u53bb\u4e86\u7b2c\u4e00\u7ef4\u7684\u6570\u8bba\u51fd\u6570$f$\u548c$g$\uff0c\u5b9a\u4e49\u5b83\u4eec\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u662f\u4e0b\u9762\u7684\u5f62\u5f0f\uff1a<br/>$$<br/>(f \\\\times g)(n) = \\\\sum_{d \\\\mid n} f(d)g\\\\left(\\\\frac{n}{d}\\\\right)<br/>\\\\tag{12.3}<br/>$$<br/>\u4e5f\u5c31\u662f\u5728\u504f\u5e8f\u96c6$(X_n, \\\\;\\\\mid)$\u4e0a\u7684\u5377\u79ef\u3002\u4ee4$f(n) = \\\\sigma(n^2)$\uff0c$g(n) = 2^{\\\\omega(n)}$\uff0c$h(n) = \\\\mu^2(n)$\u4ee5\u53ca$\\\\epsilon(n) = 1$\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u628a\u4e4b\u524d\u7684\u7ed3\u679c\u7b80\u5199\u4e3a\uff1a<br/>$$<br/>f = g \\\\times \\\\epsilon \\\\\\\\<br/>g = h \\\\times \\\\epsilon<br/>$$<br/>\u5229\u7528\u5377\u79ef\u7684\u7ed3\u5408\u5f8b\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>f & = (h \\\\times \\\\epsilon) \\\\times \\\\epsilon \\\\\\\\<br/>& = h \\\\times (\\\\epsilon \\\\times \\\\epsilon)<br/>\\\\end{aligned}<br/>$$<br/>\u6ce8\u610f\u5230\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\epsilon \\\\times \\\\epsilon & = \\\\sum_{d \\\\mid n} 1 \\\\\\\\<br/>& = \\\\sigma(n)<br/>\\\\end{aligned}<br/>$$<br/>\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u6c42\u7684\u4e1c\u897f\u4e5f\u5c31\u662f\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{i = 1}^n f(i) & = \\\\sum_{i = 1}^n \\\\sum_{d \\\\mid i} \\\\mu^2(d) \\\\sigma\\\\left({i \\\\over d}\\\\right) \\\\\\\\<br/>& = \\\\sum_{i = 1}^n \\\\mu^2(i) \\\\sum_{j = 1}^{\\\\left\\\\lfloor {n \\\\over i} \\\\right\\\\rfloor} \\\\sigma(j)<br/>\\\\end{aligned}<br/>$$<br/>\u9996\u5148\u8003\u8651$\\\\sigma(n)$\u7684\u524d\u7f00\u548c\u5982\u4f55\u8ba1\u7b97\uff1a<br/>$$<br/>\\\\sum_{i = 1}^n \\\\sigma(i) = \\\\sum_{i = 1}^n \\\\left\\\\lfloor {n \\\\over i} \\\\right\\\\rfloor<br/>\\\\tag{12.4}<br/>$$<br/>\u7531\u4e8e\u4e0b\u53d6\u6574\u53ef\u4ee5\u5206\u6bb5\uff0c\u6240\u4ee5\u53ef\u4ee5\u5728$O(\\\\sqrt{n})$\u7684\u590d\u6742\u5ea6\u5185\u8ba1\u7b97\u3002<br/>\u7136\u540e\u8003\u8651$\\\\mu^2(n)$\u7684\u524d\u7f00\u548c\u5982\u4f55\u8ba1\u7b97\uff1a<br/>$$<br/>\\\\sum_{i = 1}^n \\\\mu^2(i) = \\\\sum_{i = 1}^{\\\\sqrt{n}} \\\\mu(i)\\\\left\\\\lfloor {n \\\\over i^2} \\\\right\\\\rfloor<br/>\\\\tag{12.5}<br/>$$<br/>\u8fd9\u662f\u4e3a\u4ec0\u4e48\uff1f\u7ed3\u5408$\\\\mu^2(n)$\u7684\u610f\u4e49\uff0c\u8fd9\u4e2a\u524d\u7f00\u548c\u5c31\u662f\u7edf\u8ba1\u524d$n$\u4e2a\u6570\u91cc\u9762\uff0c\u6709\u591a\u5c11\u4e2a\u6570\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\u3002\u5f53$i = 1$\u65f6\uff0c\u6240\u6709\u6570\u5b57\u5747\u88ab\u7edf\u8ba1\u4e86\u4e00\u904d\u3002\u7136\u540e\u679a\u4e3e$1$\u5230$\\\\sqrt{n}$\u7684\u6bcf\u4e2a\u6570\u5b57\uff0c\u5982\u679c\u4e0d\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c$\\\\mu(i)$\u4f1a\u8fd4\u56de$0$\u3002\u5982\u679c\u662f\u7d20\u6570\u8fde\u4e58\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u5b83\u7684\u4efb\u610f\u5927\u4e8e$1$\u7684\u6b21\u6570\u7684\u5e42\u90fd\u4e0d\u662f\u7b54\u6848\uff0c\u6b64\u65f6\u5e94\u5f53\u5220\u53bb\u3002\u4e8e\u662f$\\\\mu$\u51fd\u6570\u5728\u6b64\u5145\u5f53\u4e86\u5bb9\u65a5\u7cfb\u6570\u3002<br/>\u56de\u5230\u4e4b\u524d\u7684\u5f0f\u5b50\uff1a<br/>$$<br/>\\\\sum_{i = 1}^n \\\\mu^2(i) \\\\sum_{j = 1}^{\\\\left\\\\lfloor {n \\\\over i} \\\\right\\\\rfloor} \\\\sigma(j)<br/>$$<br/>\u5bf9\u4e8e$\\\\sigma(n)$\u7684\u524d\u7f00\u548c\u7684\u4e0a\u6807\u4e5f\u662f\u53ef\u4ee5\u5206\u6bb5\u7684\uff0c\u8fd9\u6837\u5c31\u9700\u8981\u7528\u5230$\\\\mu^2(n)$\u7684\u524d\u7f00\u548c\u3002<br/>\u6240\u4ee5\u6700\u540e\u7684\u590d\u6742\u5ea6\u53ef\u4ee5\u8fd9\u6837\u4f30\u8ba1\uff1a<br/>$$<br/>\\\\sum_{k = 1}^{\\\\sqrt{n}} \\\\sqrt{k} + \\\\sum_{k = 1}^{\\\\sqrt{n}} \\\\sqrt{{n \\\\over k}}<br/>\\\\tag{12.6}<br/>$$<br/>\u663e\u7136\u53f3\u8fb9\u7684\u4ee3\u4ef7\u66f4\u9ad8\u3002\u7528\u79ef\u5206\u53ef\u4ee5\u4f30\u8ba1\u4e00\u4e0b\uff1a<br/>$$<br/>\\\\sum_{k = 1}^{\\\\lfloor \\\\sqrt{n} \\\\rfloor} \\\\sqrt{n \\\\over k} \\\\leqslant \\\\int_0^{\\\\lfloor \\\\sqrt{n} \\\\rfloor} \\\\sqrt{n \\\\over x} \\\\;\\\\mathrm{d}x = O(n^{3/4})<br/>$$<br/>\u5982\u679c\u9884\u5904\u7406\u524d$S$\u4e2a\u524d\u7f00\u548c\u7684\u7b54\u6848\uff0c\u5f53\u8be2\u95ee$\\\\mu^2(n)$\u548c$\\\\sigma(n)$\u7684\u524d\u7f00\u548c\u65f6\uff0c\u5982\u679c$n \\\\leqslant S$\uff0c\u5c31\u76f4\u63a5\u8fd4\u56de\u9884\u5904\u7406\u7684\u503c\u3002\u90a3\u4e48\u590d\u6742\u5ea6\u5927\u7ea6\u4e3a\uff1a<br/>$$<br/>\\\\sum_{k = 1}^{\\\\min\\\\{\\\\lfloor \\\\sqrt{n} \\\\rfloor, \\\\lfloor n / S \\\\rfloor\\\\}} \\\\sqrt{n \\\\over x}<br/>\\\\tag{12.7}<br/>$$<br/>\u5f53$S \\\\lt \\\\sqrt{n}$\u65f6\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u5206\u6790\u4e0d\u53d8\u3002\u5426\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e0a\u754c\u53d8\u4e3a\uff1a<br/>$$<br/>O\\\\left(S + {n \\\\over \\\\sqrt{S}}\\\\right)<br/>$$<br/>\u5f53$S = n / \\\\sqrt{S}$\u65f6\u53d6\u5f97\u6700\u5c0f\u503c\uff0c\u6b64\u65f6$S = n^{2/3}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^{2/3})$\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u7a7a\u95f4\u4e0a\u4e5f\u8981\u4ed8\u51fa\u540c\u6837\u7684\u4ee3\u4ef7\u3002<br/><br/><br/><br/><br/>\u5728\u504f\u5e8f\u96c6$(X_n,\\\\;\\\\mid\\\\;)$\u4e0a\u7b80\u5316\u540e\u7684\u5377\u79ef (\u5373\u72c4\u5229\u514b\u96f7\u5377\u79ef)\uff0c\u4f1a\u6ee1\u8db3\u4ea4\u6362\u5f8b\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-8-18/mobius.html"
},
"\u8ba1\u7b97\u5206\u62c6\u6570\u7684\u4e00\u79cd\u65b9\u6cd5": {
"tags": "\u5206\u62c6\u6570 \u7ec4\u5408\u6570\u5b66 FFT",
"text": "\u8ba1\u7b97\u5206\u62c6\u6570\u7684\u4e00\u79cd\u65b9\u6cd5<br/>\u539f\u59cb\u95ee\u9898<br/>\u7ed9\u5b9a $n$\uff0c\u8981\u6c42\u8ba1\u7b97 $p(n)$ \u548c $q(n)$\uff0c\u5176\u4e2d $p(n)$ \u8868\u793a $n$ \u7684\u5206\u62c6\u65b9\u6848\u603b\u6570\uff0c$q(n)$ \u8868\u793a $n$ \u7684\u4e0d\u4f7f\u7528\u91cd\u590d\u5143\u7d20\u7684\u5206\u62c6\u65b9\u6848\u603b\u6570\u3002<br/>\u4f8b\u5982 $p(4) = 5$\uff0c\u56e0\u4e3a\u6709\u4ee5\u4e0b\u51e0\u79cd\u5206\u62c6\u65b9\u6848\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>4 & = 4 \\\\\\\\<br/>4 & = 3 + 1 \\\\\\\\<br/>4 & = 2 + 2 \\\\\\\\<br/>4 & = 2 + 1 + 1 \\\\\\\\<br/>4 & = 1 + 1 + 1 + 1<br/>\\\\end{aligned}<br/>$$<br/>\u800c $q(4) = 2$\uff0c\u56e0\u4e3a\u5728\u4e0a\u9762\u53ea\u6709\u524d\u4e24\u79cd\u6ca1\u6709\u51fa\u73b0\u91cd\u590d\u5143\u7d20\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u91cc\u5c06\u4e0e\u6570\u5b57\u76f8\u5173\u7684\u57fa\u672c\u8fd0\u7b97\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u89c6\u4e3a\u5e38\u6570\u65f6\u95f4\u3002<br/>\u57fa\u672c\u601d\u8def<br/>\u4e3b\u8981\u8fd8\u662f\u5229\u7528\u53cc\u8ba1\u6570\u7684\u5957\u8def\uff0c\u5bf9\u4e8e $p(n)$\uff0c\u5bb9\u6613\u5f97\u77e5\uff1a<br/>$$<br/>np(n) = \\\\sum_{k=1}^n k \\\\sum_{t=1}^{\\\\lfloor n / k \\\\rfloor} p(n - kt)<br/>$$<br/>\u5bf9\u4e8e $q(n)$\uff0c\u53cc\u8ba1\u6570\u8c8c\u4f3c\u5c31\u6ca1\u6cd5\u76f4\u63a5\u4f7f\u7528\u4e86\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e1\uff1a<br/><br/>\u5c06 $n$ \u62c6\u5206\u4e3a\u4e0d\u540c\u7684\u90e8\u5206\u7684\u65b9\u6848\u6570\u7b49\u4e8e\u5c06 $n$ \u62c6\u5206\u4e3a\u5404\u90e8\u5206\u90fd\u662f\u5947\u6570\u7684\u65b9\u6848\u6570\u3002<br/><br/>\u8bc1\u660e $1$\uff1a \u8003\u8651\u6784\u9020\u53cc\u5c04\u3002<br/>\u7531\u4e8e\u6bcf\u4e2a\u6570 $n$ \u90fd\u53ef\u4ee5\u88ab\u552f\u4e00\u8868\u793a\u4e3a $2^k \\\\cdot t$ \u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $t$ \u662f\u5947\u6570\u3002\u5229\u7528\u8fd9\u4e00\u70b9\u53ef\u4ee5\u6c9f\u901a\u4e0a\u8ff0\u4e24\u79cd\u62c6\u5206\u65b9\u6cd5\u3002<br/><br/>\u7ed9\u5b9a\u4e00\u4e2a\u6bcf\u4e2a\u90e8\u5206\u4e0d\u540c\u7684\u62c6\u5206\u65b9\u6848\uff0c\u6784\u9020\u4e00\u4e2a\u65b0\u7684\u62c6\u5206\u65b9\u6848\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u6570 $n = 2^k \\\\cdot t$\uff0c\u5728\u65b0\u65b9\u6848\u4e2d\u52a0\u5165 $2^k$ \u4e2a $t$\u3002\u6613\u77e5\u65b0\u65b9\u6848\u4e2d\u7684\u6bcf\u4e2a\u90e8\u5206\u90fd\u662f\u5947\u6570\u3002<br/>\u4ece\u4e0a\u9762\u7ed9\u51fa\u7684\u65b0\u65b9\u6848\u8fd8\u539f\u539f\u6765\u7684\u65b9\u6848\uff1a\u7edf\u8ba1\u6bcf\u4e2a\u5947\u6570 $t$ \u7684\u51fa\u73b0\u6b21\u6570 $c$\uff0c\u5e76\u5c06\u5176\u8868\u793a\u4e3a\u4e8c\u8fdb\u5236\uff0c\u5373 $c = c_0c_1...{c_p}_{(2)}$\u3002\u5bf9\u4e8e $0 \\\\leqslant k \\\\leqslant p$\uff0c\u5982\u679c $c_k = 1$\uff0c\u90a3\u4e48\u8868\u793a\u539f\u65b9\u6848\u4e2d\u6709\u4e00\u4e2a\u6570\u4e3a $2^k \\\\cdot t$\u3002<br/><br/>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982 $6 = 1 + 2 + 3$\uff0c\u6309\u7167\u4e0a\u8ff0\u65b9\u6cd5\u8f6c\u4e3a\u5168\u90e8\u90fd\u662f\u5947\u6570\u7684\u65b9\u6848\u5c31\u662f $6 = 1 + 1 + 1 + 3$\uff0c\u8fd9\u91cc $1$ \u51fa\u73b0\u4e86 $3 = 11_{(2)}$ \u6b21\uff0c\u6240\u4ee5\u77e5\u9053\u539f\u65b9\u6848\u4e2d\u6709 $2^0 \\\\times 1 = 1$ \u548c $2^1 \\\\times 1 = 2$ \u8fd9\u4e24\u4e2a\u6570\u3002<br/>\u8bc1\u660e $2$\uff1a \u5229\u7528\u751f\u6210\u51fd\u6570\u76f4\u63a5\u8bc1\u660e\u3002\u636e\u8bf4\u662f\u6b27\u62c9\u5f53\u65f6\u7ed9\u51fa\u7684\u8bc1\u660e\u3002<br/>\u6839\u636e\u51e0\u4f55\u7ea7\u6570\uff0c\u6211\u4eec\u77e5\u9053\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>1 + x^k & = \\\\sum_{k = 0}^\\\\infty x^k - x^{2k}\\\\sum_{k = 0}^\\\\infty x^k \\\\\\\\<br/>& = {1 - x^{2k} \\\\over 1 - x^k} \\\\;\\\\;\\\\;\\\\; (|x| < 1)<br/>\\\\end{aligned}<br/>$$<br/>\u6ce8\u610f\u5230\u5206\u5b50\u90e8\u5206\u603b\u662f\u5076\u6570\u6b21\u5e42\u3002\u56e0\u6b64\u8bbe $o(n)$ \u8868\u793a\u5c06 $n$ \u5206\u4e3a\u6bcf\u4e2a\u90e8\u5206\u5747\u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\uff0c\u5219\uff1a<br/>$$<br/>\\\\begin{aligned}<br/>\\\\sum_{k = 0}^\\\\infty q(k)x^k & = \\\\prod_{k = 1}^\\\\infty (1 + x^k) \\\\\\\\<br/>& = \\\\prod_{k = 1}^\\\\infty {1 - x^{2k} \\\\over 1 - x^k} \\\\\\\\<br/>& = {1 - x^2 \\\\over 1 - x}{1 - x^4 \\\\over 1 - x^2}{1 - x^6 \\\\over 1 - x^3}{1 - x^8 \\\\over 1 - x^4}\\\\cdots \\\\\\\\<br/>& = \\\\prod_{k = 0}^\\\\infty {1 \\\\over 1 - x^{2k + 1}} \\\\\\\\<br/>& = \\\\prod_{k = 0}^\\\\infty \\\\left(\\\\sum_{j = 0}^\\\\infty x^{j(2k + 1)} \\\\right) = \\\\sum_{k = 0}^\\\\infty o(k)x^k<br/>\\\\end{aligned}<br/>$$<br/>\u5373 $q(n)$ \u7684\u751f\u6210\u51fd\u6570\u4e0e $o(n)$ \u662f\u4e00\u6837\u7684\uff0c\u4ece\u800c\u8bc1\u660e\u5b83\u4eec\u76f8\u7b49\u3002<br/>\u73b0\u5728\u56de\u5230\u539f\u6765\u7684\u95ee\u9898\uff0c\u7531\u4e8e\u53ea\u662f\u8981\u6c42\u6bcf\u4e2a\u90e8\u5206\u90fd\u662f\u5947\u6570\uff0c\u6240\u4ee5\u53ef\u4ee5\u518d\u4e00\u6b21\u8fd0\u7528\u53cc\u8ba1\u6570\uff1a<br/>$$<br/>nq(n) = \\\\sum_{k = 1}^n (k \\\\bmod 2) k \\\\sum_{t = 1}^{\\\\lfloor n / k \\\\rfloor} q(n - kt)<br/>$$<br/>\u73b0\u5728\u4ee4 $T = kt$ \u6362\u5143\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a<br/>$$<br/>nq(n) = \\\\sum_{T = 1}^n q(n - T) \\\\sum_{k | T} (k \\\\bmod 2)k<br/>$$<br/>\u4ee4 $c(n) = \\\\sum_{k | n} (k \\\\bmod 2)k$\uff0c\u5373 $n$ \u7684\u6240\u6709\u5947\u6570\u56e0\u5b50\u4e4b\u548c\uff0c\u5e76\u4e14\u6613\u77e5 $c(0) = 0$\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u5f0f\u5b50\u53ef\u4ee5\u7b80\u5316\u4e3a\uff1a<br/>$$<br/>nq(n) = \\\\sum_{k = 0}^n c(k)q(n - k)<br/>$$<br/>\u53d8\u6210\u4e86\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u3002$c(1)$ \u5230 $c(n)$ \u663e\u7136\u53ef\u4ee5\u5728$O(n \\\\ln n)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa\u6765\uff0c\u6b64\u5916\u4f7f\u7528 \u201c\u5206\u6cbb + FFT\u201d \u5c31\u53ef\u4ee5\u5728 $O(n \\\\log^2 n)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97 $q(1)$ \u5230 $q(n)$ \u6240\u6709\u7684\u503c\u3002\u4e0a\u8ff0\u63a8\u5bfc\u8fc7\u7a0b\u5bf9\u4e8e $p(n)$ \u6765\u8bb2\u662f\u4e00\u6837\u7684\u3002<br/>\u5b9e\u73b0<br/>\u4e0b\u9762\u7684\u7a0b\u5e8f\u5b9e\u73b0\u4e86\u8ba1\u7b97 $q(0)$ \u5230 $q(n)$ \u6240\u6709\u7684\u503c\u5728\u6a21 $998244353$ \u610f\u4e49\u4e0b\u7684\u503c\uff1a<br/>  1<br/>  2<br/>  3<br/>  4<br/>  5<br/>  6<br/>  7<br/>  8<br/>  9<br/> 10<br/> 11<br/> 12<br/> 13<br/> 14<br/> 15<br/> 16<br/> 17<br/> 18<br/> 19<br/> 20<br/> 21<br/> 22<br/> 23<br/> 24<br/> 25<br/> 26<br/> 27<br/> 28<br/> 29<br/> 30<br/> 31<br/> 32<br/> 33<br/> 34<br/> 35<br/> 36<br/> 37<br/> 38<br/> 39<br/> 40<br/> 41<br/> 42<br/> 43<br/> 44<br/> 45<br/> 46<br/> 47<br/> 48<br/> 49<br/> 50<br/> 51<br/> 52<br/> 53<br/> 54<br/> 55<br/> 56<br/> 57<br/> 58<br/> 59<br/> 60<br/> 61<br/> 62<br/> 63<br/> 64<br/> 65<br/> 66<br/> 67<br/> 68<br/> 69<br/> 70<br/> 71<br/> 72<br/> 73<br/> 74<br/> 75<br/> 76<br/> 77<br/> 78<br/> 79<br/> 80<br/> 81<br/> 82<br/> 83<br/> 84<br/> 85<br/> 86<br/> 87<br/> 88<br/> 89<br/> 90<br/> 91<br/> 92<br/> 93<br/> 94<br/> 95<br/> 96<br/> 97<br/> 98<br/> 99<br/>100<br/>101<br/>102<br/>103<br/>104<br/>105<br/>106<br/>107<br/>108<br/>109<br/>110<br/>111<br/>112<br/>113<br/>114<br/>115<br/>116<br/>117<br/>118<br/>119<br/>120<br/>121<br/>122<br/>123<br/>124<br/>125<br/>126<br/>127#include <cstring><br/><br/>#include <algorithm><br/>#include <iostream><br/><br/>using namespace std;<br/><br/>#define NMAX 400000<br/>#define MOD 998244353<br/>#define G 3<br/><br/>typedef long long i64;<br/><br/>inline i64 qpow(i64 a, int b) {<br/>    i64 r = 1;<br/>    for (; b; a = a * a %  MOD, b >>= 1)<br/>        if (b & 1) r = r * a %  MOD;<br/>    return r;<br/>}<br/><br/>inline i64 inv(i64 x) {<br/>    return qpow(x, MOD - 2);<br/>}<br/><br/>inline void add(i64 &a, i64 b) {<br/>    a += b;<br/>    if (a >= MOD) a -= MOD;<br/>    else if (a < 0) a += MOD;<br/>}<br/><br/>inline int nxtp(int n) {<br/>    int r = 1;<br/>    for (; r < n; r <<= 1);<br/>    return r;<br/>}<br/><br/>void fft(i64 *a, int n, bool in = false) {<br/>    static i64 b[NMAX + 10];<br/>    memcpy(b, a, sizeof(i64) * n);<br/>    for (int i = 0, k = 0, j; i < n; k |= j, i++) {<br/>        a[i] = b[k];<br/>        for (j = n >> 1; k & j; k ^= j, j >>= 1); <br/>    }<br/><br/>    for (int s = 2; s <= n; s <<= 1) {<br/>        int l = s >> 1;<br/>        i64 wn = qpow(G, in ? MOD - (MOD - 1) / s - 1 : (MOD - 1) / s);<br/>        for (int i = 0; i < n; i += s) {<br/>            i64 w = 1;<br/>            for (int j = i; j < i + l; j++) {<br/>                i64 t = a[j + l];<br/>                a[j + l] = (a[j] - w * t) %  MOD;<br/>                a[j] = (a[j] + w * t) %  MOD;<br/>                w = w * wn %  MOD;<br/>            }<br/>        }<br/>    }<br/><br/>    if (in) {<br/>        i64 d = inv(n);<br/>        for (int i = 0; i < n; i++) {<br/>            a[i] = a[i] * d %  MOD;<br/>        }<br/>    }<br/>}<br/><br/>static int n;<br/>static i64 q[NMAX + 10], c[NMAX + 10];<br/><br/>void initialize() {<br/>    ios::sync_with_stdio(false);<br/><br/>    cin >> n;<br/>    q[0] = 1;<br/><br/>    for (int i = 1; i <= n; i += 2) {<br/>        for (int j = i; j <= n; j += i) {<br/>            add(c[j], i);<br/>        }<br/>    }<br/>}<br/><br/>static i64 a[NMAX + 10], b[NMAX + 10];<br/><br/>void solve(int l, int r) {<br/>    if (l == r) {<br/>        if (l) q[l] = q[l] * inv(l) %  MOD;<br/>        return;<br/>    }<br/><br/>    int m = (l + r) >> 1;<br/>    solve(l, m);<br/><br/>    int alen = m - l + 1, blen = r - l + 1;<br/>    int len = nxtp(blen - 1);<br/><br/>    memset(a, 0, sizeof(i64) * len);<br/>    memset(b, 0, sizeof(i64) * len);<br/>    memcpy(a, q + l, sizeof(i64) * alen);<br/>    memcpy(b, c, sizeof(i64) * blen);<br/><br/>    fft(a, len);<br/>    fft(b, len);<br/>    for (int i = 0; i < len; i++) {<br/>        a[i] = a[i] * b[i] %  MOD;<br/>    }<br/>    fft(a, len, true);<br/><br/>    for (int i = alen; i < blen; i++) {<br/>        add(q[m + i - alen + 1], a[i]);<br/>    }<br/><br/>    solve(m + 1, r);<br/>}<br/><br/>int main() {<br/>    initialize();<br/><br/>    solve(0, n);<br/><br/>    for (int i = 0; i <= n; i++) {<br/>        cout << q[i] << \\  \\ ;<br/>    }<br/>    cout << \\ \\\\n\\ ;<br/><br/>    return 0;<br/>}<br/><br/><br/><br/><br/><br/><br/>\u8fd9\u91cc\u4e5f\u6709\u4e0b\u9762\u4e24\u4e2a\u8bc1\u660e\uff1ahttps://math.stackexchange.com/q/54976\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-10-1/p-and-q.html"
},
"\u8ba1\u7b97\u7eaf\u7535\u963b\u7f51\u7edc\u7684\u7b49\u6548\u7535\u963b": {
"tags": "\u7535\u963b\u7f51\u7edc \u9ad8\u65af\u6d88\u5143",
"text": "\u8ba1\u7b97\u7eaf\u7535\u963b\u7f51\u7edc\u7684\u7b49\u6548\u7535\u963b<br/><br/>\u8ba1\u7b97\u7eaf\u7535\u963b\u7f51\u7edc\u7684\u7b49\u6548\u7535\u963b\uff0c\u4e0e\u8ba1\u7b97\u70f7\u70c3\u7684\u540c\u5206\u5f02\u6784\u4f53\u6570\u91cf\uff0c\u662f\u8bb8\u591a\u5b66\u4e60 OI \u7684\u9ad8\u4e2d\u751f\u60f3\u8981\u89e3\u51b3\u7684\u95ee\u9898\u3002\u4e0d\u8fc7\u76f8\u6bd4\u4e8e\u8ba1\u7b97\u70f7\u70c3\u7684\u540c\u5206\u5f02\u6784\u4f53\u6570\u91cf\u800c\u8a00\uff0c\u8fd9\u4e2a\u95ee\u9898\u7b80\u5355\u5f88\u591a\u3002\u672c\u6587\u5c06\u4ecb\u7ecd\u4e00\u79cd\u7b80\u5355\u7684\u7b49\u6548\u7535\u963b\u8ba1\u7b97\u65b9\u6cd5\uff0c\u5e76\u7ed9\u51fa\u4e00\u4e2a\u8ba1\u7b97\u6240\u6709\u63a5\u5165\u7535\u8def\u65b9\u6848\u7684\u7b49\u6548\u7535\u963b\u7684\u7b97\u6cd5\u3002<br/><br/>\u57fa\u672c\u6982\u5ff5<br/><br/>\u4e0a\u56fe\u662f\u7535\u963b\u7f51\u7edc\u7684\u4e00\u4e2a\u793a\u610f\u56fe\u3002\u5176\u4e2d\u77e9\u5f62\u8868\u793a\u7eaf\u7535\u963b\uff0c\u4e0a\u9762\u53ef\u80fd\u4f1a\u6807\u6ce8\u5b83\u7684\u963b\u503c\u3002\u7c97\u7ebf\u8868\u793a\u5bfc\u7ebf\uff0c\u5bfc\u7ebf\u7684\u4ea4\u70b9\u901a\u5e38\u4f1a\u662f\u63a5\u7ebf\u67f1\u4e4b\u7c7b\u7684\u4e1c\u897f\uff0c\u79f0\u4e4b\u4e3a\u8282\u70b9\uff0c\u53ef\u4ee5\u8fde\u5165\u5916\u90e8\u7535\u8def\u3002\u6211\u4eec\u7684\u76ee\u6807\u662f\uff0c\u7ed9\u51fa\u8fd9\u4e2a\u7f51\u7edc\u7684\u7ed3\u6784\u3001\u6bcf\u4e2a\u7535\u963b\u7684\u963b\u503c\u4ee5\u53ca\u63a5\u5165\u5916\u7535\u8def\u7684\u4e24\u4e2a\u8282\u70b9\uff08\u4e00\u4e2a\u662f\u7535\u6d41\u6d41\u5165\u7684\u4f4d\u7f6e\uff0c\u53e6\u4e00\u4e2a\u662f\u7535\u6d41\u6d41\u51fa\u7684\u4f4d\u7f6e\uff0c\u5982\u4e0a\u56fe\u4e2d\u7684\u5de6\u8fb9\u548c\u53f3\u8fb9\u4e24\u4e2a\u4e0d\u95ed\u5408\u7684\u5bfc\u7ebf\uff09\uff0c\u8ba1\u7b97\u51fa\u5b83\u7684\u7b49\u6548\u7535\u963b\uff0c\u5373\u7535\u6d41\u7ecf\u8fc7\u7535\u963b\u7f51\u7edc\u65f6\u7684\u7535\u538b $U$ \u4e0e\u6d41\u5165\u7535\u6d41 $I$ \u4e4b\u6bd4\u3002\u4f8b\u5982\uff0c\u4e0a\u56fe\u8868\u793a\u7684\u7535\u963b\u7f51\u7edc\u7684\u7b49\u6548\u7535\u963b\u4e3a $159/71\\\\;\\\\Omega \\\\approx 2.239\\\\;\\\\Omega$\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\uff0c\u8fd9\u91cc\u5c06\u7535\u963b\u7f51\u7edc\u8f6c\u4e3a\u56fe\u8bba\u7684\u6a21\u578b\u3002\u56fe\u4e2d\u4e00\u5171\u6709 $n$ \u4e2a\u8282\u70b9\u548c $m$ \u4e2a\u7535\u963b\uff0c\u6bcf\u4e2a\u8282\u70b9\u5bf9\u5e94\u56fe\u4e2d\u7684\u70b9\uff0c\u6bcf\u4e2a\u7535\u963b\u5bf9\u5e94\u56fe\u4e2d\u7684\u4e00\u6761\u8fb9\uff0c\u7528\u8fb9\u6743\u8868\u793a\u7535\u963b\u7684\u963b\u503c\u3002\u4f8b\u5982\uff0c\u4e0a\u9762\u5c55\u793a\u7684\u7535\u963b\u7f51\u7edc\u53ef\u4ee5\u8868\u793a\u4e3a\u4e0b\u9762\u7684\u5f62\u5f0f\uff1a<br/><br/>\u63a5\u5165\u7535\u8def\u540e\uff0c\u6bcf\u4e2a\u7535\u963b\u4e0a\u90fd\u4f1a\u901a\u6709\u7535\u6d41\uff0c\u8bb0\u4e3a $I$\u3002\u7535\u6d41\u6709\u65b9\u5411\u4e4b\u5206\uff0c\u5982\u679c\u67d0\u6761\u8fb9 $(u,\\\\;v)$ \u4e0a\u7684\u7684\u7535\u6d41\u662f\u4ece $u$ \u6d41\u5411 $v$ \u7684\uff0c\u90a3\u4e48 $I_{uv} = -I_{vu} \\\\geqslant 0$\u3002\u8bbe\u8fd9\u6761\u8fb9\u7684\u7535\u963b\u4e3a $R_{uv} = R_{vu}$\uff0c\u90a3\u4e48\u5b83\u7684\u7535\u538b\u4e3a $U_{uv} = -U_{vu} = I_{uv}R_{uv}$\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u79f0\u5916\u90e8\u7535\u6d41\u6d41\u5165\u7f51\u7edc\u7684\u8282\u70b9\u4e3a\u6e90\u70b9 $s$\uff0c\u4ece\u7f51\u7edc\u6d41\u51fa\u5230\u5916\u90e8\u7535\u8def\u7684\u8282\u70b9\u4e3a\u6c47\u70b9 $t$\uff0c$(s,\\\\;t)$ \u79f0\u4f5c\u4e00\u4e2a\u70b9\u5bf9\u3002\u663e\u7136\u4e0d\u540c\u7684\u6e90\u70b9\u548c\u6c47\u70b9\u8ba1\u7b97\u51fa\u6765\u7684\u7b49\u6548\u7535\u963b\u4f1a\u662f\u4e0d\u540c\u7684\u3002<br/>\u8ba1\u7b97\u4e00\u4e2a\u70b9\u5bf9<br/>\u9996\u5148\u6211\u4eec\u9700\u8981\u77e5\u9053\u6bd4\u8f83\u76f4\u89c2\u7684\u57fa\u5c14\u970d\u592b\u5b9a\u5f8b\uff1a<br/><br/>\u57fa\u5c14\u970d\u592b\u7535\u6d41\u5b9a\u5f8b\uff1a\u6240\u6709\u8fdb\u5165\u67d0\u8282\u70b9\u7684\u7535\u6d41\u7684\u603b\u548c\u7b49\u4e8e\u6240\u6709\u79bb\u5f00\u8be5\u8282\u70b9\u7684\u7535\u6d41\u7684\u603b\u548c\u3002<br/>\u57fa\u5c14\u970d\u592b\u7535\u538b\u5b9a\u5f8b\uff1a\u6cbf\u7740\u95ed\u5408\u56de\u8def\u6240\u6709\u5143\u4ef6\u4e24\u7aef\u7684\u7535\u538b\u7684\u4ee3\u6570\u548c\u7b49\u4e8e\u96f6\u3002<br/><br/>\u6839\u636e\u8fd9\u4e24\u70b9\uff0c\u5982\u4f55\u6c42\u51fa\u7b49\u6548\u7535\u963b\u5462\uff1f\u9996\u5148\u53ef\u4ee5\u5047\u5b9a\u6d41\u5165\u7684\u7535\u6d41\u4e3a $1\\\\;\\\\mathrm{A}$\uff0c\u7136\u540e\u5c31\u53ea\u9700\u6c42\u51fa\u6e90\u70b9\u5230\u6c47\u70b9\u7684\u7535\u538b\u5373\u53ef\u3002\u6839\u636e\u7535\u538b\u5b9a\u5f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ece\u6e90\u70b9\u5230\u6c47\u70b9\u7684\u4efb\u610f\u4e00\u6761\u8def\u5f84\u7684\u7535\u538b\u662f\u5b9a\u503c\u3002\u539f\u56e0\u975e\u5e38\u7b80\u5355\uff0c\u5bf9\u4e8e\u4e24\u6761\u4e0d\u540c\u7684\u8def\u5f84\uff1a<br/><br/>\u5982\u679c\u5b58\u5728\u4e0d\u91cd\u5408\u7684\u90e8\u5206\uff0c\u6211\u4eec\u5bf9\u8fd9\u4e2a\u90e8\u5206\u8fdb\u884c\u8c03\u6574\uff0c\u5728\u7535\u538b\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u4e00\u6761\u8def\u5f84\u53d8\u4e3a\u53e6\u5916\u4e00\u6761\u8def\u5f84\u3002\u5982\u4e0a\u56fe\uff0c\u8bbe\u5de6\u8fb9\u7684\u5206\u5c94\u70b9\u4e3a $A$\uff0c\u53f3\u8fb9\u7684\u5206\u5c94\u70b9\u4e3a $B$\uff0c\u7531\u4e8e\u56de\u8def\u7535\u538b\u4e3a $0$\uff0c\u6240\u4ee5\u4e0b\u9762\u90a3\u4e00\u6761\u4ece $A$ \u5230 $B$ \u7684\u8def\u5f84\u7684\u7535\u538b $U_1$ \u4e0e\u4ece $B$ \u5230 $A$ \u7684\u7535\u538b $U_2$ \u7684\u4ee3\u6570\u548c\u4e3a $0$\uff0c\u5373 $U_1 + U_2 = 0$\uff0c\u800c\u9760\u4e0a\u9762\u7684\u4ece $A$ \u5230 $B$ \u7684\u7535\u538b $U_3 = -U_2$\uff0c\u56e0\u6b64 $U_1 = U_3$\uff0c\u4ece\u800c\u53d1\u73b0\u4e0a\u8ff0\u89c4\u5f8b\u3002\u7531\u4e8e\u5047\u5b9a\u6d41\u5165\u7684\u7535\u6d41\u662f $1\\\\;\\\\mathrm{A}$\uff0c\u6240\u4ee5\u7b49\u6548\u7535\u963b\u7b49\u4e8e\u7535\u538b\u7684\u7edd\u5bf9\u503c\u3002<br/>\u4e3a\u4e86\u6c42\u51fa\u7535\u538b\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6c42\u51fa\u6bcf\u4e2a\u7535\u963b\u4e0a\u7684\u7535\u6d41\u7684\u60c5\u51b5\u3002\u6839\u636e\u7535\u6d41\u5b9a\u5f8b\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5217\u51fa $n$ \u4e2a\u65b9\u7a0b\u3002\u4e0d\u8fc7\u5f88\u4e0d\u5e78\uff0c\u8fd9 $n$ \u4e2a\u65b9\u7a0b\u4e2d\u4efb\u610f\u4e00\u4e2a\u90fd\u53ef\u4ee5\u88ab\u5269\u4e0b $n - 1$ \u4e2a\u65b9\u7a0b\u8868\u793a\u51fa\u6765\uff0c\u610f\u601d\u662f\u6211\u4eec\u53ea\u6709 $n - 1$ \u4e2a\u65b9\u7a0b\u662f\u771f\u6b63\u6709\u7528\u7684\u3002\u8fb9\u6570\u4e00\u5171\u6709 $m$ \u6761\uff0c\u4e5f\u5c31\u662f $m$ \u4e2a\u672a\u77e5\u6570\uff0c\u8fd8\u9700\u8981\u627e\u51fa $m - n + 1$ \u4e2a\u7ebf\u6027\u72ec\u7acb\u7684\u65b9\u7a0b\u624d\u53ef\u4ee5\u89e3\u51fa\u5177\u4f53\u60c5\u51b5\u3002\u78b0\u5de7\u7684\u662f\uff0c\u5982\u679c\u7f51\u7edc\u662f\u8fde\u901a\u7684\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5b83\u7684\u4efb\u610f\u4e00\u68f5\u751f\u6210\u6811\uff0c\u521a\u597d\u6709 $m - n + 1$ \u6761\u975e\u6811\u8fb9\uff0c\u6bcf\u6761\u975e\u6811\u8fb9\u5747\u5bf9\u5e94\u4e86\u4e00\u4e2a\u73af\uff0c\u53ef\u4ee5\u4f9d\u6b64\u548c\u7535\u538b\u5b9a\u5f8b\u5217\u51fa\u5269\u4e0b\u7684\u65b9\u7a0b\u3002<br/>\u5f97\u5230\u4e86 $m$ \u4e2a\u65b9\u7a0b\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u9ad8\u65af\u6d88\u5143\u5728 $\\\\Theta(m^3)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa\u7535\u6d41\u7684\u5206\u914d\u60c5\u51b5\u4e86\u3002\u5f97\u5230\u6bcf\u4e2a\u7535\u963b\u4e0a\u7ecf\u8fc7\u7684\u7535\u6d41\u540e\uff0c\u4ece\u6e90\u70b9\u5230\u6c47\u70b9\u4efb\u610f\u627e\u4e00\u6761\u8def\u5f84\u8ba1\u7b97\u7535\u538b\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u7b49\u6548\u7535\u963b\u3002\u4e00\u822c\u6211\u4eec\u4f1a\u9009\u53d6 DFS \u751f\u6210\u6811\u6765\u5217\u51fa\u7535\u538b\u7684\u65b9\u7a0b\uff0c\u4e3b\u8981\u7684\u539f\u56e0\u5c31\u662f DFS \u751f\u6210\u6811\u4e0a\u7684\u975e\u6811\u8fb9\u90fd\u662f\u8fd4\u7956\u8fb9\uff0c\u65b9\u4fbf\u904d\u5386\u5bf9\u5e94\u7684\u73af\u4e0a\u7684\u6240\u6709\u7684\u8fb9\u3002<br/>\u6211\u4f7f\u7528 Python \u5b9e\u73b0\u4e86\u4e0a\u9762\u6240\u8bf4\u7684\u8fc7\u7a0b\u3002\u4e0d\u8fc7\u5077\u4e86\u61d2\uff0c\u662f\u7528 SymPy \u89e3\u7684\u65b9\u7a0b......\u6240\u4ee5\u7b97\u7684\u4e0d\u662f\u5f88\u5feb\u3002\u5177\u4f53\u7684\u4ee3\u7801\u53ef\u4ee5\u67e5\u770b\u8fd9\u91cc\u3002<br/>\u8ba1\u7b97\u6240\u6709\u70b9\u5bf9<br/>\u60f3\u5230\u53ef\u4ee5\u8ba1\u7b97\u6240\u6709\u70b9\u5bf9\u7b49\u6548\u7535\u963b\u7684\u521d\u8877\u662f\u7531\u4e8e\u8ba1\u7b97\u4e0d\u540c\u70b9\u5bf9\u65f6\u7684\u5217\u51fa\u65b9\u7a0b\u7ec4\u5176\u5b9e\u6ca1\u6709\u591a\u5927\u5dee\u522b\uff0c\u53ea\u6709\u6e90\u70b9\u548c\u6c47\u70b9\u5217\u51fa\u7684\u7535\u6d41\u65b9\u7a0b\u5b58\u5728\u7740\u4e00\u4e2a\u5e38\u6570\u3002\u6839\u636e\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u4e0d\u59a8\u591a\u5199\u51e0\u4e2a\u53d8\u91cf $x_1,\\\\;x_2,\\\\;...,\\\\;x_{n - 1}$\uff0c\u8868\u793a\u6bcf\u4e2a\u8282\u70b9\u4ece\u5916\u90e8\u7535\u8def\u5f97\u5230\u7684\u7535\u6d41\u3002\u4e4b\u6240\u4ee5\u53ea\u5230 $x_{n - 1}$\uff0c\u662f\u56e0\u4e3a\u7535\u6d41\u65b9\u7a0b\u53ea\u5217\u51fa\u4e86 $n - 1$ \u4e2a\u3002\u5982\u679c $x_i = 0$ \u8868\u793a\u8282\u70b9 $i$ \u6ca1\u6709\u76f4\u63a5\u4e0e\u5916\u90e8\u7535\u8def\u76f8\u8fde\uff0c\u800c $x_i = 1$ \u548c $x_i = -1$ \u5206\u522b\u8868\u793a\u4ece\u5916\u90e8\u7535\u8def\u6d41\u5165\u548c\u6d41\u51fa\u5230\u5916\u90e8\u7535\u8def\u3002\u5728\u4e0d\u9884\u5148\u6307\u5b9a\u6e90\u70b9\u548c\u6c47\u70b9\u7684\u60c5\u51b5\u4e0b\u628a\u5b83\u4eec\u5f53\u505a\u5df2\u77e5\u91cf\u5199\u5165\u65b9\u7a0b\u3002\u867d\u7136\u73b0\u5728\u6709 $m + n - 1$ \u4e2a\u672a\u77e5\u6570\u5374\u53ea\u6709 $m$ \u4e2a\u65b9\u7a0b\uff0c\u4f46\u662f\u8fd9\u4e2a\u65f6\u5019\u6267\u884c\u9ad8\u65af\u6d88\u5143\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e2a\u7535\u6d41\u4e0e $x_1,\\\\;...,\\\\;x_{n-1}$ \u7684\u5173\u7cfb\uff08\u5982 $I_1 = 2x_1 + 0.3x_3$\uff09\u3002\u5982\u679c\u518d\u7ed9\u51fa $x_1,\\\\;...,\\\\;x_{n - 1}$ \u7684\u503c\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u6bcf\u4e2a\u7535\u6d41\u7684\u5177\u4f53\u503c\u3002<br/>\u73b0\u5728\u6765\u6307\u5b9a\u6e90\u70b9 $s$ \u548c\u6c47\u70b9 $t$\u3002\u76f8\u5f53\u4e8e\u4e4b\u524d\u65b0\u8bbe\u7684\u53d8\u91cf\u4e2d\uff0c\u4ee4 $x_s = 1$ \u548c $x_t = -1$\uff0c\u5176\u5b83\u7684\u5747\u4e3a $0$\u3002\u56e0\u6b64\u53ea\u7528 $\\\\Theta(n)$ \u7684\u65f6\u95f4\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6240\u6709\u7535\u6d41\u503c\uff0c\u4e5f\u5c31\u53ef\u4ee5\u7b97\u51fa\u7535\u963b\u3002\u7531\u4e8e\u70b9\u5bf9\u603b\u6570\u53ea\u6709 $\\\\Theta(n^2)$ \u5bf9\uff0c\u56e0\u6b64\u9ad8\u65af\u6d88\u5143\u540e\u53ea\u9700\u8981 $\\\\Theta(n^3)$ \u7684\u65f6\u95f4\u5c31\u53ef\u4ee5\u8ba1\u7b97\u6240\u6709\u7684\u7b49\u6548\u7535\u963b\u3002\u5728\u8fde\u901a\u56fe\u4e2d\uff0c\u5b58\u5728 $m \\\\geqslant n - 1$\uff0c\u56e0\u6b64\u603b\u7684\u590d\u6742\u5ea6\u4f9d\u7136\u4e3a $\\\\Theta(m^3)$\u3002<br/>\u6211\u7684 C++ \u5b9e\u73b0\u53ef\u4ee5\u5728\u8fd9\u91cc\u67e5\u770b\u3002",
"url": "blog/2017-10-28/resist.html"
},
"\u8bf1\u5bfc\u6392\u5e8f\u4e0eSA-IS\u7b97\u6cd5": {
"tags": "\u6570\u636e\u7ed3\u6784 \u5b57\u7b26\u4e32 \u540e\u7f00\u6570\u7ec4 \u8bf1\u5bfc\u6392\u5e8f SA-IS",
"text": "\u8bf1\u5bfc\u6392\u5e8f\u4e0eSA-IS\u7b97\u6cd5<br/>SA-IS\u662f\u4e00\u79cd\u5728\u5b9e\u9645\u8fd0\u7528\u4e2d\u76f8\u5f53\u5feb\u901f\u7684\u7ebf\u6027\u65f6\u95f4\u6784\u5efa\u5b57\u7b26\u4e32\u7684\u540e\u7f00\u6570\u7ec4\u7684\u7b97\u6cd5\u3002\u672c\u6587\u5c06\u901a\u8fc7\u5bf9\u539f\u8bba\u65871\u8fdb\u884c\u4e00\u4e9b\u7ffb\u8bd1\u548c\u603b\u7ed3\u6765\u4ecb\u7ecd\u8be5\u7b97\u6cd5\u3002\u6700\u540e\u4f1a\u63d0\u4f9b\u4e00\u4e2aSA-IS\u7b97\u6cd5\u7684C++\u5b9e\u73b0\u3002<br/>1. \u8bb0\u53f7<br/>\u73b0\u5728\u5148\u89c4\u5b9a\u4e00\u4e9b\u8bb0\u53f7\uff0c\u4ee5\u65b9\u4fbf\u4e4b\u540e\u7684\u8ba8\u8bba\u3002<br/>\u6211\u4eec\u901a\u5e38\u4f7f\u7528\u5927\u5199\u5b57\u6bcd$S, A, B, \\\\dots$\u6765\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5c0f\u5199\u5b57\u6bcd$a, b, c, \\\\dots$\u8868\u793a\u5355\u4e2a\u7684\u5b57\u7b26\u3002\u5b57\u7b26\u901a\u5e38\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u6574\u6570\u3002\u5b57\u7b26\u5728\u4e00\u5b9a\u6761\u4ef6\u4e0b\u6570\u91cf\u662f\u6709\u9650\u7684\uff0c\u6211\u4eec\u5c06\u6240\u6709\u4f1a\u7528\u5230\u7684\u5b57\u7b26\u653e\u5165\u5b57\u7b26\u96c6$\\\\Sigma$\u4e2d\uff0c\u6b64\u65f6$|\\\\Sigma|$\u8868\u793a\u5b57\u7b26\u96c6\u7684\u5927\u5c0f\u3002\u5b57\u7b26\u4e32\u4e4b\u95f4\u53ef\u4ee5\u4efb\u610f\u8fde\u63a5\uff0c\u5982$AB$\u8868\u793a\u5b57\u7b26\u4e32$A$\u4e0e\u5b57\u7b26\u4e32$B$\u4f9d\u6b21\u8fde\u63a5\u800c\u6210\u7684\u65b0\u5b57\u7b26\u4e32\u3002\u5b57\u7b26\u4e32\u4e0e\u5355\u4e2a\u5b57\u7b26\u4e4b\u95f4\u4e5f\u662f\u5982\u6b64\u3002\u7279\u522b\u7684\uff0c\u6211\u4eec\u5c06\u7a7a\u4e32\u8bb0\u4e3a$\\\\epsilon$\u3002<br/>\u5bf9\u4e8e\u4e00\u4e2a\u5b57\u7b26\u4e32\u6211\u4eec\u53ef\u4ee5\u8bbf\u95ee\u5176\u4e2d\u7684\u4efb\u610f\u5b57\u7b26\uff0c\u7528$S[x]$\u8868\u793a$S$\u4e2d\u4e0b\u6807\u4e3a$x$\u7684\u5b57\u7b26\u3002\u4e0b\u6807\u4ece$0$\u5f00\u59cb\u3002\u6211\u4eec\u7528$S[a, b]$\u8868\u793a$S$\u7684\u4e00\u4e2a\u5b50\u4e32\uff0c\u5373\u4e0b\u6807\u4e3a$a$\u7684\u5b57\u7b26\u5f00\u59cb\u4e00\u76f4\u5230\u4e0b\u6807\u4e3a$b$\u7684\u5b57\u7b26\u4f9d\u6b21\u8fde\u63a5\u800c\u6210\u7684\u5b57\u7b26\u4e32\uff0c\u5176\u4e2d\u5fc5\u987b\u6ee1\u8db3$0 \\\\le a \\\\le b \\\\lt |S|$\u3002\u5b9a\u4e49\u4e00\u4e2a\u5b57\u7b26\u4e32$S$\u7684\u524d\u7f00\u4e3a$\\\\text{prefix}(S, i) = S[0, i]$\uff0c\u5176\u540e\u7f00\u4e3a$\\\\text{suffix}(S, i) = S[i, |S| - 1]$\u3002<br/>\u4e24\u4e2a\u5b57\u7b26\u4e32$A$\u548c$B$\u4e4b\u95f4\u5b58\u5728\u6bd4\u8f83\u5173\u7cfb\u3002\u5f53$A$\u4e0e$B$\u7684\u957f\u5ea6\u76f8\u540c\uff0c\u4e14\u5176\u4e2d\u5bf9\u5e94\u4e0b\u6807\u7684\u5b57\u7b26\u4e5f\u76f8\u540c\u65f6\uff0c\u5219\u4e3a$A = B$\u3002\u5f53\u4ece\u5de6\u81f3\u53f3\u51fa\u73b0\u7b2c\u4e00\u5bf9\u4e0d\u76f8\u540c\u7684\u5b57\u7b26\u65f6\uff0c\u5219\u4ee5\u8fd9\u4e24\u4e2a\u5b57\u7b26\u7684\u5927\u5c0f\u5173\u7cfb\u4f5c\u4e3a$A$\u548c$B$\u95f4\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u8fd9\u79f0\u4e3a\u5b57\u5178\u5e8f\u3002\u4e3a\u4e86\u7b80\u5316\u4e00\u4e9b\u64cd\u4f5c\uff0c\u5b9a\u4e49$\\\\#$\u662f\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u5b57\u7b26\uff0c\u5e76\u4e14\u5c06\u5176\u9ed8\u8ba4\u4f5c\u4e3a\u6bcf\u4e2a\u5b57\u7b26\u4e32\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b262\uff0c\u5373\u4f5c\u4e3a$S[|S|]$\u3002<br/>\u53e6\u5916\uff0c\u5b9a\u4e49\u51fd\u6570$\\\\text{lcp}(A, B)$\u8868\u793a$A$\u548c$B$\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u7684\u957f\u5ea6\uff0c\u5373\u4e24\u8005\u6240\u6709\u76f8\u540c\u7684\u524d\u7f00\u4e2d\uff0c\u6700\u957f\u7684\u4e00\u4e2a\u7684\u957f\u5ea6\u3002\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u5b57\u5178\u5e8f\u7684\u4e00\u4e2a\u6027\u8d28\uff1a<br/>\u5b9a\u7406 1.1 $A < B$\u5f53\u4e14\u4ec5\u5f53$A[\\\\text{lcp}(A, B)] < B[\\\\text{lcp}(A, B)]$\u3002<br/>\u8bc1\u660e \u8fd9\u4e2a\u7ed3\u8bba\u663e\u7136\u6210\u7acb\uff0c\u56e0\u4e3a$\\\\text{prefix}(A, \\\\text{lcp}(A, B) - 1) = \\\\text{prefix}(B, \\\\text{lcp}(A, B) - 1)$\u3002<br/>2. SA-IS\u7b97\u6cd5<br/>SA-IS\u7b97\u6cd5\u662f\u57fa\u4e8e\u8bf1\u5bfc\u6392\u5e8f\u8fd9\u79cd\u601d\u60f3\u3002\u57fa\u672c\u60f3\u6cd5\u5c31\u662f\u5c06\u95ee\u9898\u7684\u89c4\u6a21\u7f29\u5c0f\uff0c\u901a\u8fc7\u89e3\u51b3\u66f4\u5c0f\u7684\u95ee\u9898\uff0c\u83b7\u53d6\u8db3\u591f\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u7684\u89e3\u51b3\u539f\u59cb\u95ee\u9898\u3002\u4ece\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u9700\u8981\u9012\u5f52\u5904\u7406\u5b50\u95ee\u9898\u3002<br/>\u5728\u4ecb\u7ecdSA-IS\u7b97\u6cd5\u524d\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u8be5\u7b97\u6cd5\u7684\u57fa\u672c\u6846\u67b6\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17function SA-IS(S):<br/>    t = bool[]<br/>    S1 = int[]<br/>    P = int[]<br/>    bucket = int[]<br/>    \u626b\u63cf\u5012\u5e8f\u5b57\u7b26\u4e32\u786e\u5b9a\u6bcf\u4e00\u4e2a\u540e\u7f00\u7684\u7c7b\u578b -> t<br/>    \u626b\u63cft\u6570\u7ec4\u786e\u5b9a\u6240\u6709\u7684LMS\u5b50\u4e32 -> P<br/>    \u5bf9\u6240\u6709\u7684LMS\u5b50\u4e32\u8fdb\u884c\u8bf1\u5bfc\u6392\u5e8f<br/>    \u5bf9\u6bcf\u4e00\u4e2aLMS\u5b50\u4e32\u91cd\u65b0\u547d\u540d\uff0c\u751f\u6210\u65b0\u7684\u4e32S1<br/><br/>    if S1\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u7b26\u90fd\u4e0d\u4e00\u6837:<br/>        \u76f4\u63a5\u8ba1\u7b97SA1<br/>    else<br/>        SA1 = SA-IS(S1)  # \u9012\u5f52\u8ba1\u7b97SA1<br/><br/>    \u5229\u7528SA1\u6765\u8fdb\u884c\u8bf1\u5bfc\u6392\u5e8f\uff0c\u8ba1\u7b97SA<br/>    return SA<br/><br/><br/>\u73b0\u5728\u4f60\u4e0d\u4f1a\u660e\u767d\u8fd9\u91cc\u9762\u90fd\u5199\u4e86\u4e9b\u4ec0\u4e48\u4e1c\u897f\uff0c\u56e0\u4e3a\u8fd9\u53ea\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6d41\u7a0b\u3002\u63a5\u4e0b\u6765\u5c06\u4f1a\u4ecb\u7ecd\u5176\u4e2d\u7684\u6bcf\u4e00\u6b65\u5e76\u8bc1\u660e\u5176\u6b63\u786e\u6027\u3002<br/>2.1 \u540e\u7f00\u7c7b\u578b<br/>\u5728\u7b2c6\u884c\u4e2d\uff0c\u786e\u5b9a\u540e\u7f00\u7684\u7c7b\u578b\u53ef\u80fd\u4f1a\u4ee4\u4eba\u65e0\u6cd5\u7406\u89e3\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u8fd8\u6ca1\u6709\u5b9a\u4e49\u4ec0\u4e48\u662f\u540e\u7f00\u7684\u7c7b\u578b......<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u540e\u7f00$\\\\text{suffix}(S, i)$\uff0c\u5f53$\\\\text{suffix}(S, i) < \\\\text{suffix}(S, i + 1)$\u65f6\uff0c\u662f$S$\u578b\u540e\u7f00\u3002\u5f53$\\\\text{suffix}(S, i) > \\\\text{suffix}(S, i + 1)$\u65f6\uff0c\u662f$L$\u578b\u540e\u7f00\u3002\u5bf9\u4e8e\u7279\u6b8a\u7684\u540e\u7f00$\\\\text{suffix}(S, |S|) = \\\\#$\uff0c\u5b83\u9ed8\u8ba4\u4e3a$S$\u578b\u3002<br/>\u4f8b\u5982\uff0c\u5bf9\u4e8e\u5b57\u7b26\u4e32mmiissiissiippii\uff0c\u6bcf\u4e00\u540e\u7f00\u7684\u7c7b\u578b\u4e3a\uff1a<br/>1<br/>2<br/>3      0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16<br/>S[i]: m  m  i  i  s  s  i  i  s  s  i  i  p  p  i  i  #<br/>t[i]: L  L  S  S  L  L  S  S  L  L  S  S  L  L  L  L  S<br/><br/><br/>\u65e2\u7136\u6211\u4eec\u9700\u8981\u5f97\u77e5\u6bcf\u4e00\u4e2a\u540e\u7f00\u7c7b\u578b\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u5feb\u901f\u7684\u7b97\u6cd5\u6765\u8ba1\u7b97\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u4eec\u6709\u5982\u4e0b\u7684\u6027\u8d28\uff1a<br/>\u5f15\u7406 2.1 (\u540e\u7f00\u7c7b\u578b\u9012\u63a8\u6027\u8d28) \u5bf9\u4e8e\u4efb\u610f\u7684$i \\\\in [0, |S| - 1]$:<br/>\u5982\u679c$t[i] = \\\\text{S-type}$\uff0c\u5f53\u4e14\u4ec5\u5f53\u4e0b\u9762\u4efb\u610f\u4e00\u9879\u6210\u7acb\uff1a<br/><br/>$S[i] < S[i + 1]$<br/>$S[i] = S[i + 1]$\u4e14$t[i + 1] = \\\\text{S-type}$<br/><br/>\u5982\u679c$t[i] = \\\\text{L-type}$\uff0c\u5f53\u4e14\u4ec5\u5f53\u4e0b\u9762\u4efb\u610f\u4e00\u9879\u6210\u7acb\uff1a<br/><br/>$S[i] > S[i + 1]$<br/>$S[i] = S[i + 1]$\u4e14$t[i + 1] = \\\\text{L-type}$<br/><br/>\u8bc1\u660e \u8fd9\u91cc\u8bc1\u660e$S$\u578b\u7684\uff0c$L$\u578b\u662f\u7c7b\u4f3c\u7684\u3002\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u663e\u7136\u662f\u6210\u7acb\u7684\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u8bbe$\\\\text{suffix}(S, i) = aA, \\\\text{suffix}(S, i + 1) = aB$\u3002\u7531\u4e8e\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u76f8\u540c\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u6bd4\u8f83$A$\u548c$B$\u7684\u5927\u5c0f\u3002\u56e0\u4e3a\u5b83\u4eec\u662f\u8fde\u7eed\u7684\u540e\u7f00\uff0c\u6240\u4ee5$A = \\\\text{suffix}(S, i + 1), B = \\\\text{suffix}(S, i + 2)$\u3002\u7531\u4e8e\u6211\u4eec\u662f\u4ece\u53f3\u5f80\u5de6\u63a8\u51fa$t$\uff0c\u6240\u4ee5$A$\u4e0e$B$\u7684\u5173\u7cfb\u5b9e\u9645\u4e0a\u53ef\u4ee5\u7531$t[i + 1]$\u7ed9\u51fa\u3002\u6545$t[i] = t[i + 1]$\u3002<br/>\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5728$\\\\Theta(|S|)$\u7684\u65f6\u95f4\u5185\uff0c\u63a8\u51fa\u6574\u4e2a$t$\u6570\u7ec4\u3002<br/>\u5173\u4e8e\u540e\u7f00\u7c7b\u578b\uff0c\u6211\u4eec\u8fd8\u53ef\u5f97\u51fa\u53e6\u5916\u4e00\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u6027\u8d28\uff1a<br/>\u5f15\u7406 2.2 (\u540e\u7f00\u7c7b\u578b\u6307\u5bfc\u6392\u5e8f) \u5bf9\u4e8e\u4e24\u4e2a\u540e\u7f00$A$\u548c$B$\uff0c\u5982\u679c$A[0] = B[0]$\u4e14$A$\u662f$S$\u578b\uff0c$B$\u662f$L$\u578b\uff0c\u5219$A < B$\u3002<br/>\u8bc1\u660e \u8bbe$A = abX, B = acY$\uff0c\u8fd9\u91cc\u5047\u8bbe$a \\\\neq b, a \\\\neq c$\u3002\u56e0\u4e3a$A$\u662f$S$\u578b\uff0c\u6240\u4ee5\u53ef\u77e5$a < b$\u3002\u540c\u7406\uff0c$B$\u662f$L$\u578b\uff0c\u53ef\u77e5$a > c$\u3002\u6545$ c < a < b$\uff0c\u6240\u4ee5$A < B$\u3002\u5982\u679c$a = b, a = c$\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u5c06\u7b2c\u4e00\u4e2a\u5b57\u7b26\u53bb\u6389\uff0c\u5f97\u5230\u65b0\u7684\u540e\u7f00\u6765\u8fdb\u884c\u6bd4\u8f83\u3002\u6839\u636e\u5f15\u7406 2.1\uff0c\u53bb\u6389\u7b2c\u4e00\u4e2a\u5b57\u7b26\u540e\u7684\u540e\u7f00\u7c7b\u578b\u4e0d\u53d8\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u7684\u64cd\u4f5c\u4ece\u800c\u53d8\u4e3a\u7b2c\u4e00\u79cd\u60c5\u51b5\u3002<br/>2.2 LMS\u5b50\u4e32<br/>\u7136\u800c\u5149\u6709\u540e\u7f00\u7c7b\u578b\uff0c\u8fd8\u4e0d\u8db3\u4ee5\u8fdb\u884c\u6392\u5e8f\u3002\u56e0\u6b64\u6211\u4eec\u5728\u540e\u7f00\u7c7b\u578b\u7684$S$\u578b\u4e2d\u6311\u51fa\u7279\u522b\u7684\u4e00\u7c7b\uff0c\u8bb0\u4e3a$*$\u578b\u3002$*$\u578b\u662f$S$\u578b\u7684\u4e00\u79cd\uff0c\u5b83\u7684\u7279\u6b8a\u4e4b\u5904\u5728\u4e8e\u5b83\u8981\u6c42\u5b83\u7684\u5de6\u8fb9\u7684\u540e\u7f00\u5fc5\u987b\u662f$L$\u578b\u7684\u3002\u4f9d\u7136\u4ee5mmiissiissiippii\u4e3a\u4f8b\uff1a<br/>1<br/>2<br/>3<br/>4      0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16<br/>S[i]: m  m  i  i  s  s  i  i  s  s  i  i  p  p  i  i  #<br/>t[i]: L  L  S  S  L  L  S  S  L  L  S  S  L  L  L  L  S<br/>            *           *           *                 *<br/><br/><br/>\u53ef\u4ee5\u5c06\u5176\u7406\u89e3\u4e3a\u4e00\u8fde\u4e32\u7684$S$\u578b\u4e2d\u6700\u9760\u5de6\u7684\u4e00\u4e2a\u3002LMS (LeftMost S-type)\u4e5f\u6b63\u662f\u8fd9\u4e2a\u610f\u601d\u3002\u540c\u65f6\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u540e\u7f00$\\\\#$\u59cb\u7ec8\u662f$*$\u578b\u7684\u3002<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$*$\u578b\u6240\u5bf9\u5e94\u4e0a\u7684\u5b57\u7b26\uff0c\u6211\u4eec\u79f0\u4e3aLMS\u5b57\u7b26\u3002\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u4e0b\u6807\u4e3a$2, 6, 10, 16$\u90fd\u662fLMS\u5b57\u7b26\u3002<br/>\u4f4d\u7f6e\u76f8\u90bb\u7684\u4e24\u4e2aLMS\u5b57\u7b26\u4e2d\u95f4(\u5305\u62ec\u8fd9\u4e24\u4e2a\u5b57\u7b26)\u6240\u6784\u6210\u7684\u5b50\u4e32\uff0c\u79f0\u4e3aLMS\u5b50\u4e32\u3002\u5bf9\u4e8emmiissiissiippii\uff0c\u5176LMS\u5b50\u4e32\u4f9d\u6b21\u4e3aiissi\u3001iissi\u3001iippii#\u548c#\u3002<br/>\u901a\u8fc7\u89c2\u5bdf\uff0c\u6211\u4eec\u53d1\u73b0LMS\u5b50\u4e32\u5177\u6709\u4ee5\u4e0b\u7684\u6027\u8d28\uff1a<br/>\u5f15\u7406 2.3 #\u662f\u6700\u77ed\u7684LMS\u5b50\u4e32\u3002<br/>\u5f15\u7406 2.4 \u5bf9\u4e8e\u4efb\u610f\u7684\u975e#\u7684LMS\u5b50\u4e32\uff0c\u5176\u957f\u5ea6\u5927\u4e8e$2$\u3002<br/>\u8bc1\u660e \u56e0\u4e3a\u4e24\u4e2aLMS\u5b57\u7b26\u4e2d\u95f4\u5fc5\u5b9a\u6709\u4e00\u4e2a$L$\u578b\u7684\u540e\u7f00\u3002<br/>\u5f15\u7406 2.5 (\u539f\u4e32\u6298\u534a) \u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2dLMS\u5b50\u4e32\u7684\u6570\u91cf\u4e0d\u8d85\u8fc7$\\\\left\\\\lceil{|S| / 2}\\\\right\\\\rceil$\u3002<br/>\u8bc1\u660e \u6839\u636e\u5f15\u74062.4\u53ef\u77e5\u3002<br/>\u5f15\u7406 2.6 \u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u6240\u6709LMS\u5b50\u4e32\u7684\u957f\u5ea6\u4e4b\u548c\u4e3a$O(|S|)$\u3002<br/>\u6b64\u5916\uff0c\u5bf9\u4e8eLMS\u5b50\u4e32\u95f4\u7684\u5927\u5c0f\u6bd4\u8f83\uff0c\u9664\u4e86\u5bf9\u6bcf\u4e2a\u5b57\u7b26\u7684\u5b57\u5178\u5e8f\u8fdb\u884c\u6bd4\u8f83\u5916\uff0c\u8fd8\u8981\u5bf9\u6bd4\u6bcf\u4e2a\u5b57\u7b26\u6240\u5bf9\u5e94\u7684\u540e\u7f00\u7c7b\u578b\u3002$S$\u578b\u7684\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u6743\uff0c\u56e0\u4e3a\u6839\u636e\u5f15\u74062.2\u53ef\u5f97\uff0c$S$\u578b\u7684\u540e\u7f00\u5b57\u5178\u5e8f\u66f4\u5927\u3002\u53ea\u6709\u5f53\u6bcf\u4e00\u4e2a\u5b57\u7b26\u4e0e\u5176\u540e\u7f00\u7c7b\u578b\u90fd\u76f8\u540c\u65f6\uff0c\u8fd9\u4e24\u4e2aLMS\u5b50\u4e32\u624d\u88ab\u79f0\u4e3a\u662f\u76f8\u540c\u7684\u3002<br/>\u4e4b\u6240\u4ee5\u8fd9\u6837\u5b9a\u4e49\uff0c\u662f\u56e0\u4e3a\u5728\u4e4b\u540e\u6211\u4eec\u4f1a\u5229\u7528LMS\u5b50\u4e32\u6765\u8fdb\u884c\u5bf9\u540e\u7f00\u7684\u6392\u5e8f\u3002\u5982\u679c\u7f3a\u5c11\u540e\u7f00\u7c7b\u578b\u7684\u4fe1\u606f\uff0c\u5c31\u4e0d\u80fd\u591f\u4efb\u52a1\u3002<br/>\u6839\u636e\u5f15\u74062.6\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u57fa\u6570\u6392\u5e8f\u5728$O(|S|)$\u7684\u65f6\u95f4\u5185\u5bf9\u6240\u6709\u7684LMS\u5b50\u4e32\u6392\u5e8f3\u3002\u5bf9LMS\u5b50\u4e32\u6392\u5e8f\u5b8c\u540e\uff0c\u6211\u4eec\u6309\u7167\u5b57\u5178\u5e8f\u4f9d\u6b21\u91cd\u65b0\u547d\u540d4\uff0c\u6ce8\u610f\uff0c\u5982\u679c\u4e24\u4e2aLMS\u5b50\u4e32\u76f8\u540c\uff0c\u5219\u4f7f\u7528\u540c\u6837\u7684\u540d\u79f05\u3002\u8fd9\u6837\u7ed9\u6bcf\u4e2aLMS\u5b50\u4e32\u547d\u540d\u540e\uff0c\u6309\u7167\u5176\u5b50\u4e32\u539f\u6709\u7684\u987a\u5e8f\u6392\u51fa\u4e00\u4e2a\u65b0\u4e32$S_1$\u3002\u7ee7\u7eed\u4ee5mmiissiissiippii\u4e3a\u4f8b\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6      0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16<br/>S[i]: m  m  i  i  s  s  i  i  s  s  i  i  p  p  i  i  #<br/>t[i]: L  L  S  S  L  L  S  S  L  L  S  S  L  L  L  L  S<br/>            *           *           *                 *<br/>\u65b0\u540d\u79f0      2           2           1                 0<br/>S1:   2 2 1 0<br/><br/><br/>\u8fd9\u6837\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u5b9e\u9645\u4e0a\u662f\u5c06\u6240\u6709$*$\u578b\u7684\u540e\u7f00\u8fdb\u884c\u4e86\u7f29\u51cf\uff0c\u4ece\u800c\u51cf\u5c0f\u4e86\u95ee\u9898\u7684\u89c4\u6a21\u3002\u5bf9\u4e8e\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u7684\u5f15\u7406\uff1a<br/>\u5f15\u7406 2.7 (\u95ee\u9898\u7f29\u51cf) $S_1$\u4e2d\u4e24\u4e2a\u540e\u7f00\u7684\u5b57\u5178\u5e8f\u5173\u7cfb\uff0c\u5c31\u662f$S$\u4e2d\u5bf9\u5e94\u7684$*$\u578b\u540e\u7f00\u7684\u5b57\u5178\u5e8f\u5173\u7cfb\u3002<br/>\u8bc1\u660e \u6211\u4eec\u53ef\u4ee5\u5c06$S_1$\u89c6\u4e3a\u662f\u5c06$*$\u540e\u7f00\u4e2d\u4e0d\u91cd\u5408\u7684\u90e8\u5206\u8fdb\u884c\u5207\u5272\u5e76\u7f29\u51cf\u3002\u8fd9\u6837\u6bcf\u4e00\u4e2aLMS\u5b50\u4e32\u5c31\u53ef\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u8fdb\u884c\u6bd4\u8f83\u3002\u4ece\u800c\u4fdd\u6301\u4e86\u8fd9\u4e24\u8005\u7684\u4e00\u81f4\u6027\u3002<br/>\u9700\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u91cc\u53ea\u662f$*$\u578b\u540e\u7f00\u7684\u5b57\u5178\u5e8f\u5173\u7cfb\uff0c\u4e0e\u5176\u5b83\u540e\u7f00\u65e0\u5173\u3002<br/>2.3 \u4eceSA1\u8bf1\u5bfc\u81f3SA<br/>\u4ece\u4e0a\u9762\u7684\u5f15\u74062.7\u6211\u4eec\u5f97\u77e5\uff0c\u53ea\u8981\u83b7\u5f97\u4e86$S_1$\u7684\u540e\u7f00\u6570\u7ec4$SA_1$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6240\u6709$*$\u578b\u540e\u7f00\u7684\u76f8\u5bf9\u987a\u5e8f\u3002\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u5229\u7528$*$\u578b\u540e\u7f00\u7684\u76f8\u5bf9\u987a\u5e8f\u6765\u5bf9\u5176\u5b83\u7684$L$\u578b\u548c$S$\u578b\u540e\u7f006\u8fdb\u884c\u6392\u5e8f\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u540e\u7f00\u6570\u7ec4\u7684\u8ba1\u7b97\u3002<br/>\u5728\u8fd9\u91cc\u6211\u4eec\u5148\u5047\u5b9a$SA_1$\u5df2\u7ecf\u8ba1\u7b97\u51fa\u6765\uff0c\u53ea\u9700\u8003\u8651\u5982\u4f55\u8ba1\u7b97$SA$\u3002\u5728\u8fd9\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u89c2\u5bdf\u4e00\u4e0b\u540e\u7f00\u6570\u7ec4\u7684\u5f62\u5f0f\u3002\u4ee5aabaaaab\u4e3a\u4f8b\uff0c\u5b83\u7684\u540e\u7f00\u6570\u7ec4\u662f\u8fd9\u6837\u7684\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9#<br/>aaaab#<br/>aaab#<br/>aab#<br/>aabaaaab#<br/>ab#<br/>abaaaab#<br/>b#<br/>baaaab#<br/><br/><br/>\u4e0d\u96be\u53d1\u73b0\uff0c\u9996\u5b57\u6bcd\u76f8\u540c\u7684\u540e\u7f00\u662f\u8fde\u7eed\u6392\u5e03\u7684\uff0c\u8fd9\u4e00\u70b9\u53ef\u4ee5\u7528\u53cd\u8bc1\u6cd5\u6765\u8bc1\u660e\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6876\u6392\u5e8f\u7684\u601d\u60f3\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u51fa\u73b0\u8fc7\u7684\u5b57\u7b26\u5efa\u7acb\u4e00\u4e2a\u6876\uff0c\u7528$SA$\u6570\u7ec4\u6765\u5b58\u50a8\u8fd9\u4e9b\u6876\uff0c\u6bcf\u4e2a\u6876\u4e4b\u95f4\u6309\u7167\u5b57\u5178\u5e8f\u6392\u5217\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u540e\u7f00\u6570\u7ec4\u521d\u6b65\u6709\u5e8f\u3002<br/>\u6211\u4eec\u5bf9\u6bcf\u4e2a\u540e\u7f00\u90fd\u8d4b\u4e88\u4e86\u4e00\u4e2a\u540e\u7f00\u7c7b\u578b\uff0c\u90a3\u4e48\u5728\u9996\u5b57\u6bcd\u4e00\u6837\u7684\u60c5\u51b5\u4e0b\uff0c$S$\u578b\u6216$L$\u578b\u4f1a\u8fde\u7eed\u5206\u5e03\u5417\uff1f\u7b54\u6848\u662f\u80af\u5b9a\u7684\u3002\u56e0\u4e3a\u6839\u636e\u5f15\u74062.2\uff0c\u9996\u5b57\u6bcd\u76f8\u540c\u7684\u540e\u7f00\u5982\u679c\u540e\u7f00\u7c7b\u578b\u4e0d\u540c\uff0c\u5219\u76f8\u5bf9\u987a\u5e8f\u662f\u786e\u5b9a\u7684\u3002\u56e0\u6b64\u6613\u77e5\u4e0d\u4f1a\u51fa\u73b0$S$\u578b\u548c$L$\u578b\u4ea4\u66ff\u51fa\u73b0\u7684\u60c5\u51b5\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c\u7531\u4e8e$L$\u578b\u540e\u7f00\u66f4\u5c0f\uff0c\u56e0\u6b64\u603b\u662f\u5148\u6392\u5e03$L$\u578b\u540e\u7f00\uff0c\u518d\u6392\u5e03$S$\u578b\u540e\u7f00\u3002\u56e0\u6b64\u6bcf\u4e00\u4e2a\u5b57\u7b26\u7684\u6876\u53ef\u4ee5\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e00\u4e2a\u7528\u4e8e\u653e\u7f6e$L$\u578b\u540e\u7f00\uff0c\u53e6\u4e00\u4e2a\u5219\u7528\u4e8e$S$\u578b\u540e\u7f00\u3002\u4e3a\u4e86\u65b9\u4fbf\u786e\u5b9a\u6bcf\u4e00\u4e2a\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c$S$\u578b\u540e\u7f00\u7684\u6876\u7684\u653e\u7f6e\u662f\u5012\u5e8f\u7684\u3002<br/>\u4f46\u662f\u5982\u679c\u9996\u5b57\u6bcd\u548c\u540e\u7f00\u7c7b\u578b\u90fd\u4e00\u81f4\uff0c\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u5feb\u901f\u5730\u5224\u65ad\u5927\u5c0f\u5173\u7cfb\u3002\u5728\u8fd9\u91cc\u5c31\u8981\u5229\u7528\u5230\u8bf1\u5bfc\u6392\u5e8f\u4e86\u3002<br/>\u8bf1\u5bfc\u6392\u5e8f\u7684\u8fc7\u7a0b\u5206\u4e3a\u4ee5\u4e0b\u51e0\u6b65\uff1a<br/><br/>\u5c06$SA$\u6570\u7ec4\u521d\u59cb\u5316\u4e3a\u6bcf\u4e2a\u5143\u7d20\u90fd\u4e3a$-1$\u7684\u6570\u7ec4\u3002<br/>\u786e\u5b9a\u6bcf\u4e2a\u6876$S$\u578b\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002\u5c06$SA_1$\u4e2d\u7684\u6bcf\u4e00\u4e2a$*$\u578b\u540e\u7f00\u6309\u7167$SA_1$\u4e2d\u7684\u987a\u5e8f\u653e\u5165\u76f8\u5e94\u7684\u6876\u5185\u3002<br/>\u786e\u5b9a\u6bcf\u4e2a\u6876$L$\u578b\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002\u5728$SA$\u6570\u7ec4\u4e2d\u4ece\u5de6\u5f80\u53f3\u626b\u4e00\u904d\u3002\u5982\u679c$SA[i] > 0$\u4e14$t[SA[i] - 1] = \\\\text{L-type}$\uff0c\u5219\u5c06$SA[i] - 1$\u6240\u4ee3\u8868\u7684\u540e\u7f00\u653e\u5165\u5bf9\u5e94\u7684\u6876\u4e2d\u3002<br/>\u91cd\u65b0\u786e\u5b9a\u6bcf\u4e2a\u6876$S$\u578b\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u56e0\u4e3a\u6240\u6709\u7684$*$\u578b\u540e\u7f00\u8981\u91cd\u65b0\u88ab\u6392\u5e8f\u3002\u7531\u4e8e$S$\u578b\u6876\u662f\u9006\u5e8f\u6392\u653e\u7684\uff0c\u6240\u4ee5\u8fd9\u6b21\u4ece\u53f3\u81f3\u5de6\u5730\u626b\u63cf\u4e00\u904d$SA$\u3002\u5982\u679c$SA[i] > 0$\u4e14$t[SA[i] - 1] = \\\\text{S-type}$\uff0c\u5219\u5c06$SA[i] - 1$\u6240\u4ee3\u8868\u7684\u540e\u7f00\u653e\u5165\u5bf9\u5e94\u7684\u6876\u4e2d\u3002<br/><br/>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5b8c\u6210\u4ece$SA_1$\u8bf1\u5bfc\u5230$SA$\u7684\u6392\u5e8f\u5de5\u4f5c\u3002\u8fd9\u91cc\u7b80\u5355\u8bf4\u660e\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u8fd9\u6837\u505a\u662f\u6b63\u786e\u7684\uff1a\u9996\u5148\u5bf9\u4e8e\u6240\u6709\u7684$*$\u578b\u540e\u7f00\uff0c\u90fd\u662f\u6709\u5e8f\u6392\u653e\u7684\u3002\u4ece\u5de6\u81f3\u53f3\u626b\u63cf$SA$\u6570\u7ec4\u5b9e\u9645\u4e0a\u5c31\u662f\u6309\u7167\u5b57\u5178\u5e8f\u626b\u63cf\u73b0\u6709\u7684\u5df2\u6392\u5e8f\u7684\u540e\u7f00\u3002\u5bf9\u4e8e\u4e24\u4e2a\u76f8\u90bb\u7684$L$\u578b\u540e\u7f00$A$\u548c$B$\uff0c\u8fd9\u91cc\u5047\u8bbe$|A| > |B|$\uff0c\u5219\u5fc5\u5b9a\u6709$A > B$\u3002\u7531\u4e8e$B$\u4f1a\u88ab\u5148\u52a0\u5165$SA$\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u4fdd\u8bc1\u4e86$A$\u548c$B$\u4e4b\u95f4\u7684\u6709\u5e8f\u6027\u3002\u53c8\u56e0\u4e3a$L$\u578b\u6876\u662f\u4ece\u5de6\u5f80\u53f3\u7684\u987a\u5e8f\u52a0\u5165\u7684\uff0c\u6240\u4ee5\u6240\u6709\u7684$L$\u578b\u540e\u7f00\u4f1a\u9010\u6b65\u5730\u6309\u987a\u5e8f\u52a0\u5165\u5230$SA$\u4e2d\u3002\u6700\u540e\u6240\u6709\u7684$L$\u578b\u540e\u7f00\u5c06\u4f1a\u6709\u5e8f\u3002<br/>\u5bf9\u4e8e$S$\u578b\u540e\u7f00\uff0c\u9664\u4e86\u8981\u6ce8\u610f\u662f\u76f8\u53cd\u7684\u987a\u5e8f\u548c\u9700\u8981\u91cd\u65b0\u5bf9$*$\u578b\u540e\u7f00\u6392\u5e8f\u5916\uff0c\u5176\u4f59\u7684\u539f\u7406\u4e0e$L$\u578b\u7684\u6392\u5e8f\u7c7b\u4f3c\u3002<br/>\u4e4b\u524d\u7684\u8ba8\u8bba\u90fd\u662f\u57fa\u4e8e\u6211\u4eec\u5df2\u77e5$SA_1$\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u7684\u3002\u73b0\u5728\u6211\u4eec\u6765\u8003\u8651\u5982\u4f55\u8ba1\u7b97$SA_1$\u3002\u7531\u4e8e$S_1$\u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8ba1\u7b97\u5176\u540e\u7f00\u6570\u7ec4\u65f6\u53ef\u4ee5\u8003\u8651\u4e24\u79cd\u60c5\u51b5\uff1a<br/><br/>\u5982\u679c$S_1$\u4e2d\u6bcf\u4e00\u4e2a\u5b57\u7b26\u90fd\u4e0d\u4e00\u6837\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u6876\u6392\u5e8f\u76f4\u63a5\u8ba1\u7b97$SA_1$\u3002<br/>\u5426\u5219\uff0c\u9012\u5f52\u8ba1\u7b97$SA_1$\u3002\u5c31\u5982\u4e4b\u524d\u7684\u7b97\u6cd5\u6846\u67b6\u6240\u5c55\u793a\u7684\u4e00\u6837\u3002<br/><br/>2.4 \u5bf9LMS\u5b50\u4e32\u6392\u5e8f<br/>\u5230\u8fd9\u91cc\uff0cSA-IS\u7b97\u6cd5\u51e0\u4e4e\u5df2\u7ecf\u7ed3\u675f\u4e86\uff0c\u53ea\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u9700\u8981\u89e3\u51b3\uff0c\u5c31\u662f\u5bf9LMS\u5b50\u4e32\u7684\u6392\u5e8f\u3002<br/>\u4e4b\u524d\u6211\u4eec\u6240\u63d0\u53ca\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u57fa\u6570\u6392\u5e8f\u3002\u867d\u7136\u53ef\u4ee5\u5728$O(|S|)$\u7684\u65f6\u95f4\u5185\u5b8c\u6210\uff0c\u4f46\u662f\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u57fa\u6570\u6392\u5e8f\u4e0d\u4f46\u5e38\u719f\u5927\uff0c\u800c\u4e14\u5341\u5206\u590d\u6742(\u8bf7\u60f3\u8c61\u4e00\u4e0b\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u57fa\u6570\u6392\u5e8f......)\u3002\u8fd9\u4e2a\u6392\u5e8f\u76f4\u63a5\u6210\u4e3a\u4e86\u6574\u4e2a\u7b97\u6cd5\u7684\u6027\u80fd\u74f6\u9888\u3002\u56e0\u6b64\u6211\u4eec\u6025\u5207\u7684\u9700\u8981\u4e00\u79cd\u65b0\u7684\u7b97\u6cd5\u6765\u80dc\u4efb\u8fd9\u4e00\u4efb\u52a1\u3002<br/>\u8fd9\u4e2a\u7b97\u6cd5\u4f9d\u7136\u662f\u8bf1\u5bfc\u6392\u5e8f\u3002<br/>\u4e0e\u4e4b\u524d\u4ece$SA_1$\u8bf1\u5bfc\u5230$SA$\u7684\u7b97\u6cd5\u4e00\u6837\uff0c\u53ea\u662f\u6211\u4eec\u8fd9\u91cc\u5c06\u7b2c\u4e8c\u6b65\u6539\u4e3a\uff1a<br/><br/>\u786e\u5b9a\u6bcf\u4e2a\u6876$S$\u578b\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002\u5c06\u6bcf\u4e00\u4e2aLMS\u5b50\u4e32\u7684\u9996\u5b57\u6bcd\u6309\u7167\u4efb\u610f\u987a\u5e8f\u653e\u5165\u5bf9\u5e94\u7684\u6876\u4e2d\u3002<br/><br/>\u5f85\u7b97\u6cd5\u5b8c\u6210\uff0c\u6211\u4eec\u4f1a\u83b7\u5f97\u4e00\u4e2a$SA$\u6570\u7ec4\uff0c\u5176\u4e2dLMS\u5b50\u4e32\u4e4b\u95f4\u662f\u6392\u597d\u4e86\u5e8f\u7684\u3002<br/>\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u7b97\u6cd5\u662f\u6b63\u786e\u7684\uff0c\u6211\u4eec\u9700\u8981\u626f\u5230\u4e00\u4e2a\u65b0\u7684\u6982\u5ff5\uff1aLMS\u524d\u7f00\u3002<br/>\u89c4\u5b9aLMS\u524d\u7f00\u51fd\u6570$\\\\text{pre}(S, i)$\u8868\u793a (1) \u5982\u679c$\\\\text{suffix}(S, i)$\u662f$*$\u578b\u7684\uff0c\u5219$\\\\text{pre}(S, i) = S[i]$\uff0c\u5373LMS\u5b57\u7b26\u7684LMS\u524d\u7f00\u5c31\u662f\u81ea\u5df1\u3002 (2) \u5426\u5219\u662f\u4ece$S[i]$\u5f00\u59cb\uff0c\u5230\u4e0b\u4e00\u4e2aLMS\u5b57\u7b26\u4e4b\u95f4(\u5305\u62ec\u9996\u5c3e)\u7684\u5b50\u4e32\u3002\u540c\u6837\u7684\uff0c\u6309\u7167$\\\\text{suffix}(S, i)$\u7684\u540e\u7f00\u7c7b\u578b\u7684\u4e0d\u540c\uff0cLMS\u524d\u7f00\u4e5f\u540c\u6837\u5206\u4e3a$S$\u578b\u548c$L$\u578b\u3002<br/>\u4f8b\u5982\uff0c\u5728mmiissiissiippii\u4e2d\uff0c$\\\\text{pre}(S, 2) = S[2] =$ i\uff0c\u800c$\\\\text{pre}(S, 3) = S[3, 6] =$ issi\u3002<br/>\u56e0\u6b64\u4e0a\u9762\u7684\u7b97\u6cd5\u5b9e\u9645\u4e0a\u662f\u5728\u5bf9\u6bcf\u4e2aLMS\u524d\u7f00\u8fdb\u884c\u6392\u5e8f\u3002<br/>\u63a5\u4e0b\u6765\u5c06\u8bc1\u660e2-4\u6b65\u90fd\u662f\u6b63\u786e\u7684\uff0c\u5373\u6bcf\u4e00\u6b65\u5b8c\u6210\u65f6$SA$\u6570\u7ec4\u4e2d\uff0cLMS\u524d\u7f00\u90fd\u662f\u6709\u5e8f\u7684\u3002<br/><br/>\u5bf9\u4e8e\u7b2c\u4e8c\u6b65\uff0c\u7531\u4e8e\u653e\u5165\u7684LMS\u524d\u7f00\u90fd\u53ea\u6709\u4e00\u4e2a\u5b57\u7b26\uff0c\u56e0\u4e3a\u6876\u7684\u6392\u5217\u662f\u6309\u7167\u5b57\u5178\u5e8f\u7684\uff0c\u6240\u4ee5\u4fdd\u8bc1\u653e\u7f6e\u540e\u4e00\u5b9a\u6709\u5e8f\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e09\u6b65\uff0c\u5f53\u653e\u5165\u7b2c\u4e00\u4e2a$L$\u578bLMS\u524d\u7f00\u65f6\uff0c$SA$\u6570\u7ec4\u5fc5\u5b9a\u662f\u6709\u5e8f\u7684(\u6839\u636e\u5f15\u74062.2)\u3002\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u653e\u7f6e\u4e86$k$\u4e2a$L$\u578bLMS\u524d\u7f00\uff0c\u4e14\u5b83\u4eec\u5728$SA$\u6570\u7ec4\u4e2d\u4fdd\u6301\u6709\u5e8f\uff0c\u73b0\u5728\u8003\u8651\u653e\u5165\u7684\u7b2c$k + 1$\u4e2aLMS\u524d\u7f00\u662f\u5426\u4f1a\u4fdd\u8bc1\u6709\u5e8f\u3002\u6211\u4eec\u8bbe\u8fd9\u4e2aLMS\u524d\u7f00\u4e3a$\\\\text{pre}(S, i)$\uff0c\u56e0\u4e3a\u9996\u5b57\u6bcd\u4e0d\u540c\u7684LMS\u524d\u7f00\u4e00\u5b9a\u662f\u4fdd\u6301\u6709\u5e8f\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5b83\u4e0e\u5176\u9996\u5b57\u6bcd\u76f8\u540c\u7684LMS\u524d\u7f00\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u56e0\u4e3a\u6211\u4eec\u662f\u4ece\u5de6\u81f3\u53f3\u626b\u63cf\u6765\u4f7f$L$\u578bLMS\u524d\u7f00\u4ece\u5c0f\u81f3\u5927\u653e\u7f6e\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709\u4e4b\u524d\u653e\u7f6e\u7684\u4e14\u9996\u5b57\u6bcd\u4e0e\u5176\u76f8\u540c\u7684LMS\u524d\u7f00$\\\\text{pre}(S, j)$\uff0c\u5e94\u8be5\u90fd\u6709$\\\\text{pre}(S, j) < \\\\text{pre}(S, i)$\u3002\u5047\u8bbe\u6211\u4eec\u5b58\u5728\u4e00\u4e2a\u8fd9\u6837\u7684LMS\u524d\u7f00\uff0c\u4f7f\u5f97$\\\\text{pre}(S, j) > \\\\text{pre}(S, i)$\uff0c\u7531\u4e8e$\\\\text{pre}(S, j)[0] = \\\\text{pre}(S, i)[0]$\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u77e5$\\\\text{pre}(S, j + 1) > \\\\text{pre}(S, i + 1)$\u3002\u800c$\\\\text{pre}(S, j + 1)$\u4e0e$\\\\text{pre}(S, i + 1)$\u90fd\u662f\u4e4b\u524d\u6240\u52a0\u5165\u8fc7\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u4e4b\u95f4\u5e94\u5f53\u4fdd\u6301\u6709\u5e8f\u3002\u800c$\\\\text{pre}(S, j) > \\\\text{pre}(S, i)$\u544a\u8bc9\u6211\u4eec\u4e4b\u524d\u7684$SA$\u6570\u7ec4\u4e0d\u662f\u6709\u5e8f\u7684\uff0c\u4e0e\u5047\u8bbe\u76f8\u53cd\uff0c\u6545\u4e0d\u5b58\u5728\u8fd9\u6837\u7684$\\\\text{pre}(S, j)$\u3002\u56e0\u6b64\uff0c\u5f53$\\\\text{pre}(S, i)$\u653e\u7f6e\u540e\uff0c$SA$\u6570\u7ec4\u4fdd\u6301\u6709\u5e8f\u3002\u76f4\u5230\u6240\u6709\u7684$L$\u578bLMS\u524d\u7f00\u52a0\u5165\u5b8c\u6bd5\u3002<br/>\u5bf9\u4e8e\u7b2c\u56db\u6b65\u7684\u6b63\u786e\u6027\u7684\u8bc1\u660e\uff0c\u4e0e\u7b2c\u4e09\u6b65\u7684\u8bc1\u660e\u662f\u7c7b\u4f3c\u7684\u3002\u8bfb\u8005\u53ef\u4ee5\u81ea\u884c\u63a8\u7406\u4e00\u4e0b\u3002<br/><br/>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u5bf9\u8fd9\u4e2a\u8bf1\u5bfc\u6392\u5e8f\u7684\u6b63\u786e\u6027\u7684\u8bc1\u660e\u3002\u4f46\u6211\u4eec\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u53ea\u662f\u5bf9LMS\u524d\u7f00\u7684\u6392\u5e8f\uff0c\u6211\u4eec\u671f\u671b\u662f\u5bf9LMS\u5b50\u4e32\u8fdb\u884c\u6392\u5e8f\u3002\u6211\u4eec\u6ce8\u610f\u5230\u6bcf\u4e00\u4e2aLMS\u5b50\u4e32\u90fd\u53ef\u4ee5\u89c6\u4e3a\u662f\u4e00\u4e2aLMS\u5b57\u7b26\u4e0e\u4e00\u4e2aLMS\u524d\u7f00\u8fde\u63a5\u800c\u6210\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5224\u65ad\u4e24\u4e2aLMS\u5b57\u7b26\u548c\u5176\u540e\u4e00\u4f4d\u5bf9\u5e94\u7684LMS\u524d\u7f00\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u5c31\u53ef\u4ee5\u5224\u65adLMS\u5b50\u4e32\u4e4b\u95f4\u7684\u5927\u5c0f\u5173\u7cfb\u3002<br/>\u7136\u800c\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u505a\u5f97\u66f4\u7b80\u5355\u3002\u4e0b\u9762\u7684\u5f15\u7406\u8bf4\u660e\u4e86\u4e0a\u9762\u7684\u7b97\u6cd5\u7ed3\u675f\u540e\u7684$SA$\u6570\u7ec4\u5c31\u662f\u6392\u597d\u5e8f\u7684LMS\u5b50\u4e32\u7684\u6570\u7ec4\u3002<br/>\u5f15\u7406 2.8 (LMS\u5b50\u4e32\u6392\u5e8f) $SA$\u6570\u7ec4\u4e2d\u6bcf\u4e00\u4e2aLMS\u5b57\u7b26\u6240\u5bf9\u5e94\u7684LMS\u524d\u7f00\u5df2\u7ecf\u6309\u7167\u5176\u5bf9\u5e94\u7684LMS\u5b50\u4e32\u7684\u987a\u5e8f\u6392\u597d\u3002<br/>\u8bc1\u660e \u5bf9\u4e8e\u9996\u5b57\u6bcd\u4e0d\u540c\u7684LMS\u5b50\u4e32\uff0c\u8fd9\u4e2a\u7ed3\u8bba\u662f\u663e\u7136\u7684\u3002<br/>\u5bf9\u4e8e\u9996\u5b57\u6bcd\u76f8\u540c\u7684LMS\u5b50\u4e32\uff0c\u5b83\u5fc5\u5b9a\u662f\u7531\u4e00\u4e2a$L$\u578bLMS\u524d\u7f00\u4ece\u53f3\u81f3\u5de6\u7684\u63a8\u5bfc\u8fc7\u6765\u7684\u3002\u7531\u4e8e\u4e0d\u540c\u7684LMS\u5b50\u4e32\u5fc5\u5b9a\u5bf9\u5e94\u7740\u4e0d\u540c\u7684\u9012\u63a8\u7684\u987a\u5e8f\uff0c\u5e76\u4e14\u5728\u7b2c\u4e8c\u6b65\u4e2d\uff0c\u6240\u6709\u7684$L$\u578bLMS\u524d\u7f00\u5df2\u7ecf\u6392\u597d\u4e86\u5e8f\u3002\u6240\u4ee5\u7ed3\u8bba\u6210\u7acb\u3002<br/>\u6839\u636e\u8fd9\u4e2a\u5f15\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5bf9$SA$\u6570\u7ec4\u626b\u63cf\u4e00\u904d\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230LMS\u5b50\u4e32\u7684\u5b57\u5178\u5e8f\uff0c\u540c\u65f6\u5bf9\u5b83\u4eec\u8fdb\u884c\u547d\u540d\u3002<br/>3. \u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790<br/>\u5728\u4e4b\u524d\u7684\u8ba8\u8bba\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u6210\u529f\u7684\u8fd0\u7528\u8bf1\u5bfc\u6392\u5e8f\u4f7f\u6bcf\u4e00\u6b65\u90fd\u662f$\\\\Theta(|S|)$\u3002\u4f46\u662f\u7531\u4e8e\u6709\u4e00\u4e2a\u9012\u5f52\u7684\u8fc7\u7a0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f3c\u4e4e\u5e76\u4e0d\u4e00\u5b9a\u662f\u7ebf\u6027\u7684\u3002<br/>\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u6bcf\u6b21\u9012\u5f52\u90fd\u662f\u8ba1\u7b97$S_1$\u7684\u540e\u7f00\u6570\u7ec4\u3002\u5982\u679c\u6211\u4eec\u80fd\u591f\u77e5\u9053$S_1$\u7684\u89c4\u6a21\uff0c\u5c31\u80fd\u591f\u8ba1\u7b97SA-IS\u7684\u4e8b\u4ef6\u590d\u6742\u5ea6\u3002<br/>\u6839\u636e\u5f15\u74062.5\uff0c\u6211\u4eec\u5f97\u77e5$|S_1| \\\\le \\\\left\\\\lceil|S| / 2\\\\right\\\\rceil$\u3002\u56e0\u6b64\u6bcf\u4e00\u5c42\u7684\u9012\u5f52\u7684\u95ee\u9898\u89c4\u6a21\u90fd\u4f1a\u51cf\u534a\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u9012\u5f52\u5f0f\u6765\u8868\u793a\u65f6\u95f4\u590d\u6742\u5ea6\uff1a<br/>$$ T(n) = T(\\\\left\\\\lceil n/2\\\\right\\\\rceil) + \\\\Theta(n) \\\\tag{3.1} $$<br/>\u6c42\u89e3\u53ef\u5f97\uff1a<br/>$$ T(n) = \\\\Theta(n) \\\\tag{3.2} $$<br/>\u56e0\u6b64\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f$\\\\Theta(n)$\u7684\u3002<br/>\u5bf9\u4e8e\u8fd9\u4e2a\u9012\u5f52\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f\u9012\u5f52\u4e86$O(\\\\log n)$\u5c42\uff0c\u5176\u4e2d\u6bcf\u4e00\u5c42\u7684\u95ee\u9898\u89c4\u6a21\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u662f$2^0, 2^1, 2^2, \\\\dots, 2^{\\\\left\\\\lfloor\\\\log n\\\\right\\\\rfloor}$\u3002\u56e0\u6b64\u603b\u590d\u6742\u5ea6\u5c31\u662f\u5bf9\u5b83\u4eec\u8fdb\u884c\u6c42\u548c\uff1a<br/>$$ \\\\sum^{\\\\left\\\\lfloor\\\\log n\\\\right\\\\rfloor}_{k=0} 2^k = 2 \\\\times 2^{\\\\left\\\\lfloor\\\\log n\\\\right\\\\rfloor} = \\\\Theta(2^{\\\\left\\\\lfloor\\\\log n\\\\right\\\\rfloor}) = \\\\Theta(n) \\\\tag{3.3} $$<br/>\u5bf9\u4e8e\u7a7a\u95f4\u590d\u6742\u5ea6\u7684\u5206\u6790\uff0c\u4e0e\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5982\u51fa\u4e00\u8f99\u7684\u3002<br/>4. \u8fd0\u884c\u793a\u4f8b<br/>\u4e0b\u9762\u5c06\u7528aabaaaab\u4f5c\u4e3a\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u5c55\u793a\u8ba1\u7b97\u5176\u540e\u7f00\u6570\u7ec4\u7684\u6bcf\u4e00\u6b65\u3002\u5e0c\u671b\u80fd\u901a\u8fc7\u8fd9\u4e2a\u793a\u4f8b\u80fd\u591f\u66f4\u6e05\u6670\u5730\u5c55\u73b0SA-IS\u7b97\u6cd5\u7684\u8fd0\u4f5c\u6d41\u7a0b\u3002\u7531\u4e8e\u6d89\u53ca\u5230\u5bf9\u6876\u7684\u64cd\u4f5c\uff0c\u8fd9\u91cc\u7528@\u8868\u793a\u6b63\u5728\u88ab\u5904\u7406\u7684\u5143\u7d20\uff0c\u800c\u7528^\u8868\u793a\u6bcf\u4e2a\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48<br/>49<br/>50<br/>51<br/>52<br/>53<br/>54<br/>55<br/>56<br/>57<br/>58<br/>59<br/>60<br/>61<br/>62<br/>63<br/>64<br/>65<br/>66<br/>67<br/>68<br/>69<br/>70<br/>71<br/>72<br/>73<br/>74<br/>75<br/>76<br/>77<br/>78<br/>79<br/>80<br/>81<br/>82<br/>83           0  1  2  3  4  5  6  7  8<br/>S:         a  a  b  a  a  a  a  b  #<br/>\u626b\u63cf\u540e\u7f00\u7c7b\u578b<br/>t:         S  S  L  S  S  S  S  L  S<br/>LMS characters:     *              *<br/>         |# |       a         |  b  |  # \u6876\u7684\u540d\u79f0<br/>SA:       -1|-1 -1 -1 -1 -1 -1|-1 -1<br/>\u5bf9LMS\u5b50\u4e32\u8fdb\u884c\u6392\u5e8f<br/>1. \u653e\u5165LMS\u5b50\u4e32<br/>SA:       08|-1 -1 -1 -1 -1 03|-1 -1<br/>2. \u4ece*\u578bLMS\u524d\u7f00\u8bf1\u5bfc\u5230L\u578bLMS\u524d\u7f00<br/>SA:       08|-1 -1 -1 -1 -1 03|-1 -1<br/>          @^  ^                 ^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 -1<br/>           ^  ^             @      ^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02  # pre(S, 6)\u4e0d\u662fL\u578b\u7684<br/>           ^  ^                @   ^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02<br/>           ^  ^                   @^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02<br/>3. \u4eceL\u578bLMS\u524d\u7f00\u8bf1\u5bfc\u5230S\u578b\u524d\u7f00<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02<br/>           ^                 ^    @^<br/>SA:       08|-1 -1 -1 -1 -1 01|07 02<br/>           ^              ^    @   ^<br/>SA:       08|-1 -1 -1 -1 06 01|07 02<br/>           ^           ^    @      ^<br/>SA:       08|-1 -1 -1 00 06 01|07 02<br/>           ^        ^    @         ^<br/>SA:       08|-1 -1 05 00 06 01|07 02  # \u4e0d\u5b58\u5728pre(S, -1)<br/>           ^     ^    @            ^<br/>SA:       08|-1 -1 05 00 06 01|07 02<br/>           ^     ^ @               ^<br/>SA:       08|-1 04 05 00 06 01|07 02<br/>           ^  ^ @                  ^<br/>SA:       08|03 04 05 00 06 01|07 02<br/>           ^ @^                    ^<br/>SA:       08|03 04 05 00 06 01|07 02  # pre(S, 7)\u4e0d\u662fS\u578b\u7684<br/>          @^  ^                    ^<br/>SA:       08|03 04 05 00 06 01|07 02<br/>\u626b\u63cf\u5e76\u91cd\u547d\u540dLMS\u5b50\u4e32<br/>name:      1  2<br/>S1:       2 1 0<br/>\u7531\u4e8e\u6bcf\u4e00\u4e2a\u5b57\u7b26\u90fd\u4e0d\u4e00\u6837\uff0c\u76f4\u63a5\u8ba1\u7b97SA1<br/>SA1\uff1a     2 1 0<br/>\u4eceSA1\u8bf1\u5bfc\u5230SA<br/>         |$ |       a         |  b  |<br/>SA:       -1|-1 -1 -1 -1 -1 -1|-1 -1<br/>1. \u6309\u7167SA1\u7684\u539f\u987a\u5e8f\u653e\u5165(\u5ffd\u7565S1\u6700\u540e\u7684\u5b57\u7b26)<br/>SA:       08|-1 -1 -1 -1 -1 03|-1 -1<br/>           ^  ^                 ^<br/>2. \u4ece*\u578b\u540e\u7f00\u8bf1\u5bfc\u5230L\u578b\u540e\u7f00<br/>SA:       08|-1 -1 -1 -1 -1 03|-1 -1<br/>          @^  ^                 ^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 -1<br/>           ^  ^             @      ^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02<br/>           ^  ^                @   ^<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02<br/>           ^  ^                   @^<br/>3. \u4eceL\u578b\u540e\u7f00\u8bf1\u5bfc\u5230S\u578b\u540e\u7f00<br/>SA:       08|-1 -1 -1 -1 -1 03|07 02<br/>           ^                 ^    @^<br/>SA:       08|-1 -1 -1 -1 -1 01|07 02<br/>           ^              ^    @   ^<br/>SA:       08|-1 -1 -1 -1 06 01|07 02<br/>           ^           ^    @      ^<br/>SA:       08|-1 -1 -1 00 06 01|07 02<br/>           ^        ^    @         ^<br/>SA:       08|-1 -1 05 00 06 01|07 02<br/>           ^     ^    @            ^<br/>SA:       08|-1 -1 05 00 06 01|07 02<br/>           ^     ^ @               ^<br/>SA:       08|-1 04 05 00 06 01|07 02<br/>           ^  ^ @                  ^<br/>SA:       08|03 04 05 00 06 01|07 02  # pre(S, 2)\u662fL\u578b<br/>           ^ @^                    ^<br/>SA:       08|03 04 05 00 06 01|07 02<br/>          @^  ^                    ^<br/>\u540e\u7f00\u6570\u7ec4\u6784\u9020\u5b8c\u6bd5<br/>SA: 8 3 4 5 0 6 1 7 2<br/><br/>return SA<br/><br/><br/>5. \u5177\u4f53\u5b9e\u73b0\u53ca\u6027\u80fd\u5bf9\u6bd4<br/>\u5728\u539f\u8bba\u6587\u4e2d\u8bf4\u9053SA-IS\u7b97\u6cd5\u53ef\u4ee5\u5728100\u884c\u5de6\u53f3\u7684\u4ee3\u7801\u5b8c\u6210\u3002\u6211\u8bd5\u4e86\u4e00\u4e0b\uff0c\u57fa\u672c\u7b26\u5408\u8fd9\u4e2a\u8981\u6c42\u3002\u4e0b\u9762\u5c06\u4f1a\u7ed9\u51fa\u4e00\u4e2aC++\u5b9e\u73b0\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u4efd\u4ee3\u7801\u4e2d\u5e76\u6ca1\u6709\u56de\u6536\u5206\u914d\u7684\u5185\u5b58\u3002<br/>  1<br/>  2<br/>  3<br/>  4<br/>  5<br/>  6<br/>  7<br/>  8<br/>  9<br/> 10<br/> 11<br/> 12<br/> 13<br/> 14<br/> 15<br/> 16<br/> 17<br/> 18<br/> 19<br/> 20<br/> 21<br/> 22<br/> 23<br/> 24<br/> 25<br/> 26<br/> 27<br/> 28<br/> 29<br/> 30<br/> 31<br/> 32<br/> 33<br/> 34<br/> 35<br/> 36<br/> 37<br/> 38<br/> 39<br/> 40<br/> 41<br/> 42<br/> 43<br/> 44<br/> 45<br/> 46<br/> 47<br/> 48<br/> 49<br/> 50<br/> 51<br/> 52<br/> 53<br/> 54<br/> 55<br/> 56<br/> 57<br/> 58<br/> 59<br/> 60<br/> 61<br/> 62<br/> 63<br/> 64<br/> 65<br/> 66<br/> 67<br/> 68<br/> 69<br/> 70<br/> 71<br/> 72<br/> 73<br/> 74<br/> 75<br/> 76<br/> 77<br/> 78<br/> 79<br/> 80<br/> 81<br/> 82<br/> 83<br/> 84<br/> 85<br/> 86<br/> 87<br/> 88<br/> 89<br/> 90<br/> 91<br/> 92<br/> 93<br/> 94<br/> 95<br/> 96<br/> 97<br/> 98<br/> 99<br/>100<br/>101<br/>102<br/>103<br/>104<br/>105<br/>106<br/>107<br/>108<br/>109<br/>110<br/>111<br/>112<br/>113<br/>114<br/>115<br/>116<br/>117<br/>118<br/>119<br/>120<br/>121<br/>122<br/>123<br/>124<br/>125<br/>126<br/>127<br/>128<br/>129<br/>130// \u540e\u7f00\u7c7b\u578b<br/>#define L_TYPE 0<br/>#define S_TYPE 1<br/><br/>// \u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u662f\u5426\u4e3aLMS\u5b57\u7b26<br/>inline bool is_lms_char(int *type, int x) {<br/>    return x > 0 && type[x] == S_TYPE && type[x - 1] == L_TYPE;<br/>}<br/><br/>// \u5224\u65ad\u4e24\u4e2aLMS\u5b50\u4e32\u662f\u5426\u76f8\u540c<br/>inline bool equal_substring(int *S, int x, int y, int *type) {<br/>    do {<br/>        if (S[x] != S[y])<br/>            return false;<br/>        x++, y++;<br/>    } while (!is_lms_char(type, x) && !is_lms_char(type, y));<br/><br/>    return S[x] == S[y];<br/>}<br/><br/>// \u8bf1\u5bfc\u6392\u5e8f(\u4ece*\u578b\u8bf1\u5bfc\u5230L\u578b\u3001\u4eceL\u578b\u8bf1\u5bfc\u5230S\u578b)<br/>// \u8c03\u7528\u4e4b\u524d\u5e94\u5c06*\u578b\u6309\u8981\u6c42\u653e\u5165SA\u4e2d<br/>inline void induced_sort(int *S, int *SA, int *type, int *bucket, int *lbucket,<br/>                         int *sbucket, int n, int SIGMA) {<br/>    for (int i = 0; i <= n; i++)<br/>        if (SA[i] > 0 && type[SA[i] - 1] == L_TYPE)<br/>            SA[lbucket[S[SA[i] - 1]]++] = SA[i] - 1;<br/>    for (int i = 1; i <= SIGMA; i++)  // Reset S-type bucket<br/>        sbucket[i] = bucket[i] - 1;<br/>    for (int i = n; i >= 0; i--)<br/>        if (SA[i] > 0 && type[SA[i] - 1] == S_TYPE)<br/>            SA[sbucket[S[SA[i] - 1]]--] = SA[i] - 1;<br/>}<br/><br/>// SA-IS\u4e3b\u4f53<br/>// S\u662f\u8f93\u5165\u5b57\u7b26\u4e32\uff0clength\u662f\u5b57\u7b26\u4e32\u7684\u957f\u5ea6, SIGMA\u662f\u5b57\u7b26\u96c6\u7684\u5927\u5c0f<br/>static int *SAIS(int *S, int length, int SIGMA) {<br/>    int n = length - 1;<br/>    int *type = new int[n + 1];  // \u540e\u7f00\u7c7b\u578b<br/>    int *position = new int[n + 1];  // \u8bb0\u5f55LMS\u5b50\u4e32\u7684\u8d77\u59cb\u4f4d\u7f6e<br/>    int *name = new int[n + 1];  // \u8bb0\u5f55\u6bcf\u4e2aLMS\u5b50\u4e32\u7684\u65b0\u540d\u79f0<br/>    int *SA = new int[n + 1];  // SA\u6570\u7ec4<br/>    int *bucket = new int[SIGMA];  // \u6bcf\u4e2a\u5b57\u7b26\u7684\u6876<br/>    int *lbucket = new int[SIGMA];  // \u6bcf\u4e2a\u5b57\u7b26\u7684L\u578b\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e<br/>    int *sbucket = new int[SIGMA];  // \u6bcf\u4e2a\u5b57\u7b26\u7684S\u578b\u6876\u7684\u8d77\u59cb\u4f4d\u7f6e<br/><br/>    // \u521d\u59cb\u5316\u6bcf\u4e2a\u6876<br/>    memset(bucket, 0, sizeof(int) * (SIGMA + 1));<br/>    for (int i = 0; i <= n; i++)<br/>        bucket[S[i]]++;<br/>    for (int i = 1; i <= SIGMA; i++) {<br/>        bucket[i] += bucket[i - 1];<br/>        lbucket[i] = bucket[i - 1];<br/>        sbucket[i] = bucket[i] - 1;<br/>    }<br/><br/>    // \u786e\u5b9a\u540e\u7f00\u7c7b\u578b(\u5229\u7528\u5f15\u74062.1)<br/>    type[n] = S_TYPE;<br/>    for (int i = n - 1; i >= 0; i--) {<br/>        if (S[i] < S[i + 1])<br/>            type[i] = S_TYPE;<br/>        else if (S[i] > S[i + 1])<br/>            type[i] = L_TYPE;<br/>        else<br/>            type[i] = type[i + 1];<br/>    }<br/><br/>    // \u5bfb\u627e\u6bcf\u4e2aLMS\u5b50\u4e32<br/>    int cnt = 0;<br/>    for (int i = 1; i <= n; i++)<br/>        if (type[i] == S_TYPE && type[i - 1] == L_TYPE)<br/>            position[cnt++] = i;<br/><br/>    // \u5bf9LMS\u5b50\u4e32\u8fdb\u884c\u6392\u5e8f<br/>    fill(SA, SA + n + 1, -1);<br/>    for (int i = 0; i < cnt; i++)<br/>        SA[sbucket[S[position[i]]]--] = position[i];<br/>    induced_sort(S, SA, type, bucket, lbucket, sbucket, n, SIGMA);<br/><br/>    // \u4e3a\u6bcf\u4e2aLMS\u5b50\u4e32\u547d\u540d<br/>    fill(name, name + n + 1, -1);<br/>    int lastx = -1, namecnt = 1;  // \u4e0a\u4e00\u6b21\u5904\u7406\u7684LMS\u5b50\u4e32\u4e0e\u540d\u79f0\u7684\u8ba1\u6570<br/>    bool flag = false;  // \u8fd9\u91cc\u987a\u4fbf\u8bb0\u5f55\u662f\u5426\u6709\u91cd\u590d\u7684\u5b57\u7b26<br/>    for (int i = 1; i <= n; i++) {<br/>        int x = SA[i];<br/><br/>        if (is_lms_char(type, x)) {<br/>            if (lastx >= 0 && !equal_substring(S, x, lastx, type))<br/>                namecnt++;<br/>            // \u56e0\u4e3a\u53ea\u6709\u76f8\u540c\u7684LMS\u5b50\u4e32\u624d\u4f1a\u6709\u540c\u6837\u7684\u540d\u79f0<br/>            if (lastx >= 0 && namecnt == name[lastx])<br/>                flag = true;<br/><br/>            name[x] = namecnt;<br/>            lastx = x;<br/>        }<br/>    }  // for<br/>    name[n] = 0;<br/><br/>    // \u751f\u6210S1<br/>    int *S1 = new int[cnt];<br/>    int pos = 0;<br/>    for (int i = 0; i <= n; i++)<br/>        if (name[i] >= 0)<br/>            S1[pos++] = name[i];<br/><br/>    int *SA1;<br/>    if (!flag) {<br/>        // \u76f4\u63a5\u8ba1\u7b97SA1<br/>        SA1 = new int[cnt + 1];<br/><br/>        for (int i = 0; i < cnt; i++)<br/>            SA1[S1[i]] = i;<br/>    } else<br/>        SA1 = SAIS(S1, cnt, namecnt);  // \u9012\u5f52\u8ba1\u7b97SA1<br/><br/>    // \u4eceSA1\u8bf1\u5bfc\u5230SA<br/>    lbucket[0] = sbucket[0] = 0;<br/>    for (int i = 1; i <= SIGMA; i++) {<br/>        lbucket[i] = bucket[i - 1];<br/>        sbucket[i] = bucket[i] - 1;<br/>    }<br/>    fill(SA, SA + n + 1, -1);<br/>    for (int i = cnt - 1; i >= 0; i--)  // \u8fd9\u91cc\u662f\u9006\u5e8f\u626b\u63cfSA1\uff0c\u56e0\u4e3aSA\u4e2dS\u578b\u6876\u662f\u5012\u5e8f\u7684<br/>        SA[sbucket[S[position[SA1[i]]]]--] = position[SA1[i]];<br/>    induced_sort(S, SA, type, bucket, lbucket, sbucket, n, SIGMA);<br/><br/>    // \u540e\u7f00\u6570\u7ec4\u8ba1\u7b97\u5b8c\u6bd5<br/>    return SA;<br/>}<br/><br/><br/>SA-IS\u7684\u5b9e\u73b0\u8fd8\u53ef\u4ee5\u53c2\u8003\u4e00\u7bc7\u5f88\u597d\u7684\u535a\u6587: A walk through the SA-IS Suffix Array Construction Algorithm\uff0c\u8fd9\u7bc7\u6587\u7ae0\u7684\u4f5c\u8005\u4f7f\u7528Python\u4e00\u6b65\u4e00\u6b65\u5730\u4ecb\u7ecd\u4e86\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u57fa\u7840\u7684SA-IS\u7b97\u6cd5\u3002<br/>\u6211\u4eec\u770b\u5230SA-IS\u4f5c\u4e3a\u4e00\u4e2a\u540e\u7f00\u6392\u5e8f\u7684\u7b97\u6cd5\uff0c\u4ee3\u7801\u91cf\u4e5f\u5e76\u4e0d\u5c0f\uff0c\u7136\u800c\u5b9e\u9645\u4e0a\u5b83\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u5176\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u539f\u56e0\u5c31\u662fSA-IS\u7b97\u6cd5\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u987a\u5e8f\u8bbf\u95ee\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u597d\u5730\u63d0\u9ad8\u7f13\u5b58\u547d\u4e2d\u73877\u3002\u539f\u8bba\u6587\u4e2d\u5b9e\u6d4bSA-IS\u7b97\u6cd5\u51fb\u8d25\u4e86KA\u7b97\u6cd5\uff0c\u4e0d\u6127\u4e3a\u76ee\u524d\u4e3a\u6b62\u901f\u5ea6\u6700\u5feb\u7684\u540e\u7f00\u6570\u7ec4\u7684\u6784\u5efa\u7b97\u6cd5\u3002<br/>\u5bf9\u4e2d\u5b66OI\u754c\uff0c\u6784\u9020\u540e\u7f00\u6570\u7ec4\u901a\u5e38\u662f\u4f7f\u7528\u500d\u589e\u6cd5\u548cDC3\u7b97\u6cd5\u3002\u500d\u589e\u6cd5\u901f\u5ea6\u6bd4DC3\u7b97\u6cd5\u6162\u662f\u4f17\u6240\u5468\u77e5\u7684\u4e86\uff0c\u4e0b\u9762\u6211\u5c06\u7528\u4e0d\u540c\u89c4\u6a21\u7684\u968f\u673a\u5b57\u7b26\u4e32\u6765\u6bd4\u8f83DC3\u7b97\u6cd5\u4e0eSA-IS\u7b97\u6cd5\u3002<br/><br/><br/><br/>\u6570\u636e\u89c4\u6a21<br/>DC3<br/>SA-IS<br/><br/><br/><br/><br/>$10^4$<br/>$0.015\\\\text{s}$<br/>$0.011\\\\text{s}$<br/><br/><br/>$10^5$<br/>$0.055\\\\text{s}$<br/>$0.036\\\\text{s}$<br/><br/><br/>$10^6$<br/>$0.365\\\\text{s}$<br/>$0.270\\\\text{s}$<br/><br/><br/>$2\\\\times 10^6$<br/>$0.997\\\\text{s}$<br/>$0.593\\\\text{s}$<br/><br/><br/>$5\\\\times 10^6$<br/>$2.803\\\\text{s}$<br/>$2.085\\\\text{s}$<br/><br/><br/>$10^7$<br/>$4.012\\\\text{s}$<br/>$3.326\\\\text{s}$<br/><br/><br/><br/>\u7f16\u8bd1\u547d\u4ee4: g++ SAIS.cpp/DC3.cpp -o sais/dc3 -O3<br/>\u8fd0\u884c\u73af\u5883: Ubuntu 14.04 LTS x64 / CPU: 2.0GHz \u5954\u817e\u67d0CPU / 4GB\u5185\u5b58 / \u672a\u542f\u52a8X window<br/>\u4ece\u4e0a\u9762\u7684\u7ed3\u679c\u53ef\u4ee5\u770b\u51fa\uff0cSA-IS\u7b97\u6cd5\u901f\u5ea6\u4e0a\u660e\u663e\u4f18\u4e8eDC3\u7b97\u6cd5\uff0c\u5e76\u4e14\u6570\u636e\u89c4\u6a21\u8d8a\u5927\uff0c\u4e24\u8005\u7684\u901f\u5ea6\u5dee\u8ddd\u8d8a\u660e\u663e\u3002<br/>\u603b\u800c\u8a00\u4e4b\uff0cSA-IS\u7b97\u6cd5\u662f\u4e00\u4e2a\u76f8\u5f53\u4e0d\u9519\u7684\u540e\u7f00\u6570\u7ec4\u7684\u6784\u5efa\u7b97\u6cd5\u3002\u4f3c\u4e4eSA-IS\u7b97\u6cd5\u6240\u5229\u7528\u7684\u8bf1\u5bfc\u6392\u5e8f\u7684\u601d\u60f3\u8fd8\u53ef\u4ee5\u89e3\u51b3\u5176\u5b83\u7684\u4e00\u4e9b\u5b57\u7b26\u4e32\u7684\u95ee\u9898\uff0c\u5982\u8ba1\u7b97LCP\u6570\u7ec48\uff0c\u6211\u5e76\u6ca1\u6709\u5bf9\u6b64\u505a\u8fc7\u591a\u7684\u4e86\u89e3\u4e86\u3002<br/><br/><br/><br/><br/>Nong, Ge; Zhang, Sen; Chan, Wai Hong (2009): Linear Suffix Array Construction by Almost Pure Induced-Sorting\u00a0\u21a9<br/><br/><br/>\u8fd9\u91cc\u7684$\\\\#$\u5e76\u4e0d\u662f\u6307\u4e95\u53f7\uff0c\u800c\u662f\u4e00\u4e2a\u7279\u6b8a\u8bb0\u53f7\u3002\u5b57\u7b26\u4e32\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u8fd9\u4e2a\u5b57\u7b26\u3002\u00a0\u21a9<br/><br/><br/>\u540e\u9762\u6211\u4eec\u5c06\u4f1a\u6709\u66f4\u597d\u7684\u7b97\u6cd5\u6765\u5bf9LMS\u5b50\u4e32\u6392\u5e8f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e00\u81f4\uff0c\u4f46\u5728\u5b9e\u9645\u8fd0\u7528\u4e2d\u901f\u5ea6\u5feb\u5f88\u591a\u3002\u00a0\u21a9<br/><br/><br/>\u6ce8\u610f\u4e4b\u540e\u4f1a\u521b\u5efa\u65b0\u5b57\u7b26\u4e32$S_1$\uff0c\u5176\u5b57\u7b26\u96c6$\\\\Sigma$\u662f\u4e0d\u540c\u7684\u3002\u00a0\u21a9<br/><br/><br/>\u5224\u65ad\u4e24\u4e2aLMS\u5b50\u4e32\u662f\u5426\u76f8\u7b49\u53ef\u4ee5\u66b4\u529b\u5224\u65ad\uff0c\u57fa\u4e8e\u5f15\u74062.6\uff0c\u53ef\u4ee5\u8bc1\u660e\u5176\u603b\u590d\u6742\u5ea6\u4e3a$O(|S|)$\u3002\u00a0\u21a9<br/><br/><br/>\u6ce8\u610f$*$\u578b\u540e\u7f00\u4e5f\u5c5e\u4e8e$S$\u578b\u540e\u7f00\uff0c\u56e0\u6b64\u4f1a\u5bf9\u5b83\u4eec\u8fdb\u884c\u91cd\u6392\uff0c\u4ece\u800c\u786e\u4fdd\u65b0\u52a0\u5165\u7684$S$\u578b\u540e\u7f00\u7684\u987a\u5e8f\u662f\u5bf9\u7684\u3002\u00a0\u21a9<br/><br/><br/>\u5373\u964d\u4f4ecache-missing\u3002\u00a0\u21a9<br/><br/><br/>Johannes Fischer (2011): Inducing the LCP-Array\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2016-6-19/sais.html"
},
"\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5": {
"tags": "\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5",
"text": "\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5<br/>\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u662f\u4e00\u79cd\u5feb\u901f\u6c42\u51fd\u6570\u5b9a\u79ef\u5206\u7684\u65b9\u6cd5\u3002\u4e0e\u666e\u901a\u7684\u76f4\u7ebf\u62df\u5408\u65b9\u6cd5\u76f8\u6bd4\uff0c\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u91c7\u7528\u7684\u662f\u4e8c\u6b21\u51fd\u6570\u6765\u62df\u5408\u51fd\u6570\uff0c\u800c\u6548\u679c\u5341\u5206\u663e\u8457\u3002<br/>\u7528\u629b\u7269\u7ebf\u62df\u5408<br/>\u5047\u8bbe\u6211\u4eec\u6709\u4e09\u4e2a\u4e0d\u91cd\u5408\u7684\u70b9\uff0c\u90a3\u4e48\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a\u629b\u7269\u7ebf\u7ecf\u8fc7\u8fd9\u4e09\u4e2a\u70b9\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a<br/><br/>\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u5c31\u662f\u5728\u79ef\u5206\u533a\u95f4$[a,\\\\;b]$\u4e0a\u53bb\u4e09\u4e2a\u70b9$a$\u3001$b$\u548c$m = (a + b) / 2$\uff0c\u8ba1\u7b97\u5176\u539f\u51fd\u6570\u7684\u5728\u6b64\u5904\u7684\u503c\uff0c\u7136\u540e\u7528\u629b\u7269\u7ebf\u6765\u62df\u5408\u539f\u51fd\u6570\uff0c\u5373\u4f7f\u7528\u8be5\u4e8c\u6b21\u51fd\u6570\u7684\u79ef\u5206\u503c\u4ee3\u66ff\u539f\u51fd\u6570\u7684\u79ef\u5206\u503c\uff0c\u8fbe\u5230\u8fd1\u4f3c\u79ef\u5206\u7684\u6548\u679c\u3002<br/>\u5982\u4f55\u8ba1\u7b97\u8fd9\u4e2a\u4e8c\u6b21\u51fd\u6570\uff1f\u6211\u4eec\u81ea\u7136\u53ef\u4ee5\u89e3\u4e09\u5143\u4e09\u6b21\u65b9\u7a0b\u7ec4\uff0c\u4f46\u66f4\u65b9\u4fbf\u7684\u65b9\u6cd5\u662f\u62c9\u683c\u6717\u65e5\u5dee\u503c\u516c\u5f0f\uff1a<br/>$$<br/>g(x) = {(x - m)(x - b) \\\\over (a - m)(a - b)}f(a) + {(x - a)(a - b) \\\\over (m - a)(m - b)}f(m) + {(x - a)(x - m) \\\\over (b - a)(b - m)}f(b)<br/>$$<br/>\u5176\u4e2d$f(x)$\u662f\u539f\u51fd\u6570\uff0c$g(x)$\u662f\u62df\u5408\u540e\u7684\u51fd\u6570\u3002\u4e0b\u6587\u4e2d$f$\u548c$g$\u4e5f\u8868\u793a\u540c\u6837\u7684\u610f\u4e49\uff0c\u4e0d\u518d\u590d\u8ff0\u3002<br/>\u4e8c\u6b21\u51fd\u6570\u7684\u79ef\u5206<br/>\u6709\u4e86\u4e8c\u6b21\u51fd\u6570\u540e\uff0c\u8ba1\u7b97\u5176\u79ef\u5206\u662f\u5341\u5206\u7b80\u5355\u7684\u4e8b\uff0c\u4f46\u662f\u8fd9\u4e00\u5207\u8fd8\u4e0d\u591f\u5b8c\u7f8e\u3002\u4e0b\u9762\u6211\u4eec\u5c06\u63a8\u5bfc\u51fa\u4e00\u4e2a\u66f4\u7b80\u5355\u7684\u516c\u5f0f\u3002<br/>\u8bbe\uff1a<br/>$$<br/>g(x) = Ax^2 + Bx + C \\\\\\\\<br/>m = \\\\frac{(a + b)}2 \\\\\\\\<br/>f(a) = g(a), \\\\; f(m) = g(m), \\\\; f(b) = g(b)<br/>$$<br/>\u90a3\u4e48\uff1a<br/>$$<br/>\\\\int_a^b f(x) \\\\;\\\\mathrm{d}x \\\\approx \\\\int_a^b (Ax^2 + Bx + C)\\\\;\\\\mathrm{d}x<br/>$$<br/>\u6240\u4ee5\uff1a<br/>$$<br/>\\\\int_a^b (Ax^2 + Bx + C)\\\\;\\\\mathrm{d}x = \\\\frac{A}3(b^3-a^3) + \\\\frac{B}2(b^2-a^2) + C(b-a)<br/>$$<br/>\u56e0\u4e3a\uff1a<br/>$$<br/>b^3 - a^3 = (b^2 + ab + a^2)(b-a)\\\\\\\\<br/>b^2 - a^2 = (b+a)(b-a)<br/>$$<br/>\u6240\u4ee5\u4e4b\u524d\u7684\u5f0f\u5b50\u53ef\u53d8\u4e3a\uff1a<br/>$$<br/>{b-a \\\\over 6}[2A(b^2 + ab + a^2) + 3B(b+a) + 6C]<br/>$$<br/>\u8c03\u6574\u53ef\u5f97\uff1a<br/>$$<br/>{b-a \\\\over 6}\\\\left[(Aa^2 + Ba + C) + (Ab^2 + Bb + C) + 4A\\\\left({b+a \\\\over 2}\\\\right)^2 + 4B\\\\left({b+a \\\\over 2}\\\\right) + 4C\\\\right]<br/>$$<br/>\u4e8e\u662f\u5c31\u662f\uff1a<br/>$$<br/>\\\\int_a^b f(x) \\\\;\\\\mathrm{d}x = {b - a \\\\over 6}(f(a) + 4f(m) + f(b))<br/>$$<br/>\u8fd9\u5c31\u662f\u8f9b\u666e\u68ee\u6cd5\u5219\u3002<br/>\u8f9b\u666e\u68ee\u79ef\u5206<br/>\u4e0b\u9762\u5c06\u7528Python\u7b80\u5355\u5b9e\u73b0\u4e00\u4e0b\u8f9b\u666e\u68ee\u79ef\u5206\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u8ba1\u7b97\u79ef\u5206\u7684\u51fd\u6570\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8def sample(f, a, b):<br/>    \\ \\ \\ \u7528\u4e8c\u6b21\u51fd\u6570\u8fd1\u4f3c\u8ba1\u7b97\u51fd\u6570f\u7684\u79ef\u5206<br/>    f: \u51fd\u6570<br/>    a: \u79ef\u5206\u4e0b\u754c<br/>    b: \u79ef\u5206\u4e0a\u754c<br/>    \\ \\ \\ <br/><br/>    return (b - a) * (f(a) + 4.0 * f((a + b) * 0.5) + f(b)) * 0.5<br/><br/><br/>\u7136\u540e\u5c31\u662f\u5bf9f\u5206\u6210n\u6bb5\uff0c\u6bcf\u4e00\u6bb5\u4f7f\u7528\u4e8c\u6b21\u51fd\u6570\u8fd1\u4f3c\u8ba1\u7b97\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17def simpson(f, a, b, n = 1000):<br/>    \\ \\ \\ \u8ba1\u7b97\u5b9a\u79ef\u5206<br/>    f: \u539f\u51fd\u6570<br/>    a: \u79ef\u5206\u4e0b\u754c<br/>    b: \u79ef\u5206\u4e0a\u754c<br/>    n: \u5212\u5206\u7684\u533a\u95f4\u6570<br/>    \\ \\ \\ <br/><br/>    delta = (b - a) / n<br/>    result = 0<br/><br/>    for i in range(0, n):<br/>        left = a + i * delta<br/>        right = left + delta<br/>        result += sample(f, left, right)<br/><br/>    return result<br/><br/><br/>\u7528\u5b83\u6765\u8bd5\u7740\u7b97\u4e00\u4e0b\u5706\u5468\u7387\uff1a<br/>1<br/>2In [1]: simpson(lambda x : 2.0 * sqrt(1 - x**2), -1, 1, 100000)<br/>Out[1]: 3.1415926390691236<br/><br/><br/>\u53ef\u4ee5\u53d1\u73b0\u5206\u4e3a$100000$\u4e2a\u533a\u95f4\u5c31\u83b7\u5f97\u4e86$7$\u4f4d\u7684\u7cbe\u5ea6\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u4f60\u5c06sample\u6362\u4e3a\u76f4\u7ebf\u7684\u62df\u5408\uff0c\u4f60\u5c06\u53ea\u80fd\u5f97\u5230$6$\u4f4d\u7684\u7cbe\u5ea6\u3002<br/>\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u79ef\u5206<br/>\u7136\u800c\u63a7\u5236\u533a\u95f4\u4e2a\u6570\u4e0d\u662f\u4e00\u4e2a\u63a7\u5236\u7b54\u6848\u7cbe\u5ea6\u7684\u597d\u529e\u6cd5\uff0c\u901a\u5e38\u6211\u4eec\u5c06\u4f7f\u7528\u7279\u5b9a\u7684$\\\\varepsilon$\u6765\u63a7\u5236\u7cbe\u5ea6\u8bef\u5dee\u3002<br/>\u5982\u4f55\u8ba9\u7b97\u6cd5\u77e5\u9053\u5e94\u5f53\u7ee7\u7eed\u7ec6\u5206\u6765\u8fbe\u5230\u7279\u5b9a\u7cbe\u5ea6\u5462\uff1f\u901a\u5e38\u7684\u65b9\u6cd5\u5c31\u662f\u5c06\u5f53\u524d\u533a\u95f4\u5206\u4e3a\u4e24\u534a\uff0c\u7528\u8fd9\u4e24\u534a\u7684\u62df\u5408\u503c\u4e0e\u5f53\u524d\u8ba1\u7b97\u7684\u503c\u505a\u5dee\u3002\u5982\u679c\u5c0f\u4e8e$\\\\varepsilon$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8ba4\u4e3a\u7cbe\u5ea6\u8fbe\u5230\u4e86\u8981\u6c42\u3002\u5426\u5219\u6211\u4eec\u5c31\u9012\u5f52\u4e0b\u53bb\uff0c\u8ba1\u7b97\u4e24\u4e2a\u5b50\u533a\u95f4\u7684\u79ef\u5206\u3002\u6ce8\u610f\uff0c\u6b64\u65f6$\\\\varepsilon$\u4e5f\u5e94\u5f53\u7f29\u5c0f\uff0c\u4ece\u800c\u907f\u514d\u7d2f\u79ef\u7684\u8bef\u5dee\u8d85\u8fc7\u4e86$\\\\varepsilon$\u3002<br/>\u8fd9\u6837\u6211\u4eec\u5c31\u5c06\u5f97\u5230\u4e00\u4e2a\u9012\u5f52\u7b97\u6cd5\uff0c\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28def _adaptive_simpson(f, a, b, eps, current):<br/>    \\ \\ \\ \u9012\u5f52\u8fc7\u7a0b<br/>    f: \u539f\u51fd\u6570<br/>    a: \u79ef\u5206\u4e0b\u754c<br/>    b: \u79ef\u5206\u4e0a\u754c<br/>    eps: \u7cbe\u5ea6<br/>    current: [a, b]\u7684\u5b9a\u79ef\u5206\u8fd1\u4f3c\u503c\uff0c\u7528\u4e8e\u51cf\u5c11\u8ba1\u7b97\u91cf<br/>    \\ \\ \\ <br/><br/>    mid = (a + b) * 0.5<br/>    leftans = sample(f, a, mid)<br/>    rightans = sample(f, mid, b)<br/><br/>    if abs(leftans + rightans - current) < eps:  # \u5982\u679c\u8fbe\u5230\u8981\u6c42<br/>        return current<br/>    else:  # \u5426\u5219\u5c06\u9012\u5f52\u4e0b\u53bb\u8ba1\u7b97<br/>        return (_adaptive_simpson(f, a, mid, eps * 0.5, leftans) +<br/>                _adaptive_simpson(f, mid, b, eps * 0.5, rightans))<br/><br/>def adaptive_simpson(f, a, b, eps):<br/>    \\ \\ \\ \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u79ef\u5206<br/>    f: \u539f\u51fd\u6570<br/>    a: \u79ef\u5206\u4e0b\u754c<br/>    b: \u79ef\u5206\u4e0a\u754c<br/>    eps: \u7cbe\u5ea6<br/>    \\ \\ \\ <br/><br/>    return _adaptive_simpson(f, a, b, eps, sample(f, a, b))<br/><br/><br/>\u6211\u5c06\u5176\u4e0e\u7ebf\u6027\u62df\u5408\u7684\u7b97\u6cd5\u5bf9\u6bd4\u4e86\u4e00\u4e0b\u901f\u5ea6\u3002\u4ed6\u4eec\u5171\u7528\u4e00\u4e2a\u9012\u5f52\u7684\u6846\u67b6\uff0c\u53ea\u662fsample\u51fd\u6570\u6709\u4e8c\u6b21\u51fd\u6570\u62df\u5408\u548c\u76f4\u7ebf\u62df\u5408\u4e24\u79cd\uff1a<br/>\u76f4\u7ebf\u62df\u5408\uff1a<br/>1<br/>2<br/>3<br/>4In [1]: % time adaptive_simpson(sin, 0, 1000, 0.00001)<br/>CPU times: user 5.58 s, sys: 0 ns, total: 5.58 s<br/>Wall time: 5.58 s<br/>Out[1]: 0.4376209161316862<br/><br/><br/>\u4e8c\u6b21\u51fd\u6570\u62df\u5408\uff1a<br/>1<br/>2<br/>3<br/>4In [26]: % time adaptive_simpson(sin, 0, 1000, 0.00001)<br/>CPU times: user 60 ms, sys: 0 ns, total: 60 ms<br/>Wall time: 59.6 ms<br/>Out[26]: 0.43762092534838204<br/><br/><br/>\u53ef\u89c1\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u662f\u76f8\u5f53\u8fc5\u901f\u7684\u3002<br/>\u5f02\u5e38\u60c5\u51b5<br/>\u7531\u4e8e\u662f\u4f7f\u7528\u4e8c\u6b21\u51fd\u6570\u62df\u5408\uff0c\u6240\u4ee5\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u5bf9\u5149\u6ed1\u7684\u51fd\u6570\u6548\u679c\u8f83\u597d\u3002\u4f46\u4e0b\u9762\u51e0\u79cd\u60c5\u51b5\u9700\u8981\u8c28\u614e\u8003\u8651\uff1a<br/><br/>\u4e0a\u4e0b\u9707\u8361\u5341\u5206\u5267\u70c8\u7684\u51fd\u6570\uff08\u5982$y = \\\\sin(1/x)$\uff09\u4e0d\u9002\u7528\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u79cd\u51fd\u6570\u4e00\u822c\u90fd\u4e0d\u597d\u79ef\u3002<br/>\u7a81\u53d8\u7684\u51fd\u6570\uff08\u5982$y = |x|$\uff0c\u5728$x = 0$\u5904\u65e0\u5bfc\u6570\uff09\u4e0d\u9002\u7528\u3002<br/><br/>\u5bf9\u4e8e\u5b58\u5728\u6ca1\u6709\u5bfc\u6570\u7684\u70b9\u7684\u51fd\u6570\uff0c\u901a\u5e38\u7684\u89e3\u51b3\u65b9\u6cd5\u5c31\u662f\u4ece\u8fd9\u4e9b\u70b9\u5206\u5f00\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5206\u6bb5\u8ba1\u7b97\u4e86\u3002",
"url": "blog/2016-11-16/simpson.html"
},
"\u957f\u94fe\u5256\u5206": {
"tags": "\u957f\u94fe\u5256\u5206 \u6811\u4e0a\u7956\u5148\u67e5\u8be2 \u6570\u636e\u7ed3\u6784",
"text": "\u957f\u94fe\u5256\u5206<br/><br/>WC\u542c\u8bfe\u65f6\u542c\u5230\u53ef\u4ee5$\\\\Theta(1)$\u67e5\u8be2\u6811\u4e0a\u7956\u5148\u7684\u7b97\u6cd5\uff0c\u53eb\u957f\u94fe\u5256\u5206\u3002\u7136\u800c\u8bb2\u8bfe\u4eba\u975e\u5e38\u5389\u5bb3\uff0c\u8bf4\u7f51\u4e0a\u8fd9\u79cd\u8d44\u6599\u5f88\u591a\u5c31\u6ca1\u8bb2\u4e86\u3002\u7136\u800c\u6211\u59ff\u52bf\u4e0d\u591f\u5e76\u641c\u4e0d\u5230\u3002\u6253\u542c\u5230\u8be5\u7b97\u6cd5\u540e\u5728\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\u3002<br/><br/>\u67e5\u8be2\u6811\u4e0a\u7956\u5148\u7684\u4e00\u822c\u7b97\u6cd5<br/>\u9759\u6001\u6811<br/>\u9759\u6001\u7684\u6811\u4e0a\u4e4b\u524d\u6211\u53ea\u77e5\u9053$O(\\\\log n)$\u7684\u500d\u589e\u7b97\u6cd5\uff0c\u5373\u5148\u6784\u9020\u51fa\u8fd9\u68f5\u6811\u7684\u500d\u589e\u8868$f[n][k]$\uff0c\u8868\u793a$n$\u53f7\u8282\u70b9\u5f80\u6811\u6839\u8d70$2^k$\u6b65\u8d70\u5230\u7684\u7956\u5148\u3002\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u5728$O(n \\\\log n)$\u7684\u65f6\u95f4\u5185\u9884\u5904\u7406\u51fa\u6765\uff0c\u5177\u4f53\u7684\u8fd9\u91cc\u4e0d\u518d\u4ecb\u7ecd\uff0c\u7f51\u4e0a\u6216\u8005\u672c\u535a\u5ba2\u4e00\u7bc7\u5173\u4e8eLCA\u7684\u6587\u7ae0\u5185\u90fd\u6709\u4ecb\u7ecd\u3002<br/>\u6784\u5efa\u51fa\u500d\u589e\u8868\u540e\uff0c\u5982\u679c\u6211\u4eec\u60f3\u5f80\u4e0a\u65b9\u8d70$d$\u6b65\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06$d$\u6309\u7167\u4e8c\u8fdb\u5236\u5206\u89e3\u6210\u51e0\u4e2a$2$\u7684\u5e42\u7684\u548c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5229\u7528\u500d\u589e\u8868\u8fdb\u884c$O(\\\\log n)$\u6b21\u4e0a\u8df3\uff0c\u5230\u8fbe\u8ddd\u79bb\u4e3a$d$\u7684\u7956\u5148\u5904\u3002<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function find_ancestor(u, d):<br/>    k = 0<br/><br/>    while d:<br/>        if d & 1:<br/>            u = f[u][k]<br/>        d >>= 1<br/>        k++<br/><br/>    return u<br/><br/><br/>\u52a8\u6001\u6811<br/>\u5f53\u7136\u9700\u8981LCT\u5566\u3002\u9996\u5148access\u5230$u$\uff0c\u7136\u540e\u5bf9\u4e8eLCT\u4e0a\u7684\u5e73\u8861\u6811\uff0c\u989d\u5916\u8bb0\u5f55\u4e0b\u6bcf\u4e2a\u8282\u70b9\u7684\u5927\u5c0f\u5c31\u53ef\u5728\u5e73\u8861\u6811\u4e0a\u627e\u51fa\u5bf9\u5e94\u4f4d\u7f6e\u7684\u7956\u5148\u3002<br/>\u957f\u94fe\u5256\u5206<br/>\u5341\u5206\u51fa\u540d\u7684\u6811\u94fe\u5256\u5206\u662f\u6309\u7167\u513f\u5b50\u8282\u70b9\u7684\u5927\u5c0f\u6765\u6311\u9009\u91cd\u513f\u5b50\u7684\uff0c\u8fd9\u79cd\u5256\u5206\u65b9\u6cd5\u4fdd\u8bc1\u4e86\u6bcf\u4e2a\u8282\u70b9\u5230\u6839\u7684\u8def\u5f84\u4e0a\u7684\u8f7b\u8fb9\u6570\u91cf\u4e3a$O(\\\\log n)$\u6761\u3002\u5982\u679c\u6211\u4eec\u6362\u7528\u5176\u5b83\u6807\u51c6\uff0c\u5982\u6309\u7167\u513f\u5b50\u8282\u70b9\u7684\u79e9 (\u5373\u8282\u70b9\u5230\u5176\u5b50\u6811\u5185\u7684\u53f6\u5b50\u8282\u70b9\u7684\u6700\u8fdc\u8ddd\u79bb) \u4e3a\u6807\u51c6\u9009\u53d6\u91cd\u513f\u5b50\uff0c\u79f0\u5176\u4e3a\u957f\u94fe\u5256\u5206\uff0c\u90a3\u4e48\u53ef\u4ee5\u5206\u6790\u51fa\u8f7b\u8fb9\u6570\u91cf\u662f$O(\\\\sqrt n)$\u7ea7\u522b1\u7684\u3002\u4f46\u8fd9\u5c31\u65e0\u6cd5\u4f53\u73b0\u51fa\u5b83\u7684\u4f18\u52bf\u3002<br/>\u4f46\u662f\u6211\u4eec\u8003\u8651\u53e6\u5916\u4e00\u4e2a\u4e8b\u60c5\uff1a\u957f\u94fe\u5256\u5206\u4e4b\u540e\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9$u$\uff0c\u5176\u5b50\u6811\u4e2d\u5176\u5b83\u8282\u70b9$v$\u5230$u$\u7684\u8ddd\u79bb\u4e0d\u8d85\u8fc7$u$\u6240\u5904\u957f\u94fe\u7684\u957f\u5ea6\u3002\u5047\u8bbe\u8fd9\u4e2a\u8ddd\u79bb\u8d85\u8fc7\u4e86\u94fe\u957f\uff0c\u90a3\u4e48\u8bf4\u660e\u6309\u7167\u8282\u70b9\u7684\u79e9\u6765\u5256\u5206\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u671d\u7740$v$\u7684\u65b9\u5411\u8d70\u3002\u9664\u975e\u6709\u591a\u4e2a\u6700\u8fdc\u70b9\u8ddd\u79bb\u4e00\u6837\uff0c\u5426\u5219\u8fd9\u4e2a\u6700\u8fdc\u70b9\u4f1a\u4e0e$u$\u5728\u540c\u4e00\u6761\u957f\u94fe\u4e0a\u3002\u6240\u4ee5\u5b83\u7684\u8ddd\u79bb\u4e0d\u4f1a\u8d85\u51fa\u94fe\u957f\u3002<br/>\u90a3\u8fd9\u6709\u4ec0\u4e48\u7528\uff1f\u8003\u8651\u53e6\u5916\u4e00\u4e2a\u4e8b\u60c5\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u8ddd\u79bb$d$\uff0c\u627e\u5230\u4e00\u4e2a\u6700\u5927\u7684$k$\u4f7f\u5f97$2^k \\\\leqslant d$\uff0c\u90a3\u4e48\u5fc5\u5b9a\u6709$d - 2^k \\\\lt 2^k$\u3002\u540c\u65f6\uff0c\u5047\u5982\u6211\u4eec\u4ece\u4e00\u4e2a\u70b9$u$\u5f80\u4e0a\u8d70\u4e86$2^k$\u6b65\u5230\u4e86$u^\\\\prime$\uff0c\u90a3\u4e48\u6839\u636e\u4e4b\u524d\u7684\u4e8b\u5b9e\uff0c$u^\\\\prime$\u6240\u5904\u7684\u957f\u94fe\u7684\u957f\u5ea6\u81f3\u5c11\u4e3a$2^k$\u3002\u4ee4\u94fe\u957f\u4e3a$x$\uff0c\u7531\u4e8e\u5269\u4e0b\u7684\u6b65\u6570\u5c0f\u4e8e$2^k$\uff0c\u6240\u4ee5\u6211\u4eec\u5982\u679c\u6709\u8fd9\u6761\u957f\u94fe\u4ee5\u53ca\u94fe\u9876\u5f80\u4e0a\u8d70$x$\u6b65\u7684\u6240\u6709\u9876\u70b9\u4fe1\u606f\uff0c\u90a3\u4e48\u5c31\u662f\u5b58\u50a8$2x$\u4e2a\u70b9\uff0c\u4fdd\u5b58\u5728\u4e00\u4e2a\u6570\u7ec4\u5185\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u67e5\u627e\u7956\u5148\u4e86\u3002\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\\\Theta(1)$\u3002\u53e6\u5916\uff0c\u7531\u4e8e\u7531\u4e8e\u6240\u6709\u957f\u94fe\u7684\u957f\u5ea6\u4e4b\u548c\u4e3a$n$\uff0c\u6240\u4ee5\u6700\u591a\u8bb0\u5f55$2n$\u4e2a\u4fe1\u606f\uff0c\u5373\u5b83\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u662f$\\\\Theta(n)$\u7684\u3002<br/>\u56e0\u6b64\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u9700\u8981\u8ba1\u7b97\u500d\u589e\u8868\u548c\u957f\u94fe\uff0c\u8fd9\u4e00\u6b65\u53ef\u4ee5\u5728$O(n \\\\log n)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u3002\u7136\u540e\u67e5\u8be2\u7684\u5b9e\u73b0\u5982\u4e0b\u9762\u7684C++\u4ee3\u7801\u6240\u793a\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25/**<br/> * @param u (int) \u5f53\u524d\u8282\u70b9<br/> * @param d (int) \u8ddd\u79bb<br/> * @return (int) \u8fd4\u56de\u4ece\u5f53\u524d\u8282\u70b9\u5f80\u4e0a\u8d70d\u6b65\u7684\u7956\u5148<br/> */<br/>int find_ancestor(int u, int d) {<br/>    assert(0 <= d && d <= depth[u]);  // \u5fc5\u987b\u4fdd\u8bc1\u7956\u5148\u5b58\u5728<br/><br/>    if (d == 0)  // d = 0\u7279\u5224<br/>        return u;<br/><br/>    int h = highbit[d];  // highbit\u7528\u4e8e\u8bb0\u5f55\u6570\u5b571..n\u7684\u6700\u9ad8\u4f4d\uff0c\u63d0\u524d\u9884\u5904\u7406<br/>    u = f[h][u];  // f\u662f\u500d\u589e\u8868\uff0c\u4e0a\u8df32^k\u6b65<br/>    d -= 1 << h;<br/><br/>    assert(d < (1 << h));  // \u6ee1\u8db3\u4e8b\u5b9e1<br/><br/>    int t = top[u];  // top\u8bb0\u5f55\u6bcf\u4e2a\u8282\u70b9\u6240\u5904\u7684\u94fe\u7684\u94fe\u9876<br/>    int pos = len[t] - 1 - (depth[u] - depth[t]) + d;  // len\u8bb0\u5f55\u94fe\u957f<br/><br/>    // chain\u662f\u5b58\u50a8\u4e862 * len[t]\u4e2a\u8282\u70b9\u7684vector<br/>    assert(0 <= pos && pos < chain[t].size());  // \u6ee1\u8db3\u4e8b\u5b9e2<br/><br/>    return chain[t][pos];  // \u8fd4\u56de\u7b54\u6848<br/>}<br/><br/><br/>\u500d\u589e\u8868\u548c\u957f\u5ea6\u4e3a$2x$\u7684\u6570\u7ec4\u8fd8\u53ef\u4ee5\u5b58\u50a8\u5176\u5b83\u4fe1\u606f\u3002\u5c31\u4ee5\u957f\u5ea6\u4e3a$2x$\u7684\u6570\u7ec4\u800c\u8a00\uff0c\u53ef\u4ee5\u8bb0\u5f55\u524d\u7f00\u548c\u6216\u8005\u5229\u7528ST\u8868\u8bb0\u5f55\u6700\u5927/\u6700\u5c0f\u503c\uff0c\u914d\u5408\u5feb\u901f\u7684LCA\u7b97\u6cd5\u4ece\u800c\u80fd\u591f$\\\\Theta(1)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u56de\u7b54\u4e24\u70b9\u95f4\u7684\u8def\u5f84\u4e0a\u7684\u7279\u5b9a\u4fe1\u606f\u7684\u67e5\u8be2\u3002<br/>\u6b64\u5916\uff0c\u5982\u679c\u4e0d\u8003\u8651\u500d\u589e\u8868\uff0c\u6211\u4eec\u4f9d\u7136\u53ef\u4ee5\u5229\u7528\u4e8b\u5b9e1\u4ece\u800c\u8fbe\u5230\u5728$O(\\\\log n)$\u6b65\u8df3\u5230\u6839\u8282\u70b9\uff0c\u5373\u6bcf\u6b21\u8df3\u5230\u5f53\u524d\u94fe\u80fd\u8bbf\u95ee\u5230\u7684\u6700\u540e\u4e00\u4e2a\u8282\u70b9\u7684\u7236\u4eb2\u5904\u3002\u7531\u4e8e\u6bcf\u6b21\u4e0a\u8df3\u5230\u7684\u65b0\u7684\u94fe\u7684\u957f\u5ea6\u5fc5\u5b9a\u7ffb\u500d\uff0c\u6240\u4ee5\u80fd\u505a\u5230\u8fd9\u4e2a\u590d\u6742\u5ea6\u3002\u56e0\u6b64\uff0c\u957f\u94fe\u5256\u5206\u4e5f\u53ef\u4ee5\u4ee5\u540c\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5b9e\u73b0\u6811\u94fe\u5256\u5206\u7684\u529f\u80fd\u3002<br/><br/><br/><br/><br/>\u8003\u8651\u4e00\u4e2a\u6700\u574f\u60c5\u51b5\uff0c\u5c06\u957f\u5ea6\u4e3a$1..n$\u7684\u94fe\u6446\u6210\u4e00\u6392\uff0c\u5c06\u6bcf\u6761\u94fe\u7684\u7aef\u70b9\u4f9d\u6b21\u76f8\u8fde\uff0c\u90a3\u4e48\u5c06\u4f1a\u6709\u4e00\u4e2a\u8282\u70b9\u5230\u6839\u7684\u8def\u5f84\u4e0a\u6709$n - 1$\u6761\u8f7b\u8fb9\uff0c\u800c\u6b64\u65f6\u6811\u4e0a\u6709$n(n + 1) / 2$\u4e2a\u8282\u70b9\u3002\u6545\u4e0a\u754c\u81f3\u5c11\u662f$\\\\Omega(\\\\sqrt n)$\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-2-6/long-chain.html"
},
"\u9644\u4e2d 2018 \u590f\u4ee4\u8425\u8bfe\u4ef6": {
"tags": "OI",
"text": "\u9644\u4e2d 2018 \u590f\u4ee4\u8425\u8bfe\u4ef6<br/>\u6700\u8fd1\u5230\u9644\u4e2d\u8bb2\u4e86 6 \u5929\u8bfe\uff0c\u8fd9\u91cc\u6302\u4e0a\u672c\u4eba\u62d9\u52a3\u7684\u8bfe\u4ef6......<br/><br/>Day 1 - \u6808\u3001\u961f\u5217<br/>Day 2 - \u94fe\u8868\u3001DLX\u3001\u5e76\u67e5\u96c6<br/>Day 3 - \u5206\u5757\u3001\u7ebf\u6bb5\u6811\u3001\u6811\u72b6\u6570\u7ec4<br/>Day 5 - \u8d2a\u5fc3\u95ee\u9898\u9009\u8bb2<br/>Day 7 - \u7b80\u5355\u56fe\u8bba<br/>Day 8 - \u6811\u4e0a\u7b97\u6cd5\u9009\u8bb2<br/>\u539f\u59cb\u6587\u6863<br/><br/>\u590f\u4ee4\u8425\u662f\u9488\u5bf9\u521d\u4e2d\u751f\u51b2\u63d0\u9ad8\u7ec4\u7684\uff0c\u6240\u4ee5\u8bfe\u4ef6\u5185\u5bb9\u504f\u6613\uff0c\u5404\u8def\u5927\u795e\u8f7b\u55b7 QAQ<br/>\u53e6\u5916\u987a\u5e26\u4e00\u63d0\uff0c\u8fd9\u6b21\u590f\u4ee4\u8425\u4e00\u5171 12 \u5929\uff0c\u5269\u4e0b\u516d\u5929\u90fd\u662f ruanxingzhi \u962e\u5927\u7237\u8bb2\u7684\u3002",
"url": "blog/2018-7-23/sdfzsc-2018.html"
},
"\u9759\u6001\u6811\u4e0a\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898": {
"tags": "\u6700\u8fd1\u516c\u5171\u7956\u5148 \u533a\u95f4\u6700\u503c\u95ee\u9898 \u6570\u636e\u7ed3\u6784",
"text": "\u9759\u6001\u6811\u4e0a\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898<br/>\u57fa\u672c\u6982\u5ff5<br/>\u6811 $T = (V,\\\\;f,\\\\;r)$ \u662f\u4e00\u5f20\u65e0\u5411\u56fe\uff0c\u5176\u4e2d $V$ \u662f\u70b9\u7684\u96c6\u5408\uff0c$f(u)$ \u8868\u793a\u70b9 $u$ \u7684\u7236\u4eb2\uff0c$r$ \u662f\u6811\u7684\u6839\uff0c\u5e76\u4e14 $f(r) = \\\\varnothing$\uff0c\u5373\u6839\u4e0d\u5b58\u5728\u7236\u4eb2\u3002\u4e0b\u6587\u4e2d\u901a\u5e38\u7528\u6b63\u6574\u6570\u8868\u793a\u70b9\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee4 $f(r) = 0$\uff0c\u70b9 $0$ \u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u70b9\u3002\u6811\u4e2d\u9664 $r$ \u5916\uff0c\u6bcf\u4e2a\u70b9\u90fd\u4e0e\u5b83\u7684\u7236\u4eb2\u8fde\u8fb9\u6784\u6210\u8fb9\u96c6\u3002\u8bb0\u5f55 $\\\\mathrm{ch}(u)$ \u8868\u793a $u$ \u7684\u513f\u5b50\u7684\u96c6\u5408\uff0c\u5b9a\u4e49\u4e3a $\\\\mathrm{ch}(u) = \\\\{v:\\\\;f(v) = u,\\\\;v \\\\in V\\\\}$<br/>\u3002\u5b9a\u4e49 $d(u)$ \u8868\u793a\u70b9 $u$ \u5230\u6839 $r$ \u7684\u7b80\u5355\u8def\u5f84\u4e0a\u8fb9\u7684\u6570\u91cf\uff0c\u5373\u5230\u6839\u7684\u8ddd\u79bb\uff0c\u4e5f\u79f0\u6df1\u5ea6\uff0c\u56e0\u6b64\u6709 $d(r) = 0$\u3002\u4ee4 $\\\\max\\\\{d(u):\\\\;u \\\\in V\\\\}$ \u8868\u793a\u6811\u7684\u9ad8\u5ea6\uff0c\u901a\u5e38\u8bb0\u4e3a\u5b57\u6bcd $h$\u3002<br/>\u4e00\u4e2a\u70b9 $u$ \u5230\u6839 $r$ \u7684\u7b80\u5355\u8def\u5f84\u4e0a\u7684\u6240\u6709\u70b9\u90fd\u79f0\u4e3a $u$ \u7684\u7956\u5148\uff0c\u6784\u6210\u7684\u96c6\u5408\u8bb0\u505a $C(u)$\uff08\u4e3a\u4e86\u65b9\u4fbf\uff0c\u81ea\u5df1\u53ef\u4ee5\u662f\u81ea\u5df1\u7684\u7956\u5148\uff09\u3002\u800c\u4e24\u4e2a\u70b9 $u$ \u548c $v$ \u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\uff08Least Common Ancestors\uff0cLCA\uff09\u4e3a $C(u) \\\\cap C(v)$ \u4e2d\u6df1\u5ea6\u6700\u5927\u7684\u70b9\uff0c\u8bb0\u4e3a $\\\\mathrm{lca}(u,\\\\;v)$\u3002\u6240\u6709\u7956\u5148\u4e2d\u6709 $u$ \u7684\u70b9\u7684\u5bfc\u51fa\u5b50\u56fe\u540c\u6837\u4e5f\u6784\u6210\u4e00\u68f5\u6811\uff0c\u8bb0\u4e3a $T_u$\uff0c\u79f0\u4f5c\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u3002<br/>\u63a5\u4e0b\u6765\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u901a\u5e38\u8bb0 $n = |V|$\uff0c\u8868\u793a\u6811\u4e2d\u7684\u70b9\u6570\u3002\u6b64\u5916\uff0c\u7531\u4e8e\u4e0b\u9762\u4ecb\u7ecd\u7684\u7b97\u6cd5\u90fd\u8981\u5904\u7406\u591a\u7ec4\u8be2\u95ee\uff08\u901a\u5e38\u8bb0\u4f5c $q$ \u7ec4\uff09\uff0c\u6240\u4ee5\u5728\u8ba8\u8bba\u5230\u67d0\u4e2a\u7b97\u6cd5\u65f6\u7a7a\u590d\u6742\u5ea6\u7684\u65f6\u5019\uff0c\u7528 $O(f(n))$-$O(g(n))$ \u8868\u793a\u8be5\u7b97\u6cd5\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(f(n))$\uff0c\u4ee5\u53ca\u5355\u6b21\u8be2\u95ee\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(g(n))$\u3002<br/>\u89e3\u51b3\u65b9\u6848<br/>\u6734\u7d20\u7b97\u6cd5<br/>\u65e2\u7136\u662f\u8981\u6c42\u516c\u5171\u7956\u5148\uff0c\u90a3\u4e48\u6211\u4eec\u4e00\u4e2a\u76f4\u63a5\u7684\u60f3\u6cd5\u5c31\u662f\u73b0\u5c06\u4e00\u4e2a\u70b9 $u$ \u7684\u7956\u5148\u5168\u90e8\u6807\u8bb0\u51fa\u6765\uff0c\u7136\u540e $v$ \u5728\u4ece\u6700\u6df1\u7684\u7956\u5148\u5f00\u59cb\uff08\u4e5f\u5c31\u662f $v$ \u81ea\u5df1\uff09\uff0c\u4e00\u4e2a\u4e00\u4e2a\u68c0\u67e5\u662f\u4e0d\u662f\u5df2\u7ecf\u88ab\u6807\u8bb0\u8fc7\u3002\u5982\u679c\u627e\u5230\u4e86\u4e00\u4e2a\u88ab\u6807\u8bb0\u7684\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u5c31\u662f\u6700\u8fd1\u516c\u5171\u7956\u5148\u3002<br/><br/>\uff08Fig. 1. \u84dd\u8272\u4ee3\u8868 $u$ \u7684\u7956\u5148\uff0c\u6a59\u8272\u4ee3\u8868 $v$ \u68c0\u67e5\u8fc7\u7684\u7956\u5148\uff0c\u7ea2\u8272\u662f\u6700\u8fd1\u516c\u5171\u7956\u5148\uff09<br/>\u4e00\u822c\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10function LCA(u, v):<br/>    // mark: \u5927\u5c0f\u4e3a n \u7684\u6574\u6570\u6570\u7ec4<br/>    // cur: \u4e00\u4e2a\u6574\u578b\uff0c\u8bb0\u5f55\u8be5\u51fd\u6570\u88ab\u8c03\u7528\u4e86\u591a\u5c11\u6b21<br/>    cur += 1<br/>    while u != 0:<br/>        mark[u] = cur<br/>        u = f(u)<br/>    while mark[v] != cur:<br/>        v = f(v)<br/>    return v<br/><br/><br/>\u8fd9\u6837\u7684\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n)$-$O(h)$\u3002\u4e5f\u5c31\u662f\u8bf4\u6700\u574f\u60c5\u51b5\u4e0b\u53ef\u80fd\u9700\u8981 $O(n)$ \u7684\u4ee3\u4ef7\u6765\u627e\u5230\u6700\u8fd1\u516c\u5171\u7956\u5148\u3002\u7531\u4e8e\u968f\u673a\u4e00\u68f5\u6811\u7684\u6811\u9ad8\u671f\u671b\u4e3a $O(\\\\log n)$\uff0c\u6240\u4ee5\u8be5\u7b97\u6cd5\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\u6bd4\u8f83\u9ad8\u6548\u3002<br/>\u53e6\u5916\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5728\u4e00\u822c\u56fe\u6700\u5927\u5339\u914d\u7684\u5e26\u82b1\u6811\u7b97\u6cd5\u4e2d\uff0c\u7531\u4e8e\u6709 \u201c\u7f29\u82b1\u201d \u8fd9\u79cd\u64cd\u4f5c\uff0c\u5e76\u4e14\u672c\u8eab\u5bf9\u6c42\u6700\u8fd1\u516c\u5171\u7956\u5148\u7684\u590d\u6742\u5ea6\u8981\u6c42\u4e0d\u9ad8\uff0c\u6240\u4ee5\u5f88\u591a\u5e26\u82b1\u6811\u7b97\u6cd5\u7684\u5b9e\u73b0\u4e2d\u4f7f\u7528\u6734\u7d20\u7b97\u6cd5\u3002<br/>\u500d\u589e\u7b97\u6cd5<br/>\u901a\u8fc7\u8fdb\u4e00\u6b65\u89c2\u5bdf\uff0c\u53ef\u4ee5\u53d1\u73b0\u5230\u8fbe\u67d0\u4e2a\u6df1\u5ea6\u4e4b\u540e\uff0c\u7ee7\u7eed\u5f80\u4e0a\u8d70\u90fd\u4f1a\u662f\u516c\u5171\u7956\u5148\uff0c\u800c\u6700\u8fd1\u516c\u5171\u7956\u5148\u5c31\u662f\u5b83\u4eec\u4e2d\u6df1\u5ea6\u6700\u6df1\u7684\u3002\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5206\u8fd9\u4e00\u6280\u5de7\u3002\u4e8c\u5206\u4e00\u4e2a\u5411\u4e0a\u8d70\u7684\u8ddd\u79bb $x$\uff0c\u627e\u5230 $v$ \u5411\u4e0a\u8d70 $x$ \u6b65\u7684\u70b9 $p$\uff0c\u5e76\u68c0\u67e5 $p$ \u662f\u5426\u662f $u$ \u7684\u7956\u5148\u3002\u5982\u679c $p$ \u662f $u$ \u7684\u7956\u5148\uff0c\u5219 $d(\\\\mathrm{lca}(u,\\\\;v)) \\\\geqslant d(p)$\uff0c\u6240\u4ee5\u9700\u8981\u51cf\u5c0f $x$\uff0c\u53cd\u4e4b\u5219\u9700\u8981\u589e\u5927 $x$\u3002<br/>\u73b0\u5728\u5c31\u9700\u8981\u89e3\u51b3\u4e24\u4e2a\u95ee\u9898\uff1a<br/><br/>\u627e\u5230 $v$ \u5411\u4e0a\u8d70 $x$ \u6b65\u7684\u70b9 $p$\u3002<br/>\u786e\u8ba4 $p$ \u662f\u5426\u662f $u$ \u7684\u7956\u5148\u3002<br/><br/>\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u6709\u4e00\u4e2a $O(n\\\\log h)$-$\\\\Theta(1)$ \u7684\u957f\u94fe\u5256\u5206\u7b97\u6cd5\uff0c\u4f46\u662f\u8fd9\u91cc\u6682\u4e0d\u8ba8\u8bba\u8fd9\u4e2a\u7b97\u6cd5\u3002\u8003\u8651\u5230\u4e8c\u5206\u5b9e\u9645\u4e0a\u53ef\u4ee5\u8f6c\u53d8\u4e3a\u500d\u589e\u7684\u5f62\u5f0f\uff0c\u5373\u53ef\u4ee5\u5c06\u76ee\u6807 $x$ \u8f6c\u4e3a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u5e76\u4e14\u4ece\u9ad8\u4f4d\u5411\u4f4e\u4f4d\u8bd5\u4f4d\uff1a\u5982\u679c\u67d0\u4e00\u4f4d\u8d4b\u4e3a $1$ \u5bfc\u81f4\u627e\u5230\u7684 $p$ \u662f $u$ \u7684\u7956\u5148\uff0c\u5219\u5c06\u5176\u8d4b\u4e3a $0$\uff0c\u5426\u5219\u8d4b\u4e3a $1$\u3002\u8fd9\u6837\u5c31\u4fdd\u8bc1\u8bd5\u4f4d\u8fc7\u7a0b\u4e2d\u7684 $p$ \u59cb\u7ec8\u4e0d\u662f $u$ \u7684\u7956\u5148\uff0c\u6700\u540e $f(p)$ \u5c31\u6b63\u597d\u662f $\\\\mathrm{lca}(u,\\\\;v)$\u3002<br/>\u8f6c\u4e3a\u500d\u589e\u7684\u597d\u5904\u5728\u4e8e\u73b0\u5728\u53ea\u7528\u5173\u5fc3\u6bcf\u4e2a\u70b9 $v$ \u5411\u4e0a\u8d70 $2^k$ \u6b65\u7684\u70b9 $p$ \u4e86\uff0c\u800c\u8fd9\u6837\u7684\u70b9\u5bf9\u4e8e\u6bcf\u4e2a $v$ \u800c\u8a00\u53ea\u6709 $O(\\\\log h)$ \u4e2a\uff0c\u56e0\u6b64\u603b\u5171\u53ea\u7528\u8bb0\u5f55 $O(n \\\\log h)$ \u8fd9\u4e48\u591a\u7684\u4fe1\u606f\u3002\u73b0\u5728\u4ee4 $g(u,\\\\;k)$ \u8868\u793a\u70b9 $u$ \u5411\u4e0a\u8d70 $2^k$ \u6b65\u7684\u70b9 $p$\uff0c\u7136\u540e\u4e4b\u524d\u7684\u500d\u589e\u7684\u8fc7\u7a0b\u5c31\u662f\u8fd9\u6837\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6function LCA(u, v):<br/>    for k = int(log(h)) to 0:<br/>        p = g(v, k)<br/>        if p is not an ancestor of u:<br/>            v = p<br/>    return f(v)<br/><br/><br/>\u73b0\u5728\u9700\u8981\u6c42\u51fa $g(u,\\\\;k)$ \u4e2d\u7684\u503c\u3002\u9996\u5148\u5173\u6ce8\u5230 $g(u,\\\\;0) = f(u)$\uff0c\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u3002\u63a5\u4e0b\u6765\uff0c\u5bf9\u4e8e\u5411\u4e0a\u8d70 $2^k$ \u6b65\uff0c\u76f8\u5f53\u4e8e\u662f\u8d70\u4e24\u6b21 $2^{k-1}$ \u6b65\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5230\uff1a<br/>$$ g(u,\\\\;k) = g(g(u,\\\\;k - 1),\\\\;k - 1)  \\\\;\\\\;\\\\;\\\\; \\\\forall k \\\\gt 0 $$<br/>\u6240\u4ee5 $g$ \u53ef\u4ee5\u5728 $O(n \\\\log h)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa\u6765\u3002<br/>\u63a5\u4e0b\u6765\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 DFS \u5e8f\u6765\u89e3\u51b3\u8fd9\u4e2a\u5224\u5b9a\u95ee\u9898\u3002\u4e5f\u5c31\u662f\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u5728\u4ee5 $r$ \u4e3a\u8d77\u70b9\u7684 DFS \u8fc7\u7a0b\u4e2d\u5165\u6808\u548c\u51fa\u6808\u7684\u65f6\u95f4\u3002\u7531\u4e8e DFS \u7684\u6027\u8d28\uff0c$T_u$ \u4e2d\u7684\u6240\u6709\u70b9\u7684\u5165\u6808\u65f6\u95f4\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u533a\u95f4\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u5728 $\\\\Theta(n)$-$\\\\Theta(1)$ \u7684\u590d\u6742\u5ea6\u5b8c\u6210\u5224\u5b9a\u4efb\u52a1\u3002<br/>\u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528 DFS \u5e8f\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c $u$ \u548c $v$ \u6240\u5904\u7684\u6df1\u5ea6\u76f8\u540c\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06 $u$ \u548c $v$ \u540c\u65f6\u5411\u4e0a\u9762\u8d70\u540c\u6837\u7684\u6b65\u6570 $x$\u3002\u5982\u679c\u8d70\u5230\u4e86\u540c\u4e00\u4e2a\u70b9\u4e0a\uff0c\u5219\u8bf4\u660e $x$ \u9700\u8981\u51cf\u5c0f\uff0c\u5426\u5219\u8bf4\u660e\u9700\u8981\u589e\u5927\u3002\u90a3\u4e48\u5728\u6b64\u4e4b\u524d\uff0c\u5c31\u9700\u8981\u5c06 $u$ \u548c $v$ \u8c03\u5230\u540c\u4e00\u4e2a\u6df1\u5ea6\u3002<br/>\u8fd9\u91cc\u5c06\u518d\u6b21\u5229\u7528\u4e8c\u8fdb\u5236\u548c\u6211\u4eec\u7684 $g$ \u51fd\u6570\u3002\u5982\u679c\u73b0\u5728 $u$ \u6240\u5904\u7684\u6df1\u5ea6\u6bd4 $v$ \u6df1\uff0c\u5219 $u$ \u9700\u8981\u5411\u4e0a\u8d70 $x = d(u) - d(v)$ \u6b65\u3002\u4f8b\u5982\uff0c\u5982\u679c $x = 1011_{(2)}$\uff0c\u5c31\u662f\u76f8\u5f53\u4e8e\u5206\u522b\u8d70 $2^0$\u3001$2^1$ \u548c $2^3$ \u6b65\u3002\u800c\u8fd9\u90fd\u53ef\u4ee5\u5229\u7528 $g$ \u51fd\u6570\u5b9e\u73b0\u3002\u6700\u540e\u7684\u5b9e\u73b0\u4e00\u822c\u662f\u4e0b\u9762\u8fd9\u6837\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25// \u8ba1\u7b97 g \u51fd\u6570<br/>for u = 1 to n:<br/>    g(u, 0) = f(u)<br/>for k = 1 to int(log(h)):<br/>    for u = 1 to n:<br/>        g(u, k) = g(g(u, k - 1), k - 1)<br/><br/>function LCA(u, v):<br/>    if d(u) < d(v):<br/>        u, v = v, u  // \u4ea4\u6362 u \u548c v<br/><br/>    x = d(u) - d(v)<br/>    for k = 0 to int(log(x)):<br/>        if (x >> k) & 1:<br/>            u = g(u, k)<br/><br/>    if u == v:  // \u9700\u8981\u7279\u5224 v \u662f u \u7684\u7956\u5148\u7684\u60c5\u51b5<br/>        return u<br/><br/>    for k = int(log(n)) to 0:<br/>        if g(u, k) != g(v, k):<br/>            u = g(u, k)<br/>            v = g(v, k)<br/><br/>    return f(u)<br/><br/><br/>\u6700\u540e\uff0c\u500d\u589e\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u4e3a $O(n\\\\log h)$-$O(\\\\log h)$\u3002\u76f8\u5bf9\u4e8e\u6734\u7d20\u7b97\u6cd5\u800c\u8a00\uff0c\u867d\u7136\u82b1\u8d39\u4e86\u66f4\u591a\u7684\u7a7a\u95f4\uff0c\u4f46\u662f\u83b7\u5f97\u4e86\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u5de8\u5927\u63d0\u5347\uff0c\u662f\u4e00\u4e2a\u975e\u5e38\u4e0d\u9519\u7684\u6539\u8fdb\u3002\u53e6\u5916\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u5b9e\u73b0\u826f\u597d\uff0c\u500d\u589e\u6cd5\u5728\u968f\u673a\u6811\u7684\u60c5\u51b5\u4e0b\u671f\u671b\u590d\u6742\u5ea6\u4e3a $O(\\\\log \\\\log n)$\u3002<br/>\u500d\u589e\u7684\u601d\u60f3\u53ef\u4ee5\u6269\u5c55\u5230\u66f4\u591a\u7684\u95ee\u9898\u4e0a\uff0c\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4eff\u7167 $g$ \u6570\u7ec4\u8bb0\u5f55\u4e00\u4e9b\u5176\u5b83\u7684\u4fe1\u606f\uff0c\u5982\u6700\u5927 / \u6700\u5c0f\u503c\uff0c\u5c31\u53ef\u4ee5\u7528\u6765\u6c42\u6811\u4e0a\u4e24\u70b9\u95f4\u6700\u77ed\u8def\u5f84\u7684\u8fb9\u6743\u6700\u5927 / \u6700\u5c0f\u503c\u3002\u5728\u540e\u7f00\u6570\u7ec4\u6784\u5efa\u7b97\u6cd5\u4e2d\uff0c\u4e5f\u6709\u4e00\u4e2a\u8fd0\u7528\u4e86\u500d\u589e\u601d\u60f3\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n\\\\log n)$ \u7684\u7b80\u5355\u7b97\u6cd5\u3002<br/>\u94fe\u5256\u5206<br/>\u770b\u5230\u8fd9\u91cc\u7684\u65f6\u5019\uff1a<br/>1<br/>2if u == v:  // \u9700\u8981\u7279\u5224 v \u662f u \u7684\u7956\u5148\u7684\u60c5\u51b5<br/>    return u<br/><br/><br/>\u4e0d\u77e5\u9053\u662f\u5426\u4f1a\u60f3\u5230\uff0c\u65e2\u7136\u6211\u4eec\u53ef\u4ee5 $\\\\Theta(1)$ \u5224\u5b9a $v$ \u662f\u5426\u662f $u$ \u7684\u7956\u5148\uff0c\u90a3\u4e3a\u4ec0\u4e48\u8fd8\u8981\u6d6a\u8d39\u65f6\u95f4\u6765\u4e0a\u8df3\u5462\uff1f\u56e0\u4e3a\u5373\u4f7f\u5229\u7528\u8fd9\u4e00\u70b9\u53ef\u4ee5\u51cf\u5c11\u8ba1\u7b97\u91cf\uff0c\u5374\u6ca1\u6709\u6539\u8fdb\u590d\u6742\u5ea6\u3002\u4f46\u662f\u5e76\u4e0d\u610f\u5473\u7740\u8fd9\u79cd\u60f3\u6cd5\u6ca1\u6709\u4ec0\u4e48\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u66f4\u6df1\u523b\u7684\u9053\u7406\uff1a\u5982\u679c\u6811\u662f\u94fe\u72b6\u7684\uff0c\u90a3\u4e48\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\u5c31\u5341\u5206\u7684 na\u00efve \u4e86\uff0c\u53ea\u9700\u8981\u6bd4\u8f83 $d(u)$ \u548c $d(v)$ \u7684\u5927\u5c0f\u5373\u53ef\u3002<br/>\u73b0\u5728\u6211\u4eec\u8981\u5bf9\u4ed8\u7684\u6811\u5e76\u4e0d\u80fd\u5982\u6211\u4eec\u6240\u613f\u7684\u662f\u94fe\u72b6\uff0c\u4f46\u662f\u53ef\u4e0d\u53ef\u4ee5\u628a $u$ \u548c $v$ \u4e0a\u8df3\uff0c\u4ece\u800c\u8c03\u5230 $u$ \u662f $v$ \u7684\u7956\u5148\u5462\uff1f\u4e0d\u59a8\u5c1d\u8bd5\u5c06\u6811\u5212\u5206\u6210\u8bb8\u591a\u957f\u94fe\uff0c\u66f4\u5f62\u5f0f\u5316\u7684\u8bf4\uff0c\u5c31\u662f\u7528\u4e24\u4e24\u4e0d\u76f8\u4ea4\u7684\u7b80\u5355\u8def\u5f84\u8986\u76d6\u6574\u68f5\u6811\uff0c\u4ece\u800c\u4f7f\u5f97\u6bcf\u4e2a\u70b9\u90fd\u5728\u552f\u4e00\u7684\u4e00\u6761\u8def\u5f84\u4e0a\uff1a<br/><br/>\uff08Fig. 2. \u4e0a\u56fe\u8868\u793a\u4e86\u4e00\u79cd\u5212\u5206\u65b9\u6848\uff0c\u6ce8\u610f\u84dd\u8272\u7684\u8def\u5f84\u53ea\u6709\u4e00\u4e2a\u70b9\uff09<br/>\u5f53\u7136\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u7b80\u5355\u8def\u5f84\u4e0a\u7684\u70b9\u7684\u6df1\u5ea6\u662f\u5355\u8c03\u7684\uff08\u5373\u4e0d\u4f1a\u51fa\u73b0\u5148\u4e0a\u884c\u540e\u4e0b\u884c\u7684\u60c5\u51b5\uff09\u3002\u8fd9\u4e9b\u7b80\u5355\u8def\u5f84\u4e5f\u79f0\u4e3a\u94fe\u3002\u8fd9\u6837\u4e00\u6765\u5728\u540c\u4e00\u6761\u94fe\u4e0a\u7684\u7684\u60c5\u51b5\u5c31\u5341\u5206\u7b80\u5355\u4e86\u3002\u4e3a\u4e86\u65b9\u4fbf\u79f0\u547c\uff0c\u94fe\u4e2d\u6df1\u5ea6\u6700\u5c0f\u7684\u70b9\u53eb\u505a\u94fe\u9876\uff0c\u5982\u679c\u4e00\u6761\u6811\u8fb9\u4e0d\u5b58\u5728\u4e8e\u4efb\u4f55\u4e00\u6761\u94fe\u4e0a\uff0c\u5219\u79f0\u4e3a\u8f7b\u8fb9\uff0c\u5426\u5219\u79f0\u4e3a\u91cd\u8fb9\u3002\u5f53 $u$ \u548c $v$ \u4e0d\u5728\u540c\u4e00\u6761\u94fe\u4e0a\u65f6\uff0c\u53ef\u4ee5\u8ba9 $u$ \u6216\u8005 $v$ \u6cbf\u7740\u94fe\u9876\u7684\u8f7b\u8fb9\u8d70\u4e0a\u53bb\uff0c\u5c31\u4f1a\u5230\u8fbe\u53e6\u5916\u4e00\u6761\u94fe\u3002\u4f8b\u5982\uff0c\u5982\u679c $u$ \u5728\u4e0a\u56fe\u4e2d\u7684\u7eff\u8272\u70b9\u4e2d\uff0c\u800c $v$ \u5728\u6a59\u8272\u70b9\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9 $u$ \u6cbf\u7740\u7eff\u8272\u548c\u6a59\u8272\u4e4b\u95f4\u7684\u8f7b\u8fb9\u8d70\u4e0a\u53bb\u3002\u5230\u8fbe\u6a59\u8272\u94fe\uff0c\u4ece\u800c\u53d8\u6210\u4e86\u4e00\u6761\u94fe\u4e0a\u7684\u60c5\u51b5\u3002\u5177\u4f53\u7684\u5b9e\u73b0\u5c31\u5927\u6982\u5c31\u662f\u8fd9\u6837\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14function LCA(u, v):<br/>    // top: \u4e00\u4e2a\u6574\u578b\u6570\u7ec4\uff0ctop[u] \u8868\u793a u \u6240\u5904\u7684\u94fe\u7684\u94fe\u9876<br/>    while top[u] != top[v]:<br/>        // \u6311\u9009\u94fe\u9876\u6df1\u5ea6\u8f83\u6df1\u7684\u4e00\u4e2a\u70b9\u5411\u4e0a\u8df3<br/>        if d(top[u]) > d(top[v]):<br/>            u = f(top[u])<br/>        else:<br/>            v = f(top[v])<br/><br/>    // \u6b64\u65f6 u \u548c v \u5728\u540c\u4e00\u6761\u94fe\u4e0a<br/>    if d(u) < d(v):<br/>        return u<br/>    else:<br/>        return v<br/><br/><br/>\u73b0\u5728\u7684\u76ee\u6807\u5c31\u662f\u627e\u51fa\u4e00\u79cd\u94fe\u5256\u5206\u7684\u65b9\u6848\uff0c\u4f7f\u5f97\u8fd9\u79cd \u201c\u8d70\u8f7b\u8fb9\u201d \u7684\u60c5\u51b5\u5c3d\u91cf\u5c11\u3002\u7531\u4e8e\u6211\u4eec\u94fe\u5256\u5206\u7684\u65b9\u6cd5\u6240\u51b3\u5b9a\u7684\uff0c\u6bcf\u4e2a\u70b9\u6cbf\u7740\u94fe\u5411\u4e0b\u8d70\u6700\u591a\u80fd\u8d70\u5230\u4e00\u4e2a\u513f\u5b50\u5904\uff0c\u59d1\u4e14\u79f0\u8fd9\u4e2a\u513f\u5b50\u4e3a\u91cd\u513f\u5b50\u3002\u5f53\u6211\u4eec\u4e3a\u6bcf\u4e2a\u70b9\u9009\u53d6\u597d\u91cd\u513f\u5b50\u540e\uff0c\u94fe\u5256\u5206\u7684\u65b9\u6848\u4e5f\u5c31\u51fa\u6765\u4e86\u3002\u5f53\u7136\uff0c\u968f\u4fbf\u9009\u53d6\u91cd\u513f\u5b50\u662f\u4e0d\u53ef\u53d6\u7684\uff0c\u5c31\u50cf\u5728\u4e0b\u9762\u8fd9\u68f5\u6811\u4e2d\uff1a<br/><br/>\uff08Fig. 3. \u4e00\u6761\u957f\u94fe\u7684\u6bcf\u4e2a\u70b9\u90fd\u591a\u6302\u4e86\u4e00\u4e2a\u70b9\uff09<br/>\u5982\u679c\u968f\u673a\u9009\u53d6\uff0c\u90a3\u4e48\u957f\u94fe\u4e0a\u7684\u6bcf\u6761\u8fb9\u5c31\u6709 $1/2$ \u7684\u6982\u7387\u6210\u4e3a\u8f7b\u8fb9\uff0c\u5982\u679c\u4ece\u5e95\u7aef\u8d70\u5230\u6839\u8282\u70b9\uff0c\u671f\u671b\u8981\u8d70 $h / 2$ \u6761\u8f7b\u8fb9\u3002<br/>\u6240\u4ee5\u9700\u8981\u6362\u4e00\u79cd\u601d\u8def\uff0c\u6211\u4eec\u5e0c\u671b\u6811\u4e0a\u5212\u5206\u51fa\u7684\u94fe\u5c3d\u91cf\u5c11\uff0c\u4e00\u79cd\u601d\u8def\u5c31\u662f\u6bcf\u6b21\u6311\u51fa\u6700\u957f\u7684\u4e00\u6761\u94fe\u3002\u663e\u7136\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $u$\uff0c\u5b83\u7684\u91cd\u513f\u5b50 $v \\\\in \\\\mathrm{ch}(u)$ \u5e94\u5f53\u6ee1\u8db3 $T_v$ \u7684\u6811\u9ad8\u6700\u9ad8\u3002\u5982\u679c\u6309\u7167\u6b64\u6807\u51c6\u9009\u53d6\u91cd\u513f\u5b50\uff0c\u6700\u591a\u53c8\u4f1a\u8d70\u591a\u5c11\u6761\u8f7b\u8fb9\u5462\uff1f<br/><br/>\uff08Fig. 4. \u8fd9\u53ea\u662f\u4e00\u79cd\u53ef\u80fd\u7684\u60c5\u51b5\uff09<br/>\u4e0d\u59a8\u6765\u5206\u6790\u4e00\u4e0b\u5982\u679c\u5df2\u7ecf\u8d70\u8fc7\u4e86 $x$ \u6761\u8f7b\u8fb9\u540e\uff0c\u6811\u4e2d\u81f3\u5c11\u6709\u591a\u5c11\u4e2a\u70b9\u3002\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4ece\u6700\u5de6\u4e0b\u89d2\u7684\u84dd\u8272\u70b9 $u$ \u5f00\u59cb\u8d70\u8f7b\u8fb9\uff0c\u90a3\u4e48 $u$ \u6240\u7ecf\u8fc7\u7684\u8def\u5f84\u4e0a\u81f3\u5c11\u6709 $x + 1$ \u4e2a\u70b9\u3002\u5047\u8bbe\u73b0\u5728\u8d70\u5230\u4e86 $p$\uff0c\u90a3\u4e48 $T_p$ \u4e2d\u7684\u6700\u957f\u94fe\u81f3\u5c11\u4e3a $x + 1$\uff0c\u56e0\u4e3a $p$ \u6240\u5728\u7684\u957f\u94fe\u662f\u6700\u957f\u7684\uff0c\u6240\u4ee5 $p$ \u6240\u5904\u7684\u957f\u94fe\u7684\u957f\u5ea6\u4e5f\u81f3\u5c11\u4e3a $x + 1$\u3002\u7531\u6b64\u53ef\u4ee5\u5206\u6790\u51fa\uff1a<br/>$$ n \\\\geqslant \\\\sum_{k = 1}^{x + 1} k = {(x + 1)(x + 2) \\\\over 2} \\\\geqslant x^2 $$<br/>\u6362\u53e5\u8bdd\u8bb2\u5c31\u662f $ x = O(\\\\sqrt{n}) $\u3002\u5373\u4efb\u610f\u4e00\u4e2a\u70b9\u5f00\u59cb\u53ea\u8981\u8d70 $O(\\\\sqrt{n})$ \u6761\u8f7b\u8fb9\u5c31\u53ef\u4ee5\u5230\u8fbe\u6839\u8282\u70b9\u3002\u6700\u540e\u8fd9\u79cd\u65b9\u6cd5\u7684\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n)$-$O(\\\\sqrt{n})$\u3002\u5b9e\u9645\u4e0a\u8fd9\u79cd\u65b9\u6cd5\u5728\u4e4b\u524d\u63d0\u5230\u8fc7\uff0c\u901a\u5e38\u79f0\u4f5c\u957f\u94fe\u5256\u5206\uff0c\u5b83\u4f7f\u7528\u8f83\u5c11\u7684\u7a7a\u95f4\u548c\u4e0d\u662f\u5f88\u574f\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5b8c\u6210\u4e86\u6700\u8fd1\u516c\u5171\u7956\u5148\u7684\u8ba1\u7b97\u4efb\u52a1\u3002<br/>\u4f46\u662f\u8fd9\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c$O(\\\\sqrt{n})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u76f8\u6bd4\u4e4b\u4e8e\u500d\u589e\u7b97\u6cd5\uff0c\u8fd8\u4e0d\u662f\u4e00\u4e2a\u5f88\u7406\u60f3\u7684\u7ed3\u679c\u3002\u56de\u5fc6\u4e00\u4e0b\u4e4b\u524d\u7684\u5206\u6790\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u4e86\u4ec0\u4e48\uff1a<br/><br/>\u5982\u679c $T_u$ \u4e2d\u5b58\u5728\u4e00\u6761\u957f\u5ea6 $l$ \u7684\u94fe\uff0c\u90a3\u4e48 $u$ \u6240\u5904\u7684\u957f\u94fe\u7684\u957f\u5ea6\u81f3\u5c11\u4e3a $l$\u3002<br/><br/>\u56e0\u4e3a\u8fd9\u4e00\u70b9\uff0c\u4e0a\u8ff0\u5206\u6790\u4e2d\u6bcf\u6b21\u5230\u8fbe\u7684\u65b0\u7684\u957f\u94fe\u7684\u957f\u5ea6\u81f3\u5c11\u52a0 $1$\u3002\u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u51fa\u4e00\u4e2a\u5927\u80c6\u7684\u60f3\u6cd5\uff1a\u6bcf\u6b21\u5411\u4e0a\u8d70\u94fe\u957f $l$ \u6b65\uff0c\u90a3\u4e48\u65b0\u5230\u8fbe\u7684\u957f\u94fe\u7684\u957f\u5ea6\u5c31\u4f1a\u7ffb\u500d\uff0c\u4ece\u800c\u53ef\u4ee5\u8fbe\u5230 $O(\\\\log h)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002<br/>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e00\u6761\u957f\u94fe\u8bb0\u5f55\u5b83\u7684\u957f\u5ea6 $l$\uff0c\u4ee5\u53ca\u4ece\u94fe\u9876\u5411\u4e0a\u8d70 $l$ \u6b65\u5230\u8fbe\u7684\u70b9 $p$\uff08\u5982\u679c\u94fe\u9876\u7684\u6df1\u5ea6\u4e0d\u8db3 $l$ \u5219\u4e3a\u6839\u8282\u70b9 $r$\uff09\u3002\u7136\u540e\u56fa\u5b9a $v$\uff0c\u4e0d\u65ad\u4e0a\u8df3 $u$\uff0c\u76f4\u5230 $p$ \u662f $v$ \u7684\u7956\u5148\u3002\u8fd9\u4e2a\u65f6\u5019\u53d1\u73b0\u4ec5\u8fd9\u6837\u505a\u65e0\u6cd5\u77e5\u9053\u6700\u8fd1\u516c\u5171\u7956\u5148\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u80fd\u8fc7\u5934\u4e86\uff0c\u4f46\u662f\u53ef\u4ee5\u5f97\u77e5\u6700\u8fd1\u516c\u5171\u7956\u5148\u4e00\u5b9a\u5728 $u$ \u5230 $p$ \u7684\u957f\u94fe\u4e0a\uff0c\u5e76\u4e14\u5b83\u6ee1\u8db3\u4e8c\u5206\u6027\u8d28\u3002\u56e0\u6b64\u7a0d\u52a0\u6539\u52a8\uff0c\u5bf9\u4e8e\u6bcf\u6761\u94fe\uff0c\u5b58\u50a8\u8fd9\u6761\u94fe\u672c\u8eab\u7684\u6240\u6709\u70b9\uff0c\u4ee5\u53ca\u4ece\u94fe\u9876\u5411\u4e0a\u8d70\u81f3\u591a $l$ \u6b65\u7684\u6240\u6709\u70b9\uff08\u603b\u957f\u6700\u591a\u4e3a $2l$\uff09\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u6700\u540e\u4e00\u4e2a\u4e8c\u5206\u8fc7\u7a0b\u4e86\u3002<br/>\u867d\u7136\u6bcf\u6761\u94fe\u82b1\u8d39\u4e86 $2l$ \u7684\u7a7a\u95f4\u6765\u5b58\u50a8\u8fd9\u4e9b\u70b9\uff0c\u4f46\u662f\u7531\u4e8e\u6240\u6709\u94fe\u957f\u52a0\u8d77\u6765\u53ea\u6709 $n$\uff0c\u6545\u6700\u540e\u7684\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n)$-$O(\\\\log h)$\u3002\u6211\u4eec\u6210\u529f\u5b9e\u73b0\u4e86\u5728\u500d\u589e\u7b97\u6cd5\u7684\u57fa\u7840\u4e0a\uff0c\u51cf\u5c0f\u7a7a\u95f4\u5f00\u9500\u7684\u4efb\u52a1\u3002<br/>\u770b\u5230\u4e0a\u9762\u5570\u54e9\u5427\u55e6\u4e00\u5927\u5806\uff0c\u6709\u7684\u4eba\u53ef\u80fd\u4e00\u5f00\u59cb\u60f3\u6cd5\u5c31\u4e0d\u4e00\u6837\u3002\u53ef\u80fd\u4f1a\u60f3\u5c1d\u8bd5\u5c06\u91cd\u513f\u5b50 $v$ \u9009\u53d6\u4e3a $T_v$ \u7684\u5927\u5c0f\u6700\u5927\u7684\u90a3\u4e00\u4e2a\u3002\u6309\u7167\u8fd9\u4e2a\u6807\u51c6\uff0c\u4e4b\u524d\u957f\u94fe\u5256\u5206\u7684\u6700\u574f\u60c5\u51b5\u7684\u90a3\u68f5\u6811\uff0c\u5e94\u8be5\u88ab\u5212\u5206\u6210\u8fd9\u6837\uff1a<br/><br/>\uff08Fig. 5. \u5b9e\u9645\u4e0a\uff0c\u9664\u4e86\u6700\u5de6\u4e0b\u89d2\uff0c\u5176\u5b83\u90e8\u5206\u4e00\u5b9a\u4f1a\u88ab\u5212\u5206\u6210\u8fd9\u6837\uff09<br/>Aha\uff01EXCITED\uff01\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u65e0\u8bba\u4ec0\u4e48\u8be2\u95ee\uff0c\u6700\u591a\u8d70\u4e00\u6b21\u8f7b\u8fb9\u4e86\uff0c\u663e\u7136\u79d1\u5b66\u4e86\u5f88\u591a\u3002\u5728\u8fd9\u79cd\u5256\u5206\u4e2d\uff0c\u5982\u679c\u4f7f\u7528\u4e4b\u524d\u957f\u94fe\u5256\u5206\u7684 $O(\\\\sqrt{n})$ \u7b97\u6cd5\uff0c\u73b0\u5728\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u53d8\u6210\u4ec0\u4e48\u4e86\u5462\uff1f<br/>\u5957\u7528\u4e4b\u524d\u7684\u5206\u6790\u8fc7\u7a0b\uff0c\u5f53\u4e00\u4e2a\u70b9 $v$ \u6bcf\u8d70\u4e00\u6761\u8f7b\u8fb9\u5230 $u$\uff0c\u6211\u4eec\u5c31\u4f1a\u77e5\u9053 $u$ \u7684\u91cd\u513f\u5b50 $x$ \u4e00\u5b9a\u6ee1\u8db3 $T_x$ \u7684\u5927\u5c0f\u4e0d\u5c0f\u4e8e $T_v$ \u7684\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f\u8bf4 $T_u$ \u7684\u5927\u5c0f\u76f8\u5bf9\u4e8e $T_v$ \u800c\u8a00\u81f3\u5c11\u7ffb\u4e86\u4e00\u500d\u3002\u6700\u540e\u5f97\u51fa\u7ed3\u8bba\uff0c\u4efb\u610f\u4e00\u4e2a\u70b9\u8d70\u5230\u6839\u8282\u70b9\u53ea\u4f1a\u7ecf\u8fc7 $O(\\\\log n)$ \u6761\u8f7b\u8fb9\u3002\u901a\u8fc7\u7b80\u5355\u7684\u8c03\u6574\u9009\u53d6\u91cd\u513f\u5b50\u7684\u7b56\u7565\uff0c\u6211\u4eec\u76f4\u63a5\u83b7\u5f97\u4e86\u66f4\u52a0\u4f18\u79c0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u79cd\u5256\u5206\u65b9\u6cd5\u79f0\u4e3a\u8f7b\u91cd\u94fe\u8def\u5f84\u5256\u5206\uff08Heavy-Light Decomposition\uff0cHLD\uff0c\u53c8\u79f0\u6811\u94fe\u5256\u5206\uff09\uff0c\u8fd9\u79cd\u601d\u60f3\u5728\u52a8\u6001\u6811\uff08LCT\u3001Toptree \u4e4b\u7c7b\uff09\u4e0a\u53d1\u6325\u4e86\u6781\u5927\u7684\u4f5c\u7528\u3002<br/>\u63a5\u4e0b\u6765\u53c8\u662f\u4e00\u4e2a\u8001\u751f\u5e38\u8c08\u7684\u95ee\u9898\uff0c\u6709\u4e86\u8fd9\u79cd\u5256\u5206\u65b9\u6cd5\uff0c\u957f\u94fe\u5256\u5206\u5c31\u6ca1\u6709\u7528\u5904\u4e86\u5417\uff1f\u5e76\u4e0d\u3002\u4e4b\u524d\u63d0\u5230\u4e86\u7528\u957f\u94fe\u5256\u5206\u5728 $O(n\\\\log h)$-$\\\\Theta(1)$ \u7684\u590d\u6742\u5ea6\u5b8c\u6210\u6c42\u4e00\u4e2a\u70b9\u5411\u4e0a\u8d70 $k$ \u6b65\u7684\u70b9\uff0c\u8fd9\u662f\u4e00\u822c\u7b97\u6cd5\u65e0\u6cd5\u505a\u5230\u7684\u3002\u7ecf\u8fc7\u4e4b\u524d\u5bf9\u957f\u94fe\u5256\u5206\u7684\u5206\u6790\uff0c\u76f8\u4fe1\u4f60\u4e00\u5b9a\u80fd\u60f3\u51fa\u5177\u4f53\u65b9\u6cd5\u3002\u4f5c\u4e3a\u4e00\u4e2a\u63d0\u793a\uff0c\u90a3 $O(n \\\\log h)$ \u7684\u7a7a\u95f4\u5b9e\u9645\u4e0a\u662f\u88ab\u500d\u589e\u7b97\u6cd5\u4e2d\u7684 $g$ \u51fd\u6570\u5403\u6389\u4e86\u3002<br/>\u4e0e\u500d\u589e\u7b97\u6cd5\u7c7b\u4f3c\uff0c\u94fe\u5256\u5206\u65b9\u6cd5\u5b9e\u8d28\u4e0a\u5b8c\u6210\u4e86\u5bf9\u6811\u4e0a\u4efb\u610f\u7b80\u5355\u8def\u5f84\u5212\u5206\u4e3a\u5c11\u91cf\u94fe\u7684\u76ee\u6807\uff0c\u4ece\u800c\u4f7f\u5f97\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u53ef\u4ee5\u5728\u6811\u4e0a\u5927\u663e\u8eab\u624b\u3002\u7531\u4e8e\u672c\u6587\u53ea\u8ba8\u8bba\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\uff0c\u5bf9\u4e8e\u94fe\u5256\u5206\u7684\u5176\u4ed6\u6269\u5c55\u53ef\u4ee5\u53bb\u5bfb\u627e\u5176\u4ed6\u8d44\u6599\u3002<br/>\u8f6c\u5316\u4e3a RMQ<br/>\u5c31\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u4e00\u76f4\u5728\u8003\u8651\u76f4\u63a5\u5728\u6811\u4e0a\u5904\u7406\u95ee\u9898\u3002\u6709\u7684\u65f6\u5019\uff0c\u5c06\u4e00\u4e2a\u95ee\u9898\u8f6c\u6362\u4e3a\u53e6\u5916\u4e00\u4e2a\u7b49\u4ef7\u7684\u95ee\u9898\uff0c\u4e0d\u5931\u4e3a\u4e00\u79cd\u5947\u5999\u7684\u601d\u8def\u3002<br/>\u73b0\u5728\u9000\u56de\u5230\u4e00\u79cd\u5341\u5206\u6734\u7d20\u7684\u5b9e\u73b0\u65b9\u6cd5\uff1a\u4ece\u70b9 $u$ \u5f00\u59cb\uff0c\u641c\u7d22 $T_u$\uff0c\u5982\u679c $v$ \u5728 $T_u$ \u4e2d\uff0c\u5219\u6700\u8fd1\u516c\u5171\u7956\u5148\u4e3a $u$\u3002\u5426\u5219\u4ee4 $u = f(u)$\uff0c\u7ee7\u7eed\u6267\u884c\u4ee5\u4e0a\u8fc7\u7a0b\u3002\u5f53\u7136\uff0c\u5982\u679c\u67d0\u4e9b\u70b9\u5df2\u7ecf\u88ab\u904d\u5386\u8fc7\u4e86\uff0c\u5219\u4e0d\u9700\u8981\u518d\u6b21\u8bbf\u95ee\u3002\u6216\u8005\u53ef\u4ee5\u6362\u4e00\u4e2a\u89d2\u5ea6\uff1a\u5c06\u6811\u4e0a\u7684\u6bcf\u6761\u65e0\u5411\u8fb9\u62c6\u4e3a\u4e24\u6761\u6709\u5411\u8fb9\u3002\u5bf9\u4e8e\u5c5e\u4e8e\u540c\u4e00\u6761\u65e0\u5411\u8fb9\u7684\u4e24\u6761\u6709\u5411\u8fb9\uff0c\u6211\u4eec\u4f18\u5148\u8d70\u5411\u4e0b\u8d70\u7684\u8fb9\u3002\u6bcf\u8fdb\u5165\u4e00\u4e2a\u70b9\u7684\u65f6\u5019\uff0c\u5c31\u8bb0\u5f55\u4e00\u4e0b\uff0c\u6700\u540e\u4f1a\u6784\u6210\u4e00\u4e2a\u5e8f\u5217\u3002\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f DFS \u5e8f\u3002<br/><br/>\uff08Fig. 6. \u8fd9\u68f5\u6811\u7684 DFS \u5e8f\u662f 1 2 4 2 5 6 5 2 1 3 1\uff09<br/>\u5047\u8bbe $u$ \u7684 DFS \u5165\u6808\u65f6\u95f4\u65e9\u4e8e $v$ \uff0c\u90a3\u4e48\u4e4b\u524d\u7684\u6734\u7d20\u65b9\u6cd5\u76f8\u5f53\u4e8e\u4ece $u$ \u5f00\u59cb\u6cbf\u7740\u8fd9\u4e9b\u8fb9\u6765\u641c\u7d22\uff0c\u76f4\u5230\u5230\u8fbe $v$\u3002\u641c\u7d22\u8fc7\u7a0b\u4e2d\u8bbf\u95ee\u5230\u7684\u6df1\u5ea6\u6700\u5c0f\u7684\u70b9\u5c31\u662f $u$ \u548c $v$ \u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u3002<br/><br/>\uff08Fig. 7. \u51e0\u4e2a\u5c0f\u4f8b\u5b50\uff0c\u5206\u522b\u4e3a\u67e5\u8be2 $\\\\mathrm{lca}(4,\\\\;6)$\u3001$\\\\mathrm{lca}(4,\\\\;3)$ \u548c $\\\\mathrm{lca}(1,\\\\;4)$\uff09<br/>\u73b0\u5728\u60c5\u51b5\u5c31\u5341\u5206\u6e05\u695a\u4e86\uff0c\u7531\u4e8e\u8fd9\u4e2a DFS \u5e8f\u662f\u56fa\u5b9a\u7684\uff0c\u800c\u4e14\u56e0\u4e3a\u6bcf\u6761\u65e0\u5411\u8fb9\u90fd\u88ab\u62c6\u6210\u4e86\u4e24\u6761\u6709\u5411\u8fb9\uff0c\u52a0\u4e0a\u8fdb\u5165\u6839\u8282\u70b9\u7684\u4e00\u6b21\u8bb0\u5f55\uff0c\u6240\u4ee5\u5e8f\u5217\u7684\u957f\u5ea6\u4e3a $2n - 1$\u3002\u73b0\u5728\u6211\u4eec\u5c06 DFS \u5e8f\u4e0a\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u70b9 $u$ \u6362\u4e3a $u$ \u7684\u6df1\u5ea6\uff0c\u79f0\u4e4b\u4e3a\u6df1\u5ea6\u5e8f\u5217\u3002\u8fd9\u6837\u76f8\u5f53\u4e8e\u5728\u4e00\u4e2a\u957f\u4e3a $2n - 1$ \u7684\u5e8f\u5217\u4e0a\uff0c\u67e5\u8be2\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u6700\u5c0f\u503c\u3002\u4e5f\u5c31\u662f\u9759\u6001\u533a\u95f4\u6700\u503c\u95ee\u9898\uff08Range Minimum / Maximum Query\uff0cRMQ\uff09\u3002\u4f7f\u7528\u5e73\u8861\u6811\u548c\u7ebf\u6bb5\u6811\u5747\u53ef\u4ee5\u505a\u5230 $\\\\Theta(n)$-$O(\\\\log n)$ \u7684\u590d\u6742\u5ea6\uff0c\u4f46\u8fd9\u91cc\u4e0d\u4f1a\u8ba8\u8bba\u5b83\u4eec\u3002\u63a5\u4e0b\u6765\u5c06\u4f1a\u8f6c\u4e3a\u8ba8\u8bba\u4e13\u95e8\u7528\u4e8e\u89e3\u51b3\u9759\u6001 RMQ \u95ee\u9898\u7684\u7a00\u758f\u8868\u7b97\u6cd5\uff08Sparse Table\uff0c\u53c8\u79f0 ST \u8868\uff09\u3002<br/>\u7a00\u758f\u8868<br/>\u9996\u5148\u6ce8\u610f\u5230\u533a\u95f4 $[l,\\\\;r]$ \u7684\u6700\u503c\u53ef\u4ee5\u7531\u591a\u4e2a\u533a\u95f4 $[l_1,\\\\;r_1],\\\\;[l_2,\\\\;r_2],\\\\;...,\\\\;[l_k,\\\\;r_k]$ \u7684\u6700\u503c\u5f97\u6765\uff0c\u53ea\u8981\u6ee1\u8db3\u8fd9\u4e9b\u533a\u95f4\u7684\u5e76\u96c6\u662f $[l,\\\\;r]$\u3002\u57fa\u4e8e\u8fd9\u79cd\u601d\u60f3\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u4e00\u4e9b\u533a\u95f4\u7684\u6700\u503c\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u53ea\u8981\u786e\u4fdd\u80fd\u627e\u51fa\u4e00\u4e9b\u5df2\u7ecf\u5904\u7406\u8fc7\u7684\u533a\u95f4\u5e76\u8d77\u6765\u6ee1\u8db3\u8be2\u95ee\u7684\u8981\u6c42\uff0c\u5c31\u53ef\u4ee5\u56de\u7b54\u8be2\u95ee\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u60f3\u6cd5\u5c31\u662f\u62c6\u6210\u4e24\u4e2a\u533a\u95f4\uff0c\u4e00\u4e2a\u662f\u524d\u7f00\u4e00\u4e2a\u662f\u540e\u7f00\uff1a<br/><br/>\uff08Fig. 8. \u4e00\u4e2a\u533a\u95f4\u88ab\u62c6\u4e3a\u4e24\u4e2a\u5b50\u533a\u95f4\uff09<br/>\u55ef\uff0c\u5206\u6210\u4e24\u4e2a\u533a\u95f4\uff0c\u4e0d\u96be\u60f3\u5230 $2^k + 2^k = 2^{k + 1}$\u3002\u4e5f\u5c31\u662f\u8bf4\u53ea\u7528\u8ba1\u7b97\u6240\u6709\u957f\u5ea6\u4e3a $2^k$ \u7684\u533a\u95f4\u7684\u6700\u503c\uff0c\u5c31\u53ef\u4ee5\u5728 $\\\\Theta(1)$ \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u4efb\u610f\u533a\u95f4\u7684\u6700\u503c\u3002\u8bb0 $f(i,\\\\;j)$ \u8868\u793a\u4ee5 $i$ \u4e3a\u5de6\u7aef\u70b9\uff0c\u957f\u5ea6\u4e3a $2^j$ \u7684\u533a\u95f4\u6700\u503c\uff0c\u7136\u540e\u4ee4 $\\\\mathrm{highbit}(n) = \\\\lfloor \\\\log n \\\\rfloor$\uff0c\u5373\u6700\u5927\u7684 $k$ \u6ee1\u8db3 $2^k \\\\leqslant n$\u3002\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7b80\u5355\u7684\u5728 $\\\\Theta(n)$ \u7684\u65f6\u95f4\u5185\u9884\u5904\u7406\u51fa\u6765\u3002\u4e4b\u540e\uff0c\u6bcf\u6b21\u67e5\u8be2\u5c31\u662f\u8fd9\u6837\u7684\uff1a<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7highbit[1] = 0<br/>for i = 2 to n:<br/>    highbit[i] = highbit[i >> 1] + 1<br/><br/>function QUERY(l, r):<br/>    k = highbit[r - l + 1]<br/>    return min(f(l, k), f(r - (1 << k) + 1, k))  // \u6216\u8005 max<br/><br/><br/>\u73b0\u5728\u5c31\u53ea\u9700\u8981\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $f(i,\\\\;j)$ \u4e86\u3002\u8ba1\u7b97\u4e00\u4e2a\u5e8f\u5217\u4e2d\u6240\u6709\u957f\u5ea6\u4e3a $l$ \u7684\u533a\u95f4\u7684\u6700\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u79cd\u53eb\u505a\u5355\u8c03\u961f\u5217\u7684\u65b9\u6cd5\u3002\u4f7f\u7528\u4e00\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u6765\u7ef4\u62a4\u5f53\u524d\u533a\u95f4\u5185\u4ece\u5de6\u81f3\u53f3\u7684\u4e00\u4e2a\u5355\u8c03\u9012\u51cf\uff08\u6216\u9012\u589e\uff09\u5e8f\u5217\uff0c\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u6700\u503c\u7684\u5019\u9009\u961f\u5217\u3002\u6bcf\u6b21\u4ece\u540e\u9762\u52a0\u5165\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u5c31\u4f1a\u5bfc\u81f4\u961f\u5217\u91cc\u9762\u4e0d\u5355\u8c03\uff0c\u6240\u4ee5\u9700\u8981\u4e0d\u65ad\u5730\u4ece\u5c3e\u90e8\u5f39\u51fa\u5143\u7d20\uff0c\u4f7f\u5f97\u65b0\u7684\u5143\u7d20\u52a0\u5165\u540e\uff0c\u4f9d\u7136\u6ee1\u8db3\u5355\u8c03\u6027\u3002\u8fd9\u6837\uff0c\u961f\u9996\u7684\u5143\u7d20\u59cb\u7ec8\u662f\u6700\u5927\uff08\u6216\u6700\u5c0f\uff09\u503c\u3002\u5982\u679c\u6536\u7f29\u5de6\u8fb9\u754c\uff0c\u5bfc\u81f4\u961f\u9996\u5143\u7d20\u88ab\u5f39\u51fa\uff0c\u65b0\u7684\u961f\u9996\u4f9d\u7136\u662f\u6700\u5927\uff08\u6216\u6700\u5c0f\uff09\u503c\u3002\u4e0a\u8ff0\u65b9\u6cd5\u4e2d\u6bcf\u4e2a\u5143\u7d20\u53ea\u4f1a\u5165\u6808\u4e00\u6b21\uff0c\u51fa\u6808\u4e00\u6b21\uff0c\u6240\u4ee5\u5355\u6b21\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n)$\u3002\u7531\u4e8e\u6211\u4eec\u9700\u8981\u8ba1\u7b97\u7684\u957f\u5ea6 $l$ \u90fd\u662f $2$ \u7684\u5e42\uff0c\u603b\u5171\u53ea\u6709 $\\\\Theta(\\\\log n)$ \u4e2a\uff0c\u6240\u4ee5\u603b\u7684\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n \\\\log n)$-$\\\\Theta(1)$\u3002<br/>\u5f53\u7136\uff0c\u6211\u4eec\u6709\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u3002\u56e0\u4e3a\u6bcf\u4e2a\u957f\u5ea6\u4e3a $2^k$ \u7684\u533a\u95f4\u53ef\u4ee5\u62c6\u6210\u4e24\u4e2a\u957f\u5ea6\u4e3a $2^{k-1}$ \u7684\u533a\u95f4\uff0c\u56e0\u800c\u53ef\u4ee5\u9012\u63a8\u8ba1\u7b97\uff0c\u4e5f\u5c31\u662f $f(i,\\\\;j)$ \u6ee1\u8db3\u4e0b\u9762\u7684\u5173\u7cfb\uff08\u4ee5\u6700\u5927\u503c\u4e3a\u4f8b\uff0c$a_i$ \u662f\u76ee\u6807\u5e8f\u5217\uff09\uff1a<br/>$$ \\\\begin{aligned} f(i,\\\\;0) & = a_i \\\\\\\\ f(i,\\\\;j) & = \\\\max\\\\{f(i,\\\\;j-1),\\\\;f(i+2^{j-1},\\\\;j-1)\\\\} \\\\;\\\\;\\\\;\\\\; \\\\forall j > 0 \\\\end{aligned}$$<br/>\u540c\u6837\uff0c\u5b83\u7684\u590d\u6742\u5ea6\u4e5f\u4e3a $\\\\Theta(n \\\\log n)$-$\\\\Theta(1)$\u3002\u5982\u679c\u5c06\u8fd9\u4e2a\u7b97\u6cd5\u8fd0\u7528\u5230\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\u4e0a\u9762\uff0c\u6211\u4eec\u5c31\u9996\u6b21\u83b7\u5f97\u4e86\u5355\u6b21\u8be2\u95ee\u65f6\u95f4\u4e3a\u5e38\u6570\u7684\u7b97\u6cd5\u3002\u8fd9\u662f\u4e00\u4e2a\u76f8\u5f53\u5927\u7684\u7a81\u7834\u3002<br/>\u7136\u800c\u4e00\u5207\u90fd\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u6211\u4eec\u4e0d\u7981\u4f1a\u60f3\uff0c\u80fd\u5426\u7ee7\u7eed\u4f18\u5316\uff0c\u4ece\u800c\u8fbe\u5230 $\\\\Theta(n)$-$\\\\Theta(1)$ \u7684\u7406\u8bba\u4e0b\u754c\u5462\uff08\u56e0\u4e3a\u8fd9\u662f\u8f93\u5165\u8f93\u51fa\u7684\u590d\u6742\u5ea6\uff09\uff1f\u7b54\u6848\u662f\u80af\u5b9a\u7684\u3002\u5c31\u76ee\u524d\u6765\u770b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u964d\u4f4e\u7a00\u758f\u8868\u7684\u7a7a\u95f4\u6d88\u8017\uff0c\u540c\u65f6\u4fdd\u8bc1\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5373\u53ef\u3002<br/>\u5982\u4f55\u964d\u4f4e\u7a7a\u95f4\u590d\u6742\u5ea6\u5462\uff1f\u4e00\u4e2a\u5947\u8469\u7684\u60f3\u6cd5\u5c31\u662f\uff0c\u5982\u679c\u53ea\u6709 $n / \\\\log n$ \u4e2a\u5143\u7d20\uff0c\u90a3\u7a7a\u95f4\u590d\u6742\u5ea6\u4e0d\u5c31\u81ea\u7136\u53d8\u6210 $\\\\Theta(n)$ \u4e86\u5417\uff1f\u4f46\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e2a\u770b\u8d77\u6765\u5f88\u4e0d\u79d1\u5b66\u7684\u60f3\u6cd5\u5462\uff1f\u8fd9\u65f6\u5206\u5757\u7684\u6280\u5de7\u5c31\u53ef\u7528\u4e0a\u4e86\u3002\u9996\u5148\u8bbe\u5b9a\u4e00\u4e2a\u5757\u5927\u5c0f $S$\uff0c\u7136\u540e\u4ece\u524d\u5f80\u540e\u6bcf $S$ \u4e2a\u5143\u7d20\u5212\u4e3a\u4e00\u5757\uff0c\u6ce8\u610f\u6700\u540e\u4e00\u5757\u53ef\u80fd\u6ca1\u6709 $S$ \u4e2a\u5143\u7d20\u3002\u8fd9\u6837\u6574\u4e2a\u5e8f\u5217\u5c31\u5212\u4e3a\u4e86 $\\\\Theta(n / S)$ \u5757\u3002\u8003\u8651\u4e00\u4e0b\u6bcf\u4e00\u6b21\u8be2\u95ee\u53ef\u80fd\u51fa\u73b0\u7684\u60c5\u51b5\uff1a<br/><br/>\uff08Fig. 9. \u4e0a\u9762\u7684\u5e8f\u5217\u5212\u4e3a\u4e86 $6$ \u5757\uff09<br/>\u5c31\u4e0a\u56fe\u5217\u4e3e\u7684\u4e09\u79cd\u60c5\u51b5\u800c\u8a00\uff0c\u5b9e\u9645\u4e0a\u53ea\u6709\u4e24\u79cd\uff1a<br/><br/>\u8be2\u95ee\u8de8\u8d8a\u7684\u5757\u4e0e\u5757\u4e4b\u95f4\u7684\u5206\u754c\u7ebf\u3002<br/>\u8be2\u95ee\u6ca1\u6709\u8de8\u8d8a\u8fd9\u4e2a\u5206\u754c\u7ebf\u3002<br/><br/>\u6b64\u65f6\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u8be2\u95ee\u533a\u95f4\u662f\u7531\u4e00\u4e9b\u8fde\u7eed\u7684\u5757\uff08\u53ef\u80fd\u6ca1\u6709\uff09\u548c\u9996\u5c3e\u4e24\u4e2a\u5757\u7684\u4e00\u4e2a\u540e\u7f00\u548c\u4e00\u4e2a\u524d\u7f00\u6784\u6210\u3002\u8fde\u7eed\u7684\u5757\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7a00\u758f\u8868\u89e3\u51b3\uff0c\u5373\u7528\u6bcf\u4e2a\u5757\u5185\u7684\u6700\u503c\u8868\u793a\u8fd9\u4e2a\u5757\uff0c\u6784\u6210\u4e00\u4e2a\u5e8f\u5217\uff0c\u7136\u540e\u5efa\u7acb\u4e00\u4e2a\u5927\u5c0f\u4e3a $\\\\Theta(n/S)$ \u7684\u7a00\u758f\u8868\uff1b\u524d\u7f00\u548c\u540e\u7f00\u90e8\u5206\uff0c\u7531\u4e8e\u6bcf\u4e2a\u5757\u7684\u524d\u7f00\u6700\u503c\u548c\u540e\u7f00\u6700\u503c\u603b\u5171\u53ea\u6709 $\\\\Theta(n)$ \u4e2a\uff0c\u4e5f\u53ef\u4ee5\u63d0\u524d\u5904\u7406\u3002\u8fd9\u4e00\u90e8\u5206\u7684\u590d\u6742\u5ea6\u505a\u5230\u4e86 $\\\\Theta(n)$-$\\\\Theta(1)$\u3002<br/>\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u4f3c\u4e4e\u5c31\u6ca1\u6709\u90a3\u4e48\u65b9\u4fbf\u4e86\u3002\u73b0\u5728\u6211\u4eec\u5bf9\u4ed8\u7684\u662f\u4e00\u4e2a\u5927\u5c0f\u4e3a $O(S)$ \u7684 RMQ \u95ee\u9898\uff0c\u5982\u679c\u76f4\u63a5\u5c1d\u8bd5\u5bf9\u6bcf\u4e2a\u5757\u5efa\u7acb\u5c0f\u7684\u7a00\u758f\u8868\uff0c\u8ba1\u7b97\u53ef\u77e5\u6211\u4eec\u73b0\u5728\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u662f\uff1a<br/>$$\\\\Theta((n/S) \\\\cdot S \\\\log  S+ (n / S) \\\\cdot \\\\log (n/S)) = \\\\Theta(n \\\\log S + (n \\\\log n)/S)$$<br/>\u901a\u8fc7\u5bf9 $S$ \u6c42\u5bfc\u53ef\u77e5\u5927\u7ea6\u9009\u53d6 $S = \\\\log n$ \u65f6\u8fbe\u5230\u6700\u4f18\u590d\u6742\u5ea6\uff0c\u6b64\u65f6\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n \\\\log \\\\log n)$\u3002<br/>What a pity\uff01\u6211\u4eec\u8d39\u5c3d\u5fc3\u601d\uff0c\u5374\u4ecd\u7136\u4e0d\u80fd\u8fbe\u5230\u7ebf\u6027\u590d\u6742\u5ea6\u3002\u6ce8\u610f\u5230\u6211\u4eec\u7684\u7a7a\u95f4\u51e0\u4e4e\u90fd\u7528\u5728\u5904\u7406\u4e00\u5806\u5927\u5c0f\u4e3a $O(S)$ \u7684\u5b50\u95ee\u9898\u4e0a\u4e86\u3002\u7531\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\u53ef\u4ee5\u662f\u4efb\u610f\u6570\u503c\uff0c\u6240\u4ee5\u5757\u4e0e\u5757\u4e4b\u95f4\u51e0\u4e4e\u4e0d\u53ef\u80fd\u76f8\u540c\uff0c\u8fd9\u5bfc\u81f4\u5229\u7528\u73b0\u6709\u7684\u7b97\u6cd5\u96be\u4ee5\u5c06\u7a7a\u95f4\u590d\u6742\u5ea6\u964d\u4e0b\u6765\u3002<br/>\u73b0\u5728\u56de\u5230\u6700\u5f00\u59cb\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u6c42\u6700\u8fd1\u516c\u5171\u7956\u5148\u3002DFS \u5e8f\u603b\u6709\u4e00\u4e9b\u975e\u5e38\u597d\u7684\u6027\u8d28\uff0c\u5c31\u4f8b\u5982\u4e4b\u524d\u7684\u6df1\u5ea6\u5e8f\u5217\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u5e8f\u5217\u4e0a\u76f8\u90bb\u4e24\u4e2a\u6570\u4e4b\u5dee\u603b\u662f $\\\\pm 1$\u3002\u8fd9\u662f\u56e0\u4e3a DFS \u8fd9\u4e2a\u8fc7\u7a0b\u7684\u6bcf\u4e00\u6b65\u8981\u4e48\u5f80\u4e0b\u8d70\uff0c\u8981\u4e48\u5f80\u4e0a\u8d70\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6df1\u5ea6\u5e8f\u5217\u7684\u5dee\u5206\u5e8f\u52171\u4e0a\u53ea\u6709 $\\\\pm 1$\u3002\u5982\u679c\u539f\u5e8f\u5217\u957f\u5ea6\u4e3a $S$\uff0c\u90a3\u4e48\u5b83\u7684\u5dee\u5206\u5e8f\u5217\u5c31\u53ea\u6709 $2^{S-1}$ \u79cd\uff0c\u8fd9\u8fdc\u8fdc\u5c0f\u4e8e\u539f\u59cb\u5e8f\u5217\u53ef\u80fd\u7684\u79cd\u6570\u3002<br/>\u73b0\u5728\u4f60\u4e5f\u8bb8\u53ef\u4ee5\u731c\u5230\u63a5\u4e0b\u6765\u8981\u505a\u4ec0\u4e48\u4e86\u3002\u7531\u4e8e\u5dee\u5206\u5e8f\u5217\u79cd\u7c7b\u4e0d\u591a\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u5dee\u5206\u5e8f\u5217\u505a\u4e00\u904d\u524d\u7f00\u548c\u5904\u7406\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u5e8f\u5217\uff0c\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e0a\u7684\u503c\u662f\u5dee\u5206\u5e8f\u5217\u4e0a\u524d $i$ \u4e2a\u6570\u7684\u548c\uff0c\u5e76\u4e14\u5904\u7406\u8fd9\u4e2a\u5e8f\u5217\u4e0a\u7684\u6bcf\u4e2a\u533a\u95f4\u7684\u6700\u503c\u3002\u7136\u540e\u5982\u679c\u77e5\u9053\u539f\u59cb\u5e8f\u5217\u7684\u7b2c\u4e00\u9879 $a$\uff0c\u90a3\u4e48\u539f\u59cb\u5e8f\u5217\u5c31\u76f8\u5f53\u4e8e\u662f\u524d\u7f00\u548c\u5e8f\u5217\u524d\u6dfb\u52a0\u4e00\u4e2a $0$\uff0c\u5e76\u4e14\u6bcf\u4e2a\u6570\u90fd\u52a0\u4e0a $a$\uff0c\u6240\u4ee5\u53ef\u4ee5\u8f7b\u677e\u77e5\u9053\u539f\u59cb\u5e8f\u5217\u7684\u6700\u503c\u3002<br/>\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u5f97\u5927\u5c0f\u4e3a $O(S)$ \u7684 RMQ \u95ee\u9898\u51cf\u5c0f\u603b\u7a7a\u95f4\u4ee3\u4ef7\u4e86\u3002\u9009\u5b9a $S = \\\\frac12\\\\log n$\uff0c\u4e00\u65b9\u9762\uff0c\u8fd9\u6837\u4f7f\u5f97\u5dee\u5206\u5e8f\u5217\u7684\u79cd\u7c7b\u53ea\u6709 $2^{1/2\\\\log n - 1} = \\\\Theta(\\\\sqrt{n})$ \u79cd\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u7c97\u66b4\u7684\u4f7f\u7528 $\\\\Theta(S^2)$ \u7684\u7a7a\u95f4\u4e3a\u6bcf\u4e00\u79cd\u5dee\u5206\u5e8f\u5217\u8ba1\u7b97\u533a\u95f4\u6700\u503c\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7a00\u758f\u8868\uff1b\u53e6\u4e00\u65b9\u9762\uff0c\u8de8\u8d8a\u591a\u4e2a\u5757\u7684\u8be2\u95ee\u540c\u6837\u53ef\u4ee5\u4f7f\u7528\u4e4b\u524d\u7684\u5206\u5757\u7b97\u6cd5\uff0c\u5e76\u4e14\u7a7a\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u662f $\\\\Theta(n)$\u3002\u7efc\u4e0a\uff0c\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\u53ef\u4ee5\u5728 $\\\\Theta(n)$-$\\\\Theta(1)$ \u7684\u590d\u6742\u5ea6\u89e3\u51b3\u4e86\u3002<br/>\u5728\u5177\u4f53\u5b9e\u73b0\u4e0a\uff0c\u7531\u4e8e $\\\\log n$ \u4e0d\u5927\uff0c\u6240\u4ee5\u5dee\u5206\u5e8f\u5217\u901a\u5e38\u7528\u4e8c\u8fdb\u5236\u6765\u8868\u793a\uff08\u5982\u4e8c\u8fdb\u5236\u4f4d $1$ \u8868\u793a\u5dee\u5206\u5e8f\u5217\u4e0a\u7684 $+1$\uff0c\u5bf9\u5e94\u7684 $0$ \u5219\u8868\u793a $-1$\uff09\u3002\u8fd9\u6837\u5c31\u53ea\u9700\u8981\u8bbf\u95ee\u6570\u7ec4\u4e0b\u6807\u5c31\u53ef\u4ee5\u77e5\u9053\u7279\u5b9a\u5dee\u5206\u5e8f\u5217\u7684\u4fe1\u606f\u4e86\u3002<br/>\u7b1b\u5361\u5c14\u6811<br/>\u867d\u7136\u6700\u8fd1\u516c\u5171\u7956\u5148\u7684\u7406\u8bba\u590d\u6742\u5ea6\u4e0b\u754c\u5df2\u7ecf\u5b9e\u73b0\u4e86\uff0c\u672c\u6587\u4f3c\u4e4e\u4e5f\u5c31\u6ca1\u6709\u5fc5\u8981\u7ee7\u7eed\u4e0b\u53bb\u4e86\u3002\u4f46\u662f\u4e4b\u524d\u6211\u80af\u5b9a\u7684\u56de\u7b54\u4e86 RMQ \u80fd\u5426\u8fbe\u5230\u7406\u8bba\u4e0b\u754c\uff0c\u540c\u65f6\u4e5f\u4e3a\u4e86\u63ed\u793a\u6700\u8fd1\u516c\u5171\u7956\u5148\u548c RMQ \u95ee\u9898\u4e4b\u95f4\u7684\u4e00\u4e9b\u8054\u7cfb\uff0c\u8fd9\u91cc\u8fd8\u662f\u6709\u5fc5\u8981\u8bf4\u4e00\u4e0b\u5982\u4f55\u6539\u8fdb\u7a00\u758f\u8868\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u3002<br/>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u63a5\u4e0b\u6765\u90fd\u53ea\u8003\u8651\u6700\u5927\u503c\u3002\u6211\u4eec\u77e5\u9053\uff0c\u6700\u5927\u503c\u4e00\u5b9a\u662f\u5e8f\u5217\u4e0a\u7684\u4e00\u4e2a\u503c\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5e8f\u5217\u4e0a\u7684\u6bcf\u4e2a\u503c\uff0c\u6709\u54ea\u4e9b\u533a\u95f4\u7684\u6700\u5927\u503c\u662f\u5b83\u81ea\u5df1\u5462\uff1f\u9996\u5148\u6765\u627e\u51fa\u4e00\u4e2a\u6700\u5927\u7684\u533a\u95f4\u6ee1\u8db3\u8fd9\u4e2a\u533a\u95f4\u7684\u6700\u5927\u503c\u5c31\u662f\u81ea\u5df1\uff0c\u5047\u8bbe\u5e8f\u5217\u662f $a_i$\uff0c\u73b0\u5728\u6211\u4eec\u8981\u786e\u5b9a\u7684\u662f $a_x$ \u7684\u6700\u5927\u533a\u95f4 $[l,\\\\;r]$\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ece $[x,\\\\;x]$ \u5f00\u59cb\uff0c\u68c0\u67e5 $a_{l-1}$ \u662f\u5426\u4e0d\u8d85\u8fc7 $a_x$\uff0c\u5982\u679c\u662f\uff0c\u5219 $l$ \u53ef\u4ee5\u51cf $1$\uff1b\u540c\u7406\uff0c\u5982\u679c\u6ee1\u8db3 $a_{r+1} \\\\leqslant a_x$\uff0c\u90a3\u4e48 $r$ \u4e5f\u53ef\u4ee5\u52a0 $1$\u3002\u5f53\u7136\u6211\u4eec\u9700\u8981\u6ee1\u8db3 $l \\\\geqslant 1$ \u4ee5\u53ca $r \\\\leqslant L$\uff0c\u5176\u4e2d $L$ \u662f\u5e8f\u5217\u957f\u5ea6\u3002\u8fd9\u6837\u505a\u7684\u6b63\u786e\u6027\u662f\u663e\u7136\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u533a\u95f4\u4e0d\u80fd\u8de8\u8fc7\u4efb\u4f55\u4e00\u4e2a\u6bd4 $a_x$ \u5927\u7684\u4f4d\u7f6e\u3002\u6b64\u5916\uff0c\u6211\u4eec\u5bb9\u6613\u5f97\u5230\u6240\u6709\u6ee1\u8db3\u6700\u5927\u503c\u4e3a $a_x$ \u7684\u533a\u95f4 $[l',\\\\;r']$ \u6ee1\u8db3 $l \\\\leqslant l' \\\\leqslant x \\\\leqslant r' \\\\leqslant r$\u3002<br/>\u8bbe $l(x)$ \u548c $r(x)$ \u8868\u793a\u4e4b\u524d\u5bf9\u4e8e\u7279\u5b9a\u7684 $x$ \u6240\u8bf4\u7684 $l$ \u548c $r$\uff0c\u5e76\u4e14 $M(x) = [l(x),\\\\;r(x)]$\u3002\u6c42\u51fa\u6240\u6709\u7684 $l(x)$ \u548c $r(x)$ \u56fa\u7136\u53ef\u4ee5\u4f7f\u7528\u8d2a\u5fc3\u7b97\u6cd5\uff0c\u4f46\u662f\u5b83\u6548\u7387\u4e0d\u9ad8\u3002\u5176\u5b9e\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528\u4e4b\u524d\u63d0\u5230\u8fc7\u7684\u5355\u8c03\u961f\u5217\u3002\u56e0\u4e3a\u5411\u5de6\u627e\u51fa $l(x)$ \u7684\u8fc7\u7a0b\u5c31\u76f8\u5f53\u4e8e\u4e0d\u505c\u5730\u4ece\u961f\u5217\u672b\u5c3e\u5f39\u51fa\u5143\u7d20\uff0c\u76f4\u5230\u627e\u5230\u7b2c\u4e00\u4e2a\u5927\u4e8e $a_x$ \u7684\u5143\u7d20\u3002\u800c\u6c42\u51fa $r(x)$ \u5c31\u662f\u8981\u77e5\u9053 $a_x$ \u662f\u5f53\u8c01\u52a0\u5165\u961f\u5217\u540e\u88ab\u5f39\u51fa\u7684\uff0c\u5982\u679c\u52a0\u5165 $a_y$ \u5bfc\u81f4 $a_x$ \u88ab\u5f39\u51fa\uff0c\u90a3\u4e48\u8bf4\u660e $a_y$ \u662f $a_x$ \u5411\u53f3\u8d70\u7684\u7b2c\u4e00\u4e2a\u5927\u4e8e $a_x$ \u7684\u4f4d\u7f6e\u3002\u6b64\u5916\u8fd8\u9700\u8981\u6ce8\u610f\uff0c\u6700\u540e\u961f\u5217\u91cc\u9762\u80af\u5b9a\u8fd8\u4f1a\u5269\u4f59\u4e00\u4e9b\u5143\u7d20\u6ca1\u6709\u88ab\u5f39\u51fa\u6765\uff0c\u8fd9\u5219\u8bf4\u660e\u8fd9\u4e9b\u5143\u7d20\u7684 $r(x)$ \u90fd\u662f $L$\u3002\u8fd9\u6837\u505a\u7684\u8bdd\u5c31\u53ea\u7528 $\\\\Theta(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e86\u3002\u5177\u4f53\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16// a: \u957f\u5ea6\u4e3a L \u7684\u6574\u578b\u6570\u7ec4\uff0c\u8868\u793a\u5e8f\u5217<br/>Q = []  // \u5355\u8c03\u961f\u5217<br/>for i = 1 to L:<br/>    while Q is not empty and a[Q.last()] <= a[i]:<br/>        r(Q.last()) = i - 1<br/>        Q.pop_back()<br/><br/>    if Q is empty:<br/>        l(i) = 1  // \u6b64\u65f6 a[i] \u4e00\u8def\u5f80\u5de6\u6ca1\u6709\u9047\u5230\u66f4\u5927\u7684\u503c<br/>    else:<br/>        l(i) = Q.last() + 1<br/><br/>    Q.push_back(i)<br/><br/>foreach i in Q:<br/>    r(i) = L<br/><br/><br/>\u73b0\u5728\u6211\u4eec\u6765\u89c2\u5bdf\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a<br/><br/>\uff08Fig. 10. \u5728\u5e8f\u5217 2 3 1 6 4 5 7 \u7684\u4f8b\u5b50\uff09<br/>\u6b64\u65f6\u4f60\u5c31\u4f1a\u53d1\u73b0\u6240\u6709\u7684\u8fd9\u4e9b\u533a\u95f4\u4e24\u4e24\u4e4b\u95f4\u53ea\u6709\u5305\u542b\u548c\u5206\u79bb\u7684\u5173\u7cfb\u3002\u5229\u7528\u8fd9\u79cd\u5305\u542b\u5173\u7cfb\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u5c31\u53ef\u4ee5\u6784\u9020\u4e00\u68f5\u6811\uff1a<br/><br/>\uff08Fig. 11. \u5982\u679c $M(x) \\\\subseteq M(y)$\uff0c\u90a3\u4e48 $y$ \u662f\u6811\u4e0a $x$ \u7684\u7956\u5148\uff09<br/>\u8fd9\u68f5\u4e8c\u53c9\u6811\u88ab\u79f0\u4e3a\u7b1b\u5361\u5c14\u6811\uff08Cartesian Tree\uff09\u3002\u5bf9\u4e8e\u77e5\u9053 Treap \u7684\u4eba\u6765\u8bf4\u8fd9\u4e2a\u540d\u8bcd\u4e00\u5b9a\u4e0d\u964c\u751f\uff0c\u8fd9\u68f5\u6811\u76f8\u5f53\u4e8e\u7ed9\u6bcf\u4e2a\u4f4d\u7f6e $x$ \u7684\u6743\u503c\u662f $a_x$ \u540e\u5efa\u7acb\u7684 Treap\u3002\u5982\u679c\u5e8f\u5217\u4e2d\u6ca1\u6709\u91cd\u590d\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u8fd9\u68f5\u6811\u662f\u552f\u4e00\u7684\u3002\u56de\u5fc6\u8d77\u6240\u6709\u6ee1\u8db3\u6700\u5927\u503c\u4e3a $a_x$ \u7684\u533a\u95f4 $[l',\\\\;r']$ \u6ee1\u8db3 $l(x) \\\\leqslant l' \\\\leqslant x \\\\leqslant r' \\\\leqslant r(x)$\uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u4e2a\u6700\u5927\u503c $x$ \u5728\u6811\u4e0a\u4e00\u5b9a\u662f $l'$ \u548c $r'$ \u7684\u516c\u5171\u7956\u5148\u3002\u6b64\u5916\uff0c\u8fd8\u8981\u6ee1\u8db3 $l' \\\\leqslant x \\\\leqslant r'$\uff0c\u8fd9\u6070\u597d\u8bf4\u660e $x$ \u9700\u8981\u662f $\\\\mathrm{lca}(l',\\\\;r')$\u3002\u56e0\u4e3a\u5982\u679c\u4e0d\u662f\u6700\u8fd1\u516c\u5171\u7956\u5148\u5c31\u4e0d\u4f1a\u5c06 $l'$ \u548c $r'$ \u9694\u5f00\uff0c\u5c31\u6bd4\u5982\u4e0a\u56fe\u4e2d\u7684 $[3,\\\\;5]$\uff0c\u8fd9\u4e2a\u533a\u95f4\u7684\u6700\u5927\u503c\u662f $a_4$\uff0c\u800c\u4e0d\u662f $a_7$\u3002<br/>\u5982\u679c\u6211\u4eec\u80fd\u591f\u5feb\u901f\u7684\u6784\u5efa\u51fa\u7b1b\u5361\u5c14\u6811\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e0a\u4e00\u8282\u8ba8\u8bba\u7684 $\\\\Theta(n)$-$\\\\Theta(1)$ \u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u7b97\u6cd5\u4ee5\u540c\u6837\u7684\u590d\u6742\u5ea6\u89e3\u51b3\u9759\u6001 RMQ \u95ee\u9898\u4e86\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u4eec\u53ea\u7528\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u4e4b\u524d\u7684\u5355\u8c03\u961f\u5217\u7b97\u6cd5\uff0c\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u7b1b\u5361\u5c14\u6811\u3002<br/>\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u6709\u4e86\u4e00\u68f5\u7b1b\u5361\u5c14\u6811\uff0c\u8003\u8651\u5728\u540e\u9762\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u5143\u7d20 $a_x$ \u65f6\uff0c\u7b1b\u5361\u5c14\u6811\u8be5\u5982\u4f55\u53d8\u5316\u3002\u9996\u5148\uff0c\u6211\u4eec\u8fd8\u662f\u8981\u627e\u51fa $a_x$ \u5f80\u5de6\u8d70\u7684\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u5143\u7d20 $a_y$\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u77e5\u9053 $y$ \u662f $x$ \u7684\u7236\u4eb2\u4e86\u3002\u53e6\u5916\uff0c\u4e0d\u8981\u5fd8\u8bb0\u90a3\u4e9b\u88ab\u5f39\u51fa\u961f\u5217\u7684\u70b9\uff0c\u8fd9\u4e9b\u7684\u70b9\u7684 $r$ \u51fd\u6570\u7684\u503c\u5df2\u7ecf\u5168\u90e8\u88ab\u4fee\u6539\u4e3a $x - 1$ \u4e86\uff0c\u6240\u4ee5\u4f1a\u6539\u53d8\u5b83\u4eec\u7684\u7236\u4eb2\uff1a<br/><br/>\uff08Fig. 12. \u65b0\u52a0\u5165\u4e00\u4e2a\u5143\u7d20\uff0c\u5176\u6743\u503c\u4e3a $7$\uff0c\u4ee5 $6$ \u4e3a\u6839\u7684\u5b50\u6811\u53d8\u6210\u4e86\u65b0\u70b9\u7684\u5de6\u513f\u5b50\uff09<br/>\u7ecf\u4fee\u6539\u540e\u7684\u7b97\u6cd5\u5b9e\u73b0\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5<br/> 6<br/> 7<br/> 8<br/> 9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19// \u73b0\u5728\u6bcf\u4e2a\u5143\u7d20 a[i] \u6709\u4e09\u4e2a\u5c5e\u6027 value\u3001left \u548c right\uff0c<br/>// \u5206\u522b\u8868\u793a\u6743\u503c\u3001\u4e8c\u53c9\u6811\u4e0a\u7684\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\uff0c\u5982\u679c\u6ca1\u6709\u513f\u5b50\u5219\u4e3a null<br/>function BUILD-CARTESIAN-TREE(a):<br/>    Q = []<br/>    foreach x in a:<br/>        while Q is not empty and Q.last().value <= x.value:<br/>            Q.last().right = x.left<br/>            x.left = Q.last()<br/>            Q.pop_back()<br/><br/>        Q.push_back(x)<br/><br/>    // \u6700\u540e\u7559\u5728\u961f\u5217\u91cc\u7684\u70b9\u76f8\u8fde<br/>    while Q.size() > 1:<br/>        v = Q.last()<br/>        Q.pop_back()<br/>        Q.last().right = v<br/><br/>    return Q.first()  // \u8fd4\u56de\u7b1b\u5361\u5c14\u6811\u7684\u6811\u6839<br/><br/><br/>\u81f3\u6b64\uff0c\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\u548c\u533a\u95f4\u6700\u503c\u95ee\u9898\u540c\u65f6\u90fd\u5f97\u5230\u4e86\u4f18\u79c0\u7684\u89e3\u51b3\u65b9\u6848\u3002\u73b0\u5728\u6211\u4eec\u6765\u6574\u7406\u4e00\u4e0b\u8fd9\u4e24\u8005\u4e4b\u95f4\u7684\u8054\u7cfb\uff1a<br/><br/>\u5229\u7528 DFS \u5e8f\u53ef\u4ee5\u5c06\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\u8f6c\u4e3a\u533a\u95f4\u6700\u503c\u95ee\u9898\u3002<br/>\u5229\u7528\u7b1b\u5361\u5c14\u6811\u53ef\u4ee5\u5c06\u533a\u95f4\u6700\u503c\u95ee\u9898\u8f6c\u4e3a\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898\u3002<br/><br/>\u6ce8\u8bb0<br/>\u4e0a\u6587\u4e2d\u5b9e\u9645\u4e0a\u53ea\u4ecb\u7ecd\u4e86\u5728\u7ebf\u7b97\u6cd5\uff0c\u800c\u6ca1\u6709\u4ecb\u7ecd\u79bb\u7ebf\u7b97\u6cd5\uff0c\u4e00\u662f\u56e0\u4e3a\u79bb\u7ebf\u7b97\u6cd5\u5e94\u7528\u573a\u666f\u6bd4\u8f83\u5c11\uff0c\u4e8c\u662f\u56e0\u4e3a\u6211\u6240\u77e5\u9053\u7684\u79bb\u7ebf\u7b97\u6cd5\uff08\u5206\u6cbb\u6cd5\u548c Tarjan \u7b97\u6cd5\uff09\u7684\u590d\u6742\u5ea6\u5e76\u6ca1\u6709\u8fbe\u5230\u7406\u8bba\u4e0b\u754c\uff08Tarjan \u7b97\u6cd5\u662f\u4e00\u4e2a\u590d\u6742\u5ea6\u63a5\u8fd1\u5e38\u6570\u7684 $\\\\Theta(n + q)$-$O(\\\\alpha(n))$ \u7b97\u6cd5\uff09\u3002\u6240\u4ee5\u53ea\u5728\u8fd9\u91cc\u7b80\u5355\u63d0\u53ca\u4e00\u4e0b\u3002\u5206\u6cbb\u7b97\u6cd5\u4f7f\u7528\u4e86\u4e00\u79cd\u901a\u5e38\u79f0\u4f5c \u201c\u6574\u4f53\u4e8c\u5206\u201d \u7684\u601d\u60f3\uff1a\u5b9a\u4e49\u8fc7\u7a0b $\\\\mathrm{solve}(l,\\\\;r)$ \u4f1a\u89e3\u51b3\u6700\u8fd1\u516c\u5171\u7956\u5148\u7684\u6df1\u5ea6\u5728 $[l,\\\\;r]$ \u7684\u6240\u6709\u8be2\u95ee\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5927\u81f4\u6267\u884c\u6b65\u9aa4\u5982\u4e0b\uff1a<br/><br/>\u4ee4 $m = (l + r) / 2$\uff0c\u8868\u793a\u6211\u4eec\u4e8c\u5206\u7684\u7b54\u6848\u3002<br/>\u5c06\u6240\u6709\u6df1\u5ea6\u4e3a $m$ \u7684\u70b9 $u$ \u7684\u5b50\u6811 $T_u$ \u5185\u6df1\u5ea6\u4e0d\u5927\u4e8e $r$ \u7684\u70b9\u7684\u6807\u53f7\u8bbe\u4e3a $u$\u3002<br/>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee $u$\u3001$v$\uff0c\u5982\u679c $u$ \u548c $v$ \u90fd\u6709\u6807\u53f7\u4e14\u6807\u53f7\u76f8\u540c\uff0c\u5219\u8bf4\u660e $d(\\\\mathrm{lca}(u,\\\\;v)) \\\\geqslant m$\uff0c\u5c06\u8fd9\u4e2a\u8be2\u95ee\u4ea4\u7ed9 $\\\\mathrm{solve}(m,\\\\;r)$\u3002\u5426\u5219\u5c06 $u$ \u548c $v$ \u90fd\u53d8\u4e3a\u81ea\u5df1\u6807\u53f7\u7684\u7236\u4eb2\uff08\u5982\u679c\u6ca1\u6709\u6807\u53f7\u5219\u4e0d\u53d8\uff09\uff0c\u5e76\u4ea4\u7ed9 $\\\\mathrm{solve}(l,\\\\;m-1)$\u3002<br/>\u6e05\u9664\u6240\u6709\u6807\u53f7\u5e76\u4e14\u9012\u5f52\u5904\u7406 $\\\\mathrm{solve}(m,\\\\;r)$ \u548c $\\\\mathrm{solve}(l,\\\\;m-1)$\u3002<br/><br/>\u5206\u6cbb\u7b97\u6cd5\u672c\u8d28\u4e0a\u662f\u5b9e\u73b0\u4e86\u4e00\u4e2a\u96c6\u4f53\u500d\u589e\u7684\u65b9\u6cd5\uff0c\u5176\u590d\u6742\u5ea6\u4e3a $\\\\Theta(n + q)$-$O(\\\\log h)$\u3002Tarjan \u7b97\u6cd5\u5219\u662f\u5bf9 DFS \u5e8f\u7684\u5904\u7406\uff0c\u5728\u56de\u6eaf\u7684\u65f6\u5019\u5c06\u7236\u4eb2\u4e0e\u513f\u5b50\u5229\u7528\u5e76\u67e5\u96c6\u8fde\u63a5\u8d77\u6765\uff0c\u5e76\u4e14\u5728\u5e76\u67e5\u96c6\u4e0a\u5b58\u50a8\u9644\u52a0\u4fe1\u606f\u4f7f\u5f97\u53ef\u4ee5\u67e5\u8be2\u7b54\u6848\uff0c\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u65b9\u4fbf\u3002<br/>\u5728\u524d\u6587\u4e2d\u7559\u4e0b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u601d\u8003\u9898\uff0c\u5c31\u662f\u5229\u7528\u957f\u94fe\u5256\u5206\u5b9e\u73b0 $O(n \\\\log h)$-$\\\\Theta(1)$ \u7684\u7956\u5148\u67e5\u8be2\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53ef\u4ee5\u5728 https://riteme.github.io/blog/2017-2-6/long-chain.html \u5904\u627e\u5230\u7b54\u6848\u3002<br/>RMQ \u95ee\u9898\u7684\u5b9e\u73b0\u65b9\u9762\uff0c\u5176\u5b9e\u8fd8\u6709\u8bb8\u591a\u53ef\u4ee5\u4ed4\u7ec6\u601d\u8003\u7684\u5730\u65b9\u3002\u867d\u7136\u6211\u4eec\u5728\u7406\u8bba\u4e0a\u8fbe\u5230\u4e86\u6700\u4f18\uff0c\u4f46\u662f\u5b83\u4ed8\u51fa\u4e86\u8f83\u5927\u7684\u7a7a\u95f4\u4ee3\u4ef7\uff0c\u5e76\u4e14\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\u8fd9\u79cd\u7b97\u6cd5\u5b9e\u9645\u8868\u73b0\u60c5\u51b5\u5e76\u4e0d\u5982\u60f3\u8c61\u4e2d\u90a3\u4e48\u4f18\u79c0\u3002\u76f8\u5173\u7684\u8ba8\u8bba\u53ef\u4ee5\u5728 Wikipedia \u7684\u7b1b\u5361\u5c14\u6811\uff08https://en.wikipedia.org/wiki/Cartesian_tree\uff09\u7684\u5f15\u7528\u4e2d\u627e\u5230\u3002<br/>\u6700\u540e\uff0c\u524d\u9762\u6240\u63d0\u53ca\u7684\u7b97\u6cd5\u6211\u57fa\u672c\u4e0a\u4eb2\u81ea\u4f7f\u7528 C++ \u5b9e\u73b0\u5e76\u6d4b\u8bd5\u8fc7\uff0c\u8fd9\u4e9b\u4ee3\u7801\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230\uff1ahttps://github.com/riteme/test/tree/master/oi/Code/algs/Graph/LCA<br/><br/><br/><br/><br/>\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a_i$ \u7ecf\u8fc7\u5dee\u5206\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u957f\u5ea6\u4e3a $n - 1$ \u7684\u5e8f\u5217 $d_i$\uff0c\u5176\u4e2d $d_i = a_{i + 1} - a_i$\uff0c\u5373\u8bb0\u5f55\u76f8\u90bb\u4e24\u4e2a\u6570\u4e4b\u5dee\u3002\u5982\u679c\u77e5\u9053 $a_1$\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u901a\u8fc7 $d_i$ \u63a8\u51fa $a_i$\u3002\u00a0\u21a9<br/><br/><br/>",
"url": "blog/2017-9-3/lca.html"
}
}